function GraphemeSplitter(){var t=3,e=4,r=12,i=13,n=16,o=17;function a(t,e){void 0===e&&(e=0);var r=t.charCodeAt(e);if(55296<=r&&r<=56319&&e<t.length-1){var i=r;return 56320<=(n=t.charCodeAt(e+1))&&n<=57343?1024*(i-55296)+(n-56320)+65536:i}if(56320<=r&&r<=57343&&e>=1){var n=r;return 55296<=(i=t.charCodeAt(e-1))&&i<=56319?1024*(i-55296)+(n-56320)+65536:n}return r}function s(a,s,h){var l=[a].concat(s).concat([h]),u=l[l.length-2],c=h,p=l.lastIndexOf(14);if(p>1&&l.slice(1,p).every((function(e){return e==t}))&&-1==[t,i,o].indexOf(a))return 2;var d=l.lastIndexOf(e);if(d>0&&l.slice(1,d).every((function(t){return t==e}))&&-1==[r,e].indexOf(u))return l.filter((function(t){return t==e})).length%2==1?3:4;if(0==u&&1==c)return 0;if(2==u||0==u||1==u)return 14==c&&s.every((function(e){return e==t}))?2:1;if(2==c||0==c||1==c)return 1;if(6==u&&(6==c||7==c||9==c||10==c))return 0;if(!(9!=u&&7!=u||7!=c&&8!=c))return 0;if((10==u||8==u)&&8==c)return 0;if(c==t||15==c)return 0;if(5==c)return 0;if(u==r)return 0;var f=-1!=l.indexOf(t)?l.lastIndexOf(t)-1:l.length-2;return-1!=[i,o].indexOf(l[f])&&l.slice(f+1,-1).every((function(e){return e==t}))&&14==c||15==u&&-1!=[n,o].indexOf(c)?0:-1!=s.indexOf(e)?2:u==e&&c==e?0:1}function h(e){return 1536<=e&&e<=1541||1757==e||1807==e||2274==e||3406==e||69821==e||70082<=e&&e<=70083||72250==e||72326<=e&&e<=72329||73030==e?r:13==e?0:10==e?1:0<=e&&e<=9||11<=e&&e<=12||14<=e&&e<=31||127<=e&&e<=159||173==e||1564==e||6158==e||8203==e||8206<=e&&e<=8207||8232==e||8233==e||8234<=e&&e<=8238||8288<=e&&e<=8292||8293==e||8294<=e&&e<=8303||55296<=e&&e<=57343||65279==e||65520<=e&&e<=65528||65529<=e&&e<=65531||113824<=e&&e<=113827||119155<=e&&e<=119162||917504==e||917505==e||917506<=e&&e<=917535||917632<=e&&e<=917759||918e3<=e&&e<=921599?2:768<=e&&e<=879||1155<=e&&e<=1159||1160<=e&&e<=1161||1425<=e&&e<=1469||1471==e||1473<=e&&e<=1474||1476<=e&&e<=1477||1479==e||1552<=e&&e<=1562||1611<=e&&e<=1631||1648==e||1750<=e&&e<=1756||1759<=e&&e<=1764||1767<=e&&e<=1768||1770<=e&&e<=1773||1809==e||1840<=e&&e<=1866||1958<=e&&e<=1968||2027<=e&&e<=2035||2070<=e&&e<=2073||2075<=e&&e<=2083||2085<=e&&e<=2087||2089<=e&&e<=2093||2137<=e&&e<=2139||2260<=e&&e<=2273||2275<=e&&e<=2306||2362==e||2364==e||2369<=e&&e<=2376||2381==e||2385<=e&&e<=2391||2402<=e&&e<=2403||2433==e||2492==e||2494==e||2497<=e&&e<=2500||2509==e||2519==e||2530<=e&&e<=2531||2561<=e&&e<=2562||2620==e||2625<=e&&e<=2626||2631<=e&&e<=2632||2635<=e&&e<=2637||2641==e||2672<=e&&e<=2673||2677==e||2689<=e&&e<=2690||2748==e||2753<=e&&e<=2757||2759<=e&&e<=2760||2765==e||2786<=e&&e<=2787||2810<=e&&e<=2815||2817==e||2876==e||2878==e||2879==e||2881<=e&&e<=2884||2893==e||2902==e||2903==e||2914<=e&&e<=2915||2946==e||3006==e||3008==e||3021==e||3031==e||3072==e||3134<=e&&e<=3136||3142<=e&&e<=3144||3146<=e&&e<=3149||3157<=e&&e<=3158||3170<=e&&e<=3171||3201==e||3260==e||3263==e||3266==e||3270==e||3276<=e&&e<=3277||3285<=e&&e<=3286||3298<=e&&e<=3299||3328<=e&&e<=3329||3387<=e&&e<=3388||3390==e||3393<=e&&e<=3396||3405==e||3415==e||3426<=e&&e<=3427||3530==e||3535==e||3538<=e&&e<=3540||3542==e||3551==e||3633==e||3636<=e&&e<=3642||3655<=e&&e<=3662||3761==e||3764<=e&&e<=3769||3771<=e&&e<=3772||3784<=e&&e<=3789||3864<=e&&e<=3865||3893==e||3895==e||3897==e||3953<=e&&e<=3966||3968<=e&&e<=3972||3974<=e&&e<=3975||3981<=e&&e<=3991||3993<=e&&e<=4028||4038==e||4141<=e&&e<=4144||4146<=e&&e<=4151||4153<=e&&e<=4154||4157<=e&&e<=4158||4184<=e&&e<=4185||4190<=e&&e<=4192||4209<=e&&e<=4212||4226==e||4229<=e&&e<=4230||4237==e||4253==e||4957<=e&&e<=4959||5906<=e&&e<=5908||5938<=e&&e<=5940||5970<=e&&e<=5971||6002<=e&&e<=6003||6068<=e&&e<=6069||6071<=e&&e<=6077||6086==e||6089<=e&&e<=6099||6109==e||6155<=e&&e<=6157||6277<=e&&e<=6278||6313==e||6432<=e&&e<=6434||6439<=e&&e<=6440||6450==e||6457<=e&&e<=6459||6679<=e&&e<=6680||6683==e||6742==e||6744<=e&&e<=6750||6752==e||6754==e||6757<=e&&e<=6764||6771<=e&&e<=6780||6783==e||6832<=e&&e<=6845||6846==e||6912<=e&&e<=6915||6964==e||6966<=e&&e<=6970||6972==e||6978==e||7019<=e&&e<=7027||7040<=e&&e<=7041||7074<=e&&e<=7077||7080<=e&&e<=7081||7083<=e&&e<=7085||7142==e||7144<=e&&e<=7145||7149==e||7151<=e&&e<=7153||7212<=e&&e<=7219||7222<=e&&e<=7223||7376<=e&&e<=7378||7380<=e&&e<=7392||7394<=e&&e<=7400||7405==e||7412==e||7416<=e&&e<=7417||7616<=e&&e<=7673||7675<=e&&e<=7679||8204==e||8400<=e&&e<=8412||8413<=e&&e<=8416||8417==e||8418<=e&&e<=8420||8421<=e&&e<=8432||11503<=e&&e<=11505||11647==e||11744<=e&&e<=11775||12330<=e&&e<=12333||12334<=e&&e<=12335||12441<=e&&e<=12442||42607==e||42608<=e&&e<=42610||42612<=e&&e<=42621||42654<=e&&e<=42655||42736<=e&&e<=42737||43010==e||43014==e||43019==e||43045<=e&&e<=43046||43204<=e&&e<=43205||43232<=e&&e<=43249||43302<=e&&e<=43309||43335<=e&&e<=43345||43392<=e&&e<=43394||43443==e||43446<=e&&e<=43449||43452==e||43493==e||43561<=e&&e<=43566||43569<=e&&e<=43570||43573<=e&&e<=43574||43587==e||43596==e||43644==e||43696==e||43698<=e&&e<=43700||43703<=e&&e<=43704||43710<=e&&e<=43711||43713==e||43756<=e&&e<=43757||43766==e||44005==e||44008==e||44013==e||64286==e||65024<=e&&e<=65039||65056<=e&&e<=65071||65438<=e&&e<=65439||66045==e||66272==e||66422<=e&&e<=66426||68097<=e&&e<=68099||68101<=e&&e<=68102||68108<=e&&e<=68111||68152<=e&&e<=68154||68159==e||68325<=e&&e<=68326||69633==e||69688<=e&&e<=69702||69759<=e&&e<=69761||69811<=e&&e<=69814||69817<=e&&e<=69818||69888<=e&&e<=69890||69927<=e&&e<=69931||69933<=e&&e<=69940||70003==e||70016<=e&&e<=70017||70070<=e&&e<=70078||70090<=e&&e<=70092||70191<=e&&e<=70193||70196==e||70198<=e&&e<=70199||70206==e||70367==e||70371<=e&&e<=70378||70400<=e&&e<=70401||70460==e||70462==e||70464==e||70487==e||70502<=e&&e<=70508||70512<=e&&e<=70516||70712<=e&&e<=70719||70722<=e&&e<=70724||70726==e||70832==e||70835<=e&&e<=70840||70842==e||70845==e||70847<=e&&e<=70848||70850<=e&&e<=70851||71087==e||71090<=e&&e<=71093||71100<=e&&e<=71101||71103<=e&&e<=71104||71132<=e&&e<=71133||71219<=e&&e<=71226||71229==e||71231<=e&&e<=71232||71339==e||71341==e||71344<=e&&e<=71349||71351==e||71453<=e&&e<=71455||71458<=e&&e<=71461||71463<=e&&e<=71467||72193<=e&&e<=72198||72201<=e&&e<=72202||72243<=e&&e<=72248||72251<=e&&e<=72254||72263==e||72273<=e&&e<=72278||72281<=e&&e<=72283||72330<=e&&e<=72342||72344<=e&&e<=72345||72752<=e&&e<=72758||72760<=e&&e<=72765||72767==e||72850<=e&&e<=72871||72874<=e&&e<=72880||72882<=e&&e<=72883||72885<=e&&e<=72886||73009<=e&&e<=73014||73018==e||73020<=e&&e<=73021||73023<=e&&e<=73029||73031==e||92912<=e&&e<=92916||92976<=e&&e<=92982||94095<=e&&e<=94098||113821<=e&&e<=113822||119141==e||119143<=e&&e<=119145||119150<=e&&e<=119154||119163<=e&&e<=119170||119173<=e&&e<=119179||119210<=e&&e<=119213||119362<=e&&e<=119364||121344<=e&&e<=121398||121403<=e&&e<=121452||121461==e||121476==e||121499<=e&&e<=121503||121505<=e&&e<=121519||122880<=e&&e<=122886||122888<=e&&e<=122904||122907<=e&&e<=122913||122915<=e&&e<=122916||122918<=e&&e<=122922||125136<=e&&e<=125142||125252<=e&&e<=125258||917536<=e&&e<=917631||917760<=e&&e<=917999?t:8205==e?15:11}return this.nextBreak=function(t,e){if(void 0===e&&(e=0),e<0)return 0;if(e>=t.length-1)return t.length;for(var r,i,n=h(a(t,e)),o=[],l=e+1;l<t.length;l++)if(i=l-1,!(55296<=(r=t).charCodeAt(i)&&r.charCodeAt(i)<=56319&&56320<=r.charCodeAt(i+1)&&r.charCodeAt(i+1)<=57343)){var u=h(a(t,l));if(s(n,o,u))return l;o.push(u)}return t.length},this.splitGraphemes=function(t){for(var e,r=[],i=0;(e=this.nextBreak(t,i))<t.length;)r.push(t.slice(i,e)),i=e;return i<t.length&&r.push(t.slice(i)),r},this.iterateGraphemes=function(t){var e=0,r={next:function(){var r,i;return(i=this.nextBreak(t,e))<t.length?(r=t.slice(e,i),e=i,{value:r,done:!1}):e<t.length?(r=t.slice(e),e=t.length,{value:r,done:!1}):{value:void 0,done:!0}}.bind(this)};return"undefined"!=typeof Symbol&&Symbol.iterator&&(r[Symbol.iterator]=function(){return r}),r},this.countGraphemes=function(t){for(var e,r=0,i=0;(e=this.nextBreak(t,i))<t.length;)i=e,r++;return i<t.length&&r++,r},this}!function t(e,r,i){function n(a,s){if(!r[a]){if(!e[a]){var h="function"==typeof require&&require;if(!s&&h)return h(a,!0);if(o)return o(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var u=r[a]={exports:{}};e[a][0].call(u.exports,(function(t){var r=e[a][1][t];return n(r||t)}),u,u.exports,t,e,r,i)}return r[a].exports}for(var o="function"==typeof require&&require,a=0;a<i.length;a++)n(i[a]);return n}({1:[function(t){(function(e){"use strict";if(e._babelPolyfill)throw new Error("only one instance of babel/polyfill is allowed");e._babelPolyfill=!0,t("./es6-shim"),t("regenerator-babel/runtime")}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./es6-shim":2,"regenerator-babel/runtime":60}],2:[function(t,e){t("core-js/es6"),e.exports=t("core-js/modules/$").core},{"core-js/es6":3,"core-js/modules/$":16}],3:[function(t,e){t("../modules/es6.symbol"),t("../modules/es6.object.assign"),t("../modules/es6.object.is"),t("../modules/es6.object.set-prototype-of"),t("../modules/es6.object.to-string"),t("../modules/es6.object.statics-accept-primitives"),t("../modules/es6.function.name"),t("../modules/es6.number.constructor"),t("../modules/es6.number.statics"),t("../modules/es6.math"),t("../modules/es6.string.from-code-point"),t("../modules/es6.string.raw"),t("../modules/es6.string.iterator"),t("../modules/es6.string.code-point-at"),t("../modules/es6.string.ends-with"),t("../modules/es6.string.includes"),t("../modules/es6.string.repeat"),t("../modules/es6.string.starts-with"),t("../modules/es6.array.from"),t("../modules/es6.array.of"),t("../modules/es6.array.species"),t("../modules/es6.array.iterator"),t("../modules/es6.array.copy-within"),t("../modules/es6.array.fill"),t("../modules/es6.array.find"),t("../modules/es6.array.find-index"),t("../modules/es6.regexp"),t("../modules/es6.promise"),t("../modules/es6.map"),t("../modules/es6.set"),t("../modules/es6.weak-map"),t("../modules/es6.weak-set"),t("../modules/es6.reflect"),e.exports=t("../modules/$").core},{"../modules/$":16,"../modules/es6.array.copy-within":27,"../modules/es6.array.fill":28,"../modules/es6.array.find":30,"../modules/es6.array.find-index":29,"../modules/es6.array.from":31,"../modules/es6.array.iterator":32,"../modules/es6.array.of":33,"../modules/es6.array.species":34,"../modules/es6.function.name":35,"../modules/es6.map":36,"../modules/es6.math":37,"../modules/es6.number.constructor":38,"../modules/es6.number.statics":39,"../modules/es6.object.assign":40,"../modules/es6.object.is":41,"../modules/es6.object.set-prototype-of":42,"../modules/es6.object.statics-accept-primitives":43,"../modules/es6.object.to-string":44,"../modules/es6.promise":45,"../modules/es6.reflect":46,"../modules/es6.regexp":47,"../modules/es6.set":48,"../modules/es6.string.code-point-at":49,"../modules/es6.string.ends-with":50,"../modules/es6.string.from-code-point":51,"../modules/es6.string.includes":52,"../modules/es6.string.iterator":53,"../modules/es6.string.raw":54,"../modules/es6.string.repeat":55,"../modules/es6.string.starts-with":56,"../modules/es6.symbol":57,"../modules/es6.weak-map":58,"../modules/es6.weak-set":59}],4:[function(t,e){"use strict";var r=t("./$"),i=t("./$.ctx");e.exports=function(t){var e=1==t,n=2==t,o=3==t,a=4==t,s=6==t,h=5==t||s;return function(l){for(var u,c,p=Object(r.assertDefined(this)),d=r.ES5Object(p),f=i(l,arguments[1],3),m=r.toLength(d.length),v=0,y=e?Array(m):n?[]:void 0;m>v;v++)if((h||v in d)&&(c=f(u=d[v],v,p),t))if(e)y[v]=c;else if(c)switch(t){case 3:return!0;case 5:return u;case 6:return v;case 2:y.push(u)}else if(a)return!1;return s?-1:o||a?a:y}}},{"./$":16,"./$.ctx":11}],5:[function(t,e){function r(t,e,r){if(!t)throw TypeError(r?e+r:e)}var i=t("./$");r.def=i.assertDefined,r.fn=function(t){if(!i.isFunction(t))throw TypeError(t+" is not a function!");return t},r.obj=function(t){if(!i.isObject(t))throw TypeError(t+" is not an object!");return t},r.inst=function(t,e,r){if(!(t instanceof e))throw TypeError(r+": use the 'new' operator!");return t},e.exports=r},{"./$":16}],6:[function(t,e){var r=t("./$");e.exports=Object.assign||function(t){for(var e=Object(r.assertDefined(t)),i=arguments.length,n=1;i>n;)for(var o,a=r.ES5Object(arguments[n++]),s=r.getKeys(a),h=s.length,l=0;h>l;)e[o=s[l++]]=a[o];return e}},{"./$":16}],7:[function(t,e){function r(t){return o.call(t).slice(8,-1)}var i=t("./$"),n=t("./$.wks")("toStringTag"),o={}.toString;r.classof=function(t){var e,i;return null==t?void 0===t?"Undefined":"Null":"string"==typeof(i=(e=Object(t))[n])?i:r(e)},r.set=function(t,e,r){t&&!i.has(t=r?t:t.prototype,n)&&i.hide(t,n,e)},e.exports=r},{"./$":16,"./$.wks":26}],8:[function(t,e){"use strict";function r(t,e){if(!c(t))return("string"==typeof t?"S":"P")+t;if(f(t))return"F";if(!l(t,m)){if(!e)return"E";p(t,m,++b)}return"O"+t[m]}function i(t,e){var i,n=r(e);if("F"!=n)return t[v][n];for(i=t[g];i;i=i.n)if(i.k==e)return i}var n=t("./$"),o=t("./$.ctx"),a=t("./$.uid").safe,s=t("./$.assert"),h=t("./$.iter"),l=n.has,u=n.set,c=n.isObject,p=n.hide,d=h.step,f=Object.isFrozen||n.core.Object.isFrozen,m=a("id"),v=a("O1"),y=a("last"),g=a("first"),_=a("iter"),x=n.DESC?a("size"):"size",b=0;e.exports={getConstructor:function(t,e,r){function a(i){var o=s.inst(this,a,t);u(o,v,n.create(null)),u(o,x,0),u(o,y,void 0),u(o,g,void 0),null!=i&&h.forOf(i,e,o[r],o)}return n.mix(a.prototype,{clear:function(){for(var t=this,e=t[v],r=t[g];r;r=r.n)r.r=!0,r.p&&(r.p=r.p.n=void 0),delete e[r.i];t[g]=t[y]=void 0,t[x]=0},delete:function(t){var e=this,r=i(e,t);if(r){var n=r.n,o=r.p;delete e[v][r.i],r.r=!0,o&&(o.n=n),n&&(n.p=o),e[g]==r&&(e[g]=n),e[y]==r&&(e[y]=o),e[x]--}return!!r},forEach:function(t){for(var e,r=o(t,arguments[1],3);e=e?e.n:this[g];)for(r(e.v,e.k,this);e&&e.r;)e=e.p},has:function(t){return!!i(this,t)}}),n.DESC&&n.setDesc(a.prototype,"size",{get:function(){return s.def(this[x])}}),a},def:function(t,e,n){var o,a,s=i(t,e);return s?s.v=n:(t[y]=s={i:a=r(e,!0),k:e,v:n,p:o=t[y],n:void 0,r:!1},t[g]||(t[g]=s),o&&(o.n=s),t[x]++,"F"!=a&&(t[v][a]=s)),t},getEntry:i,getIterConstructor:function(){return function(t,e){u(this,_,{o:t,k:e})}},next:function(){for(var t=this[_],e=t.k,r=t.l;r&&r.r;)r=r.p;return t.o&&(t.l=r=r?r.n:t.o[g])?d(0,"key"==e?r.k:"value"==e?r.v:[r.k,r.v]):(t.o=void 0,d(1))}}},{"./$":16,"./$.assert":5,"./$.ctx":11,"./$.iter":15,"./$.uid":24}],9:[function(t,e){"use strict";function r(t,e){return y.call(t.array,(function(t){return t[0]===e}))}function i(t){return t[m]||u(t,m,{array:[],get:function(t){var e=r(this,t);return e?e[1]:void 0},has:function(t){return!!r(this,t)},set:function(t,e){var i=r(this,t);i?i[1]=e:this.array.push([t,e])},delete:function(t){var e=g.call(this.array,(function(e){return e[0]===t}));return~e&&this.array.splice(e,1),!!~e}})[m]}var n=t("./$"),o=t("./$.uid").safe,a=t("./$.assert"),s=t("./$.iter").forOf,h=n.has,l=n.isObject,u=n.hide,c=Object.isFrozen||n.core.Object.isFrozen,p=0,d=o("id"),f=o("weak"),m=o("leak"),v=t("./$.array-methods"),y=v(5),g=v(6);e.exports={getConstructor:function(t,e,r){function o(i){n.set(a.inst(this,o,t),d,p++),null!=i&&s(i,e,this[r],this)}return n.mix(o.prototype,{delete:function(t){return!!l(t)&&(c(t)?i(this).delete(t):h(t,f)&&h(t[f],this[d])&&delete t[f][this[d]])},has:function(t){return!!l(t)&&(c(t)?i(this).has(t):h(t,f)&&h(t[f],this[d]))}}),o},def:function(t,e,r){return c(a.obj(e))?i(t).set(e,r):(h(e,f)||u(e,f,{}),e[f][t[d]]=r),t},leakStore:i,WEAK:f,ID:d}},{"./$":16,"./$.array-methods":4,"./$.assert":5,"./$.iter":15,"./$.uid":24}],10:[function(t,e){"use strict";var r=t("./$"),i=t("./$.def"),n=t("./$.iter"),o=t("./$.assert").inst;e.exports=function(e,a,s,h,l){function u(t,e){var i=f[t];r.FW&&(f[t]=function(t,r){var n=i.call(this,0===t?0:t,r);return e?this:n})}var c=r.g[e],p=c,d=h?"set":"add",f=p&&p.prototype,m={};if(r.isFunction(p)&&(l||!n.BUGGY&&f.forEach&&f.entries)){var v,y=new p,g=y[d](l?{}:-0,1);(n.fail((function(t){new p(t)}))||n.DANGER_CLOSING)&&((p=function(t){o(this,p,e);var r=new c;return null!=t&&n.forOf(t,h,r[d],r),r}).prototype=f,r.FW&&(f.constructor=p)),l||y.forEach((function(t,e){v=1/e==-1/0})),v&&(u("delete"),u("has"),h&&u("get")),(v||g!==y)&&u(d,!0)}else p=s.getConstructor(e,h,d),r.mix(p.prototype,a);return t("./$.cof").set(p,e),t("./$.species")(p),m[e]=p,i(i.G+i.W+i.F*(p!=c),m),l||n.std(p,e,s.getIterConstructor(),s.next,h?"key+value":"value",!h,!0),p}},{"./$":16,"./$.assert":5,"./$.cof":7,"./$.def":12,"./$.iter":15,"./$.species":21}],11:[function(t,e){var r=t("./$.assert").fn;e.exports=function(t,e,i){if(r(t),~i&&void 0===e)return t;switch(i){case 1:return function(r){return t.call(e,r)};case 2:return function(r,i){return t.call(e,r,i)};case 3:return function(r,i,n){return t.call(e,r,i,n)}}return function(){return t.apply(e,arguments)}}},{"./$.assert":5}],12:[function(t,e){function r(t,e){return function(){return t.apply(e,arguments)}}function i(t,e,h){var l,u,c,p,d=t&i.G,f=d?o:t&i.S?o[e]:(o[e]||{}).prototype,m=d?a:a[e]||(a[e]={});for(l in d&&(h=e),h)c=((u=!(t&i.F)&&f&&l in f)?f:h)[l],p=t&i.B&&u?r(c,o):t&i.P&&s(c)?r(Function.call,c):c,f&&!u&&(d?f[l]=c:delete f[l]&&n.hide(f,l,c)),m[l]!=c&&n.hide(m,l,p)}var n=t("./$"),o=n.g,a=n.core,s=n.isFunction;o.core=a,i.F=1,i.G=2,i.S=4,i.P=8,i.B=16,i.W=32,e.exports=i},{"./$":16}],13:[function(t,e){e.exports=function(t){return t.FW=!0,t.path=t.g,t}},{}],14:[function(t,e){e.exports=function(t,e,r){var i=void 0===r;switch(e.length){case 0:return i?t():t.call(r);case 1:return i?t(e[0]):t.call(r,e[0]);case 2:return i?t(e[0],e[1]):t.call(r,e[0],e[1]);case 3:return i?t(e[0],e[1],e[2]):t.call(r,e[0],e[1],e[2]);case 4:return i?t(e[0],e[1],e[2],e[3]):t.call(r,e[0],e[1],e[2],e[3]);case 5:return i?t(e[0],e[1],e[2],e[3],e[4]):t.call(r,e[0],e[1],e[2],e[3],e[4])}return t.apply(r,e)}},{}],15:[function(t,e){"use strict";function r(t,e){s.hide(t,p,e),d in[]&&s.hide(t,d,e)}function i(t,e,i,n){var o=t.prototype,a=o[p]||o[d]||n&&o[n]||i;if(s.FW&&r(o,a),a!==i){var h=s.getProto(a.call(new t));l.set(h,e+" Iterator",!0),s.FW&&s.has(o,d)&&r(h,s.that)}return f[e]=a,f[e+" Iterator"]=s.that,a}function n(t){var e=s.g.Symbol,r=t[e&&e.iterator||d]||t[p]||f[l.classof(t)];return c(r.call(t))}function o(t){var e=t.return;void 0!==e&&c(e.call(t))}function a(t,e,r,i){try{return i?e(c(r)[0],r[1]):e(r)}catch(e){throw o(t),e}}var s=t("./$"),h=t("./$.ctx"),l=t("./$.cof"),u=t("./$.def"),c=t("./$.assert").obj,p=t("./$.wks")("iterator"),d="@@iterator",f={},m={},v="keys"in[]&&!("next"in[].keys());r(m,s.that);var y=!0;!function(){try{var t=[1].keys();t.return=function(){y=!1},Array.from(t,(function(){throw 2}))}catch(t){}}();var g=e.exports={BUGGY:v,DANGER_CLOSING:y,fail:function(t){var e=!0;try{var r=[[{},1]],i=r[p](),n=i.next;i.next=function(){return e=!1,n.call(this)},r[p]=function(){return i},t(r)}catch(t){}return e},Iterators:f,prototype:m,step:function(t,e){return{value:e,done:!!t}},stepCall:a,close:o,is:function(t){var e=Object(t),r=s.g.Symbol;return(r&&r.iterator||d)in e||p in e||s.has(f,l.classof(e))},get:n,set:r,create:function(t,e,r,i){t.prototype=s.create(i||g.prototype,{next:s.desc(1,r)}),l.set(t,e+" Iterator")},define:i,std:function(t,e,r,n,o,a,h){function l(t){return function(){return new r(this,t)}}g.create(r,e,n);var c,p,d=l("key+value"),f=l("value"),m=t.prototype;if("value"==o?f=i(t,e,f,"values"):d=i(t,e,d,"entries"),o&&(c={entries:d,keys:a?f:l("key"),values:f},u(u.P+u.F*v,e,c),h))for(p in c)p in m||s.hide(m,p,c[p])},forOf:function(t,e,r,i){for(var s,l=n(t),u=h(r,i,e?2:1);!(s=l.next()).done;)if(!1===a(l,u,s.value,e))return o(l)}}},{"./$":16,"./$.assert":5,"./$.cof":7,"./$.ctx":11,"./$.def":12,"./$.wks":26}],16:[function(t,e){"use strict";function r(t){return isNaN(t=+t)?0:(t>0?p:c)(t)}function i(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}function n(t,e,r){return t[e]=r,t}function o(t){return m?function(e,r,n){return y.setDesc(e,r,i(t,n))}:n}function a(t){if(null==t)throw TypeError("Can't call method on  "+t);return t}var s="undefined"!=typeof self?self:Function("return this")(),h={},l=Object.defineProperty,u={}.hasOwnProperty,c=Math.ceil,p=Math.floor,d=Math.max,f=Math.min,m=!!function(){try{return 2==l({},"a",{get:function(){return 2}}).a}catch(t){}}(),v=o(1),y=e.exports=t("./$.fw")({g:s,core:h,html:s.document&&document.documentElement,isObject:function(t){return null!==t&&("object"==typeof t||"function"==typeof t)},isFunction:function(t){return"function"==typeof t},it:function(t){return t},that:function(){return this},toInteger:r,toLength:function(t){return t>0?f(r(t),9007199254740991):0},toIndex:function(t,e){return 0>(t=r(t))?d(t+e,0):f(t,e)},has:function(t,e){return u.call(t,e)},create:Object.create,getProto:Object.getPrototypeOf,DESC:m,desc:i,getDesc:Object.getOwnPropertyDescriptor,setDesc:l,getKeys:Object.keys,getNames:Object.getOwnPropertyNames,getSymbols:Object.getOwnPropertySymbols,assertDefined:a,ES5Object:Object,toObject:function(t){return y.ES5Object(a(t))},hide:v,def:o(0),set:s.Symbol?n:v,mix:function(t,e){for(var r in e)v(t,r,e[r]);return t},each:[].forEach});"undefined"!=typeof __e&&(__e=h),"undefined"!=typeof __g&&(__g=s)},{"./$.fw":13}],17:[function(t,e){var r=t("./$");e.exports=function(t,e){for(var i,n=r.toObject(t),o=r.getKeys(n),a=o.length,s=0;a>s;)if(n[i=o[s++]]===e)return i}},{"./$":16}],18:[function(t,e){var r=t("./$"),i=t("./$.assert").obj;e.exports=function(t){return i(t),r.getSymbols?r.getNames(t).concat(r.getSymbols(t)):r.getNames(t)}},{"./$":16,"./$.assert":5}],19:[function(t,e){"use strict";e.exports=function(t,e,r){var i=e===Object(e)?function(t){return e[t]}:e;return function(e){return String(r?e:this).replace(t,i)}}},{}],20:[function(t,e){var r=t("./$"),i=t("./$.assert");e.exports=Object.setPrototypeOf||("__proto__"in{}?function(e,n){try{(n=t("./$.ctx")(Function.call,r.getDesc(Object.prototype,"__proto__").set,2))({},[])}catch(t){e=!0}return function(t,o){return i.obj(t),i(null===o||r.isObject(o),o,": can't set as prototype!"),e?t.__proto__=o:n(t,o),t}}():void 0)},{"./$":16,"./$.assert":5,"./$.ctx":11}],21:[function(t,e){var r=t("./$");e.exports=function(e){r.DESC&&r.FW&&r.setDesc(e,t("./$.wks")("species"),{configurable:!0,get:r.that})}},{"./$":16,"./$.wks":26}],22:[function(t,e){"use strict";var r=t("./$");e.exports=function(t){return function(e){var i,n,o=String(r.assertDefined(this)),a=r.toInteger(e),s=o.length;return 0>a||a>=s?t?"":void 0:55296>(i=o.charCodeAt(a))||i>56319||a+1===s||(n=o.charCodeAt(a+1))<56320||n>57343?t?o.charAt(a):i:t?o.slice(a,a+2):n-56320+(i-55296<<10)+65536}}},{"./$":16}],23:[function(t,e){"use strict";function r(){var t=+this;if(s.has(_,t)){var e=_[t];delete _[t],e()}}function i(t){r.call(t.data)}var n,o,a,s=t("./$"),h=t("./$.ctx"),l=t("./$.cof"),u=t("./$.invoke"),c=s.g,p=s.isFunction,d=c.setImmediate,f=c.clearImmediate,m=c.postMessage,v=c.addEventListener,y=c.MessageChannel,g=0,_={},x="onreadystatechange";p(d)&&p(f)||(d=function(t){for(var e=[],r=1;arguments.length>r;)e.push(arguments[r++]);return _[++g]=function(){u(p(t)?t:Function(t),e)},n(g),g},f=function(t){delete _[t]},"process"==l(c.process)?n=function(t){c.process.nextTick(h(r,t,1))}:v&&p(m)&&!s.g.importScripts?(n=function(t){m(t,"*")},v("message",i,!1)):p(y)?(a=(o=new y).port2,o.port1.onmessage=i,n=h(a.postMessage,a,1)):n=s.g.document&&x in document.createElement("script")?function(t){s.html.appendChild(document.createElement("script"))[x]=function(){s.html.removeChild(this),r.call(t)}}:function(t){setTimeout(h(r,t,1),0)}),e.exports={set:d,clear:f}},{"./$":16,"./$.cof":7,"./$.ctx":11,"./$.invoke":14}],24:[function(t,e){function r(t){return"Symbol("+t+")_"+(++i+Math.random()).toString(36)}var i=0;r.safe=t("./$").g.Symbol||r,e.exports=r},{"./$":16}],25:[function(t,e){var r=t("./$"),i=t("./$.wks")("unscopables");!r.FW||i in[]||r.hide(Array.prototype,i,{}),e.exports=function(t){r.FW&&([][i][t]=!0)}},{"./$":16,"./$.wks":26}],26:[function(t,e){var r=t("./$").g,i={};e.exports=function(e){return i[e]||(i[e]=r.Symbol&&r.Symbol[e]||t("./$.uid").safe("Symbol."+e))}},{"./$":16,"./$.uid":24}],27:[function(t){"use strict";var e=t("./$"),r=t("./$.def"),i=e.toIndex;r(r.P,"Array",{copyWithin:function(t,r){var n=Object(e.assertDefined(this)),o=e.toLength(n.length),a=i(t,o),s=i(r,o),h=arguments[2],l=void 0===h?o:i(h,o),u=Math.min(l-s,o-a),c=1;for(a>s&&s+u>a&&(c=-1,s=s+u-1,a=a+u-1);u-- >0;)s in n?n[a]=n[s]:delete n[a],a+=c,s+=c;return n}}),t("./$.unscope")("copyWithin")},{"./$":16,"./$.def":12,"./$.unscope":25}],28:[function(t){"use strict";var e=t("./$"),r=t("./$.def"),i=e.toIndex;r(r.P,"Array",{fill:function(t){for(var r=Object(e.assertDefined(this)),n=e.toLength(r.length),o=i(arguments[1],n),a=arguments[2],s=void 0===a?n:i(a,n);s>o;)r[o++]=t;return r}}),t("./$.unscope")("fill")},{"./$":16,"./$.def":12,"./$.unscope":25}],29:[function(t){var e=t("./$.def");e(e.P,"Array",{findIndex:t("./$.array-methods")(6)}),t("./$.unscope")("findIndex")},{"./$.array-methods":4,"./$.def":12,"./$.unscope":25}],30:[function(t){var e=t("./$.def");e(e.P,"Array",{find:t("./$.array-methods")(5)}),t("./$.unscope")("find")},{"./$.array-methods":4,"./$.def":12,"./$.unscope":25}],31:[function(t){var e=t("./$"),r=t("./$.ctx"),i=t("./$.def"),n=t("./$.iter"),o=n.stepCall;i(i.S+i.F*n.DANGER_CLOSING,"Array",{from:function(t){var i,a,s,h,l=Object(e.assertDefined(t)),u=arguments[1],c=void 0!==u,p=c?r(u,arguments[2],2):void 0,d=0;if(n.is(l))for(h=n.get(l),a=new("function"==typeof this?this:Array);!(s=h.next()).done;d++)a[d]=c?o(h,p,[s.value,d],!0):s.value;else for(a=new("function"==typeof this?this:Array)(i=e.toLength(l.length));i>d;d++)a[d]=c?p(l[d],d):l[d];return a.length=d,a}})},{"./$":16,"./$.ctx":11,"./$.def":12,"./$.iter":15}],32:[function(t){var e=t("./$"),r=t("./$.unscope"),i=t("./$.uid").safe("iter"),n=t("./$.iter"),o=n.step,a=n.Iterators;n.std(Array,"Array",(function(t,r){e.set(this,i,{o:e.toObject(t),i:0,k:r})}),(function(){var t=this[i],e=t.o,r=t.k,n=t.i++;return!e||n>=e.length?(t.o=void 0,o(1)):o(0,"key"==r?n:"value"==r?e[n]:[n,e[n]])}),"value"),a.Arguments=a.Array,r("keys"),r("values"),r("entries")},{"./$":16,"./$.iter":15,"./$.uid":24,"./$.unscope":25}],33:[function(t){var e=t("./$.def");e(e.S,"Array",{of:function(){for(var t=0,e=arguments.length,r=new("function"==typeof this?this:Array)(e);e>t;)r[t]=arguments[t++];return r.length=e,r}})},{"./$.def":12}],34:[function(t){t("./$.species")(Array)},{"./$.species":21}],35:[function(t){"use strict";var e=t("./$"),r="name",i=e.setDesc,n=Function.prototype;r in n||e.FW&&e.DESC&&i(n,r,{configurable:!0,get:function(){var t=String(this).match(/^\s*function ([^ (]*)/),n=t?t[1]:"";return e.has(this,r)||i(this,r,e.desc(5,n)),n},set:function(t){e.has(this,r)||i(this,r,e.desc(0,t))}})},{"./$":16}],36:[function(t){"use strict";var e=t("./$.collection-strong");t("./$.collection")("Map",{get:function(t){var r=e.getEntry(this,t);return r&&r.v},set:function(t,r){return e.def(this,0===t?0:t,r)}},e,!0)},{"./$.collection":10,"./$.collection-strong":8}],37:[function(t){function e(t){return 0==(t=+t)?t:t>-1e-6&&1e-6>t?t+t*t/2:s(t)-1}var r=1/0,i=t("./$.def"),n=Math.E,o=Math.pow,a=Math.abs,s=Math.exp,h=Math.log,l=Math.sqrt,u=Math.ceil,c=Math.floor,p=Math.sign||function(t){return 0==(t=+t)||t!=t?t:0>t?-1:1};i(i.S,"Math",{acosh:function(t){return(t=+t)<1?NaN:isFinite(t)?h(t/n+l(t+1)*l(t-1)/n)+1:t},asinh:function t(e){return isFinite(e=+e)&&0!=e?0>e?-t(-e):h(e+l(e*e+1)):e},atanh:function(t){return 0==(t=+t)?t:h((1+t)/(1-t))/2},cbrt:function(t){return p(t=+t)*o(a(t),1/3)},clz32:function(t){return(t>>>=0)?32-t.toString(2).length:32},cosh:function(t){return(s(t=+t)+s(-t))/2},expm1:e,fround:function(t){return new Float32Array([t])[0]},hypot:function(){for(var t,e=0,i=arguments.length,n=i,a=Array(i),s=-r;i--;){if((t=a[i]=+arguments[i])==r||t==-r)return r;t>s&&(s=t)}for(s=t||1;n--;)e+=o(a[n]/s,2);return s*l(e)},imul:function(t,e){var r=65535,i=+t,n=+e,o=r&i,a=r&n;return 0|o*a+((r&i>>>16)*a+o*(r&n>>>16)<<16>>>0)},log1p:function(t){return(t=+t)>-1e-8&&1e-8>t?t-t*t/2:h(1+t)},log10:function(t){return h(t)/Math.LN10},log2:function(t){return h(t)/Math.LN2},sign:p,sinh:function(t){return a(t=+t)<1?(e(t)-e(-t))/2:(s(t-1)-s(-t-1))*(n/2)},tanh:function(t){var i=e(t=+t),n=e(-t);return i==r?1:n==r?-1:(i-n)/(s(t)+s(-t))},trunc:function(t){return(t>0?c:u)(t)}})},{"./$.def":12}],38:[function(t){"use strict";function e(t){if(i(t)&&(t=function(t){var e,r;if(n(e=t.valueOf)&&!i(r=e.call(t)))return r;if(n(e=t.toString)&&!i(r=e.call(t)))return r;throw TypeError("Can't convert object to number")}(t)),"string"==typeof t&&t.length>2&&48==t.charCodeAt(0)){var e=!1;switch(t.charCodeAt(1)){case 66:case 98:e=!0;case 79:case 111:return parseInt(t.slice(2),e?2:8)}}return+t}var r=t("./$"),i=r.isObject,n=r.isFunction,o="Number",a=r.g[o],s=a,h=a.prototype;!r.FW||a("0o1")&&a("0b1")||(a=function t(r){return this instanceof t?new s(e(r)):e(r)},r.each.call(r.DESC?r.getNames(s):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),(function(t){r.has(s,t)&&!r.has(a,t)&&r.setDesc(a,t,r.getDesc(s,t))})),a.prototype=h,h.constructor=a,r.hide(r.g,o,a))},{"./$":16}],39:[function(t){function e(t){return!r.isObject(t)&&isFinite(t)&&o(t)===t}var r=t("./$"),i=t("./$.def"),n=Math.abs,o=Math.floor,a=9007199254740991;i(i.S,"Number",{EPSILON:Math.pow(2,-52),isFinite:function(t){return"number"==typeof t&&isFinite(t)},isInteger:e,isNaN:function(t){return t!=t},isSafeInteger:function(t){return e(t)&&n(t)<=a},MAX_SAFE_INTEGER:a,MIN_SAFE_INTEGER:-a,parseFloat:parseFloat,parseInt:parseInt})},{"./$":16,"./$.def":12}],40:[function(t){var e=t("./$.def");e(e.S,"Object",{assign:t("./$.assign")})},{"./$.assign":6,"./$.def":12}],41:[function(t){var e=t("./$.def");e(e.S,"Object",{is:function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}})},{"./$.def":12}],42:[function(t){var e=t("./$.def");e(e.S,"Object",{setPrototypeOf:t("./$.set-proto")})},{"./$.def":12,"./$.set-proto":20}],43:[function(t){function e(t,e){var a=(r.core.Object||{})[t]||Object[t],s=0,h={};h[t]=1==e?function(t){return n(t)?a(t):t}:2==e?function(t){return!n(t)||a(t)}:3==e?function(t){return!!n(t)&&a(t)}:4==e?function(t,e){return a(o(t),e)}:5==e?function(t){return a(Object(r.assertDefined(t)))}:function(t){return a(o(t))};try{a("z")}catch(t){s=1}i(i.S+i.F*s,"Object",h)}var r=t("./$"),i=t("./$.def"),n=r.isObject,o=r.toObject;e("freeze",1),e("seal",1),e("preventExtensions",1),e("isFrozen",2),e("isSealed",2),e("isExtensible",3),e("getOwnPropertyDescriptor",4),e("getPrototypeOf",5),e("keys"),e("getOwnPropertyNames")},{"./$":16,"./$.def":12}],44:[function(t){"use strict";var e=t("./$"),r=t("./$.cof"),i={};i[t("./$.wks")("toStringTag")]="z",e.FW&&"z"!=r(i)&&e.hide(Object.prototype,"toString",(function(){return"[object "+r.classof(this)+"]"}))},{"./$":16,"./$.cof":7,"./$.wks":26}],45:[function(t){"use strict";function e(t){var e=b(t)[l];return null!=e?e:t}var r,i=t("./$"),n=t("./$.ctx"),o=t("./$.cof"),a=t("./$.def"),s=t("./$.assert"),h=t("./$.iter"),l=t("./$.wks")("species"),u=t("./$.uid").safe("record"),c=h.forOf,p="Promise",d=i.g,f=d.process,m=f&&f.nextTick||t("./$.task").set,v=d[p],y=v,g=i.isFunction,_=i.isObject,x=s.fn,b=s.obj;g(v)&&g(v.resolve)&&v.resolve(r=new v((function(){})))==r||function(){function t(t){var e;return _(t)&&(e=t.then),!!g(e)&&e}function e(t){var r,i=t[u],n=i.c,o=0;if(i.h)return!0;for(;n.length>o;)if((r=n[o++]).fail||e(r.P))return!0}function r(r,i){var n=r.c;(i||n.length)&&m((function(){var a=r.p,s=r.v,h=1==r.s,l=0;if(i&&!e(a))setTimeout((function(){e(a)||("process"==o(f)?f.emit("unhandledRejection",s,a):d.console&&g(console.error)&&console.error("Unhandled promise rejection",s))}),1e3);else for(;n.length>l;)!function(e){var i,n,o=h?e.ok:e.fail;try{o?(h||(r.h=!0),(i=!0===o?s:o(s))===e.P?e.rej(TypeError(p+"-chain cycle")):(n=t(i))?n.call(i,e.res,e.rej):e.res(i)):e.rej(s)}catch(t){e.rej(t)}}(n[l++]);n.length=0}))}function a(t){var e=this;e.d||(e.d=!0,(e=e.r||e).v=t,e.s=2,r(e,!0))}function h(e){var i,o,s=this;if(!s.d){s.d=!0,s=s.r||s;try{(i=t(e))?(o={r:s,d:!1},i.call(e,n(h,o,1),n(a,o,1))):(s.v=e,s.s=1,r(s))}catch(t){a.call(o||{r:s,d:!1},t)}}}v=function(t){x(t);var e={p:s.inst(this,v,p),c:[],s:0,d:!1,v:void 0,h:!1};i.hide(this,u,e);try{t(n(h,e,1),n(a,e,1))}catch(t){a.call(e,t)}},i.mix(v.prototype,{then:function(t,e){var i=b(b(this).constructor)[l],n={ok:!g(t)||t,fail:!!g(e)&&e},o=n.P=new(null!=i?i:v)((function(t,e){n.res=x(t),n.rej=x(e)})),a=this[u];return a.c.push(n),a.s&&r(a),o},catch:function(t){return this.then(void 0,t)}})}(),a(a.G+a.W+a.F*(v!=y),{Promise:v}),a(a.S,p,{reject:function(t){return new(e(this))((function(e,r){r(t)}))},resolve:function(t){return _(t)&&u in t&&i.getProto(t)===this.prototype?t:new(e(this))((function(e){e(t)}))}}),a(a.S+a.F*(h.fail((function(t){v.all(t).catch((function(){}))}))||h.DANGER_CLOSING),p,{all:function(t){var r=e(this),n=[];return new r((function(e,o){c(t,!1,n.push,n);var a=n.length,s=Array(a);a?i.each.call(n,(function(t,i){r.resolve(t).then((function(t){s[i]=t,--a||e(s)}),o)})):e(s)}))},race:function(t){var r=e(this);return new r((function(e,i){c(t,!1,(function(t){r.resolve(t).then(e,i)}))}))}}),o.set(v,p),t("./$.species")(v)},{"./$":16,"./$.assert":5,"./$.cof":7,"./$.ctx":11,"./$.def":12,"./$.iter":15,"./$.species":21,"./$.task":23,"./$.uid":24,"./$.wks":26}],46:[function(t){function e(t){var e,r=[];for(e in t)r.push(e);i.set(this,s,{o:t,a:r,i:0})}function r(t){return function(e){m(e);try{return t.apply(void 0,arguments),!0}catch(t){return!1}}}var i=t("./$"),n=t("./$.def"),o=t("./$.set-proto"),a=t("./$.iter"),s=t("./$.uid").safe("iter"),h=a.step,l=t("./$.assert"),u=i.isObject,c=i.getDesc,p=i.setDesc,d=i.getProto,f=Function.apply,m=l.obj,v=Object.isExtensible||i.it;a.create(e,"Object",(function(){var t,e=this[s],r=e.a;do{if(e.i>=r.length)return h(1)}while(!((t=r[e.i++])in e.o));return h(0,t)}));var y={apply:t("./$.ctx")(Function.call,f,3),construct:function(t,e){var r=l.fn(arguments.length<3?t:arguments[2]).prototype,n=i.create(u(r)?r:Object.prototype),o=f.call(t,n,e);return u(o)?o:n},defineProperty:r(p),deleteProperty:function(t,e){var r=c(m(t),e);return!(r&&!r.configurable)&&delete t[e]},enumerate:function(t){return new e(m(t))},get:function t(e,r){var n,o=arguments.length<3?e:arguments[2],a=c(m(e),r);return a?i.has(a,"value")?a.value:void 0===a.get?void 0:a.get.call(o):u(n=d(e))?t(n,r,o):void 0},getOwnPropertyDescriptor:function(t,e){return c(m(t),e)},getPrototypeOf:function(t){return d(m(t))},has:function(t,e){return e in t},isExtensible:function(t){return!!v(m(t))},ownKeys:t("./$.own-keys"),preventExtensions:r(Object.preventExtensions||i.it),set:function t(e,r,n){var o,a,s=arguments.length<4?e:arguments[3],h=c(m(e),r);if(!h){if(u(a=d(e)))return t(a,r,n,s);h=i.desc(0)}return i.has(h,"value")?!(!1===h.writable||!u(s))&&((o=c(s,r)||i.desc(0)).value=n,p(s,r,o),!0):void 0!==h.set&&(h.set.call(s,n),!0)}};o&&(y.setPrototypeOf=function(t,e){return o(m(t),e),!0}),n(n.G,{Reflect:{}}),n(n.S,"Reflect",y)},{"./$":16,"./$.assert":5,"./$.ctx":11,"./$.def":12,"./$.iter":15,"./$.own-keys":18,"./$.set-proto":20,"./$.uid":24}],47:[function(t){var e=t("./$"),r=t("./$.cof"),i=e.g.RegExp,n=i,o=i.prototype;e.FW&&e.DESC&&(function(){try{return"/a/i"==i(/a/g,"i")}catch(t){}}()||(i=function(t,e){return new n("RegExp"==r(t)&&void 0!==e?t.source:t,e)},e.each.call(e.getNames(n),(function(t){t in i||e.setDesc(i,t,{configurable:!0,get:function(){return n[t]},set:function(e){n[t]=e}})})),o.constructor=i,i.prototype=o,e.hide(e.g,"RegExp",i)),"g"!=/./g.flags&&e.setDesc(o,"flags",{configurable:!0,get:t("./$.replacer")(/^.*\/(\w*)$/,"$1")})),t("./$.species")(i)},{"./$":16,"./$.cof":7,"./$.replacer":19,"./$.species":21}],48:[function(t){"use strict";var e=t("./$.collection-strong");t("./$.collection")("Set",{add:function(t){return e.def(this,t=0===t?0:t,t)}},e)},{"./$.collection":10,"./$.collection-strong":8}],49:[function(t){var e=t("./$.def");e(e.P,"String",{codePointAt:t("./$.string-at")(!1)})},{"./$.def":12,"./$.string-at":22}],50:[function(t){"use strict";var e=t("./$"),r=t("./$.cof"),i=t("./$.def"),n=e.toLength;i(i.P,"String",{endsWith:function(t){if("RegExp"==r(t))throw TypeError();var i=String(e.assertDefined(this)),o=arguments[1],a=n(i.length),s=void 0===o?a:Math.min(n(o),a);return t+="",i.slice(s-t.length,s)===t}})},{"./$":16,"./$.cof":7,"./$.def":12}],51:[function(t){var e=t("./$.def"),r=t("./$").toIndex,i=String.fromCharCode;e(e.S,"String",{fromCodePoint:function(){for(var t,e=[],n=arguments.length,o=0;n>o;){if(t=+arguments[o++],r(t,1114111)!==t)throw RangeError(t+" is not a valid code point");e.push(65536>t?i(t):i(55296+((t-=65536)>>10),t%1024+56320))}return e.join("")}})},{"./$":16,"./$.def":12}],52:[function(t){"use strict";var e=t("./$"),r=t("./$.cof"),i=t("./$.def");i(i.P,"String",{includes:function(t){if("RegExp"==r(t))throw TypeError();return!!~String(e.assertDefined(this)).indexOf(t,arguments[1])}})},{"./$":16,"./$.cof":7,"./$.def":12}],53:[function(t){var e=t("./$").set,r=t("./$.string-at")(!0),i=t("./$.uid").safe("iter"),n=t("./$.iter"),o=n.step;n.std(String,"String",(function(t){e(this,i,{o:String(t),i:0})}),(function(){var t,e=this[i],n=e.o,a=e.i;return a>=n.length?o(1):(t=r.call(n,a),e.i+=t.length,o(0,t))}))},{"./$":16,"./$.iter":15,"./$.string-at":22,"./$.uid":24}],54:[function(t){var e=t("./$"),r=t("./$.def");r(r.S,"String",{raw:function(t){for(var r=e.toObject(t.raw),i=e.toLength(r.length),n=arguments.length,o=[],a=0;i>a;)o.push(String(r[a++])),n>a&&o.push(String(arguments[a]));return o.join("")}})},{"./$":16,"./$.def":12}],55:[function(t){"use strict";var e=t("./$"),r=t("./$.def");r(r.P,"String",{repeat:function(t){var r=String(e.assertDefined(this)),i="",n=e.toInteger(t);if(0>n||1/0==n)throw RangeError("Count can't be negative");for(;n>0;(n>>>=1)&&(r+=r))1&n&&(i+=r);return i}})},{"./$":16,"./$.def":12}],56:[function(t){"use strict";var e=t("./$"),r=t("./$.cof"),i=t("./$.def");i(i.P,"String",{startsWith:function(t){if("RegExp"==r(t))throw TypeError();var i=String(e.assertDefined(this)),n=e.toLength(Math.min(arguments[1],i.length));return t+="",i.slice(n,n+t.length)===t}})},{"./$":16,"./$.cof":7,"./$.def":12}],57:[function(t){"use strict";function e(t){var e=v[t]=r.set(r.create(c.prototype),f,t);return r.DESC&&d&&r.setDesc(Object.prototype,t,{configurable:!0,set:function(e){h(this,t,e)}}),e}var r=t("./$"),i=t("./$.cof").set,n=t("./$.uid"),o=t("./$.def"),a=t("./$.keyof"),s=r.has,h=r.hide,l=r.getNames,u=r.toObject,c=r.g.Symbol,p=c,d=!1,f=n.safe("tag"),m={},v={};r.isFunction(c)||h((c=function(t){if(this instanceof c)throw TypeError("Symbol is not a constructor");return e(n(t))}).prototype,"toString",(function(){return this[f]})),o(o.G+o.W,{Symbol:c});var y={for:function(t){return s(m,t+="")?m[t]:m[t]=c(t)},keyFor:function(t){return a(m,t)},pure:n.safe,set:r.set,useSetter:function(){d=!0},useSimple:function(){d=!1}};r.each.call("hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),(function(r){var i=t("./$.wks")(r);y[r]=c===p?i:e(i)})),d=!0,o(o.S,"Symbol",y),o(o.S+o.F*(c!=p),"Object",{getOwnPropertyNames:function(t){for(var e,r=l(u(t)),i=[],n=0;r.length>n;)s(v,e=r[n++])||i.push(e);return i},getOwnPropertySymbols:function(t){for(var e,r=l(u(t)),i=[],n=0;r.length>n;)s(v,e=r[n++])&&i.push(v[e]);return i}}),i(c,"Symbol"),i(Math,"Math",!0),i(r.g.JSON,"JSON",!0)},{"./$":16,"./$.cof":7,"./$.def":12,"./$.keyof":17,"./$.uid":24,"./$.wks":26}],58:[function(t){"use strict";var e=t("./$"),r=t("./$.collection-weak"),i=r.leakStore,n=r.ID,o=r.WEAK,a=e.has,s=e.isObject,h=Object.isFrozen||e.core.Object.isFrozen,l={},u=t("./$.collection")("WeakMap",{get:function(t){if(s(t)){if(h(t))return i(this).get(t);if(a(t,o))return t[o][this[n]]}},set:function(t,e){return r.def(this,t,e)}},r,!0,!0);e.FW&&7!=(new u).set((Object.freeze||Object)(l),7).get(l)&&e.each.call(["delete","has","get","set"],(function(t){var e=u.prototype[t];u.prototype[t]=function(r,n){if(s(r)&&h(r)){var o=i(this)[t](r,n);return"set"==t?this:o}return e.call(this,r,n)}}))},{"./$":16,"./$.collection":10,"./$.collection-weak":9}],59:[function(t){"use strict";var e=t("./$.collection-weak");t("./$.collection")("WeakSet",{add:function(t){return e.def(this,t,!0)}},e,!1,!0)},{"./$.collection":10,"./$.collection-weak":9}],60:[function(t,e){(function(t){!function(t){"use strict";function r(t,e,r,i){return new a(t,e,r||null,i||[])}function i(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}function n(){}function o(){}function a(t,e,r,n){function o(e,n){if(h===_)throw new Error("Generator is already running");if(h===x)return c();for(;;){var o=s.delegate;if(o){var a;if("throw"===(a=i(o.iterator[e],o.iterator,n)).type){s.delegate=null,e="throw",n=a.arg;continue}if(e="next",n=p,!(l=a.arg).done)return h=g,l;s[o.resultName]=l.value,s.next=o.nextLoc,s.delegate=null}if("next"===e){if(h===y&&void 0!==n)throw new TypeError("attempt to send "+JSON.stringify(n)+" to newborn generator");h===g?s.sent=n:delete s.sent}else if("throw"===e){if(h===y)throw h=x,n;s.dispatchException(n)&&(e="next",n=p)}else"return"===e&&s.abrupt("return",n);if(h=_,"normal"===(a=i(t,r,s)).type){h=s.done?x:g;var l={value:a.arg,done:s.done};if(a.arg!==b)return l;s.delegate&&"next"===e&&(n=p)}else"throw"===a.type&&(h=x,"next"===e?s.dispatchException(a.arg):n=a.arg)}}var a=e?Object.create(e.prototype):this,s=new l(n),h=y;return a.next=o.bind(a,"next"),a.throw=o.bind(a,"throw"),a.return=o.bind(a,"return"),a}function s(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function h(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function l(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(s,this),this.reset()}function u(t){if(t){var e=t[f];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(d.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=p,e.done=!0,e};return i.next=i}}return{next:c}}function c(){return{value:p,done:!0}}var p,d=Object.prototype.hasOwnProperty,f="function"==typeof Symbol&&Symbol.iterator||"@@iterator",m="object"==typeof e,v=t.regeneratorRuntime;if(v)m&&(e.exports=v);else{(v=t.regeneratorRuntime=m?e.exports:{}).wrap=r;var y="suspendedStart",g="suspendedYield",_="executing",x="completed",b={},w=o.prototype=a.prototype;n.prototype=w.constructor=o,o.constructor=n,n.displayName="GeneratorFunction",v.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===n||"GeneratorFunction"===(e.displayName||e.name))},v.mark=function(t){return t.__proto__=o,t.prototype=Object.create(w),t},v.async=function(t,e,n,o){return new Promise((function(a,s){function h(t){var e=i(this,null,t);if("throw"!==e.type){var r=e.arg;r.done?a(r.value):Promise.resolve(r.value).then(u,c)}else s(e.arg)}var l=r(t,e,n,o),u=h.bind(l.next),c=h.bind(l.throw);u()}))},w[f]=function(){return this},w.toString=function(){return"[object Generator]"},v.keys=function(t){var e=[];for(var r in t)e.push(r);return e.reverse(),function r(){for(;e.length;){var i=e.pop();if(i in t)return r.value=i,r.done=!1,r}return r.done=!0,r}},v.values=u,l.prototype={constructor:l,reset:function(){this.prev=0,this.next=0,this.sent=p,this.done=!1,this.delegate=null,this.tryEntries.forEach(h);for(var t,e=0;d.call(this,t="t"+e)||20>e;++e)this[t]=null},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){function e(e,i){return o.type="throw",o.arg=t,r.next=e,!!i}if(this.done)throw t;for(var r=this,i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i],o=n.completion;if("root"===n.tryLoc)return e("end");if(n.tryLoc<=this.prev){var a=d.call(n,"catchLoc"),s=d.call(n,"finallyLoc");if(a&&s){if(this.prev<n.catchLoc)return e(n.catchLoc,!0);if(this.prev<n.finallyLoc)return e(n.finallyLoc)}else if(a){if(this.prev<n.catchLoc)return e(n.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<n.finallyLoc)return e(n.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&d.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var n=i;break}}n&&("break"===t||"continue"===t)&&n.tryLoc<=e&&e<n.finallyLoc&&(n=null);var o=n?n.completion:{};return o.type=t,o.arg=e,n?this.next=n.finallyLoc:this.complete(o),b},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=t.arg,this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc)}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var i=r.completion;if("throw"===i.type){var n=i.arg;h(r)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:u(t),resultName:e,nextLoc:r},b}}}}("object"==typeof t?t:"object"==typeof window?window:this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1]),window.graphemeSplitter=new GraphemeSplitter;
/*!
 * pixi.js - v5.3.7
 * Compiled Tue, 29 Dec 2020 19:33:12 UTC
 *
 * pixi.js is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var PIXI=function(t){"use strict";var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function r(t,e){return t(e={exports:{}},e.exports),e.exports}var i=r((function(t,r){!function(t){var e=t.Promise,i=e&&"resolve"in e&&"reject"in e&&"all"in e&&"race"in e&&function(){var t;return new e((function(e){t=e})),"function"==typeof t}();r?(r.Promise=i?e:_,r.Polyfill=_):i||(t.Promise=_);var n=function(){};function o(t){return"[object Array]"===Object.prototype.toString.call(t)}var a,s="undefined"!=typeof setImmediate?setImmediate:setTimeout,h=[];function l(){for(var t=0;t<h.length;t++)h[t][0](h[t][1]);h=[],a=!1}function u(t,e){h.push([t,e]),a||(a=!0,s(l,0))}function c(t){var e=t.owner,r=e.state_,i=e.data_,n=t[r],o=t.then;if("function"==typeof n){r="fulfilled";try{i=n(i)}catch(t){m(o,t)}}p(o,i)||("fulfilled"===r&&d(o,i),"rejected"===r&&m(o,i))}function p(t,e){var r;try{if(t===e)throw new TypeError("A promises callback cannot return that same promise.");if(e&&("function"==typeof e||"object"==typeof e)){var i=e.then;if("function"==typeof i)return i.call(e,(function(i){r||(r=!0,e!==i?d(t,i):f(t,i))}),(function(e){r||(r=!0,m(t,e))})),!0}}catch(e){return r||m(t,e),!0}return!1}function d(t,e){t!==e&&p(t,e)||f(t,e)}function f(t,e){"pending"===t.state_&&(t.state_="sealed",t.data_=e,u(y,t))}function m(t,e){"pending"===t.state_&&(t.state_="sealed",t.data_=e,u(g,t))}function v(t){var e=t.then_;t.then_=void 0;for(var r=0;r<e.length;r++)c(e[r])}function y(t){t.state_="fulfilled",v(t)}function g(t){t.state_="rejected",v(t)}function _(t){if("function"!=typeof t)throw new TypeError("Promise constructor takes a function argument");if(this instanceof _==!1)throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this.then_=[],function(t,e){function r(t){m(e,t)}try{t((function(t){d(e,t)}),r)}catch(t){r(t)}}(t,this)}_.prototype={constructor:_,state_:"pending",then_:null,data_:void 0,then:function(t,e){var r={owner:this,then:new this.constructor(n),fulfilled:t,rejected:e};return"fulfilled"===this.state_||"rejected"===this.state_?u(c,r):this.then_.push(r),r.then},catch:function(t){return this.then(null,t)}},_.all=function(t){if(!o(t))throw new TypeError("You must pass an array to Promise.all().");return new this((function(e,r){var i=[],n=0;function o(t){return n++,function(r){i[t]=r,--n||e(i)}}for(var a,s=0;s<t.length;s++)(a=t[s])&&"function"==typeof a.then?a.then(o(s),r):i[s]=a;n||e(i)}))},_.race=function(t){if(!o(t))throw new TypeError("You must pass an array to Promise.race().");return new this((function(e,r){for(var i,n=0;n<t.length;n++)(i=t[n])&&"function"==typeof i.then?i.then(e,r):e(i)}))},_.resolve=function(t){return t&&"object"==typeof t&&t.constructor===this?t:new this((function(e){e(t)}))},_.reject=function(t){return new this((function(e,r){r(t)}))}}("undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:e)})),n=(i.Promise,i.Polyfill),o=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable;function h(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}var l=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},r=0;r<10;r++)e["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach((function(t){i[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},i)).join("")}catch(t){return!1}}()?Object.assign:function(t,e){for(var r,i,n=arguments,l=h(t),u=1;u<arguments.length;u++){for(var c in r=Object(n[u]))a.call(r,c)&&(l[c]=r[c]);if(o){i=o(r);for(var p=0;p<i.length;p++)s.call(r,i[p])&&(l[i[p]]=r[i[p]])}}return l};
/*!
	 * @pixi/polyfill - v5.3.7
	 * Compiled Tue, 29 Dec 2020 19:33:12 UTC
	 *
	 * @pixi/polyfill is licensed under the MIT License.
	 * http://www.opensource.org/licenses/mit-license
	 */window.Promise||(window.Promise=n),Object.assign||(Object.assign=l);if(Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),!window.performance||!window.performance.now){var u=Date.now();window.performance||(window.performance={}),window.performance.now=function(){return Date.now()-u}}for(var c=Date.now(),p=["ms","moz","webkit","o"],d=0;d<p.length&&!window.requestAnimationFrame;++d){var f=p[d];window.requestAnimationFrame=window[f+"RequestAnimationFrame"],window.cancelAnimationFrame=window[f+"CancelAnimationFrame"]||window[f+"CancelRequestAnimationFrame"]}window.requestAnimationFrame||(window.requestAnimationFrame=function(t){if("function"!=typeof t)throw new TypeError(t+"is not a function");var e=Date.now(),r=16+c-e;return r<0&&(r=0),c=e,window.setTimeout((function(){c=Date.now(),t(performance.now())}),r)}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){return clearTimeout(t)}),Math.sign||(Math.sign=function(t){return 0===(t=Number(t))||isNaN(t)?t:t>0?1:-1}),Number.isInteger||(Number.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}),window.ArrayBuffer||(window.ArrayBuffer=Array),window.Float32Array||(window.Float32Array=Array),window.Uint32Array||(window.Uint32Array=Array),window.Uint16Array||(window.Uint16Array=Array),window.Uint8Array||(window.Uint8Array=Array),window.Int32Array||(window.Int32Array=Array);var m=/iPhone/i,v=/iPod/i,y=/iPad/i,g=/\biOS-universal(?:.+)Mac\b/i,_=/\bAndroid(?:.+)Mobile\b/i,x=/Android/i,b=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,w=/Silk/i,T=/Windows Phone/i,E=/\bWindows(?:.+)ARM\b/i,S=/BlackBerry/i,A=/BB10/i,I=/Opera Mini/i,P=/\b(CriOS|Chrome)(?:.+)Mobile/i,M=/Mobile(?:.+)Firefox\b/i,C=function(t){return void 0!==t&&"MacIntel"===t.platform&&"number"==typeof t.maxTouchPoints&&t.maxTouchPoints>1&&"undefined"==typeof MSStream};
/*!
	 * @pixi/settings - v5.3.7
	 * Compiled Tue, 29 Dec 2020 19:33:12 UTC
	 *
	 * @pixi/settings is licensed under the MIT License.
	 * http://www.opensource.org/licenses/mit-license
	 */
var R=function(t){var e={userAgent:"",platform:"",maxTouchPoints:0};t||"undefined"==typeof navigator?"string"==typeof t?e.userAgent=t:t&&t.userAgent&&(e={userAgent:t.userAgent,platform:t.platform,maxTouchPoints:t.maxTouchPoints||0}):e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var r=e.userAgent,i=r.split("[FBAN");void 0!==i[1]&&(r=i[0]),void 0!==(i=r.split("Twitter"))[1]&&(r=i[0]);var n=function(t){return function(e){return e.test(t)}}(r),o={apple:{phone:n(m)&&!n(T),ipod:n(v),tablet:!n(m)&&(n(y)||C(e))&&!n(T),universal:n(g),device:(n(m)||n(v)||n(y)||n(g)||C(e))&&!n(T)},amazon:{phone:n(b),tablet:!n(b)&&n(w),device:n(b)||n(w)},android:{phone:!n(T)&&n(b)||!n(T)&&n(_),tablet:!n(T)&&!n(b)&&!n(_)&&(n(w)||n(x)),device:!n(T)&&(n(b)||n(w)||n(_)||n(x))||n(/\bokhttp\b/i)},windows:{phone:n(T),tablet:n(E),device:n(T)||n(E)},other:{blackberry:n(S),blackberry10:n(A),opera:n(I),firefox:n(M),chrome:n(P),device:n(S)||n(A)||n(I)||n(M)||n(P)},any:!1,phone:!1,tablet:!1};return o.any=o.apple.device||o.android.device||o.windows.device||o.other.device,o.phone=o.apple.phone||o.android.phone||o.windows.phone,o.tablet=o.apple.tablet||o.android.tablet||o.windows.tablet,o}(window.navigator);var O={MIPMAP_TEXTURES:1,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:function(t){var e=!0;if(R.tablet||R.phone){var r;if(R.apple.device)if(r=navigator.userAgent.match(/OS (\d+)_(\d+)?/))parseInt(r[1],10)<11&&(e=!1);if(R.android.device)if(r=navigator.userAgent.match(/Android\s([0-9.]*)/))parseInt(r[1],10)<7&&(e=!1)}return e?t:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,autoDensity:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:33071,SCALE_MODE:1,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:R.apple.device?"highp":"mediump",CAN_UPLOAD_SAME_BUFFER:!R.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1},D=r((function(t){var e=Object.prototype.hasOwnProperty,r="~";function i(){}function n(t,e,r){this.fn=t,this.context=e,this.once=r||!1}function o(t,e,i,o,a){if("function"!=typeof i)throw new TypeError("The listener must be a function");var s=new n(i,o||t,a),h=r?r+e:e;return t._events[h]?t._events[h].fn?t._events[h]=[t._events[h],s]:t._events[h].push(s):(t._events[h]=s,t._eventsCount++),t}function a(t,e){0==--t._eventsCount?t._events=new i:delete t._events[e]}function s(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(r=!1)),s.prototype.eventNames=function(){var t,i,n=[];if(0===this._eventsCount)return n;for(i in t=this._events)e.call(t,i)&&n.push(r?i.slice(1):i);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(t)):n},s.prototype.listeners=function(t){var e=r?r+t:t,i=this._events[e];if(!i)return[];if(i.fn)return[i.fn];for(var n=0,o=i.length,a=new Array(o);n<o;n++)a[n]=i[n].fn;return a},s.prototype.listenerCount=function(t){var e=r?r+t:t,i=this._events[e];return i?i.fn?1:i.length:0},s.prototype.emit=function(t,e,i,n,o,a){var s=arguments,h=r?r+t:t;if(!this._events[h])return!1;var l,u,c=this._events[h],p=arguments.length;if(c.fn){switch(c.once&&this.removeListener(t,c.fn,void 0,!0),p){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,e),!0;case 3:return c.fn.call(c.context,e,i),!0;case 4:return c.fn.call(c.context,e,i,n),!0;case 5:return c.fn.call(c.context,e,i,n,o),!0;case 6:return c.fn.call(c.context,e,i,n,o,a),!0}for(u=1,l=new Array(p-1);u<p;u++)l[u-1]=s[u];c.fn.apply(c.context,l)}else{var d,f=c.length;for(u=0;u<f;u++)switch(c[u].once&&this.removeListener(t,c[u].fn,void 0,!0),p){case 1:c[u].fn.call(c[u].context);break;case 2:c[u].fn.call(c[u].context,e);break;case 3:c[u].fn.call(c[u].context,e,i);break;case 4:c[u].fn.call(c[u].context,e,i,n);break;default:if(!l)for(d=1,l=new Array(p-1);d<p;d++)l[d-1]=s[d];c[u].fn.apply(c[u].context,l)}}return!0},s.prototype.on=function(t,e,r){return o(this,t,e,r,!1)},s.prototype.once=function(t,e,r){return o(this,t,e,r,!0)},s.prototype.removeListener=function(t,e,i,n){var o=r?r+t:t;if(!this._events[o])return this;if(!e)return a(this,o),this;var s=this._events[o];if(s.fn)s.fn!==e||n&&!s.once||i&&s.context!==i||a(this,o);else{for(var h=0,l=[],u=s.length;h<u;h++)(s[h].fn!==e||n&&!s[h].once||i&&s[h].context!==i)&&l.push(s[h]);l.length?this._events[o]=1===l.length?l[0]:l:a(this,o)}return this},s.prototype.removeAllListeners=function(t){var e;return t?(e=r?r+t:t,this._events[e]&&a(this,e)):(this._events=new i,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=r,s.EventEmitter=s,t.exports=s})),B=k,N=k;function k(t,e,r){r=r||2;var i,n,o,a,s,h,l,u=e&&e.length,c=u?e[0]*r:t.length,p=F(t,0,c,r,!0),d=[];if(!p||p.next===p.prev)return d;if(u&&(p=function(t,e,r,i){var n,o,a,s,h,l=[];for(n=0,o=e.length;n<o;n++)a=e[n]*i,s=n<o-1?e[n+1]*i:t.length,(h=F(t,a,s,i,!1))===h.next&&(h.steiner=!0),l.push(H(h));for(l.sort(z),n=0;n<l.length;n++)W(l[n],r),r=L(r,r.next);return r}(t,e,p,r)),t.length>80*r){i=o=t[0],n=a=t[1];for(var f=r;f<c;f+=r)(s=t[f])<i&&(i=s),(h=t[f+1])<n&&(n=h),s>o&&(o=s),h>a&&(a=h);l=0!==(l=Math.max(o-i,a-n))?1/l:0}return V(p,d,r,i,n,l),d}function F(t,e,r,i,n){var o,a;if(n===st(t,e,r,i)>0)for(o=e;o<r;o+=i)a=nt(o,t[o],t[o+1],a);else for(o=r-i;o>=e;o-=i)a=nt(o,t[o],t[o+1],a);return a&&Q(a,a.next)&&(ot(a),a=a.next),a}function L(t,e){if(!t)return t;e||(e=t);var r,i=t;do{if(r=!1,i.steiner||!Q(i,i.next)&&0!==Z(i.prev,i,i.next))i=i.next;else{if(ot(i),(i=e=i.prev)===i.next)break;r=!0}}while(r||i!==e);return e}function V(t,e,r,i,n,o,a){if(t){!a&&o&&function(t,e,r,i){var n=t;do{null===n.z&&(n.z=G(n.x,n.y,e,r,i)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next}while(n!==t);n.prevZ.nextZ=null,n.prevZ=null,function(t){var e,r,i,n,o,a,s,h,l=1;do{for(r=t,t=null,o=null,a=0;r;){for(a++,i=r,s=0,e=0;e<l&&(s++,i=i.nextZ);e++);for(h=l;s>0||h>0&&i;)0!==s&&(0===h||!i||r.z<=i.z)?(n=r,r=r.nextZ,s--):(n=i,i=i.nextZ,h--),o?o.nextZ=n:t=n,n.prevZ=o,o=n;r=i}o.nextZ=null,l*=2}while(a>1)}(n)}(t,i,n,o);for(var s,h,l=t;t.prev!==t.next;)if(s=t.prev,h=t.next,o?j(t,i,n,o):X(t))e.push(s.i/r),e.push(t.i/r),e.push(h.i/r),ot(t),t=h.next,l=h.next;else if((t=h)===l){a?1===a?V(t=U(L(t),e,r),e,r,i,n,o,2):2===a&&Y(t,e,r,i,n,o):V(L(t),e,r,i,n,o,1);break}}}function X(t){var e=t.prev,r=t,i=t.next;if(Z(e,r,i)>=0)return!1;for(var n=t.next.next;n!==t.prev;){if($(e.x,e.y,r.x,r.y,i.x,i.y,n.x,n.y)&&Z(n.prev,n,n.next)>=0)return!1;n=n.next}return!0}function j(t,e,r,i){var n=t.prev,o=t,a=t.next;if(Z(n,o,a)>=0)return!1;for(var s=n.x<o.x?n.x<a.x?n.x:a.x:o.x<a.x?o.x:a.x,h=n.y<o.y?n.y<a.y?n.y:a.y:o.y<a.y?o.y:a.y,l=n.x>o.x?n.x>a.x?n.x:a.x:o.x>a.x?o.x:a.x,u=n.y>o.y?n.y>a.y?n.y:a.y:o.y>a.y?o.y:a.y,c=G(s,h,e,r,i),p=G(l,u,e,r,i),d=t.prevZ,f=t.nextZ;d&&d.z>=c&&f&&f.z<=p;){if(d!==t.prev&&d!==t.next&&$(n.x,n.y,o.x,o.y,a.x,a.y,d.x,d.y)&&Z(d.prev,d,d.next)>=0)return!1;if(d=d.prevZ,f!==t.prev&&f!==t.next&&$(n.x,n.y,o.x,o.y,a.x,a.y,f.x,f.y)&&Z(f.prev,f,f.next)>=0)return!1;f=f.nextZ}for(;d&&d.z>=c;){if(d!==t.prev&&d!==t.next&&$(n.x,n.y,o.x,o.y,a.x,a.y,d.x,d.y)&&Z(d.prev,d,d.next)>=0)return!1;d=d.prevZ}for(;f&&f.z<=p;){if(f!==t.prev&&f!==t.next&&$(n.x,n.y,o.x,o.y,a.x,a.y,f.x,f.y)&&Z(f.prev,f,f.next)>=0)return!1;f=f.nextZ}return!0}function U(t,e,r){var i=t;do{var n=i.prev,o=i.next.next;!Q(n,o)&&K(n,i,i.next,o)&&rt(n,o)&&rt(o,n)&&(e.push(n.i/r),e.push(i.i/r),e.push(o.i/r),ot(i),ot(i.next),i=t=o),i=i.next}while(i!==t);return L(i)}function Y(t,e,r,i,n,o){var a=t;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&J(a,s)){var h=it(a,s);return a=L(a,a.next),h=L(h,h.next),V(a,e,r,i,n,o),void V(h,e,r,i,n,o)}s=s.next}a=a.next}while(a!==t)}function z(t,e){return t.x-e.x}function W(t,e){if(e=function(t,e){var r,i=e,n=t.x,o=t.y,a=-1/0;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){var s=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(s<=n&&s>a){if(a=s,s===n){if(o===i.y)return i;if(o===i.next.y)return i.next}r=i.x<i.next.x?i:i.next}}i=i.next}while(i!==e);if(!r)return null;if(n===a)return r;var h,l=r,u=r.x,c=r.y,p=1/0;i=r;do{n>=i.x&&i.x>=u&&n!==i.x&&$(o<c?n:a,o,u,c,o<c?a:n,o,i.x,i.y)&&(h=Math.abs(o-i.y)/(n-i.x),rt(i,t)&&(h<p||h===p&&(i.x>r.x||i.x===r.x&&q(r,i)))&&(r=i,p=h)),i=i.next}while(i!==l);return r}(t,e)){var r=it(e,t);L(e,e.next),L(r,r.next)}}function q(t,e){return Z(t.prev,t,e.prev)<0&&Z(e.next,t,t.next)<0}function G(t,e,r,i,n){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*n)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*n)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function H(t){var e=t,r=t;do{(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next}while(e!==t);return r}function $(t,e,r,i,n,o,a,s){return(n-a)*(e-s)-(t-a)*(o-s)>=0&&(t-a)*(i-s)-(r-a)*(e-s)>=0&&(r-a)*(o-s)-(n-a)*(i-s)>=0}function J(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&K(r,r.next,t,e))return!0;r=r.next}while(r!==t);return!1}(t,e)&&(rt(t,e)&&rt(e,t)&&function(t,e){var r=t,i=!1,n=(t.x+e.x)/2,o=(t.y+e.y)/2;do{r.y>o!=r.next.y>o&&r.next.y!==r.y&&n<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(i=!i),r=r.next}while(r!==t);return i}(t,e)&&(Z(t.prev,t,e.prev)||Z(t,e.prev,e))||Q(t,e)&&Z(t.prev,t,t.next)>0&&Z(e.prev,e,e.next)>0)}function Z(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function Q(t,e){return t.x===e.x&&t.y===e.y}function K(t,e,r,i){var n=et(Z(t,e,r)),o=et(Z(t,e,i)),a=et(Z(r,i,t)),s=et(Z(r,i,e));return n!==o&&a!==s||(!(0!==n||!tt(t,r,e))||(!(0!==o||!tt(t,i,e))||(!(0!==a||!tt(r,t,i))||!(0!==s||!tt(r,e,i)))))}function tt(t,e,r){return e.x<=Math.max(t.x,r.x)&&e.x>=Math.min(t.x,r.x)&&e.y<=Math.max(t.y,r.y)&&e.y>=Math.min(t.y,r.y)}function et(t){return t>0?1:t<0?-1:0}function rt(t,e){return Z(t.prev,t,t.next)<0?Z(t,e,t.next)>=0&&Z(t,t.prev,e)>=0:Z(t,e,t.prev)<0||Z(t,t.next,e)<0}function it(t,e){var r=new at(t.i,t.x,t.y),i=new at(e.i,e.x,e.y),n=t.next,o=e.prev;return t.next=e,e.prev=t,r.next=n,n.prev=r,i.next=r,r.prev=i,o.next=i,i.prev=o,i}function nt(t,e,r,i){var n=new at(t,e,r);return i?(n.next=i.next,n.prev=i,i.next.prev=n,i.next=n):(n.prev=n,n.next=n),n}function ot(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function at(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function st(t,e,r,i){for(var n=0,o=e,a=r-i;o<r;o+=i)n+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return n}k.deviation=function(t,e,r,i){var n=e&&e.length,o=n?e[0]*r:t.length,a=Math.abs(st(t,0,o,r));if(n)for(var s=0,h=e.length;s<h;s++){var l=e[s]*r,u=s<h-1?e[s+1]*r:t.length;a-=Math.abs(st(t,l,u,r))}var c=0;for(s=0;s<i.length;s+=3){var p=i[s]*r,d=i[s+1]*r,f=i[s+2]*r;c+=Math.abs((t[p]-t[f])*(t[d+1]-t[p+1])-(t[p]-t[d])*(t[f+1]-t[p+1]))}return 0===a&&0===c?0:Math.abs((c-a)/a)},k.flatten=function(t){for(var e=t[0][0].length,r={vertices:[],holes:[],dimensions:e},i=0,n=0;n<t.length;n++){for(var o=0;o<t[n].length;o++)for(var a=0;a<e;a++)r.vertices.push(t[n][o][a]);n>0&&(i+=t[n-1].length,r.holes.push(i))}return r},B.default=N;var ht=r((function(t,r){!function(i){var n=r&&!r.nodeType&&r,o=t&&!t.nodeType&&t,a="object"==typeof e&&e;a.global!==a&&a.window!==a&&a.self!==a||(i=a);var s,h,l=2147483647,u=/^xn--/,c=/[^\x20-\x7E]/,p=/[\x2E\u3002\uFF0E\uFF61]/g,d={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},f=Math.floor,m=String.fromCharCode;function v(t){throw RangeError(d[t])}function y(t,e){for(var r=t.length,i=[];r--;)i[r]=e(t[r]);return i}function g(t,e){var r=t.split("@"),i="";return r.length>1&&(i=r[0]+"@",t=r[1]),i+y((t=t.replace(p,".")).split("."),e).join(".")}function _(t){for(var e,r,i=[],n=0,o=t.length;n<o;)(e=t.charCodeAt(n++))>=55296&&e<=56319&&n<o?56320==(64512&(r=t.charCodeAt(n++)))?i.push(((1023&e)<<10)+(1023&r)+65536):(i.push(e),n--):i.push(e);return i}function x(t){return y(t,(function(t){var e="";return t>65535&&(e+=m((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+=m(t)})).join("")}function b(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function w(t,e,r){var i=0;for(t=r?f(t/700):t>>1,t+=f(t/e);t>455;i+=36)t=f(t/35);return f(i+36*t/(t+38))}function T(t){var e,r,i,n,o,a,s,h,u,c,p,d=[],m=t.length,y=0,g=128,_=72;for((r=t.lastIndexOf("-"))<0&&(r=0),i=0;i<r;++i)t.charCodeAt(i)>=128&&v("not-basic"),d.push(t.charCodeAt(i));for(n=r>0?r+1:0;n<m;){for(o=y,a=1,s=36;n>=m&&v("invalid-input"),((h=(p=t.charCodeAt(n++))-48<10?p-22:p-65<26?p-65:p-97<26?p-97:36)>=36||h>f((l-y)/a))&&v("overflow"),y+=h*a,!(h<(u=s<=_?1:s>=_+26?26:s-_));s+=36)a>f(l/(c=36-u))&&v("overflow"),a*=c;_=w(y-o,e=d.length+1,0==o),f(y/e)>l-g&&v("overflow"),g+=f(y/e),y%=e,d.splice(y++,0,g)}return x(d)}function E(t){var e,r,i,n,o,a,s,h,u,c,p,d,y,g,x,T=[];for(d=(t=_(t)).length,e=128,r=0,o=72,a=0;a<d;++a)(p=t[a])<128&&T.push(m(p));for(i=n=T.length,n&&T.push("-");i<d;){for(s=l,a=0;a<d;++a)(p=t[a])>=e&&p<s&&(s=p);for(s-e>f((l-r)/(y=i+1))&&v("overflow"),r+=(s-e)*y,e=s,a=0;a<d;++a)if((p=t[a])<e&&++r>l&&v("overflow"),p==e){for(h=r,u=36;!(h<(c=u<=o?1:u>=o+26?26:u-o));u+=36)x=h-c,g=36-c,T.push(m(b(c+x%g,0))),h=f(x/g);T.push(m(b(h,0))),o=w(r,y,i==n),r=0,++i}++r,++e}return T.join("")}if(s={version:"1.3.2",ucs2:{decode:_,encode:x},decode:T,encode:E,toASCII:function(t){return g(t,(function(t){return c.test(t)?"xn--"+E(t):t}))},toUnicode:function(t){return g(t,(function(t){return u.test(t)?T(t.slice(4).toLowerCase()):t}))}},n&&o)if(t.exports==n)o.exports=s;else for(h in s)s.hasOwnProperty(h)&&(n[h]=s[h]);else i.punycode=s}(e)})),lt=function(t){return"string"==typeof t},ut=function(t){return"object"==typeof t&&null!==t},ct=function(t){return null===t},pt=function(t){return null==t};function dt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var ft=function(t,e,r,i){e=e||"&",r=r||"=";var n={};if("string"!=typeof t||0===t.length)return n;var o=/\+/g;t=t.split(e);var a=1e3;i&&"number"==typeof i.maxKeys&&(a=i.maxKeys);var s=t.length;a>0&&s>a&&(s=a);for(var h=0;h<s;++h){var l,u,c,p,d=t[h].replace(o,"%20"),f=d.indexOf(r);f>=0?(l=d.substr(0,f),u=d.substr(f+1)):(l=d,u=""),c=decodeURIComponent(l),p=decodeURIComponent(u),dt(n,c)?Array.isArray(n[c])?n[c].push(p):n[c]=[n[c],p]:n[c]=p}return n},mt=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}},vt=function(t,e,r,i){return e=e||"&",r=r||"=",null===t&&(t=void 0),"object"==typeof t?Object.keys(t).map((function(i){var n=encodeURIComponent(mt(i))+r;return Array.isArray(t[i])?t[i].map((function(t){return n+encodeURIComponent(mt(t))})).join(e):n+encodeURIComponent(mt(t[i]))})).join(e):i?encodeURIComponent(mt(i))+r+encodeURIComponent(mt(t)):""},yt=r((function(t,e){e.decode=e.parse=ft,e.encode=e.stringify=vt})),gt=(yt.decode,yt.parse,yt.encode,yt.stringify,kt),_t=function(t,e){return kt(t,!1,!0).resolve(e)},xt=function(t,e){if(!t)return e;return kt(t,!1,!0).resolveObject(e)},bt=function(t){lt(t)&&(t=kt(t));if(!(t instanceof Tt))return Tt.prototype.format.call(t);return t.format()},wt=Tt;function Tt(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var Et=/^([a-z0-9.+-]+:)/i,St=/:[0-9]*$/,At=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,It=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),Pt=["'"].concat(It),Mt=["%","/","?",";","#"].concat(Pt),Ct=["/","?","#"],Rt=/^[+a-z0-9A-Z_-]{0,63}$/,Ot=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,Dt={javascript:!0,"javascript:":!0},Bt={javascript:!0,"javascript:":!0},Nt={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function kt(t,e,r){if(t&&ut(t)&&t instanceof Tt)return t;var i=new Tt;return i.parse(t,e,r),i}Tt.prototype.parse=function(t,e,r){if(!lt(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var i=t.indexOf("?"),n=-1!==i&&i<t.indexOf("#")?"?":"#",o=t.split(n);o[0]=o[0].replace(/\\/g,"/");var a=t=o.join(n);if(a=a.trim(),!r&&1===t.split("#").length){var s=At.exec(a);if(s)return this.path=a,this.href=a,this.pathname=s[1],s[2]?(this.search=s[2],this.query=e?yt.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this}var h=Et.exec(a);if(h){var l=(h=h[0]).toLowerCase();this.protocol=l,a=a.substr(h.length)}if(r||h||a.match(/^\/\/[^@\/]+@[^@\/]+/)){var u="//"===a.substr(0,2);!u||h&&Bt[h]||(a=a.substr(2),this.slashes=!0)}if(!Bt[h]&&(u||h&&!Nt[h])){for(var c,p,d=-1,f=0;f<Ct.length;f++){-1!==(m=a.indexOf(Ct[f]))&&(-1===d||m<d)&&(d=m)}-1!==(p=-1===d?a.lastIndexOf("@"):a.lastIndexOf("@",d))&&(c=a.slice(0,p),a=a.slice(p+1),this.auth=decodeURIComponent(c)),d=-1;for(f=0;f<Mt.length;f++){var m;-1!==(m=a.indexOf(Mt[f]))&&(-1===d||m<d)&&(d=m)}-1===d&&(d=a.length),this.host=a.slice(0,d),a=a.slice(d),this.parseHost(),this.hostname=this.hostname||"";var v="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!v)for(var y=this.hostname.split(/\./),g=(f=0,y.length);f<g;f++){var _=y[f];if(_&&!_.match(Rt)){for(var x="",b=0,w=_.length;b<w;b++)_.charCodeAt(b)>127?x+="x":x+=_[b];if(!x.match(Rt)){var T=y.slice(0,f),E=y.slice(f+1),S=_.match(Ot);S&&(T.push(S[1]),E.unshift(S[2])),E.length&&(a="/"+E.join(".")+a),this.hostname=T.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),v||(this.hostname=ht.toASCII(this.hostname));var A=this.port?":"+this.port:"",I=this.hostname||"";this.host=I+A,this.href+=this.host,v&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==a[0]&&(a="/"+a))}if(!Dt[l])for(f=0,g=Pt.length;f<g;f++){var P=Pt[f];if(-1!==a.indexOf(P)){var M=encodeURIComponent(P);M===P&&(M=escape(P)),a=a.split(P).join(M)}}var C=a.indexOf("#");-1!==C&&(this.hash=a.substr(C),a=a.slice(0,C));var R=a.indexOf("?");if(-1!==R?(this.search=a.substr(R),this.query=a.substr(R+1),e&&(this.query=yt.parse(this.query)),a=a.slice(0,R)):e&&(this.search="",this.query={}),a&&(this.pathname=a),Nt[l]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){A=this.pathname||"";var O=this.search||"";this.path=A+O}return this.href=this.format(),this},Tt.prototype.format=function(){var t=this.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var e=this.protocol||"",r=this.pathname||"",i=this.hash||"",n=!1,o="";this.host?n=t+this.host:this.hostname&&(n=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(n+=":"+this.port)),this.query&&ut(this.query)&&Object.keys(this.query).length&&(o=yt.stringify(this.query));var a=this.search||o&&"?"+o||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||Nt[e])&&!1!==n?(n="//"+(n||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):n||(n=""),i&&"#"!==i.charAt(0)&&(i="#"+i),a&&"?"!==a.charAt(0)&&(a="?"+a),e+n+(r=r.replace(/[?#]/g,(function(t){return encodeURIComponent(t)})))+(a=a.replace("#","%23"))+i},Tt.prototype.resolve=function(t){return this.resolveObject(kt(t,!1,!0)).format()},Tt.prototype.resolveObject=function(t){if(lt(t)){var e=new Tt;e.parse(t,!1,!0),t=e}for(var r=new Tt,i=Object.keys(this),n=0;n<i.length;n++){var o=i[n];r[o]=this[o]}if(r.hash=t.hash,""===t.href)return r.href=r.format(),r;if(t.slashes&&!t.protocol){for(var a=Object.keys(t),s=0;s<a.length;s++){var h=a[s];"protocol"!==h&&(r[h]=t[h])}return Nt[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r}if(t.protocol&&t.protocol!==r.protocol){if(!Nt[t.protocol]){for(var l=Object.keys(t),u=0;u<l.length;u++){var c=l[u];r[c]=t[c]}return r.href=r.format(),r}if(r.protocol=t.protocol,t.host||Bt[t.protocol])r.pathname=t.pathname;else{for(var p=(t.pathname||"").split("/");p.length&&!(t.host=p.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==p[0]&&p.unshift(""),p.length<2&&p.unshift(""),r.pathname=p.join("/")}if(r.search=t.search,r.query=t.query,r.host=t.host||"",r.auth=t.auth,r.hostname=t.hostname||t.host,r.port=t.port,r.pathname||r.search){var d=r.pathname||"",f=r.search||"";r.path=d+f}return r.slashes=r.slashes||t.slashes,r.href=r.format(),r}var m=r.pathname&&"/"===r.pathname.charAt(0),v=t.host||t.pathname&&"/"===t.pathname.charAt(0),y=v||m||r.host&&t.pathname,g=y,_=r.pathname&&r.pathname.split("/")||[],x=(p=t.pathname&&t.pathname.split("/")||[],r.protocol&&!Nt[r.protocol]);if(x&&(r.hostname="",r.port=null,r.host&&(""===_[0]?_[0]=r.host:_.unshift(r.host)),r.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===p[0]?p[0]=t.host:p.unshift(t.host)),t.host=null),y=y&&(""===p[0]||""===_[0])),v)r.host=t.host||""===t.host?t.host:r.host,r.hostname=t.hostname||""===t.hostname?t.hostname:r.hostname,r.search=t.search,r.query=t.query,_=p;else if(p.length)_||(_=[]),_.pop(),_=_.concat(p),r.search=t.search,r.query=t.query;else if(!pt(t.search)){if(x)r.hostname=r.host=_.shift(),(S=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=S.shift(),r.host=r.hostname=S.shift());return r.search=t.search,r.query=t.query,ct(r.pathname)&&ct(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!_.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var b=_.slice(-1)[0],w=(r.host||t.host||_.length>1)&&("."===b||".."===b)||""===b,T=0,E=_.length;E>=0;E--)"."===(b=_[E])?_.splice(E,1):".."===b?(_.splice(E,1),T++):T&&(_.splice(E,1),T--);if(!y&&!g)for(;T--;T)_.unshift("..");!y||""===_[0]||_[0]&&"/"===_[0].charAt(0)||_.unshift(""),w&&"/"!==_.join("/").substr(-1)&&_.push("");var S,A=""===_[0]||_[0]&&"/"===_[0].charAt(0);x&&(r.hostname=r.host=A?"":_.length?_.shift():"",(S=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=S.shift(),r.host=r.hostname=S.shift()));return(y=y||r.host&&_.length)&&!A&&_.unshift(""),_.length?r.pathname=_.join("/"):(r.pathname=null,r.path=null),ct(r.pathname)&&ct(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=t.auth||r.auth,r.slashes=r.slashes||t.slashes,r.href=r.format(),r},Tt.prototype.parseHost=function(){var t=this.host,e=St.exec(t);e&&(":"!==(e=e[0])&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)};var Ft={parse:gt,resolve:_t,resolveObject:xt,format:bt,Url:wt};
/*!
	 * @pixi/constants - v5.3.7
	 * Compiled Tue, 29 Dec 2020 19:33:12 UTC
	 *
	 * @pixi/constants is licensed under the MIT License.
	 * http://www.opensource.org/licenses/mit-license
	 */!function(t){t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2"}(t.ENV||(t.ENV={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS"}(t.RENDERER_TYPE||(t.RENDERER_TYPE={})),function(t){t[t.COLOR=16384]="COLOR",t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL"}(t.BUFFER_BITS||(t.BUFFER_BITS={})),function(t){t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR"}(t.BLEND_MODES||(t.BLEND_MODES={})),function(t){t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(t.DRAW_MODES||(t.DRAW_MODES={})),function(t){t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(t.FORMATS||(t.FORMATS={})),function(t){t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(t.TARGETS||(t.TARGETS={})),function(t){t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.FLOAT=5126]="FLOAT",t[t.HALF_FLOAT=36193]="HALF_FLOAT"}(t.TYPES||(t.TYPES={})),function(t){t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR"}(t.SCALE_MODES||(t.SCALE_MODES={})),function(t){t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(t.WRAP_MODES||(t.WRAP_MODES={})),function(t){t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON"}(t.MIPMAP_MODES||(t.MIPMAP_MODES={})),function(t){t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA"}(t.ALPHA_MODES||(t.ALPHA_MODES={})),function(t){t[t.NO=0]="NO",t[t.YES=1]="YES",t[t.AUTO=2]="AUTO",t[t.BLEND=0]="BLEND",t[t.CLEAR=1]="CLEAR",t[t.BLIT=2]="BLIT"}(t.CLEAR_MODES||(t.CLEAR_MODES={})),function(t){t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL"}(t.GC_MODES||(t.GC_MODES={})),function(t){t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp"}(t.PRECISION||(t.PRECISION={})),function(t){t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE"}(t.MASK_TYPES||(t.MASK_TYPES={})),function(t){t[t.NONE=0]="NONE",t[t.LOW=2]="LOW",t[t.MEDIUM=4]="MEDIUM",t[t.HIGH=8]="HIGH"}(t.MSAA_QUALITY||(t.MSAA_QUALITY={})),
/*!
	 * @pixi/utils - v5.3.7
	 * Compiled Tue, 29 Dec 2020 19:33:12 UTC
	 *
	 * @pixi/utils is licensed under the MIT License.
	 * http://www.opensource.org/licenses/mit-license
	 */
O.RETINA_PREFIX=/@([0-9\.]+)x/,O.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!0;var Lt,Vt=!1;function Xt(t){var e;if(!Vt){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var r=["\n %c %c %c PixiJS 5.3.7 -  "+t+"   %c  %c  http://www.pixijs.com/  %c %c %c%c \n\n","background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];(e=window.console).log.apply(e,r)}else window.console&&window.console.log("PixiJS 5.3.7 - "+t+" - http://www.pixijs.com/");Vt=!0}}function jt(){return void 0===Lt&&(Lt=function(){var t={stencil:!0,failIfMajorPerformanceCaveat:O.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!window.WebGLRenderingContext)return!1;var e=document.createElement("canvas"),r=e.getContext("webgl",t)||e.getContext("experimental-webgl",t),i=!(!r||!r.getContextAttributes().stencil);if(r){var n=r.getExtension("WEBGL_lose_context");n&&n.loseContext()}return r=null,i}catch(t){return!1}}()),Lt}function Ut(t,e){return void 0===e&&(e=[]),e[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255,e}function Yt(t){var e=t.toString(16);return"#"+(e="000000".substr(0,6-e.length)+e)}function zt(t){return"string"==typeof t&&"#"===t[0]&&(t=t.substr(1)),parseInt(t,16)}var Wt=function(){for(var e=[],r=[],i=0;i<32;i++)e[i]=i,r[i]=i;e[t.BLEND_MODES.NORMAL_NPM]=t.BLEND_MODES.NORMAL,e[t.BLEND_MODES.ADD_NPM]=t.BLEND_MODES.ADD,e[t.BLEND_MODES.SCREEN_NPM]=t.BLEND_MODES.SCREEN,r[t.BLEND_MODES.NORMAL]=t.BLEND_MODES.NORMAL_NPM,r[t.BLEND_MODES.ADD]=t.BLEND_MODES.ADD_NPM,r[t.BLEND_MODES.SCREEN]=t.BLEND_MODES.SCREEN_NPM;var n=[];return n.push(r),n.push(e),n}();function qt(t,e){return Wt[e?1:0][t]}function Gt(t,e,r,i){return r=r||new Float32Array(4),i||void 0===i?(r[0]=t[0]*e,r[1]=t[1]*e,r[2]=t[2]*e):(r[0]=t[0],r[1]=t[1],r[2]=t[2]),r[3]=e,r}function Ht(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;var r=t>>16&255,i=t>>8&255,n=255&t;return(255*e<<24)+((r=r*e+.5|0)<<16)+((i=i*e+.5|0)<<8)+(n=n*e+.5|0)}function $t(t,e,r,i){return(r=r||new Float32Array(4))[0]=(t>>16&255)/255,r[1]=(t>>8&255)/255,r[2]=(255&t)/255,(i||void 0===i)&&(r[0]*=e,r[1]*=e,r[2]*=e),r[3]=e,r}function Jt(t,e){void 0===e&&(e=null);var r=6*t;if((e=e||new Uint16Array(r)).length!==r)throw new Error("Out buffer length is incorrect, got "+e.length+" and expected "+r);for(var i=0,n=0;i<r;i+=6,n+=4)e[i+0]=n+0,e[i+1]=n+1,e[i+2]=n+2,e[i+3]=n+0,e[i+4]=n+2,e[i+5]=n+3;return e}function Zt(t){if(4===t.BYTES_PER_ELEMENT)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array";return null}var Qt={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};function Kt(t){return t+=0===t?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1}function te(t){return!(t&t-1||!t)}function ee(t){var e=(t>65535?1:0)<<4,r=((t>>>=e)>255?1:0)<<3;return e|=r,e|=r=((t>>>=r)>15?1:0)<<2,(e|=r=((t>>>=r)>3?1:0)<<1)|(t>>>=r)>>1}function re(t,e,r){var i,n=t.length;if(!(e>=n||0===r)){var o=n-(r=e+r>n?n-e:r);for(i=e;i<o;++i)t[i]=t[i+r];t.length=o}}function ie(t){return 0===t?0:t<0?-1:1}var ne=0;function oe(){return++ne}var ae={};function se(t,e,r){if(void 0===r&&(r=3),!ae[e]){var i=(new Error).stack;void 0===i?console.warn("PixiJS Deprecation Warning: ",e+"\nDeprecated since v"+t):(i=i.split("\n").splice(r).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",e+"\nDeprecated since v"+t),console.warn(i),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",e+"\nDeprecated since v"+t),console.warn(i))),ae[e]=!0}}var he={},le=Object.create(null),ue=Object.create(null);var ce=function(){function t(t,e,r){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=r||O.RESOLUTION,this.resize(t,e)}return t.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},t.prototype.resize=function(t,e){this.canvas.width=t*this.resolution,this.canvas.height=e*this.resolution},t.prototype.destroy=function(){this.context=null,this.canvas=null},Object.defineProperty(t.prototype,"width",{get:function(){return this.canvas.width},set:function(t){this.canvas.width=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.canvas.height},set:function(t){this.canvas.height=t},enumerable:!1,configurable:!0}),t}();function pe(t){var e,r,i,n=t.width,o=t.height,a=t.getContext("2d"),s=a.getImageData(0,0,n,o).data,h=s.length,l={top:null,left:null,right:null,bottom:null},u=null;for(e=0;e<h;e+=4)0!==s[e+3]&&(r=e/4%n,i=~~(e/4/n),null===l.top&&(l.top=i),(null===l.left||r<l.left)&&(l.left=r),(null===l.right||l.right<r)&&(l.right=r+1),(null===l.bottom||l.bottom<i)&&(l.bottom=i));return null!==l.top&&(n=l.right-l.left,o=l.bottom-l.top+1,u=a.getImageData(l.left,l.top,n,o)),{height:o,width:n,data:u}}var de,fe=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i;function me(t,e){if(void 0===e&&(e=window.location),0===t.indexOf("data:"))return"";e=e||window.location,de||(de=document.createElement("a")),de.href=t;var r=gt(de.href),i=!r.port&&""===e.port||r.port===e.port;return r.hostname===e.hostname&&i&&r.protocol===e.protocol?"":"anonymous"}function ve(t,e){var r=O.RETINA_PREFIX.exec(t);return r?parseFloat(r[1]):void 0!==e?e:1}var ye,ge={BaseTextureCache:ue,CanvasRenderTarget:ce,DATA_URI:fe,ProgramCache:he,TextureCache:le,clearTextureCache:function(){var t;for(t in le)delete le[t];for(t in ue)delete ue[t]},correctBlendMode:qt,createIndicesForQuads:Jt,decomposeDataUri:function(t){var e=fe.exec(t);if(e)return{mediaType:e[1]?e[1].toLowerCase():void 0,subType:e[2]?e[2].toLowerCase():void 0,charset:e[3]?e[3].toLowerCase():void 0,encoding:e[4]?e[4].toLowerCase():void 0,data:e[5]}},deprecation:se,destroyTextureCache:function(){var t;for(t in le)le[t].destroy();for(t in ue)ue[t].destroy()},determineCrossOrigin:me,getBufferType:Zt,getResolutionOfUrl:ve,hex2rgb:Ut,hex2string:Yt,interleaveTypedArrays:function(t,e){for(var r=0,i=0,n={},o=0;o<t.length;o++)i+=e[o],r+=t[o].length;var a=new ArrayBuffer(4*r),s=null,h=0;for(o=0;o<t.length;o++){var l=e[o],u=t[o],c=Zt(u);n[c]||(n[c]=new Qt[c](a)),s=n[c];for(var p=0;p<u.length;p++){s[(p/l|0)*i+h+p%l]=u[p]}h+=l}return new Float32Array(a)},isPow2:te,isWebGLSupported:jt,log2:ee,nextPow2:Kt,premultiplyBlendMode:Wt,premultiplyRgba:Gt,premultiplyTint:Ht,premultiplyTintToRgba:$t,removeItems:re,rgb2hex:function(t){return(255*t[0]<<16)+(255*t[1]<<8)+(255*t[2]|0)},sayHello:Xt,sign:ie,skipHello:function(){Vt=!0},string2hex:zt,trimCanvas:pe,uid:oe,isMobile:R,EventEmitter:D,earcut:B,url:Ft},_e=2*Math.PI,xe=180/Math.PI,be=Math.PI/180;
/*!
	 * @pixi/math - v5.3.7
	 * Compiled Tue, 29 Dec 2020 19:33:12 UTC
	 *
	 * @pixi/math is licensed under the MIT License.
	 * http://www.opensource.org/licenses/mit-license
	 */(ye=t.SHAPES||(t.SHAPES={}))[ye.POLY=0]="POLY",ye[ye.RECT=1]="RECT",ye[ye.CIRC=2]="CIRC",ye[ye.ELIP=3]="ELIP",ye[ye.RREC=4]="RREC";var we=function(){function e(e,r,i,n){void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=0),void 0===n&&(n=0),this.x=Number(e),this.y=Number(r),this.width=Number(i),this.height=Number(n),this.type=t.SHAPES.RECT}return Object.defineProperty(e.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(e,"EMPTY",{get:function(){return new e(0,0,0,0)},enumerable:!1,configurable:!0}),e.prototype.clone=function(){return new e(this.x,this.y,this.width,this.height)},e.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},e.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},e.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0)&&(t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height)},e.prototype.pad=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},e.prototype.fit=function(t){var e=Math.max(this.x,t.x),r=Math.min(this.x+this.width,t.x+t.width),i=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(r-e,0),this.y=i,this.height=Math.max(n-i,0),this},e.prototype.ceil=function(t,e){void 0===t&&(t=1),void 0===e&&(e=.001);var r=Math.ceil((this.x+this.width-e)*t)/t,i=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=r-this.x,this.height=i-this.y,this},e.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),r=Math.max(this.x+this.width,t.x+t.width),i=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=r-e,this.y=i,this.height=n-i,this},e}(),Te=function(){function e(e,r,i){void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=0),this.x=e,this.y=r,this.radius=i,this.type=t.SHAPES.CIRC}return e.prototype.clone=function(){return new e(this.x,this.y,this.radius)},e.prototype.contains=function(t,e){if(this.radius<=0)return!1;var r=this.radius*this.radius,i=this.x-t,n=this.y-e;return(i*=i)+(n*=n)<=r},e.prototype.getBounds=function(){return new we(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)},e}(),Ee=function(){function e(e,r,i,n){void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=0),void 0===n&&(n=0),this.x=e,this.y=r,this.width=i,this.height=n,this.type=t.SHAPES.ELIP}return e.prototype.clone=function(){return new e(this.x,this.y,this.width,this.height)},e.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var r=(t-this.x)/this.width,i=(e-this.y)/this.height;return(r*=r)+(i*=i)<=1},e.prototype.getBounds=function(){return new we(this.x-this.width,this.y-this.height,this.width,this.height)},e}(),Se=function(){function e(){for(var e=arguments,r=[],i=0;i<arguments.length;i++)r[i]=e[i];var n=Array.isArray(r[0])?r[0]:r;if("number"!=typeof n[0]){for(var o=[],a=0,s=n.length;a<s;a++)o.push(n[a].x,n[a].y);n=o}this.points=n,this.type=t.SHAPES.POLY,this.closeStroke=!0}return e.prototype.clone=function(){var t=new e(this.points.slice());return t.closeStroke=this.closeStroke,t},e.prototype.contains=function(t,e){for(var r=!1,i=this.points.length/2,n=0,o=i-1;n<i;o=n++){var a=this.points[2*n],s=this.points[2*n+1],h=this.points[2*o],l=this.points[2*o+1];s>e!=l>e&&t<(e-s)/(l-s)*(h-a)+a&&(r=!r)}return r},e}(),Ae=function(){function e(e,r,i,n,o){void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=0),void 0===n&&(n=0),void 0===o&&(o=20),this.x=e,this.y=r,this.width=i,this.height=n,this.radius=o,this.type=t.SHAPES.RREC}return e.prototype.clone=function(){return new e(this.x,this.y,this.width,this.height,this.radius)},e.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(e>=this.y+this.radius&&e<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var r=t-(this.x+this.radius),i=e-(this.y+this.radius),n=this.radius*this.radius;if(r*r+i*i<=n)return!0;if((r=t-(this.x+this.width-this.radius))*r+i*i<=n)return!0;if(r*r+(i=e-(this.y+this.height-this.radius))*i<=n)return!0;if((r=t-(this.x+this.radius))*r+i*i<=n)return!0}return!1},e}(),Ie=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},t.prototype.copyTo=function(t){return t.set(this.x,this.y),t},t.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},t.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x=t,this.y=e,this},t}(),Pe=function(){function t(t,e,r,i){void 0===r&&(r=0),void 0===i&&(i=0),this._x=r,this._y=i,this.cb=t,this.scope=e}return t.prototype.clone=function(e,r){return void 0===e&&(e=this.cb),void 0===r&&(r=this.scope),new t(e,r,this._x,this._y)},t.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this._x===t&&this._y===e||(this._x=t,this._y=e,this.cb.call(this.scope)),this},t.prototype.copyFrom=function(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this},t.prototype.copyTo=function(t){return t.set(this._x,this._y),t},t.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),t}(),Me=function(){function t(t,e,r,i,n,o){void 0===t&&(t=1),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=1),void 0===n&&(n=0),void 0===o&&(o=0),this.array=null,this.a=t,this.b=e,this.c=r,this.d=i,this.tx=n,this.ty=o}return t.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},t.prototype.set=function(t,e,r,i,n,o){return this.a=t,this.b=e,this.c=r,this.d=i,this.tx=n,this.ty=o,this},t.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var r=e||this.array;return t?(r[0]=this.a,r[1]=this.b,r[2]=0,r[3]=this.c,r[4]=this.d,r[5]=0,r[6]=this.tx,r[7]=this.ty,r[8]=1):(r[0]=this.a,r[1]=this.c,r[2]=this.tx,r[3]=this.b,r[4]=this.d,r[5]=this.ty,r[6]=0,r[7]=0,r[8]=1),r},t.prototype.apply=function(t,e){e=e||new Ie;var r=t.x,i=t.y;return e.x=this.a*r+this.c*i+this.tx,e.y=this.b*r+this.d*i+this.ty,e},t.prototype.applyInverse=function(t,e){e=e||new Ie;var r=1/(this.a*this.d+this.c*-this.b),i=t.x,n=t.y;return e.x=this.d*r*i+-this.c*r*n+(this.ty*this.c-this.tx*this.d)*r,e.y=this.a*r*n+-this.b*r*i+(-this.ty*this.a+this.tx*this.b)*r,e},t.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},t.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},t.prototype.rotate=function(t){var e=Math.cos(t),r=Math.sin(t),i=this.a,n=this.c,o=this.tx;return this.a=i*e-this.b*r,this.b=i*r+this.b*e,this.c=n*e-this.d*r,this.d=n*r+this.d*e,this.tx=o*e-this.ty*r,this.ty=o*r+this.ty*e,this},t.prototype.append=function(t){var e=this.a,r=this.b,i=this.c,n=this.d;return this.a=t.a*e+t.b*i,this.b=t.a*r+t.b*n,this.c=t.c*e+t.d*i,this.d=t.c*r+t.d*n,this.tx=t.tx*e+t.ty*i+this.tx,this.ty=t.tx*r+t.ty*n+this.ty,this},t.prototype.setTransform=function(t,e,r,i,n,o,a,s,h){return this.a=Math.cos(a+h)*n,this.b=Math.sin(a+h)*n,this.c=-Math.sin(a-s)*o,this.d=Math.cos(a-s)*o,this.tx=t-(r*this.a+i*this.c),this.ty=e-(r*this.b+i*this.d),this},t.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var r=this.a,i=this.c;this.a=r*t.a+this.b*t.c,this.b=r*t.b+this.b*t.d,this.c=i*t.a+this.d*t.c,this.d=i*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},t.prototype.decompose=function(t){var e=this.a,r=this.b,i=this.c,n=this.d,o=-Math.atan2(-i,n),a=Math.atan2(r,e),s=Math.abs(o+a);return s<1e-5||Math.abs(_e-s)<1e-5?(t.rotation=a,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=o,t.skew.y=a),t.scale.x=Math.sqrt(e*e+r*r),t.scale.y=Math.sqrt(i*i+n*n),t.position.x=this.tx,t.position.y=this.ty,t},t.prototype.invert=function(){var t=this.a,e=this.b,r=this.c,i=this.d,n=this.tx,o=t*i-e*r;return this.a=i/o,this.b=-e/o,this.c=-r/o,this.d=t/o,this.tx=(r*this.ty-i*n)/o,this.ty=-(t*this.ty-e*n)/o,this},t.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},t.prototype.clone=function(){var e=new t;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e},t.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},t.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},Object.defineProperty(t,"IDENTITY",{get:function(){return new t},enumerable:!1,configurable:!0}),Object.defineProperty(t,"TEMP_MATRIX",{get:function(){return new t},enumerable:!1,configurable:!0}),t}(),Ce=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Re=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Oe=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],De=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Be=[],Ne=[],ke=Math.sign;!function(){for(var t=0;t<16;t++){var e=[];Be.push(e);for(var r=0;r<16;r++)for(var i=ke(Ce[t]*Ce[r]+Oe[t]*Re[r]),n=ke(Re[t]*Ce[r]+De[t]*Re[r]),o=ke(Ce[t]*Oe[r]+Oe[t]*De[r]),a=ke(Re[t]*Oe[r]+De[t]*De[r]),s=0;s<16;s++)if(Ce[s]===i&&Re[s]===n&&Oe[s]===o&&De[s]===a){e.push(s);break}}for(t=0;t<16;t++){var h=new Me;h.set(Ce[t],Re[t],Oe[t],De[t],0,0),Ne.push(h)}}();var Fe={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(t){return Ce[t]},uY:function(t){return Re[t]},vX:function(t){return Oe[t]},vY:function(t){return De[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,e){return Be[t][e]},sub:function(t,e){return Be[t][Fe.inv(e)]},rotate180:function(t){return 4^t},isVertical:function(t){return 2==(3&t)},byDirection:function(t,e){return 2*Math.abs(t)<=Math.abs(e)?e>=0?Fe.S:Fe.N:2*Math.abs(e)<=Math.abs(t)?t>0?Fe.E:Fe.W:e>0?t>0?Fe.SE:Fe.SW:t>0?Fe.NE:Fe.NW},matrixAppendRotationInv:function(t,e,r,i){void 0===r&&(r=0),void 0===i&&(i=0);var n=Ne[Fe.inv(e)];n.tx=r,n.ty=i,t.append(n)}},Le=function(){function t(){this.worldTransform=new Me,this.localTransform=new Me,this.position=new Pe(this.onChange,this,0,0),this.scale=new Pe(this.onChange,this,1,1),this.pivot=new Pe(this.onChange,this,0,0),this.skew=new Pe(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}return t.prototype.onChange=function(){this._localID++},t.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},t.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},t.prototype.updateTransform=function(t){var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var r=t.worldTransform,i=this.worldTransform;i.a=e.a*r.a+e.b*r.c,i.b=e.a*r.b+e.b*r.d,i.c=e.c*r.a+e.d*r.c,i.d=e.c*r.b+e.d*r.d,i.tx=e.tx*r.a+e.ty*r.c+r.tx,i.ty=e.tx*r.b+e.ty*r.d+r.ty,this._parentID=t._worldID,this._worldID++}},t.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(t.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!1,configurable:!0}),t.IDENTITY=new t,t}();
/*!
	 * @pixi/display - v5.3.7
	 * Compiled Tue, 29 Dec 2020 19:33:12 UTC
	 *
	 * @pixi/display is licensed under the MIT License.
	 * http://www.opensource.org/licenses/mit-license
	 */
O.SORTABLE_CHILDREN=!1;var Ve=function(){function t(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}return t.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},t.prototype.clear=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},t.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?we.EMPTY:((t=t||new we(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},t.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)},t.prototype.addQuad=function(t){var e=this.minX,r=this.minY,i=this.maxX,n=this.maxY,o=t[0],a=t[1];e=o<e?o:e,r=a<r?a:r,i=o>i?o:i,n=a>n?a:n,e=(o=t[2])<e?o:e,r=(a=t[3])<r?a:r,i=o>i?o:i,n=a>n?a:n,e=(o=t[4])<e?o:e,r=(a=t[5])<r?a:r,i=o>i?o:i,n=a>n?a:n,e=(o=t[6])<e?o:e,r=(a=t[7])<r?a:r,i=o>i?o:i,n=a>n?a:n,this.minX=e,this.minY=r,this.maxX=i,this.maxY=n},t.prototype.addFrame=function(t,e,r,i,n){this.addFrameMatrix(t.worldTransform,e,r,i,n)},t.prototype.addFrameMatrix=function(t,e,r,i,n){var o=t.a,a=t.b,s=t.c,h=t.d,l=t.tx,u=t.ty,c=this.minX,p=this.minY,d=this.maxX,f=this.maxY,m=o*e+s*r+l,v=a*e+h*r+u;c=m<c?m:c,p=v<p?v:p,d=m>d?m:d,f=v>f?v:f,c=(m=o*i+s*r+l)<c?m:c,p=(v=a*i+h*r+u)<p?v:p,d=m>d?m:d,f=v>f?v:f,c=(m=o*e+s*n+l)<c?m:c,p=(v=a*e+h*n+u)<p?v:p,d=m>d?m:d,f=v>f?v:f,c=(m=o*i+s*n+l)<c?m:c,p=(v=a*i+h*n+u)<p?v:p,d=m>d?m:d,f=v>f?v:f,this.minX=c,this.minY=p,this.maxX=d,this.maxY=f},t.prototype.addVertexData=function(t,e,r){for(var i=this.minX,n=this.minY,o=this.maxX,a=this.maxY,s=e;s<r;s+=2){var h=t[s],l=t[s+1];i=h<i?h:i,n=l<n?l:n,o=h>o?h:o,a=l>a?l:a}this.minX=i,this.minY=n,this.maxX=o,this.maxY=a},t.prototype.addVertices=function(t,e,r,i){this.addVerticesMatrix(t.worldTransform,e,r,i)},t.prototype.addVerticesMatrix=function(t,e,r,i,n,o){void 0===n&&(n=0),void 0===o&&(o=n);for(var a=t.a,s=t.b,h=t.c,l=t.d,u=t.tx,c=t.ty,p=this.minX,d=this.minY,f=this.maxX,m=this.maxY,v=r;v<i;v+=2){var y=e[v],g=e[v+1],_=a*y+h*g+u,x=l*g+s*y+c;p=Math.min(p,_-n),f=Math.max(f,_+n),d=Math.min(d,x-o),m=Math.max(m,x+o)}this.minX=p,this.minY=d,this.maxX=f,this.maxY=m},t.prototype.addBounds=function(t){var e=this.minX,r=this.minY,i=this.maxX,n=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<r?t.minY:r,this.maxX=t.maxX>i?t.maxX:i,this.maxY=t.maxY>n?t.maxY:n},t.prototype.addBoundsMask=function(t,e){var r=t.minX>e.minX?t.minX:e.minX,i=t.minY>e.minY?t.minY:e.minY,n=t.maxX<e.maxX?t.maxX:e.maxX,o=t.maxY<e.maxY?t.maxY:e.maxY;if(r<=n&&i<=o){var a=this.minX,s=this.minY,h=this.maxX,l=this.maxY;this.minX=r<a?r:a,this.minY=i<s?i:s,this.maxX=n>h?n:h,this.maxY=o>l?o:l}},t.prototype.addBoundsMatrix=function(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},t.prototype.addBoundsArea=function(t,e){var r=t.minX>e.x?t.minX:e.x,i=t.minY>e.y?t.minY:e.y,n=t.maxX<e.x+e.width?t.maxX:e.x+e.width,o=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(r<=n&&i<=o){var a=this.minX,s=this.minY,h=this.maxX,l=this.maxY;this.minX=r<a?r:a,this.minY=i<s?i:s,this.maxX=n>h?n:h,this.maxY=o>l?o:l}},t.prototype.pad=function(t,e){void 0===t&&(t=0),void 0===e&&(e=t),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},t.prototype.addFramePad=function(t,e,r,i,n,o){t-=n,e-=o,r+=n,i+=o,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>r?this.maxX:r,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>i?this.maxY:i},t}(),Xe=function(t,e){return(Xe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};
/*! *****************************************************************************
	Copyright (c) Microsoft Corporation. All rights reserved.
	Licensed under the Apache License, Version 2.0 (the "License"); you may not use
	this file except in compliance with the License. You may obtain a copy of the
	License at http://www.apache.org/licenses/LICENSE-2.0

	THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
	KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
	WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
	MERCHANTABLITY OR NON-INFRINGEMENT.

	See the Apache Version 2.0 License for specific language governing permissions
	and limitations under the License.
	***************************************************************************** */function je(t,e){function r(){this.constructor=t}Xe(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var Ue=function(t){function e(){var e=t.call(this)||this;return e.tempDisplayObjectParent=null,e.transform=new Le,e.alpha=1,e.visible=!0,e.renderable=!0,e.parent=null,e.worldAlpha=1,e._lastSortedIndex=0,e._zIndex=0,e.filterArea=null,e.filters=null,e._enabledFilters=null,e._bounds=new Ve,e._localBounds=null,e._boundsID=0,e._boundsRect=null,e._localBoundsRect=null,e._mask=null,e._destroyed=!1,e.isSprite=!1,e.isMask=!1,e}return je(e,t),e.mixin=function(t){for(var r=Object.keys(t),i=0;i<r.length;++i){var n=r[i];Object.defineProperty(e.prototype,n,Object.getOwnPropertyDescriptor(t,n))}},e.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},e.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha},e.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new we),e=this._boundsRect),this._bounds.getRectangle(e)},e.prototype.getLocalBounds=function(t){t||(this._localBoundsRect||(this._localBoundsRect=new we),t=this._localBoundsRect),this._localBounds||(this._localBounds=new Ve);var e=this.transform,r=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;var i=this._bounds,n=this._boundsID;this._bounds=this._localBounds;var o=this.getBounds(!1,t);return this.parent=r,this.transform=e,this._bounds=i,this._bounds.updateID+=this._boundsID-n,o},e.prototype.toGlobal=function(t,e,r){return void 0===r&&(r=!1),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)},e.prototype.toLocal=function(t,e,r,i){return e&&(t=e.toGlobal(t,r,i)),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,r)},e.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t},e.prototype.setTransform=function(t,e,r,i,n,o,a,s,h){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=1),void 0===i&&(i=1),void 0===n&&(n=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===s&&(s=0),void 0===h&&(h=0),this.position.x=t,this.position.y=e,this.scale.x=r||1,this.scale.y=i||1,this.rotation=n,this.skew.x=o,this.skew.y=a,this.pivot.x=s,this.pivot.y=h,this},e.prototype.destroy=function(t){this.parent&&this.parent.removeChild(this),this.removeAllListeners(),this.transform=null,this.parent=null,this._bounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},Object.defineProperty(e.prototype,"_tempDisplayObjectParent",{get:function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new Ye),this.tempDisplayObjectParent},enumerable:!1,configurable:!0}),e.prototype.enableTempParent=function(){var t=this.parent;return this.parent=this._tempDisplayObjectParent,t},e.prototype.disableTempParent=function(t){this.parent=t},Object.defineProperty(e.prototype,"x",{get:function(){return this.position.x},set:function(t){this.transform.position.x=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.position.y},set:function(t){this.transform.position.y=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"worldTransform",{get:function(){return this.transform.worldTransform},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"localTransform",{get:function(){return this.transform.localTransform},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"position",{get:function(){return this.transform.position},set:function(t){this.transform.position.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scale",{get:function(){return this.transform.scale},set:function(t){this.transform.scale.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pivot",{get:function(){return this.transform.pivot},set:function(t){this.transform.pivot.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"skew",{get:function(){return this.transform.skew},set:function(t){this.transform.skew.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotation",{get:function(){return this.transform.rotation},set:function(t){this.transform.rotation=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"angle",{get:function(){return this.transform.rotation*xe},set:function(t){this.transform.rotation=t*be},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"zIndex",{get:function(){return this._zIndex},set:function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"worldVisible",{get:function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mask",{get:function(){return this._mask},set:function(t){var e;this._mask&&((e=this._mask.maskObject||this._mask).renderable=!0,e.isMask=!1);(this._mask=t,this._mask)&&((e=this._mask.maskObject||this._mask).renderable=!1,e.isMask=!0)},enumerable:!1,configurable:!0}),e}(D),Ye=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sortDirty=null,e}return je(e,t),e}(Ue);function ze(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}Ue.prototype.displayObjectUpdateTransform=Ue.prototype.updateTransform;var We=function(t){function e(){var e=t.call(this)||this;return e.children=[],e.sortableChildren=O.SORTABLE_CHILDREN,e.sortDirty=!1,e}return je(e,t),e.prototype.onChildrenChange=function(t){},e.prototype.addChild=function(){for(var t=arguments,e=[],r=0;r<arguments.length;r++)e[r]=t[r];if(e.length>1)for(var i=0;i<e.length;i++)this.addChild(e[i]);else{var n=e[0];n.parent&&n.parent.removeChild(n),n.parent=this,this.sortDirty=!0,n.transform._parentID=-1,this.children.push(n),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",n,this,this.children.length-1),n.emit("added",this)}return e[0]},e.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t},e.prototype.swapChildren=function(t,e){if(t!==e){var r=this.getChildIndex(t),i=this.getChildIndex(e);this.children[r]=e,this.children[i]=t,this.onChildrenChange(r<i?r:i)}},e.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},e.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error("The index "+e+" supplied is out of bounds "+this.children.length);var r=this.getChildIndex(t);re(this.children,r,1),this.children.splice(e,0,t),this.onChildrenChange(e)},e.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error("getChildAt: Index ("+t+") does not exist.");return this.children[t]},e.prototype.removeChild=function(){for(var t=arguments,e=[],r=0;r<arguments.length;r++)e[r]=t[r];if(e.length>1)for(var i=0;i<e.length;i++)this.removeChild(e[i]);else{var n=e[0],o=this.children.indexOf(n);if(-1===o)return null;n.parent=null,n.transform._parentID=-1,re(this.children,o,1),this._boundsID++,this.onChildrenChange(o),n.emit("removed",this),this.emit("childRemoved",n,this,o)}return e[0]},e.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,re(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e},e.prototype.removeChildren=function(t,e){void 0===t&&(t=0),void 0===e&&(e=this.children.length);var r,i=t,n=e-i;if(n>0&&n<=e){r=this.children.splice(i,n);for(var o=0;o<r.length;++o)r[o].parent=null,r[o].transform&&(r[o].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(o=0;o<r.length;++o)r[o].emit("removed",this),this.emit("childRemoved",r[o],this,o);return r}if(0===n&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},e.prototype.sortChildren=function(){for(var t=!1,e=0,r=this.children.length;e<r;++e){var i=this.children[e];i._lastSortedIndex=e,t||0===i.zIndex||(t=!0)}t&&this.children.length>1&&this.children.sort(ze),this.sortDirty=!1},e.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var r=this.children[t];r.visible&&r.updateTransform()}},e.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){var r=e._mask.maskObject||e._mask;r.calculateBounds(),this._bounds.addBoundsMask(e._bounds,r._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._bounds.updateID=this._boundsID},e.prototype.getLocalBounds=function(e,r){void 0===r&&(r=!1);var i=t.prototype.getLocalBounds.call(this,e);if(!r)for(var n=0,o=this.children.length;n<o;++n){var a=this.children[n];a.visible&&a.updateTransform()}return i},e.prototype._calculateBounds=function(){},e.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else{this._render(t);for(var e=0,r=this.children.length;e<r;++e)this.children[e].render(t)}},e.prototype.renderAdvanced=function(t){t.batch.flush();var e=this.filters,r=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var i=0;i<e.length;i++)e[i].enabled&&this._enabledFilters.push(e[i]);this._enabledFilters.length&&t.filter.push(this,this._enabledFilters)}r&&t.mask.push(this,this._mask),this._render(t);i=0;for(var n=this.children.length;i<n;i++)this.children[i].render(t);t.batch.flush(),r&&t.mask.pop(this),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()},e.prototype._render=function(t){},e.prototype.destroy=function(e){t.prototype.destroy.call(this),this.sortDirty=!1;var r="boolean"==typeof e?e:e&&e.children,i=this.removeChildren(0,this.children.length);if(r)for(var n=0;n<i.length;++n)i[n].destroy(e)},Object.defineProperty(e.prototype,"width",{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(t){var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t},enumerable:!1,configurable:!0}),e}(Ue);We.prototype.containerUpdateTransform=We.prototype.updateTransform;
/*!
	 * @pixi/accessibility - v5.3.7
	 * Compiled Tue, 29 Dec 2020 19:33:12 UTC
	 *
	 * @pixi/accessibility is licensed under the MIT License.
	 * http://www.opensource.org/licenses/mit-license
	 */
var qe={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};Ue.mixin(qe);var Ge,He=function(){function t(t){this._hookDiv=null,(R.tablet||R.phone)&&this.createTouchHook();var e=document.createElement("div");e.style.width="100px",e.style.height="100px",e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.zIndex=2..toString(),this.div=e,this.pool=[],this.renderId=0,this.debug=!1,this.renderer=t,this.children=[],this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._isActive=!1,this._isMobileAccessibility=!1,this.androidUpdateCount=0,this.androidUpdateFrequency=500,window.addEventListener("keydown",this._onKeyDown,!1)}return Object.defineProperty(t.prototype,"isActive",{get:function(){return this._isActive},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isMobileAccessibility",{get:function(){return this._isMobileAccessibility},enumerable:!1,configurable:!0}),t.prototype.createTouchHook=function(){var t=this,e=document.createElement("button");e.style.width="1px",e.style.height="1px",e.style.position="absolute",e.style.top="-1000px",e.style.left="-1000px",e.style.zIndex=2..toString(),e.style.backgroundColor="#FF0000",e.title="select to enable accessability for this content",e.addEventListener("focus",(function(){t._isMobileAccessibility=!0,t.activate(),t.destroyTouchHook()})),document.body.appendChild(e),this._hookDiv=e},t.prototype.destroyTouchHook=function(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)},t.prototype.activate=function(){this._isActive||(this._isActive=!0,window.document.addEventListener("mousemove",this._onMouseMove,!0),window.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),this.renderer.view.parentNode&&this.renderer.view.parentNode.appendChild(this.div))},t.prototype.deactivate=function(){this._isActive&&!this._isMobileAccessibility&&(this._isActive=!1,window.document.removeEventListener("mousemove",this._onMouseMove,!0),window.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),this.div.parentNode&&this.div.parentNode.removeChild(this.div))},t.prototype.updateAccessibleObjects=function(t){if(t.visible&&t.accessibleChildren){t.accessible&&t.interactive&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);for(var e=t.children,r=0;r<e.length;r++)this.updateAccessibleObjects(e[r])}},t.prototype.update=function(){var t=performance.now();if(!(R.android.device&&t<this.androidUpdateCount)&&(this.androidUpdateCount=t+this.androidUpdateFrequency,this.renderer.renderingToScreen)){this.renderer._lastObjectRendered&&this.updateAccessibleObjects(this.renderer._lastObjectRendered);var e=this.renderer.view.getBoundingClientRect(),r=this.renderer.resolution,i=e.width/this.renderer.width*r,n=e.height/this.renderer.height*r,o=this.div;o.style.left=e.left+"px",o.style.top=e.top+"px",o.style.width=this.renderer.width+"px",o.style.height=this.renderer.height+"px";for(var a=0;a<this.children.length;a++){var s=this.children[a];if(s.renderId!==this.renderId)s._accessibleActive=!1,re(this.children,a,1),this.div.removeChild(s._accessibleDiv),this.pool.push(s._accessibleDiv),s._accessibleDiv=null,a--;else{o=s._accessibleDiv;var h=s.hitArea,l=s.worldTransform;s.hitArea?(o.style.left=(l.tx+h.x*l.a)*i+"px",o.style.top=(l.ty+h.y*l.d)*n+"px",o.style.width=h.width*l.a*i+"px",o.style.height=h.height*l.d*n+"px"):(h=s.getBounds(),this.capHitArea(h),o.style.left=h.x*i+"px",o.style.top=h.y*n+"px",o.style.width=h.width*i+"px",o.style.height=h.height*n+"px",o.title!==s.accessibleTitle&&null!==s.accessibleTitle&&(o.title=s.accessibleTitle),o.getAttribute("aria-label")!==s.accessibleHint&&null!==s.accessibleHint&&o.setAttribute("aria-label",s.accessibleHint)),s.accessibleTitle===o.title&&s.tabIndex===o.tabIndex||(o.title=s.accessibleTitle,o.tabIndex=s.tabIndex,this.debug&&this.updateDebugHTML(o))}}this.renderId++}},t.prototype.updateDebugHTML=function(t){t.innerHTML="type: "+t.type+"</br> title : "+t.title+"</br> tabIndex: "+t.tabIndex},t.prototype.capHitArea=function(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0),t.x+t.width>this.renderer.width&&(t.width=this.renderer.width-t.x),t.y+t.height>this.renderer.height&&(t.height=this.renderer.height-t.y)},t.prototype.addChild=function(t){var e=this.pool.pop();e||((e=document.createElement("button")).style.width="100px",e.style.height="100px",e.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",e.style.position="absolute",e.style.zIndex=2..toString(),e.style.borderStyle="none",navigator.userAgent.toLowerCase().indexOf("chrome")>-1?e.setAttribute("aria-live","off"):e.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?e.setAttribute("aria-relevant","additions"):e.setAttribute("aria-relevant","text"),e.addEventListener("click",this._onClick.bind(this)),e.addEventListener("focus",this._onFocus.bind(this)),e.addEventListener("focusout",this._onFocusOut.bind(this))),e.style.pointerEvents=t.accessiblePointerEvents,e.type=t.accessibleType,t.accessibleTitle&&null!==t.accessibleTitle?e.title=t.accessibleTitle:t.accessibleHint&&null!==t.accessibleHint||(e.title="displayObject "+t.tabIndex),t.accessibleHint&&null!==t.accessibleHint&&e.setAttribute("aria-label",t.accessibleHint),this.debug&&this.updateDebugHTML(e),t._accessibleActive=!0,t._accessibleDiv=e,e.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex},t.prototype._onClick=function(t){var e=this.renderer.plugins.interaction;e.dispatchEvent(t.target.displayObject,"click",e.eventData),e.dispatchEvent(t.target.displayObject,"pointertap",e.eventData),e.dispatchEvent(t.target.displayObject,"tap",e.eventData)},t.prototype._onFocus=function(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","assertive");var e=this.renderer.plugins.interaction;e.dispatchEvent(t.target.displayObject,"mouseover",e.eventData)},t.prototype._onFocusOut=function(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","polite");var e=this.renderer.plugins.interaction;e.dispatchEvent(t.target.displayObject,"mouseout",e.eventData)},t.prototype._onKeyDown=function(t){9===t.keyCode&&this.activate()},t.prototype._onMouseMove=function(t){0===t.movementX&&0===t.movementY||this.deactivate()},t.prototype.destroy=function(){this.destroyTouchHook(),this.div=null,window.document.removeEventListener("mousemove",this._onMouseMove,!0),window.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null},t}();
/*!
	 * @pixi/ticker - v5.3.7
	 * Compiled Tue, 29 Dec 2020 19:33:12 UTC
	 *
	 * @pixi/ticker is licensed under the MIT License.
	 * http://www.opensource.org/licenses/mit-license
	 */
O.TARGET_FPMS=.06,(Ge=t.UPDATE_PRIORITY||(t.UPDATE_PRIORITY={}))[Ge.INTERACTION=50]="INTERACTION",Ge[Ge.HIGH=25]="HIGH",Ge[Ge.NORMAL=0]="NORMAL",Ge[Ge.LOW=-25]="LOW",Ge[Ge.UTILITY=-50]="UTILITY";var $e=function(){function t(t,e,r,i){void 0===e&&(e=null),void 0===r&&(r=0),void 0===i&&(i=!1),this.fn=t,this.context=e,this.priority=r,this.once=i,this.next=null,this.previous=null,this._destroyed=!1}return t.prototype.match=function(t,e){return void 0===e&&(e=null),this.fn===t&&this.context===e},t.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e},t.prototype.connect=function(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this},t.prototype.destroy=function(t){void 0===t&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,this.previous=null,e},t}(),Je=function(){function e(){var t=this;this._head=new $e(null,null,1/0),this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this.autoStart=!1,this.deltaTime=1,this.deltaMS=1/O.TARGET_FPMS,this.elapsedMS=1/O.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._protected=!1,this._lastFrame=-1,this._tick=function(e){t._requestId=null,t.started&&(t.update(e),t.started&&null===t._requestId&&t._head.next&&(t._requestId=requestAnimationFrame(t._tick)))}}return e.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},e.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},e.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},e.prototype.add=function(e,r,i){return void 0===i&&(i=t.UPDATE_PRIORITY.NORMAL),this._addListener(new $e(e,r,i))},e.prototype.addOnce=function(e,r,i){return void 0===i&&(i=t.UPDATE_PRIORITY.NORMAL),this._addListener(new $e(e,r,i,!0))},e.prototype._addListener=function(t){var e=this._head.next,r=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(r);break}r=e,e=e.next}t.previous||t.connect(r)}else t.connect(r);return this._startIfPossible(),this},e.prototype.remove=function(t,e){for(var r=this._head.next;r;)r=r.match(t,e)?r.destroy():r.next;return this._head.next||this._cancelIfNeeded(),this},Object.defineProperty(e.prototype,"count",{get:function(){if(!this._head)return 0;for(var t=0,e=this._head;e=e.next;)t++;return t},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},e.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},e.prototype.destroy=function(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}},e.prototype.update=function(t){var e;if(void 0===t&&(t=performance.now()),t>this.lastTime){if((e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){var r=t-this._lastFrame|0;if(r<this._minElapsedMS)return;this._lastFrame=t-r%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*O.TARGET_FPMS;for(var i=this._head,n=i.next;n;)n=n.emit(this.deltaTime);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Object.defineProperty(e.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(this.maxFPS,t),r=Math.min(Math.max(0,e)/1e3,O.TARGET_FPMS);this._maxElapsedMS=1/r},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(t){if(0===t)this._minElapsedMS=0;else{var e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}},enumerable:!1,configurable:!0}),Object.defineProperty(e,"shared",{get:function(){if(!e._shared){var t=e._shared=new e;t.autoStart=!0,t._protected=!0}return e._shared},enumerable:!1,configurable:!0}),Object.defineProperty(e,"system",{get:function(){if(!e._system){var t=e._system=new e;t.autoStart=!0,t._protected=!0}return e._system},enumerable:!1,configurable:!0}),e}(),Ze=function(){function e(){}return e.init=function(e){var r=this;e=Object.assign({autoStart:!0,sharedTicker:!1},e),Object.defineProperty(this,"ticker",{set:function(e){this._ticker&&this._ticker.remove(this.render,this),this._ticker=e,e&&e.add(this.render,this,t.UPDATE_PRIORITY.LOW)},get:function(){return this._ticker}}),this.stop=function(){r._ticker.stop()},this.start=function(){r._ticker.start()},this._ticker=null,this.ticker=e.sharedTicker?Je.shared:new Je,e.autoStart&&this.start()},e.destroy=function(){if(this._ticker){var t=this._ticker;this.ticker=null,t.destroy()}},e}(),Qe=function(){function t(){this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0,this.global=new Ie,this.target=null,this.originalEvent=null,this.identifier=null,this.isPrimary=!1,this.button=0,this.buttons=0,this.width=0,this.height=0,this.tiltX=0,this.tiltY=0,this.pointerType=null,this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0}return Object.defineProperty(t.prototype,"pointerId",{get:function(){return this.identifier},enumerable:!1,configurable:!0}),t.prototype.getLocalPosition=function(t,e,r){return t.worldTransform.applyInverse(r||this.global,e)},t.prototype.copyEvent=function(t){"isPrimary"in t&&t.isPrimary&&(this.isPrimary=!0),this.button="button"in t&&t.button;var e="buttons"in t&&t.buttons;this.buttons=Number.isInteger(e)?e:"which"in t&&t.which,this.width="width"in t&&t.width,this.height="height"in t&&t.height,this.tiltX="tiltX"in t&&t.tiltX,this.tiltY="tiltY"in t&&t.tiltY,this.pointerType="pointerType"in t&&t.pointerType,this.pressure="pressure"in t&&t.pressure,this.rotationAngle="rotationAngle"in t&&t.rotationAngle,this.twist="twist"in t&&t.twist||0,this.tangentialPressure="tangentialPressure"in t&&t.tangentialPressure||0},t.prototype.reset=function(){this.isPrimary=!1},t}(),Ke=function(t,e){return(Ke=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};var tr=function(){function t(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.target=null,this.currentTarget=null,this.type=null,this.data=null}return t.prototype.stopPropagation=function(){this.stopped=!0,this.stopPropagationHint=!0,this.stopsPropagatingAt=this.currentTarget},t.prototype.reset=function(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.currentTarget=null,this.target=null},t}(),er=function(){function t(e){this._pointerId=e,this._flags=t.FLAGS.NONE}return t.prototype._doSet=function(t,e){this._flags=e?this._flags|t:this._flags&~t},Object.defineProperty(t.prototype,"pointerId",{get:function(){return this._pointerId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"flags",{get:function(){return this._flags},set:function(t){this._flags=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"none",{get:function(){return this._flags===t.FLAGS.NONE},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"over",{get:function(){return 0!=(this._flags&t.FLAGS.OVER)},set:function(e){this._doSet(t.FLAGS.OVER,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rightDown",{get:function(){return 0!=(this._flags&t.FLAGS.RIGHT_DOWN)},set:function(e){this._doSet(t.FLAGS.RIGHT_DOWN,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"leftDown",{get:function(){return 0!=(this._flags&t.FLAGS.LEFT_DOWN)},set:function(e){this._doSet(t.FLAGS.LEFT_DOWN,e)},enumerable:!1,configurable:!0}),t.FLAGS=Object.freeze({NONE:0,OVER:1,LEFT_DOWN:2,RIGHT_DOWN:4}),t}(),rr=function(){function t(){this._tempPoint=new Ie}return t.prototype.recursiveFindHit=function(t,e,r,i,n){if(!e||!e.visible)return!1;var o=t.data.global,a=!1,s=n=e.interactive||n,h=!0;if(e.hitArea?(i&&(e.worldTransform.applyInverse(o,this._tempPoint),e.hitArea.contains(this._tempPoint.x,this._tempPoint.y)?a=!0:(i=!1,h=!1)),s=!1):e._mask&&i&&(e._mask.containsPoint&&e._mask.containsPoint(o)||(i=!1)),h&&e.interactiveChildren&&e.children)for(var l=e.children,u=l.length-1;u>=0;u--){var c=l[u],p=this.recursiveFindHit(t,c,r,i,s);if(p){if(!c.parent)continue;s=!1,p&&(t.target&&(i=!1),a=!0)}}return n&&(i&&!t.target&&!e.hitArea&&e.containsPoint&&e.containsPoint(o)&&(a=!0),e.interactive&&(a&&!t.target&&(t.target=e),r&&r(t,e,!!a))),a},t.prototype.findHit=function(t,e,r,i){this.recursiveFindHit(t,e,r,i,!1)},t}(),ir={interactive:!1,interactiveChildren:!0,hitArea:null,get buttonMode(){return"pointer"===this.cursor},set buttonMode(t){t?this.cursor="pointer":"pointer"===this.cursor&&(this.cursor=null)},cursor:null,get trackedPointers(){return void 0===this._trackedPointers&&(this._trackedPointers={}),this._trackedPointers},_trackedPointers:void 0};Ue.mixin(ir);var nr={target:null,data:{global:null}},or=function(e){function r(t,r){var i=e.call(this)||this;return r=r||{},i.renderer=t,i.autoPreventDefault=void 0===r.autoPreventDefault||r.autoPreventDefault,i.interactionFrequency=r.interactionFrequency||10,i.mouse=new Qe,i.mouse.identifier=1,i.mouse.global.set(-999999),i.activeInteractionData={},i.activeInteractionData[1]=i.mouse,i.interactionDataPool=[],i.eventData=new tr,i.interactionDOMElement=null,i.moveWhenInside=!1,i.eventsAdded=!1,i.tickerAdded=!1,i.mouseOverRenderer=!1,i.supportsTouchEvents="ontouchstart"in window,i.supportsPointerEvents=!!window.PointerEvent,i.onPointerUp=i.onPointerUp.bind(i),i.processPointerUp=i.processPointerUp.bind(i),i.onPointerCancel=i.onPointerCancel.bind(i),i.processPointerCancel=i.processPointerCancel.bind(i),i.onPointerDown=i.onPointerDown.bind(i),i.processPointerDown=i.processPointerDown.bind(i),i.onPointerMove=i.onPointerMove.bind(i),i.processPointerMove=i.processPointerMove.bind(i),i.onPointerOut=i.onPointerOut.bind(i),i.processPointerOverOut=i.processPointerOverOut.bind(i),i.onPointerOver=i.onPointerOver.bind(i),i.cursorStyles={default:"inherit",pointer:"pointer"},i.currentCursorMode=null,i.cursor=null,i.resolution=1,i.delayedEvents=[],i.search=new rr,i._tempDisplayObject=new Ye,i._useSystemTicker=void 0===r.useSystemTicker||r.useSystemTicker,i.setTargetElement(i.renderer.view,i.renderer.resolution),i}return function(t,e){function r(){this.constructor=t}Ke(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}(r,e),Object.defineProperty(r.prototype,"useSystemTicker",{get:function(){return this._useSystemTicker},set:function(t){this._useSystemTicker=t,t?this.addTickerListener():this.removeTickerListener()},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"lastObjectRendered",{get:function(){return this.renderer._lastObjectRendered||this._tempDisplayObject},enumerable:!1,configurable:!0}),r.prototype.hitTest=function(t,e){return nr.target=null,nr.data.global=t,e||(e=this.lastObjectRendered),this.processInteractive(nr,e,null,!0),nr.target},r.prototype.setTargetElement=function(t,e){void 0===e&&(e=1),this.removeTickerListener(),this.removeEvents(),this.interactionDOMElement=t,this.resolution=e,this.addEvents(),this.addTickerListener()},r.prototype.addTickerListener=function(){!this.tickerAdded&&this.interactionDOMElement&&this._useSystemTicker&&(Je.system.add(this.tickerUpdate,this,t.UPDATE_PRIORITY.INTERACTION),this.tickerAdded=!0)},r.prototype.removeTickerListener=function(){this.tickerAdded&&(Je.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)},r.prototype.addEvents=function(){if(!this.eventsAdded&&this.interactionDOMElement){var t=this.interactionDOMElement.style;window.navigator.msPointerEnabled?(t.msContentZooming="none",t.msTouchAction="none"):this.supportsPointerEvents&&(t.touchAction="none"),this.supportsPointerEvents?(window.document.addEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("pointerdown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("pointerleave",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("pointerover",this.onPointerOver,!0),window.addEventListener("pointercancel",this.onPointerCancel,!0),window.addEventListener("pointerup",this.onPointerUp,!0)):(window.document.addEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("mouseover",this.onPointerOver,!0),window.addEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.interactionDOMElement.addEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("touchcancel",this.onPointerCancel,!0),this.interactionDOMElement.addEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.addEventListener("touchmove",this.onPointerMove,!0)),this.eventsAdded=!0}},r.prototype.removeEvents=function(){if(this.eventsAdded&&this.interactionDOMElement){var t=this.interactionDOMElement.style;window.navigator.msPointerEnabled?(t.msContentZooming="",t.msTouchAction=""):this.supportsPointerEvents&&(t.touchAction=""),this.supportsPointerEvents?(window.document.removeEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("pointerleave",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("pointerover",this.onPointerOver,!0),window.removeEventListener("pointercancel",this.onPointerCancel,!0),window.removeEventListener("pointerup",this.onPointerUp,!0)):(window.document.removeEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("mouseover",this.onPointerOver,!0),window.removeEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.interactionDOMElement.removeEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("touchcancel",this.onPointerCancel,!0),this.interactionDOMElement.removeEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.removeEventListener("touchmove",this.onPointerMove,!0)),this.interactionDOMElement=null,this.eventsAdded=!1}},r.prototype.tickerUpdate=function(t){this._deltaTime+=t,this._deltaTime<this.interactionFrequency||(this._deltaTime=0,this.update())},r.prototype.update=function(){if(this.interactionDOMElement)if(this._didMove)this._didMove=!1;else{for(var t in this.cursor=null,this.activeInteractionData)if(this.activeInteractionData.hasOwnProperty(t)){var e=this.activeInteractionData[t];if(e.originalEvent&&"touch"!==e.pointerType){var r=this.configureInteractionEventForDOMEvent(this.eventData,e.originalEvent,e);this.processInteractive(r,this.lastObjectRendered,this.processPointerOverOut,!0)}}this.setCursorMode(this.cursor)}},r.prototype.setCursorMode=function(t){if(t=t||"default",this.currentCursorMode!==t){this.currentCursorMode=t;var e=this.cursorStyles[t];if(e)switch(typeof e){case"string":this.interactionDOMElement.style.cursor=e;break;case"function":e(t);break;case"object":Object.assign(this.interactionDOMElement.style,e)}else"string"!=typeof t||Object.prototype.hasOwnProperty.call(this.cursorStyles,t)||(this.interactionDOMElement.style.cursor=t)}},r.prototype.dispatchEvent=function(t,e,r){r.stopPropagationHint&&t!==r.stopsPropagatingAt||(r.currentTarget=t,r.type=e,t.emit(e,r),t[e]&&t[e](r))},r.prototype.delayDispatchEvent=function(t,e,r){this.delayedEvents.push({displayObject:t,eventString:e,eventData:r})},r.prototype.mapPositionToPoint=function(t,e,r){var i;i=this.interactionDOMElement.parentElement?this.interactionDOMElement.getBoundingClientRect():{x:0,y:0,width:0,height:0};var n=1/this.resolution;t.x=(e-i.left)*(this.interactionDOMElement.width/i.width)*n,t.y=(r-i.top)*(this.interactionDOMElement.height/i.height)*n},r.prototype.processInteractive=function(t,e,r,i){var n=this.search.findHit(t,e,r,i),o=this.delayedEvents;if(!o.length)return n;t.stopPropagationHint=!1;var a=o.length;this.delayedEvents=[];for(var s=0;s<a;s++){var h=o[s],l=h.displayObject,u=h.eventString,c=h.eventData;c.stopsPropagatingAt===l&&(c.stopPropagationHint=!0),this.dispatchEvent(l,u,c)}return n},r.prototype.onPointerDown=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t);if(this.autoPreventDefault&&e[0].isNormalized)(t.cancelable||!("cancelable"in t))&&t.preventDefault();for(var r=e.length,i=0;i<r;i++){var n=e[i],o=this.getInteractionDataForPointerId(n),a=this.configureInteractionEventForDOMEvent(this.eventData,n,o);if(a.data.originalEvent=t,this.processInteractive(a,this.lastObjectRendered,this.processPointerDown,!0),this.emit("pointerdown",a),"touch"===n.pointerType)this.emit("touchstart",a);else if("mouse"===n.pointerType||"pen"===n.pointerType){var s=2===n.button;this.emit(s?"rightdown":"mousedown",this.eventData)}}}},r.prototype.processPointerDown=function(t,e,r){var i=t.data,n=t.data.identifier;if(r)if(e.trackedPointers[n]||(e.trackedPointers[n]=new er(n)),this.dispatchEvent(e,"pointerdown",t),"touch"===i.pointerType)this.dispatchEvent(e,"touchstart",t);else if("mouse"===i.pointerType||"pen"===i.pointerType){var o=2===i.button;o?e.trackedPointers[n].rightDown=!0:e.trackedPointers[n].leftDown=!0,this.dispatchEvent(e,o?"rightdown":"mousedown",t)}},r.prototype.onPointerComplete=function(t,e,r){for(var i=this.normalizeToPointerData(t),n=i.length,o=t.target!==this.interactionDOMElement?"outside":"",a=0;a<n;a++){var s=i[a],h=this.getInteractionDataForPointerId(s),l=this.configureInteractionEventForDOMEvent(this.eventData,s,h);if(l.data.originalEvent=t,this.processInteractive(l,this.lastObjectRendered,r,e||!o),this.emit(e?"pointercancel":"pointerup"+o,l),"mouse"===s.pointerType||"pen"===s.pointerType){var u=2===s.button;this.emit(u?"rightup"+o:"mouseup"+o,l)}else"touch"===s.pointerType&&(this.emit(e?"touchcancel":"touchend"+o,l),this.releaseInteractionDataForPointerId(s.pointerId))}},r.prototype.onPointerCancel=function(t){this.supportsTouchEvents&&"touch"===t.pointerType||this.onPointerComplete(t,!0,this.processPointerCancel)},r.prototype.processPointerCancel=function(t,e){var r=t.data,i=t.data.identifier;void 0!==e.trackedPointers[i]&&(delete e.trackedPointers[i],this.dispatchEvent(e,"pointercancel",t),"touch"===r.pointerType&&this.dispatchEvent(e,"touchcancel",t))},r.prototype.onPointerUp=function(t){this.supportsTouchEvents&&"touch"===t.pointerType||this.onPointerComplete(t,!1,this.processPointerUp)},r.prototype.processPointerUp=function(t,e,r){var i=t.data,n=t.data.identifier,o=e.trackedPointers[n],a="touch"===i.pointerType,s="mouse"===i.pointerType||"pen"===i.pointerType,h=!1;if(s){var l=2===i.button,u=er.FLAGS,c=l?u.RIGHT_DOWN:u.LEFT_DOWN,p=void 0!==o&&o.flags&c;r?(this.dispatchEvent(e,l?"rightup":"mouseup",t),p&&(this.dispatchEvent(e,l?"rightclick":"click",t),h=!0)):p&&this.dispatchEvent(e,l?"rightupoutside":"mouseupoutside",t),o&&(l?o.rightDown=!1:o.leftDown=!1)}r?(this.dispatchEvent(e,"pointerup",t),a&&this.dispatchEvent(e,"touchend",t),o&&(s&&!h||this.dispatchEvent(e,"pointertap",t),a&&(this.dispatchEvent(e,"tap",t),o.over=!1))):o&&(this.dispatchEvent(e,"pointerupoutside",t),a&&this.dispatchEvent(e,"touchendoutside",t)),o&&o.none&&delete e.trackedPointers[n]},r.prototype.onPointerMove=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t);"mouse"!==e[0].pointerType&&"pen"!==e[0].pointerType||(this._didMove=!0,this.cursor=null);for(var r=e.length,i=0;i<r;i++){var n=e[i],o=this.getInteractionDataForPointerId(n),a=this.configureInteractionEventForDOMEvent(this.eventData,n,o);a.data.originalEvent=t,this.processInteractive(a,this.lastObjectRendered,this.processPointerMove,!0),this.emit("pointermove",a),"touch"===n.pointerType&&this.emit("touchmove",a),"mouse"!==n.pointerType&&"pen"!==n.pointerType||this.emit("mousemove",a)}"mouse"===e[0].pointerType&&this.setCursorMode(this.cursor)}},r.prototype.processPointerMove=function(t,e,r){var i=t.data,n="touch"===i.pointerType,o="mouse"===i.pointerType||"pen"===i.pointerType;o&&this.processPointerOverOut(t,e,r),this.moveWhenInside&&!r||(this.dispatchEvent(e,"pointermove",t),n&&this.dispatchEvent(e,"touchmove",t),o&&this.dispatchEvent(e,"mousemove",t))},r.prototype.onPointerOut=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t)[0];"mouse"===e.pointerType&&(this.mouseOverRenderer=!1,this.setCursorMode(null));var r=this.getInteractionDataForPointerId(e),i=this.configureInteractionEventForDOMEvent(this.eventData,e,r);i.data.originalEvent=e,this.processInteractive(i,this.lastObjectRendered,this.processPointerOverOut,!1),this.emit("pointerout",i),"mouse"===e.pointerType||"pen"===e.pointerType?this.emit("mouseout",i):this.releaseInteractionDataForPointerId(r.identifier)}},r.prototype.processPointerOverOut=function(t,e,r){var i=t.data,n=t.data.identifier,o="mouse"===i.pointerType||"pen"===i.pointerType,a=e.trackedPointers[n];r&&!a&&(a=e.trackedPointers[n]=new er(n)),void 0!==a&&(r&&this.mouseOverRenderer?(a.over||(a.over=!0,this.delayDispatchEvent(e,"pointerover",t),o&&this.delayDispatchEvent(e,"mouseover",t)),o&&null===this.cursor&&(this.cursor=e.cursor)):a.over&&(a.over=!1,this.dispatchEvent(e,"pointerout",this.eventData),o&&this.dispatchEvent(e,"mouseout",t),a.none&&delete e.trackedPointers[n]))},r.prototype.onPointerOver=function(t){var e=this.normalizeToPointerData(t)[0],r=this.getInteractionDataForPointerId(e),i=this.configureInteractionEventForDOMEvent(this.eventData,e,r);i.data.originalEvent=e,"mouse"===e.pointerType&&(this.mouseOverRenderer=!0),this.emit("pointerover",i),"mouse"!==e.pointerType&&"pen"!==e.pointerType||this.emit("mouseover",i)},r.prototype.getInteractionDataForPointerId=function(t){var e,r=t.pointerId;return 1===r||"mouse"===t.pointerType?e=this.mouse:this.activeInteractionData[r]?e=this.activeInteractionData[r]:((e=this.interactionDataPool.pop()||new Qe).identifier=r,this.activeInteractionData[r]=e),e.copyEvent(t),e},r.prototype.releaseInteractionDataForPointerId=function(t){var e=this.activeInteractionData[t];e&&(delete this.activeInteractionData[t],e.reset(),this.interactionDataPool.push(e))},r.prototype.configureInteractionEventForDOMEvent=function(t,e,r){return t.data=r,this.mapPositionToPoint(r.global,e.clientX,e.clientY),"touch"===e.pointerType&&(e.globalX=r.global.x,e.globalY=r.global.y),r.originalEvent=e,t.reset(),t},r.prototype.normalizeToPointerData=function(t){var e=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(var r=0,i=t.changedTouches.length;r<i;r++){var n=t.changedTouches[r];void 0===n.button&&(n.button=t.touches.length?1:0),void 0===n.buttons&&(n.buttons=t.touches.length?1:0),void 0===n.isPrimary&&(n.isPrimary=1===t.touches.length&&"touchstart"===t.type),void 0===n.width&&(n.width=n.radiusX||1),void 0===n.height&&(n.height=n.radiusY||1),void 0===n.tiltX&&(n.tiltX=0),void 0===n.tiltY&&(n.tiltY=0),void 0===n.pointerType&&(n.pointerType="touch"),void 0===n.pointerId&&(n.pointerId=n.identifier||0),void 0===n.pressure&&(n.pressure=n.force||.5),void 0===n.twist&&(n.twist=0),void 0===n.tangentialPressure&&(n.tangentialPressure=0),void 0===n.layerX&&(n.layerX=n.offsetX=n.clientX),void 0===n.layerY&&(n.layerY=n.offsetY=n.clientY),n.isNormalized=!0,e.push(n)}else if(!(t instanceof MouseEvent)||this.supportsPointerEvents&&t instanceof window.PointerEvent)e.push(t);else{var o=t;void 0===o.isPrimary&&(o.isPrimary=!0),void 0===o.width&&(o.width=1),void 0===o.height&&(o.height=1),void 0===o.tiltX&&(o.tiltX=0),void 0===o.tiltY&&(o.tiltY=0),void 0===o.pointerType&&(o.pointerType="mouse"),void 0===o.pointerId&&(o.pointerId=1),void 0===o.pressure&&(o.pressure=.5),void 0===o.twist&&(o.twist=0),void 0===o.tangentialPressure&&(o.tangentialPressure=0),o.isNormalized=!0,e.push(o)}return e},r.prototype.destroy=function(){this.removeEvents(),this.removeTickerListener(),this.removeAllListeners(),this.renderer=null,this.mouse=null,this.eventData=null,this.interactionDOMElement=null,this.onPointerDown=null,this.processPointerDown=null,this.onPointerUp=null,this.processPointerUp=null,this.onPointerCancel=null,this.processPointerCancel=null,this.onPointerMove=null,this.processPointerMove=null,this.onPointerOut=null,this.processPointerOverOut=null,this.onPointerOver=null,this.search=null},r}(D),ar=function(){function t(t){this.items=[],this._name=t,this._aliasCount=0}return t.prototype.emit=function(t,e,r,i,n,o,a,s){if(arguments.length>8)throw new Error("max arguments reached");var h=this,l=h.name,u=h.items;this._aliasCount++;for(var c=0,p=u.length;c<p;c++)u[c][l](t,e,r,i,n,o,a,s);return u===this.items&&this._aliasCount--,this},t.prototype.ensureNonAliasedItems=function(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))},t.prototype.add=function(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this},t.prototype.remove=function(t){var e=this.items.indexOf(t);return-1!==e&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this},t.prototype.contains=function(t){return-1!==this.items.indexOf(t)},t.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},t.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.items.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),t}();Object.defineProperties(ar.prototype,{dispatch:{value:ar.prototype.emit},run:{value:ar.prototype.emit}}),
/*!
	 * @pixi/core - v5.3.7
	 * Compiled Tue, 29 Dec 2020 19:33:12 UTC
	 *
	 * @pixi/core is licensed under the MIT License.
	 * http://www.opensource.org/licenses/mit-license
	 */
O.PREFER_ENV=R.any?t.ENV.WEBGL:t.ENV.WEBGL2,O.STRICT_TEXTURE_CACHE=!1;var sr=[];function hr(t,e){if(!t)return null;var r="";if("string"==typeof t){var i=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);i&&(r=i[1].toLowerCase())}for(var n=sr.length-1;n>=0;--n){var o=sr[n];if(o.test&&o.test(t,r))return new o(t,e)}throw new Error("Unrecognized source type to auto-detect Resource")}
/*! *****************************************************************************
	Copyright (c) Microsoft Corporation. All rights reserved.
	Licensed under the Apache License, Version 2.0 (the "License"); you may not use
	this file except in compliance with the License. You may obtain a copy of the
	License at http://www.apache.org/licenses/LICENSE-2.0

	THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
	KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
	WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
	MERCHANTABLITY OR NON-INFRINGEMENT.

	See the Apache Version 2.0 License for specific language governing permissions
	and limitations under the License.
	***************************************************************************** */var lr=function(t,e){return(lr=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function ur(t,e){function r(){this.constructor=t}lr(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var cr=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new ar("setRealSize"),this.onUpdate=new ar("update"),this.onError=new ar("onError")}return t.prototype.bind=function(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.emit(this._width,this._height)},t.prototype.unbind=function(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)},t.prototype.resize=function(t,e){t===this._width&&e===this._height||(this._width=t,this._height=e,this.onResize.emit(t,e))},Object.defineProperty(t.prototype,"valid",{get:function(){return!!this._width&&!!this._height},enumerable:!1,configurable:!0}),t.prototype.update=function(){this.destroyed||this.onUpdate.emit()},t.prototype.load=function(){return Promise.resolve(this)},Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!1,configurable:!0}),t.prototype.style=function(t,e,r){return!1},t.prototype.dispose=function(){},t.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},t.test=function(t,e){return!1},t}(),pr=function(e){function r(t,r){var i=this,n=r||{},o=n.width,a=n.height;if(!o||!a)throw new Error("BufferResource width or height invalid");return(i=e.call(this,o,a)||this).data=t,i}return ur(r,e),r.prototype.upload=function(e,r,i){var n=e.gl;return n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===t.ALPHA_MODES.UNPACK),i.width===r.width&&i.height===r.height?n.texSubImage2D(r.target,0,0,0,r.width,r.height,r.format,r.type,this.data):(i.width=r.width,i.height=r.height,n.texImage2D(r.target,0,i.internalFormat,r.width,r.height,0,r.format,i.type,this.data)),!0},r.prototype.dispose=function(){this.data=null},r.test=function(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array},r}(cr),dr={scaleMode:t.SCALE_MODES.NEAREST,format:t.FORMATS.RGBA,alphaMode:t.ALPHA_MODES.NPM},fr=function(e){function r(r,i){void 0===r&&(r=null),void 0===i&&(i=null);var n=e.call(this)||this,o=(i=i||{}).alphaMode,a=i.mipmap,s=i.anisotropicLevel,h=i.scaleMode,l=i.width,u=i.height,c=i.wrapMode,p=i.format,d=i.type,f=i.target,m=i.resolution,v=i.resourceOptions;return!r||r instanceof cr||((r=hr(r,v)).internal=!0),n.width=l||0,n.height=u||0,n.resolution=m||O.RESOLUTION,n.mipmap=void 0!==a?a:O.MIPMAP_TEXTURES,n.anisotropicLevel=void 0!==s?s:O.ANISOTROPIC_LEVEL,n.wrapMode=c||O.WRAP_MODE,n.scaleMode=void 0!==h?h:O.SCALE_MODE,n.format=p||t.FORMATS.RGBA,n.type=d||t.TYPES.UNSIGNED_BYTE,n.target=f||t.TARGETS.TEXTURE_2D,n.alphaMode=void 0!==o?o:t.ALPHA_MODES.UNPACK,void 0!==i.premultiplyAlpha&&(n.premultiplyAlpha=i.premultiplyAlpha),n.uid=oe(),n.touched=0,n.isPowerOfTwo=!1,n._refreshPOT(),n._glTextures={},n.dirtyId=0,n.dirtyStyleId=0,n.cacheId=null,n.valid=l>0&&u>0,n.textureCacheIds=[],n.destroyed=!1,n.resource=null,n._batchEnabled=0,n._batchLocation=0,n.parentTextureArray=null,n.setResource(r),n}return ur(r,e),Object.defineProperty(r.prototype,"realWidth",{get:function(){return Math.ceil(this.width*this.resolution-1e-4)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"realHeight",{get:function(){return Math.ceil(this.height*this.resolution-1e-4)},enumerable:!1,configurable:!0}),r.prototype.setStyle=function(t,e){var r;return void 0!==t&&t!==this.scaleMode&&(this.scaleMode=t,r=!0),void 0!==e&&e!==this.mipmap&&(this.mipmap=e,r=!0),r&&this.dirtyStyleId++,this},r.prototype.setSize=function(t,e,r){return this.resolution=r||this.resolution,this.width=t,this.height=e,this._refreshPOT(),this.update(),this},r.prototype.setRealSize=function(t,e,r){return this.resolution=r||this.resolution,this.width=t/this.resolution,this.height=e/this.resolution,this._refreshPOT(),this.update(),this},r.prototype._refreshPOT=function(){this.isPowerOfTwo=te(this.realWidth)&&te(this.realHeight)},r.prototype.setResolution=function(t){var e=this.resolution;return e===t||(this.resolution=t,this.valid&&(this.width=this.width*e/t,this.height=this.height*e/t,this.emit("update",this)),this._refreshPOT()),this},r.prototype.setResource=function(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this},r.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},r.prototype.onError=function(t){this.emit("error",this,t)},r.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete ue[this.cacheId],delete le[this.cacheId],this.cacheId=null),this.dispose(),r.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},r.prototype.dispose=function(){this.emit("dispose",this)},r.prototype.castToBaseTexture=function(){return this},r.from=function(t,e,i){void 0===i&&(i=O.STRICT_TEXTURE_CACHE);var n="string"==typeof t,o=null;n?o=t:(t._pixiId||(t._pixiId="pixiid_"+oe()),o=t._pixiId);var a=ue[o];if(n&&i&&!a)throw new Error('The cacheId "'+o+'" does not exist in BaseTextureCache.');return a||((a=new r(t,e)).cacheId=o,r.addToCache(a,o)),a},r.fromBuffer=function(e,i,n,o){e=e||new Float32Array(i*n*4);var a=new pr(e,{width:i,height:n}),s=e instanceof Float32Array?t.TYPES.FLOAT:t.TYPES.UNSIGNED_BYTE;return new r(a,Object.assign(dr,o||{width:i,height:n,type:s}))},r.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),ue[e]&&console.warn("BaseTexture added to the cache with an id ["+e+"] that already had an entry"),ue[e]=t)},r.removeFromCache=function(t){if("string"==typeof t){var e=ue[t];if(e){var r=e.textureCacheIds.indexOf(t);return r>-1&&e.textureCacheIds.splice(r,1),delete ue[t],e}}else if(t&&t.textureCacheIds){for(var i=0;i<t.textureCacheIds.length;++i)delete ue[t.textureCacheIds[i]];return t.textureCacheIds.length=0,t}return null},r._globalBatch=0,r}(D),mr=function(t){function e(e,r){var i=this,n=r||{},o=n.width,a=n.height;(i=t.call(this,o,a)||this).items=[],i.itemDirtyIds=[];for(var s=0;s<e;s++){var h=new fr;i.items.push(h),i.itemDirtyIds.push(-2)}return i.length=e,i._load=null,i.baseTexture=null,i}return ur(e,t),e.prototype.initFromArray=function(t,e){for(var r=0;r<this.length;r++)t[r]&&(t[r].castToBaseTexture?this.addBaseTextureAt(t[r].castToBaseTexture(),r):t[r]instanceof cr?this.addResourceAt(t[r],r):this.addResourceAt(hr(t[r],e),r))},e.prototype.dispose=function(){for(var t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},e.prototype.addResourceAt=function(t,e){if(!this.items[e])throw new Error("Index "+e+" is out of bounds");return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this},e.prototype.bind=function(e){if(null!==this.baseTexture)throw new Error("Only one base texture per TextureArray is allowed");t.prototype.bind.call(this,e);for(var r=0;r<this.length;r++)this.items[r].parentTextureArray=e,this.items[r].on("update",e.update,e)},e.prototype.unbind=function(e){t.prototype.unbind.call(this,e);for(var r=0;r<this.length;r++)this.items[r].parentTextureArray=null,this.items[r].off("update",e.update,e)},e.prototype.load=function(){var t=this;if(this._load)return this._load;var e=this.items.map((function(t){return t.resource})).filter((function(t){return t})).map((function(t){return t.load()}));return this._load=Promise.all(e).then((function(){var e=t.items[0],r=e.realWidth,i=e.realHeight;return t.resize(r,i),Promise.resolve(t)})),this._load},e}(cr),vr=function(e){function r(t,r){var i,n,o=this,a=r||{},s=a.width,h=a.height;return Array.isArray(t)?(i=t,n=t.length):n=t,o=e.call(this,n,{width:s,height:h})||this,i&&o.initFromArray(i,r),o}return ur(r,e),r.prototype.addBaseTextureAt=function(t,e){if(!t.resource)throw new Error("ArrayResource does not support RenderTexture");return this.addResourceAt(t.resource,e),this},r.prototype.bind=function(r){e.prototype.bind.call(this,r),r.target=t.TARGETS.TEXTURE_2D_ARRAY},r.prototype.upload=function(t,e,r){var i=this.length,n=this.itemDirtyIds,o=this.items,a=t.gl;r.dirtyId<0&&a.texImage3D(a.TEXTURE_2D_ARRAY,0,e.format,this._width,this._height,i,0,e.format,e.type,null);for(var s=0;s<i;s++){var h=o[s];n[s]<h.dirtyId&&(n[s]=h.dirtyId,h.valid&&a.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,s,h.resource.width,h.resource.height,1,e.format,e.type,h.resource.source))}return!0},r}(mr),yr=function(e){function r(t){var r=this,i=t,n=i.naturalWidth||i.videoWidth||i.width,o=i.naturalHeight||i.videoHeight||i.height;return(r=e.call(this,n,o)||this).source=t,r.noSubImage=!1,r}return ur(r,e),r.crossOrigin=function(t,e,r){void 0===r&&0!==e.indexOf("data:")?t.crossOrigin=me(e):!1!==r&&(t.crossOrigin="string"==typeof r?r:"anonymous")},r.prototype.upload=function(e,r,i,n){var o=e.gl,a=r.realWidth,s=r.realHeight;return n=n||this.source,o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===t.ALPHA_MODES.UNPACK),this.noSubImage||r.target!==o.TEXTURE_2D||i.width!==a||i.height!==s?(i.width=a,i.height=s,o.texImage2D(r.target,0,r.format,r.format,r.type,n)):o.texSubImage2D(o.TEXTURE_2D,0,0,0,r.format,r.type,n),!0},r.prototype.update=function(){if(!this.destroyed){var t=this.source,r=t.naturalWidth||t.videoWidth||t.width,i=t.naturalHeight||t.videoHeight||t.height;this.resize(r,i),e.prototype.update.call(this)}},r.prototype.dispose=function(){this.source=null},r}(cr),gr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ur(e,t),e.test=function(t){var e=window.OffscreenCanvas;return!!(e&&t instanceof e)||t instanceof HTMLCanvasElement},e}(yr),_r=function(e){function r(i,n){var o=this,a=n||{},s=a.width,h=a.height,l=a.autoLoad,u=a.linkBaseTexture;if(i&&i.length!==r.SIDES)throw new Error("Invalid length. Got "+i.length+", expected 6");o=e.call(this,6,{width:s,height:h})||this;for(var c=0;c<r.SIDES;c++)o.items[c].target=t.TARGETS.TEXTURE_CUBE_MAP_POSITIVE_X+c;return o.linkBaseTexture=!1!==u,i&&o.initFromArray(i,n),!1!==l&&o.load(),o}return ur(r,e),r.prototype.bind=function(r){e.prototype.bind.call(this,r),r.target=t.TARGETS.TEXTURE_CUBE_MAP},r.prototype.addBaseTextureAt=function(e,r,i){if(void 0===i&&(i=this.linkBaseTexture),!this.items[r])throw new Error("Index "+r+" is out of bounds");if(!this.linkBaseTexture||e.parentTextureArray||Object.keys(e._glTextures).length>0){if(!e.resource)throw new Error("CubeResource does not support copying of renderTexture.");this.addResourceAt(e.resource,r)}else e.target=t.TARGETS.TEXTURE_CUBE_MAP_POSITIVE_X+r,e.parentTextureArray=this.baseTexture,this.items[r]=e;return e.valid&&!this.valid&&this.resize(e.realWidth,e.realHeight),this.items[r]=e,this},r.prototype.upload=function(t,e,i){for(var n=this.itemDirtyIds,o=0;o<r.SIDES;o++){var a=this.items[o];n[o]<a.dirtyId&&(a.valid&&a.resource?(a.resource.upload(t,a,i),n[o]=a.dirtyId):n[o]<-1&&(t.gl.texImage2D(a.target,0,i.internalFormat,e.realWidth,e.realHeight,0,e.format,i.type,null),n[o]=-1))}return!0},r.test=function(t){return Array.isArray(t)&&t.length===r.SIDES},r.SIDES=6,r}(mr),xr=function(e){function r(t,r){var i=this;if(r=r||{},!(t instanceof HTMLImageElement)){var n=new Image;yr.crossOrigin(n,t,r.crossorigin),n.src=t,t=n}return i=e.call(this,t)||this,!t.complete&&i._width&&i._height&&(i._width=0,i._height=0),i.url=t.src,i._process=null,i.preserveBitmap=!1,i.createBitmap=(void 0!==r.createBitmap?r.createBitmap:O.CREATE_IMAGE_BITMAP)&&!!window.createImageBitmap,i.alphaMode="number"==typeof r.alphaMode?r.alphaMode:null,void 0!==r.premultiplyAlpha&&(i.premultiplyAlpha=r.premultiplyAlpha),i.bitmap=null,i._load=null,!1!==r.autoLoad&&i.load(),i}return ur(r,e),r.prototype.load=function(t){var e=this;return this._load||(void 0!==t&&(this.createBitmap=t),this._load=new Promise((function(t,r){var i=e.source;e.url=i.src;var n=function(){e.destroyed||(i.onload=null,i.onerror=null,e.resize(i.width,i.height),e._load=null,e.createBitmap?t(e.process()):t(e))};i.complete&&i.src?n():(i.onload=n,i.onerror=function(t){r(t),e.onError.emit(t)})}))),this._load},r.prototype.process=function(){var e=this,r=this.source;return null!==this._process?this._process:null===this.bitmap&&window.createImageBitmap?(this._process=window.createImageBitmap(r,0,0,r.width,r.height,{premultiplyAlpha:this.alphaMode===t.ALPHA_MODES.UNPACK?"premultiply":"none"}).then((function(t){return e.destroyed?Promise.reject():(e.bitmap=t,e.update(),e._process=null,Promise.resolve(e))})),this._process):Promise.resolve(this)},r.prototype.upload=function(t,r,i){if("number"==typeof this.alphaMode&&(r.alphaMode=this.alphaMode),!this.createBitmap)return e.prototype.upload.call(this,t,r,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(e.prototype.upload.call(this,t,r,i,this.bitmap),!this.preserveBitmap){var n=!0,o=r._glTextures;for(var a in o){var s=o[a];if(s!==i&&s.dirtyId!==r.dirtyId){n=!1;break}}n&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},r.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,e.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},r.test=function(t){return"string"==typeof t||t instanceof HTMLImageElement},r}(yr),br=function(t){function e(e,r){var i=this;return r=r||{},(i=t.call(this,document.createElement("canvas"))||this)._width=0,i._height=0,i.svg=e,i.scale=r.scale||1,i._overrideWidth=r.width,i._overrideHeight=r.height,i._resolve=null,i._crossorigin=r.crossorigin,i._load=null,!1!==r.autoLoad&&i.load(),i}return ur(e,t),e.prototype.load=function(){var t=this;return this._load||(this._load=new Promise((function(e){if(t._resolve=function(){t.resize(t.source.width,t.source.height),e(t)},/^\<svg/.test(t.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");t.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(t.svg)))}t._loadSvg()}))),this._load},e.prototype._loadSvg=function(){var t=this,e=new Image;yr.crossOrigin(e,this.svg,this._crossorigin),e.src=this.svg,e.onerror=function(r){t._resolve&&(e.onerror=null,t.onError.emit(r))},e.onload=function(){if(t._resolve){var r=e.width,i=e.height;if(!r||!i)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var n=r*t.scale,o=i*t.scale;(t._overrideWidth||t._overrideHeight)&&(n=t._overrideWidth||t._overrideHeight/i*r,o=t._overrideHeight||t._overrideWidth/r*i),n=Math.round(n),o=Math.round(o);var a=t.source;a.width=n,a.height=o,a._pixiId="canvas_"+oe(),a.getContext("2d").drawImage(e,0,0,r,i,0,0,n,o),t._resolve(),t._resolve=null}}},e.getSize=function(t){var r=e.SVG_SIZE.exec(t),i={};return r&&(i[r[1]]=Math.round(parseFloat(r[3])),i[r[5]]=Math.round(parseFloat(r[7]))),i},e.prototype.dispose=function(){t.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},e.test=function(t,e){return"svg"===e||"string"==typeof t&&/^data:image\/svg\+xml(;(charset=utf8|utf8))?;base64/.test(t)||"string"==typeof t&&0===t.indexOf("<svg")},e.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i,e}(yr),wr=function(t){function e(r,i){var n=this;if(i=i||{},!(r instanceof HTMLVideoElement)){var o=document.createElement("video");o.setAttribute("preload","auto"),o.setAttribute("webkit-playsinline",""),o.setAttribute("playsinline",""),"string"==typeof r&&(r=[r]);var a=r[0].src||r[0];yr.crossOrigin(o,a,i.crossorigin);for(var s=0;s<r.length;++s){var h=document.createElement("source"),l=r[s],u=l.src,c=l.mime,p=(u=u||r[s]).split("?").shift().toLowerCase(),d=p.substr(p.lastIndexOf(".")+1);c=c||e.MIME_TYPES[d]||"video/"+d,h.src=u,h.type=c,o.appendChild(h)}r=o}return(n=t.call(this,r)||this).noSubImage=!0,n._autoUpdate=!0,n._isConnectedToTicker=!1,n._updateFPS=i.updateFPS||0,n._msToNextUpdate=0,n.autoPlay=!1!==i.autoPlay,n._load=null,n._resolve=null,n._onCanPlay=n._onCanPlay.bind(n),n._onError=n._onError.bind(n),!1!==i.autoLoad&&n.load(),n}return ur(e,t),e.prototype.update=function(e){if(void 0===e&&(e=0),!this.destroyed){var r=Je.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-r),(!this._updateFPS||this._msToNextUpdate<=0)&&(t.prototype.update.call(this),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},e.prototype.load=function(){var t=this;if(this._load)return this._load;var e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart.bind(this)),e.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay),e.addEventListener("error",this._onError,!0)),this._load=new Promise((function(r){t.valid?r(t):(t._resolve=r,e.load())})),this._load},e.prototype._onError=function(t){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(t)},e.prototype._isSourcePlaying=function(){var t=this.source;return t.currentTime>0&&!1===t.paused&&!1===t.ended&&t.readyState>2},e.prototype._isSourceReady=function(){var t=this.source;return 3===t.readyState||4===t.readyState},e.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(Je.shared.add(this.update,this),this._isConnectedToTicker=!0)},e.prototype._onPlayStop=function(){this._isConnectedToTicker&&(Je.shared.remove(this.update,this),this._isConnectedToTicker=!1)},e.prototype._onCanPlay=function(){var t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);var e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()},e.prototype.dispose=function(){this._isConnectedToTicker&&Je.shared.remove(this.update,this);var e=this.source;e&&(e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),t.prototype.dispose.call(this)},Object.defineProperty(e.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(Je.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(Je.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"updateFPS",{get:function(){return this._updateFPS},set:function(t){t!==this._updateFPS&&(this._updateFPS=t)},enumerable:!1,configurable:!0}),e.test=function(t,r){return t instanceof HTMLVideoElement||e.TYPES.indexOf(r)>-1},e.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],e.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"},e}(yr),Tr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ur(e,t),e.test=function(t){return!!window.createImageBitmap&&t instanceof ImageBitmap},e}(yr);sr.push(xr,Tr,gr,wr,br,pr,_r,vr);var Er={Resource:cr,BaseImageResource:yr,INSTALLED:sr,autoDetectResource:hr,AbstractMultiResource:mr,ArrayResource:vr,BufferResource:pr,CanvasResource:gr,CubeResource:_r,ImageResource:xr,SVGResource:br,VideoResource:wr,ImageBitmapResource:Tr},Sr=function(){function t(t){this.renderer=t}return t.prototype.destroy=function(){this.renderer=null},t}(),Ar=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return ur(r,e),r.prototype.upload=function(e,r,i){var n=e.gl;return n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===t.ALPHA_MODES.UNPACK),i.width===r.width&&i.height===r.height?n.texSubImage2D(r.target,0,0,0,r.width,r.height,r.format,r.type,this.data):(i.width=r.width,i.height=r.height,n.texImage2D(r.target,0,1===e.context.webGLVersion?n.DEPTH_COMPONENT:n.DEPTH_COMPONENT16,r.width,r.height,0,r.format,r.type,this.data)),!0},r}(pr),Ir=function(){function e(e,r){this.width=Math.ceil(e||100),this.height=Math.ceil(r||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new ar("disposeFramebuffer"),this.multisample=t.MSAA_QUALITY.NONE}return Object.defineProperty(e.prototype,"colorTexture",{get:function(){return this.colorTextures[0]},enumerable:!1,configurable:!0}),e.prototype.addColorTexture=function(e,r){return void 0===e&&(e=0),this.colorTextures[e]=r||new fr(null,{scaleMode:t.SCALE_MODES.NEAREST,resolution:1,mipmap:t.MIPMAP_MODES.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},e.prototype.addDepthTexture=function(e){return this.depthTexture=e||new fr(new Ar(null,{width:this.width,height:this.height}),{scaleMode:t.SCALE_MODES.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:t.MIPMAP_MODES.OFF,format:t.FORMATS.DEPTH_COMPONENT,type:t.TYPES.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},e.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},e.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},e.prototype.resize=function(t,e){if(t=Math.ceil(t),e=Math.ceil(e),t!==this.width||e!==this.height){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(var r=0;r<this.colorTextures.length;r++){var i=this.colorTextures[r],n=i.resolution;i.setSize(t/n,e/n)}if(this.depthTexture){n=this.depthTexture.resolution;this.depthTexture.setSize(t/n,e/n)}}},e.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},e.prototype.destroyDepthTexture=function(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)},e}(),Pr=function(t){function e(e){var r=this;if("number"==typeof e){var i=arguments[0],n=arguments[1],o=arguments[2],a=arguments[3];e={width:i,height:n,scaleMode:o,resolution:a}}r=t.call(this,null,e)||this;var s=e||{},h=s.width,l=s.height;return r.mipmap=0,r.width=Math.ceil(h)||100,r.height=Math.ceil(l)||100,r.valid=!0,r.clearColor=[0,0,0,0],r.framebuffer=new Ir(r.width*r.resolution,r.height*r.resolution).addColorTexture(0,r),r.maskStack=[],r.filterStack=[{}],r}return ur(e,t),e.prototype.resize=function(t,e){t=Math.ceil(t),e=Math.ceil(e),this.framebuffer.resize(t*this.resolution,e*this.resolution)},e.prototype.dispose=function(){this.framebuffer.dispose(),t.prototype.dispose.call(this)},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.framebuffer.destroyDepthTexture(),this.framebuffer=null},e}(fr),Mr=function(){function t(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}return t.prototype.set=function(t,e,r){var i=e.width,n=e.height;if(r){var o=t.width/2/i,a=t.height/2/n,s=t.x/i+o,h=t.y/n+a;r=Fe.add(r,Fe.NW),this.x0=s+o*Fe.uX(r),this.y0=h+a*Fe.uY(r),r=Fe.add(r,2),this.x1=s+o*Fe.uX(r),this.y1=h+a*Fe.uY(r),r=Fe.add(r,2),this.x2=s+o*Fe.uX(r),this.y2=h+a*Fe.uY(r),r=Fe.add(r,2),this.x3=s+o*Fe.uX(r),this.y3=h+a*Fe.uY(r)}else this.x0=t.x/i,this.y0=t.y/n,this.x1=(t.x+t.width)/i,this.y1=t.y/n,this.x2=(t.x+t.width)/i,this.y2=(t.y+t.height)/n,this.x3=t.x/i,this.y3=(t.y+t.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3},t}(),Cr=new Mr,Rr=function(t){function e(r,i,n,o,a,s){var h=t.call(this)||this;if(h.noFrame=!1,i||(h.noFrame=!0,i=new we(0,0,1,1)),r instanceof e&&(r=r.baseTexture),h.baseTexture=r,h._frame=i,h.trim=o,h.valid=!1,h._uvs=Cr,h.uvMatrix=null,h.orig=n||i,h._rotate=Number(a||0),!0===a)h._rotate=2;else if(h._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");return h.defaultAnchor=s?new Ie(s.x,s.y):new Ie(0,0),h._updateID=0,h.textureCacheIds=[],r.valid?h.noFrame?r.valid&&h.onBaseTextureUpdated(r):h.frame=i:r.once("loaded",h.onBaseTextureUpdated,h),h.noFrame&&r.on("update",h.onBaseTextureUpdated,h),h}return ur(e,t),e.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},e.prototype.onBaseTextureUpdated=function(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},e.prototype.destroy=function(t){if(this.baseTexture){if(t){var r=this.baseTexture;r&&r.url&&le[r.url]&&e.removeFromCache(r.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,e.removeFromCache(this),this.textureCacheIds=null},e.prototype.clone=function(){return new e(this.baseTexture,this.frame.clone(),this.orig.clone(),this.trim&&this.trim.clone(),this.rotate,this.defaultAnchor)},e.prototype.updateUvs=function(){this._uvs===Cr&&(this._uvs=new Mr),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},e.from=function(t,r,i){void 0===r&&(r={}),void 0===i&&(i=O.STRICT_TEXTURE_CACHE);var n="string"==typeof t,o=null;n?o=t:(t._pixiId||(t._pixiId="pixiid_"+oe()),o=t._pixiId);var a=le[o];if(n&&i&&!a)throw new Error('The cacheId "'+o+'" does not exist in TextureCache.');return a||(r.resolution||(r.resolution=ve(t)),(a=new e(new fr(t,r))).baseTexture.cacheId=o,fr.addToCache(a.baseTexture,o),e.addToCache(a,o)),a},e.fromURL=function(t,r){var i=Object.assign({autoLoad:!1},null==r?void 0:r.resourceOptions),n=e.from(t,Object.assign({resourceOptions:i},r),!1),o=n.baseTexture.resource;return n.baseTexture.valid?Promise.resolve(n):o.load().then((function(){return Promise.resolve(n)}))},e.fromBuffer=function(t,r,i,n){return new e(fr.fromBuffer(t,r,i,n))},e.fromLoader=function(t,r,i){var n=new xr(t);n.url=r;var o=new e(new fr(n,{scaleMode:O.SCALE_MODE,resolution:ve(r)}));return i||(i=r),fr.addToCache(o.baseTexture,i),e.addToCache(o,i),i!==r&&(fr.addToCache(o.baseTexture,r),e.addToCache(o,r)),o},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),le[e]&&console.warn("Texture added to the cache with an id ["+e+"] that already had an entry"),le[e]=t)},e.removeFromCache=function(t){if("string"==typeof t){var e=le[t];if(e){var r=e.textureCacheIds.indexOf(t);return r>-1&&e.textureCacheIds.splice(r,1),delete le[t],e}}else if(t&&t.textureCacheIds){for(var i=0;i<t.textureCacheIds.length;++i)le[t.textureCacheIds[i]]===t&&delete le[t.textureCacheIds[i]];return t.textureCacheIds.length=0,t}return null},Object.defineProperty(e.prototype,"resolution",{get:function(){return this.baseTexture.resolution},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"frame",{get:function(){return this._frame},set:function(t){this._frame=t,this.noFrame=!1;var e=t.x,r=t.y,i=t.width,n=t.height,o=e+i>this.baseTexture.width,a=r+n>this.baseTexture.height;if(o||a){var s=o&&a?"and":"or",h="X: "+e+" + "+i+" = "+(e+i)+" > "+this.baseTexture.width,l="Y: "+r+" + "+n+" = "+(r+n)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+h+" "+s+" "+l)}this.valid=i&&n&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=t),this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotate",{get:function(){return this._rotate},set:function(t){this._rotate=t,this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.orig.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.orig.height},enumerable:!1,configurable:!0}),e.prototype.castToBaseTexture=function(){return this.baseTexture},e}(D);function Or(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}Rr.EMPTY=new Rr(new fr),Or(Rr.EMPTY),Or(Rr.EMPTY.baseTexture),Rr.WHITE=function(){var t=document.createElement("canvas");t.width=16,t.height=16;var e=t.getContext("2d");return e.fillStyle="white",e.fillRect(0,0,16,16),new Rr(new fr(new gr(t)))}(),Or(Rr.WHITE),Or(Rr.WHITE.baseTexture);var Dr=function(t){function e(e,r){var i=this,n=null;if(!(e instanceof Pr)){var o=arguments[1],a=arguments[2],s=arguments[3],h=arguments[4];console.warn("Please use RenderTexture.create("+o+", "+a+") instead of the ctor directly."),n=arguments[0],r=null,e=new Pr({width:o,height:a,scaleMode:s,resolution:h})}return(i=t.call(this,e,r)||this).legacyRenderer=n,i.valid=!0,i.filterFrame=null,i.filterPoolKey=null,i.updateUvs(),i}return ur(e,t),Object.defineProperty(e.prototype,"framebuffer",{get:function(){return this.baseTexture.framebuffer},enumerable:!1,configurable:!0}),e.prototype.resize=function(t,e,r){void 0===r&&(r=!0),t=Math.ceil(t),e=Math.ceil(e),this.valid=t>0&&e>0,this._frame.width=this.orig.width=t,this._frame.height=this.orig.height=e,r&&this.baseTexture.resize(t,e),this.updateUvs()},e.prototype.setResolution=function(t){var e=this.baseTexture;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))},e.create=function(t){return"number"==typeof t&&(t={width:t,height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]}),new e(new Pr(t))},e}(Rr),Br=function(){function t(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}return t.prototype.createTexture=function(t,e){var r=new Pr(Object.assign({width:t,height:e,resolution:1},this.textureOptions));return new Dr(r)},t.prototype.getOptimalTexture=function(e,r,i){void 0===i&&(i=1);var n=t.SCREEN_KEY;e*=i,r*=i,this.enableFullScreen&&e===this._pixelsWidth&&r===this._pixelsHeight||(n=(65535&(e=Kt(e)))<<16|65535&(r=Kt(r))),this.texturePool[n]||(this.texturePool[n]=[]);var o=this.texturePool[n].pop();return o||(o=this.createTexture(e,r)),o.filterPoolKey=n,o.setResolution(i),o},t.prototype.getFilterTexture=function(t,e){var r=this.getOptimalTexture(t.width,t.height,e||t.resolution);return r.filterFrame=t.filterFrame,r},t.prototype.returnTexture=function(t){var e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)},t.prototype.returnFilterTexture=function(t){this.returnTexture(t)},t.prototype.clear=function(t){if(t=!1!==t)for(var e in this.texturePool){var r=this.texturePool[e];if(r)for(var i=0;i<r.length;i++)r[i].destroy(!0)}this.texturePool={}},t.prototype.setScreenSize=function(e){if(e.width!==this._pixelsWidth||e.height!==this._pixelsHeight){var r=t.SCREEN_KEY,i=this.texturePool[r];if(this.enableFullScreen=e.width>0&&e.height>0,i)for(var n=0;n<i.length;n++)i[n].destroy(!0);this.texturePool[r]=[],this._pixelsWidth=e.width,this._pixelsHeight=e.height}},t.SCREEN_KEY="screen",t}(),Nr=function(){function t(t,e,r,i,n,o,a){void 0===e&&(e=0),void 0===r&&(r=!1),void 0===i&&(i=5126),this.buffer=t,this.size=e,this.normalized=r,this.type=i,this.stride=n,this.start=o,this.instance=a}return t.prototype.destroy=function(){this.buffer=null},t.from=function(e,r,i,n,o){return new t(e,r,i,n,o)},t}(),kr=0,Fr=function(){function t(t,e,r){void 0===e&&(e=!0),void 0===r&&(r=!1),this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=r,this.static=e,this.id=kr++,this.disposeRunner=new ar("disposeBuffer")}return t.prototype.update=function(t){this.data=t||this.data,this._updateID++},t.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},t.prototype.destroy=function(){this.dispose(),this.data=null},t.from=function(e){return e instanceof Array&&(e=new Float32Array(e)),new t(e)},t}();function Lr(t){if(4===t.BYTES_PER_ELEMENT)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array";return null}var Vr={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};var Xr={5126:4,5123:2,5121:1},jr=0,Ur={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array},Yr=function(){function t(t,e){void 0===t&&(t=[]),void 0===e&&(e={}),this.buffers=t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=jr++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new ar("disposeGeometry"),this.refCount=0}return t.prototype.addAttribute=function(t,e,r,i,n,o,a,s){if(void 0===r&&(r=0),void 0===i&&(i=!1),void 0===s&&(s=!1),!e)throw new Error("You must pass a buffer when creating an attribute");e instanceof Fr||(e instanceof Array&&(e=new Float32Array(e)),e=new Fr(e));var h=t.split("|");if(h.length>1){for(var l=0;l<h.length;l++)this.addAttribute(h[l],e,r,i,n);return this}var u=this.buffers.indexOf(e);return-1===u&&(this.buffers.push(e),u=this.buffers.length-1),this.attributes[t]=new Nr(u,r,i,n,o,a,s),this.instanced=this.instanced||s,this},t.prototype.getAttribute=function(t){return this.attributes[t]},t.prototype.getBuffer=function(t){return this.buffers[this.getAttribute(t).buffer]},t.prototype.addIndex=function(t){return t instanceof Fr||(t instanceof Array&&(t=new Uint16Array(t)),t=new Fr(t)),t.index=!0,this.indexBuffer=t,-1===this.buffers.indexOf(t)&&this.buffers.push(t),this},t.prototype.getIndex=function(){return this.indexBuffer},t.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var t,e=[],r=[],i=new Fr;for(t in this.attributes){var n=this.attributes[t],o=this.buffers[n.buffer];e.push(o.data),r.push(n.size*Xr[n.type]/4),n.buffer=0}for(i.data=function(t,e){for(var r=0,i=0,n={},o=0;o<t.length;o++)i+=e[o],r+=t[o].length;var a=new ArrayBuffer(4*r),s=null,h=0;for(o=0;o<t.length;o++){var l=e[o],u=t[o],c=Lr(u);n[c]||(n[c]=new Vr[c](a)),s=n[c];for(var p=0;p<u.length;p++){s[(p/l|0)*i+h+p%l]=u[p]}h+=l}return new Float32Array(a)}(e,r),t=0;t<this.buffers.length;t++)this.buffers[t]!==this.indexBuffer&&this.buffers[t].destroy();return this.buffers=[i],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},t.prototype.getSize=function(){for(var t in this.attributes){var e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0},t.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},t.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},t.prototype.clone=function(){for(var e=new t,r=0;r<this.buffers.length;r++)e.buffers[r]=new Fr(this.buffers[r].data.slice(0));for(var r in this.attributes){var i=this.attributes[r];e.attributes[r]=new Nr(i.buffer,i.size,i.normalized,i.type,i.stride,i.start,i.instance)}return this.indexBuffer&&(e.indexBuffer=e.buffers[this.buffers.indexOf(this.indexBuffer)],e.indexBuffer.index=!0),e},t.merge=function(e){for(var r,i=new t,n=[],o=[],a=[],s=0;s<e.length;s++){r=e[s];for(var h=0;h<r.buffers.length;h++)o[h]=o[h]||0,o[h]+=r.buffers[h].data.length,a[h]=0}for(s=0;s<r.buffers.length;s++)n[s]=new(Ur[Lr(r.buffers[s].data)])(o[s]),i.buffers[s]=new Fr(n[s]);for(s=0;s<e.length;s++){r=e[s];for(h=0;h<r.buffers.length;h++)n[h].set(r.buffers[h].data,a[h]),a[h]+=r.buffers[h].data.length}if(i.attributes=r.attributes,r.indexBuffer){i.indexBuffer=i.buffers[r.buffers.indexOf(r.indexBuffer)],i.indexBuffer.index=!0;var l=0,u=0,c=0,p=0;for(s=0;s<r.buffers.length;s++)if(r.buffers[s]!==r.indexBuffer){p=s;break}for(var s in r.attributes){var d=r.attributes[s];(0|d.buffer)===p&&(u+=d.size*Xr[d.type]/4)}for(s=0;s<e.length;s++){var f=e[s].indexBuffer.data;for(h=0;h<f.length;h++)i.indexBuffer.data[h+c]+=l;l+=r.buffers[p].data.length/u,c+=f.length}}return i},t}(),zr=function(t){function e(){var e=t.call(this)||this;return e.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2]),e}return ur(e,t),e}(Yr),Wr=function(t){function e(){var e=t.call(this)||this;return e.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),e.uvs=new Float32Array([0,0,1,0,1,1,0,1]),e.vertexBuffer=new Fr(e.vertices),e.uvBuffer=new Fr(e.uvs),e.addAttribute("aVertexPosition",e.vertexBuffer).addAttribute("aTextureCoord",e.uvBuffer).addIndex([0,1,2,0,2,3]),e}return ur(e,t),e.prototype.map=function(t,e){var r=0,i=0;return this.uvs[0]=r,this.uvs[1]=i,this.uvs[2]=r+e.width/t.width,this.uvs[3]=i,this.uvs[4]=r+e.width/t.width,this.uvs[5]=i+e.height/t.height,this.uvs[6]=r,this.uvs[7]=i+e.height/t.height,r=e.x,i=e.y,this.vertices[0]=r,this.vertices[1]=i,this.vertices[2]=r+e.width,this.vertices[3]=i,this.vertices[4]=r+e.width,this.vertices[5]=i+e.height,this.vertices[6]=r,this.vertices[7]=i+e.height,this.invalidate(),this},e.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},e}(Yr),qr=0,Gr=function(){function t(t,e){this.uniforms=t,this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=qr++,this.static=!!e}return t.prototype.update=function(){this.dirtyId++},t.prototype.add=function(e,r,i){this.uniforms[e]=new t(r,i)},t.from=function(e,r){return new t(e,r)},t}(),Hr=function(){function t(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.sourceFrame=new we,this.destinationFrame=new we,this.filters=[]}return t.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null},t}(),$r=function(e){function r(t){var r=e.call(this,t)||this;return r.defaultFilterStack=[{}],r.texturePool=new Br,r.texturePool.setScreenSize(t.view),r.statePool=[],r.quad=new zr,r.quadUv=new Wr,r.tempRect=new we,r.activeState={},r.globalUniforms=new Gr({outputFrame:r.tempRect,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),r.forceClear=!1,r.useMaxPadding=!1,r}return ur(r,e),r.prototype.push=function(t,e){for(var r=this.renderer,i=this.defaultFilterStack,n=this.statePool.pop()||new Hr,o=e[0].resolution,a=e[0].padding,s=e[0].autoFit,h=e[0].legacy,l=1;l<e.length;l++){var u=e[l];o=Math.min(o,u.resolution),a=this.useMaxPadding?Math.max(a,u.padding):a+u.padding,s=s&&u.autoFit,h=h||u.legacy}1===i.length&&(this.defaultFilterStack[0].renderTexture=r.renderTexture.current),i.push(n),n.resolution=o,n.legacy=h,n.target=t,n.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),n.sourceFrame.pad(a),s&&n.sourceFrame.fit(this.renderer.renderTexture.sourceFrame),n.sourceFrame.ceil(o),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,o),n.filters=e,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height;var c=this.tempRect;c.width=n.sourceFrame.width,c.height=n.sourceFrame.height,n.renderTexture.filterFrame=n.sourceFrame,r.renderTexture.bind(n.renderTexture,n.sourceFrame,c),r.renderTexture.clear()},r.prototype.pop=function(){var e=this.defaultFilterStack,r=e.pop(),i=r.filters;this.activeState=r;var n=this.globalUniforms.uniforms;n.outputFrame=r.sourceFrame,n.resolution=r.resolution;var o=n.inputSize,a=n.inputPixel,s=n.inputClamp;if(o[0]=r.destinationFrame.width,o[1]=r.destinationFrame.height,o[2]=1/o[0],o[3]=1/o[1],a[0]=o[0]*r.resolution,a[1]=o[1]*r.resolution,a[2]=1/a[0],a[3]=1/a[1],s[0]=.5*a[2],s[1]=.5*a[3],s[2]=r.sourceFrame.width*o[2]-.5*a[2],s[3]=r.sourceFrame.height*o[3]-.5*a[3],r.legacy){var h=n.filterArea;h[0]=r.destinationFrame.width,h[1]=r.destinationFrame.height,h[2]=r.sourceFrame.x,h[3]=r.sourceFrame.y,n.filterClamp=n.inputClamp}this.globalUniforms.update();var l=e[e.length-1];if(r.renderTexture.framebuffer.multisample>1&&this.renderer.framebuffer.blit(),1===i.length)i[0].apply(this,r.renderTexture,l.renderTexture,t.CLEAR_MODES.BLEND,r),this.returnFilterTexture(r.renderTexture);else{var u=r.renderTexture,c=this.getOptimalFilterTexture(u.width,u.height,r.resolution);c.filterFrame=u.filterFrame;var p=0;for(p=0;p<i.length-1;++p){i[p].apply(this,u,c,t.CLEAR_MODES.CLEAR,r);var d=u;u=c,c=d}i[p].apply(this,u,l.renderTexture,t.CLEAR_MODES.BLEND,r),this.returnFilterTexture(u),this.returnFilterTexture(c)}r.clear(),this.statePool.push(r)},r.prototype.bindAndClear=function(e,r){if(void 0===r&&(r=t.CLEAR_MODES.CLEAR),e&&e.filterFrame){var i=this.tempRect;i.width=e.filterFrame.width,i.height=e.filterFrame.height,this.renderer.renderTexture.bind(e,e.filterFrame,i)}else this.renderer.renderTexture.bind(e);"boolean"==typeof r&&(r=r?t.CLEAR_MODES.CLEAR:t.CLEAR_MODES.BLEND,se("5.2.1","Use CLEAR_MODES when using clear applyFilter option")),(r===t.CLEAR_MODES.CLEAR||r===t.CLEAR_MODES.BLIT&&this.forceClear)&&this.renderer.renderTexture.clear()},r.prototype.applyFilter=function(e,r,i,n){var o=this.renderer;this.bindAndClear(i,n),e.uniforms.uSampler=r,e.uniforms.filterGlobals=this.globalUniforms,o.state.set(e.state),o.shader.bind(e),e.legacy?(this.quadUv.map(r._frame,r.filterFrame),o.geometry.bind(this.quadUv),o.geometry.draw(t.DRAW_MODES.TRIANGLES)):(o.geometry.bind(this.quad),o.geometry.draw(t.DRAW_MODES.TRIANGLE_STRIP))},r.prototype.calculateSpriteMatrix=function(t,e){var r=this.activeState,i=r.sourceFrame,n=r.destinationFrame,o=e._texture.orig,a=t.set(n.width,0,0,n.height,i.x,i.y),s=e.worldTransform.copyTo(Me.TEMP_MATRIX);return s.invert(),a.prepend(s),a.scale(1/o.width,1/o.height),a.translate(e.anchor.x,e.anchor.y),a},r.prototype.destroy=function(){this.texturePool.clear(!1)},r.prototype.getOptimalFilterTexture=function(t,e,r){return void 0===r&&(r=1),this.texturePool.getOptimalTexture(t,e,r)},r.prototype.getFilterTexture=function(t,e){if("number"==typeof t){var r=t;t=e,e=r}t=t||this.activeState.renderTexture;var i=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution);return i.filterFrame=t.filterFrame,i},r.prototype.returnFilterTexture=function(t){this.texturePool.returnTexture(t)},r.prototype.emptyPool=function(){this.texturePool.clear(!0)},r.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view)},r}(Sr),Jr=function(){function t(t){this.renderer=t}return t.prototype.flush=function(){},t.prototype.destroy=function(){this.renderer=null},t.prototype.start=function(){},t.prototype.stop=function(){this.flush()},t.prototype.render=function(t){},t}(),Zr=function(t){function e(e){var r=t.call(this,e)||this;return r.emptyRenderer=new Jr(e),r.currentRenderer=r.emptyRenderer,r}return ur(e,t),e.prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},e.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},e.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},e.prototype.copyBoundTextures=function(t,e){for(var r=this.renderer.texture.boundTextures,i=e-1;i>=0;--i)t[i]=r[i]||null,t[i]&&(t[i]._batchLocation=i)},e.prototype.boundArray=function(t,e,r,i){for(var n=t.elements,o=t.ids,a=t.count,s=0,h=0;h<a;h++){var l=n[h],u=l._batchLocation;if(u>=0&&u<i&&e[u]===l)o[h]=u;else for(;s<i;){var c=e[s];if(!c||c._batchEnabled!==r||c._batchLocation!==s){o[h]=s,l._batchLocation=s,e[s]=l;break}s++}}},e}(Sr),Qr=0,Kr=function(e){function r(t){var r=e.call(this,t)||this;return r.webGLVersion=1,r.extensions={},r.supports={uint32Indices:!1},r.handleContextLost=r.handleContextLost.bind(r),r.handleContextRestored=r.handleContextRestored.bind(r),t.view.addEventListener("webglcontextlost",r.handleContextLost,!1),t.view.addEventListener("webglcontextrestored",r.handleContextRestored,!1),r}return ur(r,e),Object.defineProperty(r.prototype,"isLost",{get:function(){return!this.gl||this.gl.isContextLost()},enumerable:!1,configurable:!0}),r.prototype.contextChange=function(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=Qr++,t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension("WEBGL_lose_context").restoreContext()},r.prototype.initFromContext=function(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=Qr++,this.renderer.runners.contextChange.emit(t)},r.prototype.initFromOptions=function(t){var e=this.createContext(this.renderer.view,t);this.initFromContext(e)},r.prototype.createContext=function(e,r){var i;if(O.PREFER_ENV>=t.ENV.WEBGL2&&(i=e.getContext("webgl2",r)),i)this.webGLVersion=2;else if(this.webGLVersion=1,!(i=e.getContext("webgl",r)||e.getContext("experimental-webgl",r)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=i,this.getExtensions(),this.gl},r.prototype.getExtensions=function(){var t=this.gl;1===this.webGLVersion?Object.assign(this.extensions,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),loseContext:t.getExtension("WEBGL_lose_context"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,{anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),colorBufferFloat:t.getExtension("EXT_color_buffer_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear")})},r.prototype.handleContextLost=function(t){t.preventDefault()},r.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.emit(this.gl)},r.prototype.destroy=function(){var t=this.renderer.view;t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},r.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},r.prototype.validateContext=function(t){var e=t.getContextAttributes(),r="WebGL2RenderingContext"in window&&t instanceof window.WebGL2RenderingContext;r&&(this.webGLVersion=2),e.stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");var i=r||!!t.getExtension("OES_element_index_uint");this.supports.uint32Indices=i,i||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")},r}(Sr),ti=function(e){this.framebuffer=e,this.stencil=null,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.multisample=t.MSAA_QUALITY.NONE,this.msaaBuffer=null,this.blitFramebuffer=null},ei=new we,ri=function(e){function r(t){var r=e.call(this,t)||this;return r.managedFramebuffers=[],r.unknownFramebuffer=new Ir(10,10),r.msaaSamples=null,r}return ur(r,e),r.prototype.contextChange=function(){var e=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new we,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){var r=this.renderer.context.extensions.drawBuffers,i=this.renderer.context.extensions.depthTexture;O.PREFER_ENV===t.ENV.WEBGL_LEGACY&&(r=null,i=null),r?e.drawBuffers=function(t){return r.drawBuffersWEBGL(t)}:(this.hasMRT=!1,e.drawBuffers=function(){}),i||(this.writeDepthTexture=!1)}else this.msaaSamples=e.getInternalformatParameter(e.RENDERBUFFER,e.RGBA8,e.SAMPLES)},r.prototype.bind=function(t,e){var r=this.gl;if(t){var i=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,r.bindFramebuffer(r.FRAMEBUFFER,i.framebuffer)),i.dirtyId!==t.dirtyId&&(i.dirtyId=t.dirtyId,i.dirtyFormat!==t.dirtyFormat?(i.dirtyFormat=t.dirtyFormat,this.updateFramebuffer(t)):i.dirtySize!==t.dirtySize&&(i.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(var n=0;n<t.colorTextures.length;n++){var o=t.colorTextures[n];this.renderer.texture.unbind(o.parentTextureArray||o)}t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,t.width,t.height)}else this.current&&(this.current=null,r.bindFramebuffer(r.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},r.prototype.setViewport=function(t,e,r,i){var n=this.viewport;n.width===r&&n.height===i&&n.x===t&&n.y===e||(n.x=t,n.y=e,n.width=r,n.height=i,this.gl.viewport(t,e,r,i))},Object.defineProperty(r.prototype,"size",{get:function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},enumerable:!1,configurable:!0}),r.prototype.clear=function(e,r,i,n,o){void 0===o&&(o=t.BUFFER_BITS.COLOR|t.BUFFER_BITS.DEPTH);var a=this.gl;a.clearColor(e,r,i,n),a.clear(o)},r.prototype.initFramebuffer=function(t){var e=this.gl,r=new ti(e.createFramebuffer());return r.multisample=this.detectSamples(t.multisample),t.glFramebuffers[this.CONTEXT_UID]=r,this.managedFramebuffers.push(t),t.disposeRunner.add(this),r},r.prototype.resizeFramebuffer=function(t){var e=this.gl,r=t.glFramebuffers[this.CONTEXT_UID];r.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,r.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));for(var i=t.colorTextures,n=0;n<i.length;n++)this.renderer.texture.bind(i[n],0);t.depthTexture&&this.renderer.texture.bind(t.depthTexture,0)},r.prototype.updateFramebuffer=function(t){var e=this.gl,r=t.glFramebuffers[this.CONTEXT_UID],i=t.colorTextures.length;e.drawBuffers||(i=Math.min(i,1)),r.multisample>1&&(r.msaaBuffer=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,r.msaaBuffer),e.renderbufferStorageMultisample(e.RENDERBUFFER,r.multisample,e.RGBA8,t.width,t.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.RENDERBUFFER,r.msaaBuffer));for(var n=[],o=0;o<i;o++)if(!(0===o&&r.multisample>1)){var a=t.colorTextures[o],s=a.parentTextureArray||a;this.renderer.texture.bind(s,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+o,a.target,s._glTextures[this.CONTEXT_UID].texture,0),n.push(e.COLOR_ATTACHMENT0+o)}if((n.length>1&&e.drawBuffers(n),t.depthTexture)&&this.writeDepthTexture){var h=t.depthTexture;this.renderer.texture.bind(h,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,h._glTextures[this.CONTEXT_UID].texture,0)}r.stencil||!t.stencil&&!t.depth||(r.stencil=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,r.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height),t.depthTexture||e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,r.stencil))},r.prototype.detectSamples=function(e){var r=this.msaaSamples,i=t.MSAA_QUALITY.NONE;if(e<=1||null===r)return i;for(var n=0;n<r.length;n++)if(r[n]<=e){i=r[n];break}return 1===i&&(i=t.MSAA_QUALITY.NONE),i},r.prototype.blit=function(t,e,r){var i=this.current,n=this.renderer,o=this.gl,a=this.CONTEXT_UID;if(2===n.context.webGLVersion&&i){var s=i.glFramebuffers[a];if(s){if(!t){if(s.multisample<=1)return;s.blitFramebuffer||(s.blitFramebuffer=new Ir(i.width,i.height),s.blitFramebuffer.addColorTexture(0,i.colorTextures[0])),(t=s.blitFramebuffer).width=i.width,t.height=i.height}e||((e=ei).width=i.width,e.height=i.height),r||(r=e);var h=e.width===r.width&&e.height===r.height;this.bind(t),o.bindFramebuffer(o.READ_FRAMEBUFFER,s.framebuffer),o.blitFramebuffer(e.x,e.y,e.width,e.height,r.x,r.y,r.width,r.height,o.COLOR_BUFFER_BIT,h?o.NEAREST:o.LINEAR)}}},r.prototype.disposeFramebuffer=function(t,e){var r=t.glFramebuffers[this.CONTEXT_UID],i=this.gl;if(r){delete t.glFramebuffers[this.CONTEXT_UID];var n=this.managedFramebuffers.indexOf(t);n>=0&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),e||(i.deleteFramebuffer(r.framebuffer),r.stencil&&i.deleteRenderbuffer(r.stencil))}},r.prototype.disposeAll=function(t){var e=this.managedFramebuffers;this.managedFramebuffers=[];for(var r=0;r<e.length;r++)this.disposeFramebuffer(e[r],t)},r.prototype.forceStencil=function(){var t=this.current;if(t){var e=t.glFramebuffers[this.CONTEXT_UID];if(e&&!e.stencil){t.enableStencil();var r=t.width,i=t.height,n=this.gl,o=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,o),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,r,i),e.stencil=o,n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,o)}}},r.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new we},r}(Sr),ii=function(t){this.buffer=t||null,this.updateID=-1,this.byteLength=-1,this.refCount=0},ni={5126:4,5123:2,5121:1},oi=function(e){function r(t){var r=e.call(this,t)||this;return r._activeGeometry=null,r._activeVao=null,r.hasVao=!0,r.hasInstance=!0,r.canUseUInt32ElementIndex=!1,r.managedGeometries={},r.managedBuffers={},r}return ur(r,e),r.prototype.contextChange=function(){this.disposeAll(!0);var e=this.gl=this.renderer.gl,r=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,2!==r.webGLVersion){var i=this.renderer.context.extensions.vertexArrayObject;O.PREFER_ENV===t.ENV.WEBGL_LEGACY&&(i=null),i?(e.createVertexArray=function(){return i.createVertexArrayOES()},e.bindVertexArray=function(t){return i.bindVertexArrayOES(t)},e.deleteVertexArray=function(t){return i.deleteVertexArrayOES(t)}):(this.hasVao=!1,e.createVertexArray=function(){return null},e.bindVertexArray=function(){return null},e.deleteVertexArray=function(){return null})}if(2!==r.webGLVersion){var n=e.getExtension("ANGLE_instanced_arrays");n?(e.vertexAttribDivisor=function(t,e){return n.vertexAttribDivisorANGLE(t,e)},e.drawElementsInstanced=function(t,e,r,i,o){return n.drawElementsInstancedANGLE(t,e,r,i,o)},e.drawArraysInstanced=function(t,e,r,i){return n.drawArraysInstancedANGLE(t,e,r,i)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===r.webGLVersion||!!r.extensions.uint32ElementIndex},r.prototype.bind=function(t,e){e=e||this.renderer.shader.shader;var r=this.gl,i=t.glVertexArrayObjects[this.CONTEXT_UID],n=!1;i||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=i={},n=!0);var o=i[e.program.id]||this.initGeometryVao(t,e.program,n);this._activeGeometry=t,this._activeVao!==o&&(this._activeVao=o,this.hasVao?r.bindVertexArray(o):this.activateVao(t,e.program)),this.updateBuffers()},r.prototype.reset=function(){this.unbind()},r.prototype.updateBuffers=function(){for(var t=this._activeGeometry,e=this.gl,r=0;r<t.buffers.length;r++){var i=t.buffers[r],n=i._glBuffers[this.CONTEXT_UID];if(i._updateID!==n.updateID){n.updateID=i._updateID;var o=i.index?e.ELEMENT_ARRAY_BUFFER:e.ARRAY_BUFFER;if(e.bindBuffer(o,n.buffer),this._boundBuffer=n,n.byteLength>=i.data.byteLength)e.bufferSubData(o,0,i.data);else{var a=i.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;n.byteLength=i.data.byteLength,e.bufferData(o,i.data,a)}}}},r.prototype.checkCompatibility=function(t,e){var r=t.attributes,i=e.attributeData;for(var n in i)if(!r[n])throw new Error('shader and geometry incompatible, geometry missing the "'+n+'" attribute')},r.prototype.getSignature=function(t,e){var r=t.attributes,i=e.attributeData,n=["g",t.id];for(var o in r)i[o]&&n.push(o);return n.join("-")},r.prototype.initGeometryVao=function(t,e,r){void 0===r&&(r=!0),this.checkCompatibility(t,e);var i=this.gl,n=this.CONTEXT_UID,o=this.getSignature(t,e),a=t.glVertexArrayObjects[this.CONTEXT_UID],s=a[o];if(s)return a[e.id]=s,s;var h=t.buffers,l=t.attributes,u={},c={};for(var p in h)u[p]=0,c[p]=0;for(var p in l)!l[p].size&&e.attributeData[p]?l[p].size=e.attributeData[p].size:l[p].size||console.warn("PIXI Geometry attribute '"+p+"' size cannot be determined (likely the bound shader does not have the attribute)"),u[l[p].buffer]+=l[p].size*ni[l[p].type];for(var p in l){var d=l[p],f=d.size;void 0===d.stride&&(u[d.buffer]===f*ni[d.type]?d.stride=0:d.stride=u[d.buffer]),void 0===d.start&&(d.start=c[d.buffer],c[d.buffer]+=f*ni[d.type])}s=i.createVertexArray(),i.bindVertexArray(s);for(var m=0;m<h.length;m++){var v=h[m];v._glBuffers[n]||(v._glBuffers[n]=new ii(i.createBuffer()),this.managedBuffers[v.id]=v,v.disposeRunner.add(this)),r&&v._glBuffers[n].refCount++}return this.activateVao(t,e),this._activeVao=s,a[e.id]=s,a[o]=s,s},r.prototype.disposeBuffer=function(t,e){if(this.managedBuffers[t.id]){delete this.managedBuffers[t.id];var r=t._glBuffers[this.CONTEXT_UID],i=this.gl;t.disposeRunner.remove(this),r&&(e||i.deleteBuffer(r.buffer),delete t._glBuffers[this.CONTEXT_UID])}},r.prototype.disposeGeometry=function(t,e){if(this.managedGeometries[t.id]){delete this.managedGeometries[t.id];var r=t.glVertexArrayObjects[this.CONTEXT_UID],i=this.gl,n=t.buffers;if(t.disposeRunner.remove(this),r){for(var o=0;o<n.length;o++){var a=n[o]._glBuffers[this.CONTEXT_UID];a.refCount--,0!==a.refCount||e||this.disposeBuffer(n[o],e)}if(!e)for(var s in r)if("g"===s[0]){var h=r[s];this._activeVao===h&&this.unbind(),i.deleteVertexArray(h)}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}},r.prototype.disposeAll=function(t){for(var e=Object.keys(this.managedGeometries),r=0;r<e.length;r++)this.disposeGeometry(this.managedGeometries[e[r]],t);e=Object.keys(this.managedBuffers);for(r=0;r<e.length;r++)this.disposeBuffer(this.managedBuffers[e[r]],t)},r.prototype.activateVao=function(t,e){var r=this.gl,i=this.CONTEXT_UID,n=t.buffers,o=t.attributes;t.indexBuffer&&r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,t.indexBuffer._glBuffers[i].buffer);var a=null;for(var s in o){var h=o[s],l=n[h.buffer]._glBuffers[i];if(e.attributeData[s]){a!==l&&(r.bindBuffer(r.ARRAY_BUFFER,l.buffer),a=l);var u=e.attributeData[s].location;if(r.enableVertexAttribArray(u),r.vertexAttribPointer(u,h.size,h.type||r.FLOAT,h.normalized,h.stride,h.start),h.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");r.vertexAttribDivisor(u,1)}}}},r.prototype.draw=function(t,e,r,i){var n=this.gl,o=this._activeGeometry;if(o.indexBuffer){var a=o.indexBuffer.data.BYTES_PER_ELEMENT,s=2===a?n.UNSIGNED_SHORT:n.UNSIGNED_INT;2===a||4===a&&this.canUseUInt32ElementIndex?o.instanced?n.drawElementsInstanced(t,e||o.indexBuffer.data.length,s,(r||0)*a,i||1):n.drawElements(t,e||o.indexBuffer.data.length,s,(r||0)*a):console.warn("unsupported index buffer type: uint32")}else o.instanced?n.drawArraysInstanced(t,r,e||o.getSize(),i||1):n.drawArrays(t,r,e||o.getSize());return this},r.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},r}(Sr),ai=function(){function e(e){void 0===e&&(e=null),this.type=t.MASK_TYPES.NONE,this.autoDetect=!0,this.maskObject=e||null,this.pooled=!1,this.isMaskData=!0,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._target=null}return e.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=t.MASK_TYPES.NONE,this.autoDetect=!0),this._target=null},e.prototype.copyCountersOrReset=function(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)},e}();function si(t,e,r){var i=t.createShader(e);return t.shaderSource(i,r),t.compileShader(i),i}function hi(t,e,r,i){var n=si(t,t.VERTEX_SHADER,e),o=si(t,t.FRAGMENT_SHADER,r),a=t.createProgram();if(t.attachShader(a,n),t.attachShader(a,o),i)for(var s in i)t.bindAttribLocation(a,i[s],s);return t.linkProgram(a),t.getProgramParameter(a,t.LINK_STATUS)||(t.getShaderParameter(n,t.COMPILE_STATUS)||(console.warn(e),console.error(t.getShaderInfoLog(n))),t.getShaderParameter(o,t.COMPILE_STATUS)||(console.warn(r),console.error(t.getShaderInfoLog(o))),console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",t.getProgramParameter(a,t.VALIDATE_STATUS)),console.error("gl.getError()",t.getError()),""!==t.getProgramInfoLog(a)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(a)),t.deleteProgram(a),a=null),t.deleteShader(n),t.deleteShader(o),a}function li(t){for(var e=new Array(t),r=0;r<e.length;r++)e[r]=!1;return e}function ui(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"bool":return!1;case"bvec2":return li(2*e);case"bvec3":return li(3*e);case"bvec4":return li(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}var ci,pi={},di=pi;function fi(){if(di===pi||di&&di.isContextLost()){var e=document.createElement("canvas"),r=void 0;O.PREFER_ENV>=t.ENV.WEBGL2&&(r=e.getContext("webgl2",{})),r||((r=e.getContext("webgl",{})||e.getContext("experimental-webgl",{}))?r.getExtension("WEBGL_draw_buffers"):r=null),di=r}return di}function mi(e,r,i){if("precision"!==e.substring(0,9)){var n=r;return r===t.PRECISION.HIGH&&i!==t.PRECISION.HIGH&&(n=t.PRECISION.MEDIUM),"precision "+n+" float;\n"+e}return i!==t.PRECISION.HIGH&&"precision highp"===e.substring(0,15)?e.replace("precision highp","precision mediump"):e}var vi={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function yi(t){return vi[t]}var gi=null,_i={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function xi(t,e){if(!gi){var r=Object.keys(_i);gi={};for(var i=0;i<r.length;++i){var n=r[i];gi[t[n]]=_i[n]}}return gi[e]}var bi=[{test:function(t){return"float"===t.type&&1===t.size},code:function(t){return'\n            if(uv["'+t+'"] !== ud["'+t+'"].value)\n            {\n                ud["'+t+'"].value = uv["'+t+'"]\n                gl.uniform1f(ud["'+t+'"].location, uv["'+t+'"])\n            }\n            '}},{test:function(t){return("sampler2D"===t.type||"samplerCube"===t.type||"sampler2DArray"===t.type)&&1===t.size&&!t.isArray},code:function(t){return't = syncData.textureCount++;\n\n            renderer.texture.bind(uv["'+t+'"], t);\n\n            if(ud["'+t+'"].value !== t)\n            {\n                ud["'+t+'"].value = t;\n                gl.uniform1i(ud["'+t+'"].location, t);\n; // eslint-disable-line max-len\n            }'}},{test:function(t,e){return"mat3"===t.type&&1===t.size&&void 0!==e.a},code:function(t){return'\n            gl.uniformMatrix3fv(ud["'+t+'"].location, false, uv["'+t+'"].toArray(true));\n            '}},{test:function(t,e){return"vec2"===t.type&&1===t.size&&void 0!==e.x},code:function(t){return'\n                cv = ud["'+t+'"].value;\n                v = uv["'+t+'"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud["'+t+'"].location, v.x, v.y);\n                }'}},{test:function(t){return"vec2"===t.type&&1===t.size},code:function(t){return'\n                cv = ud["'+t+'"].value;\n                v = uv["'+t+'"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud["'+t+'"].location, v[0], v[1]);\n                }\n            '}},{test:function(t,e){return"vec4"===t.type&&1===t.size&&void 0!==e.width},code:function(t){return'\n                cv = ud["'+t+'"].value;\n                v = uv["'+t+'"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud["'+t+'"].location, v.x, v.y, v.width, v.height)\n                }'}},{test:function(t){return"vec4"===t.type&&1===t.size},code:function(t){return'\n                cv = ud["'+t+'"].value;\n                v = uv["'+t+'"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud["'+t+'"].location, v[0], v[1], v[2], v[3])\n                }'}}],wi={float:"\n    if(cv !== v)\n    {\n        cv.v = v;\n        gl.uniform1f(location, v)\n    }",vec2:"\n    if(cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        gl.uniform2f(location, v[0], v[1])\n    }",vec3:"\n    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",bool:"gl.uniform1i(location, v)",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},Ti={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};var Ei,Si=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function Ai(t){for(var e="",r=0;r<t;++r)r>0&&(e+="\nelse "),r<t-1&&(e+="if(test == "+r+".0){}");return e}function Ii(t,e){if(0===t)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var r=e.createShader(e.FRAGMENT_SHADER);;){var i=Si.replace(/%forloop%/gi,Ai(t));if(e.shaderSource(r,i),e.compileShader(r),e.getShaderParameter(r,e.COMPILE_STATUS))break;t=t/2|0}return t}var Pi=0,Mi={},Ci=function(){function e(r,i,n){void 0===n&&(n="pixi-shader"),this.id=Pi++,this.vertexSrc=r||e.defaultVertexSrc,this.fragmentSrc=i||e.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(n=n.replace(/\s+/g,"-"),Mi[n]?(Mi[n]++,n+="-"+Mi[n]):Mi[n]=1,this.vertexSrc="#define SHADER_NAME "+n+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+n+"\n"+this.fragmentSrc,this.vertexSrc=mi(this.vertexSrc,O.PRECISION_VERTEX,t.PRECISION.HIGH),this.fragmentSrc=mi(this.fragmentSrc,O.PRECISION_FRAGMENT,function(){if(!ci){ci=t.PRECISION.MEDIUM;var e=fi();if(e&&e.getShaderPrecisionFormat){var r=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT);ci=r.precision?t.PRECISION.HIGH:t.PRECISION.MEDIUM}}return ci}())),this.extractData(this.vertexSrc,this.fragmentSrc),this.glPrograms={},this.syncUniforms=null}return e.prototype.extractData=function(t,e){var r=fi();if(r){var i=hi(r,t,e);this.attributeData=this.getAttributeData(i,r),this.uniformData=this.getUniformData(i,r),r.deleteProgram(i)}else this.uniformData={},this.attributeData={}},e.prototype.getAttributeData=function(t,e){for(var r={},i=[],n=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),o=0;o<n;o++){var a=e.getActiveAttrib(t,o),s=xi(e,a.type),h={type:s,name:a.name,size:yi(s),location:0};r[a.name]=h,i.push(h)}i.sort((function(t,e){return t.name>e.name?1:-1}));for(o=0;o<i.length;o++)i[o].location=o;return r},e.prototype.getUniformData=function(t,e){for(var r={},i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),n=0;n<i;n++){var o=e.getActiveUniform(t,n),a=o.name.replace(/\[.*?\]$/,""),s=o.name.match(/\[.*?\]$/),h=xi(e,o.type);r[a]={type:h,size:o.size,isArray:s,value:ui(h,o.size)}}return r},Object.defineProperty(e,"defaultVertexSrc",{get:function(){return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultFragmentSrc",{get:function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"},enumerable:!1,configurable:!0}),e.from=function(t,r,i){var n=t+r,o=he[n];return o||(he[n]=o=new e(t,r,i)),o},e}(),Ri=function(){function t(t,e){for(var r in this.program=t,this.uniformGroup=e?e instanceof Gr?e:new Gr(e):new Gr({}),t.uniformData)this.uniformGroup.uniforms[r]instanceof Array&&(this.uniformGroup.uniforms[r]=new Float32Array(this.uniformGroup.uniforms[r]))}return t.prototype.checkUniformExists=function(t,e){if(e.uniforms[t])return!0;for(var r in e.uniforms){var i=e.uniforms[r];if(i.group&&this.checkUniformExists(t,i))return!0}return!1},t.prototype.destroy=function(){this.uniformGroup=null},Object.defineProperty(t.prototype,"uniforms",{get:function(){return this.uniformGroup.uniforms},enumerable:!1,configurable:!0}),t.from=function(e,r,i){return new t(Ci.from(e,r),i)},t}(),Oi=function(){function e(){this.data=0,this.blendMode=t.BLEND_MODES.NORMAL,this.polygonOffset=0,this.blend=!0}return Object.defineProperty(e.prototype,"blend",{get:function(){return!!(1&this.data)},set:function(t){!!(1&this.data)!==t&&(this.data^=1)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"offsets",{get:function(){return!!(2&this.data)},set:function(t){!!(2&this.data)!==t&&(this.data^=2)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"culling",{get:function(){return!!(4&this.data)},set:function(t){!!(4&this.data)!==t&&(this.data^=4)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"depthTest",{get:function(){return!!(8&this.data)},set:function(t){!!(8&this.data)!==t&&(this.data^=8)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clockwiseFrontFace",{get:function(){return!!(16&this.data)},set:function(t){!!(16&this.data)!==t&&(this.data^=16)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blendMode",{get:function(){return this._blendMode},set:function(e){this.blend=e!==t.BLEND_MODES.NONE,this._blendMode=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"polygonOffset",{get:function(){return this._polygonOffset},set:function(t){this.offsets=!!t,this._polygonOffset=t},enumerable:!1,configurable:!0}),e.for2d=function(){var t=new e;return t.depthTest=!1,t.blend=!0,t},e}(),Di=function(t){function e(r,i,n){var o=this,a=Ci.from(r||e.defaultVertexSrc,i||e.defaultFragmentSrc);return(o=t.call(this,a,n)||this).padding=0,o.resolution=O.FILTER_RESOLUTION,o.enabled=!0,o.autoFit=!0,o.legacy=!!o.program.attributeData.aTextureCoord,o.state=new Oi,o}return ur(e,t),e.prototype.apply=function(t,e,r,i,n){t.applyFilter(this,e,r,i)},Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultVertexSrc",{get:function(){return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultFragmentSrc",{get:function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},enumerable:!1,configurable:!0}),e}(Ri),Bi=new Me,Ni=function(){function t(t,e){this._texture=t,this.mapCoord=new Me,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=void 0===e?.5:e,this.isSimple=!1}return Object.defineProperty(t.prototype,"texture",{get:function(){return this._texture},set:function(t){this._texture=t,this._textureID=-1},enumerable:!1,configurable:!0}),t.prototype.multiplyUvs=function(t,e){void 0===e&&(e=t);for(var r=this.mapCoord,i=0;i<t.length;i+=2){var n=t[i],o=t[i+1];e[i]=n*r.a+o*r.c+r.tx,e[i+1]=n*r.b+o*r.d+r.ty}return e},t.prototype.update=function(t){var e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._textureID===e._updateID)return!1;this._textureID=e._updateID,this._updateID++;var r=e._uvs;this.mapCoord.set(r.x1-r.x0,r.y1-r.y0,r.x3-r.x0,r.y3-r.y0,r.x0,r.y0);var i=e.orig,n=e.trim;n&&(Bi.set(i.width/n.width,0,0,i.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(Bi));var o=e.baseTexture,a=this.uClampFrame,s=this.clampMargin/o.resolution,h=this.clampOffset;return a[0]=(e._frame.x+s+h)/o.width,a[1]=(e._frame.y+s+h)/o.height,a[2]=(e._frame.x+e._frame.width-s+h)/o.width,a[3]=(e._frame.y+e._frame.height-s+h)/o.height,this.uClampOffset[0]=h/o.realWidth,this.uClampOffset[1]=h/o.realHeight,this.isSimple=e._frame.width===o.width&&e._frame.height===o.height&&0===e.rotate,!0},t}(),ki=function(t){function e(e){var r=this,i=new Me;return r=t.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n","varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n")||this,e.renderable=!1,r.maskSprite=e,r.maskMatrix=i,r}return ur(e,t),e.prototype.apply=function(t,e,r,i){var n=this.maskSprite,o=n._texture;o.valid&&(o.uvMatrix||(o.uvMatrix=new Ni(o,0)),o.uvMatrix.update(),this.uniforms.npmAlpha=o.baseTexture.alphaMode?0:1,this.uniforms.mask=o,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(o.uvMatrix.mapCoord),this.uniforms.alpha=n.worldAlpha,this.uniforms.maskClamp=o.uvMatrix.uClampFrame,t.applyFilter(this,e,r,i))},e}(Di),Fi=function(e){function r(t){var r=e.call(this,t)||this;return r.enableScissor=!1,r.alphaMaskPool=[],r.maskDataPool=[],r.maskStack=[],r.alphaMaskIndex=0,r}return ur(r,e),r.prototype.setMaskStack=function(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)},r.prototype.push=function(e,r){var i=r;if(!i.isMaskData){var n=this.maskDataPool.pop()||new ai;n.pooled=!0,n.maskObject=r,i=n}switch(i.autoDetect&&this.detect(i),i.copyCountersOrReset(this.maskStack[this.maskStack.length-1]),i._target=e,i.type){case t.MASK_TYPES.SCISSOR:this.maskStack.push(i),this.renderer.scissor.push(i);break;case t.MASK_TYPES.STENCIL:this.maskStack.push(i),this.renderer.stencil.push(i);break;case t.MASK_TYPES.SPRITE:i.copyCountersOrReset(null),this.pushSpriteMask(i),this.maskStack.push(i)}},r.prototype.pop=function(e){var r=this.maskStack.pop();if(r&&r._target===e){switch(r.type){case t.MASK_TYPES.SCISSOR:this.renderer.scissor.pop();break;case t.MASK_TYPES.STENCIL:this.renderer.stencil.pop(r.maskObject);break;case t.MASK_TYPES.SPRITE:this.popSpriteMask()}r.reset(),r.pooled&&this.maskDataPool.push(r)}},r.prototype.detect=function(e){var r=e.maskObject;if(r.isSprite)e.type=t.MASK_TYPES.SPRITE;else if(e.type=t.MASK_TYPES.STENCIL,this.enableScissor&&r.isFastRect&&r.isFastRect()){var i=r.worldTransform,n=Math.atan2(i.b,i.a),o=Math.atan2(i.d,i.c);n=Math.round(n*(180/Math.PI)*100),o=((o=Math.round(o*(180/Math.PI)*100)-n)%18e3+18e3)%18e3,0===(n=(n%9e3+9e3)%9e3)&&9e3===o&&(e.type=t.MASK_TYPES.SCISSOR)}},r.prototype.pushSpriteMask=function(t){var e=t.maskObject,r=t._target,i=this.alphaMaskPool[this.alphaMaskIndex];i||(i=this.alphaMaskPool[this.alphaMaskIndex]=[new ki(e)]),i[0].resolution=this.renderer.resolution,i[0].maskSprite=e;var n=r.filterArea;r.filterArea=e.getBounds(!0),this.renderer.filter.push(r,i),r.filterArea=n,this.alphaMaskIndex++},r.prototype.popSpriteMask=function(){this.renderer.filter.pop(),this.alphaMaskIndex--},r}(Sr),Li=function(t){function e(e){var r=t.call(this,e)||this;return r.maskStack=[],r.glConst=0,r}return ur(e,t),e.prototype.getStackLength=function(){return this.maskStack.length},e.prototype.setMaskStack=function(t){var e=this.renderer.gl,r=this.getStackLength();this.maskStack=t;var i=this.getStackLength();i!==r&&(0===i?e.disable(this.glConst):(e.enable(this.glConst),this._useCurrent()))},e.prototype._useCurrent=function(){},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.maskStack=null},e}(Sr),Vi=function(t){function e(e){var r=t.call(this,e)||this;return r.glConst=WebGLRenderingContext.SCISSOR_TEST,r}return ur(e,t),e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0},e.prototype.push=function(t){var e=t.maskObject;e.renderable=!0;var r=t._scissorRect,i=e.getBounds(!0),n=this.renderer.gl;e.renderable=!1,r?i.fit(r):n.enable(n.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=i,this._useCurrent()},e.prototype.pop=function(){var t=this.renderer.gl;this.getStackLength()>0?this._useCurrent():t.disable(t.SCISSOR_TEST)},e.prototype._useCurrent=function(){var t=this.maskStack[this.maskStack.length-1]._scissorRect,e=this.renderer.renderTexture.current,r=this.renderer.projection,i=r.transform,n=r.sourceFrame,o=r.destinationFrame,a=e?e.resolution:this.renderer.resolution,s=(t.x-n.x)*a+o.x,h=(t.y-n.y)*a+o.y,l=t.width*a,u=t.height*a;i&&(s+=i.tx*a,h+=i.ty*a),e||(h=this.renderer.height-u-h),this.renderer.gl.scissor(s,h,l,u)},e}(Li),Xi=function(t){function e(e){var r=t.call(this,e)||this;return r.glConst=WebGLRenderingContext.STENCIL_TEST,r}return ur(e,t),e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0},e.prototype.push=function(t){var e=t.maskObject,r=this.renderer.gl,i=t._stencilCounter;0===i&&(this.renderer.framebuffer.forceStencil(),r.enable(r.STENCIL_TEST)),t._stencilCounter++,r.colorMask(!1,!1,!1,!1),r.stencilFunc(r.EQUAL,i,this._getBitwiseMask()),r.stencilOp(r.KEEP,r.KEEP,r.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent()},e.prototype.pop=function(t){var e=this.renderer.gl;0===this.getStackLength()?(e.disable(e.STENCIL_TEST),e.clear(e.STENCIL_BUFFER_BIT),e.clearStencil(0)):(e.colorMask(!1,!1,!1,!1),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,this._useCurrent())},e.prototype._useCurrent=function(){var t=this.renderer.gl;t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.EQUAL,this.getStackLength(),this._getBitwiseMask()),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},e.prototype._getBitwiseMask=function(){return(1<<this.getStackLength())-1},e}(Li),ji=function(t){function e(e){var r=t.call(this,e)||this;return r.destinationFrame=null,r.sourceFrame=null,r.defaultFrame=null,r.projectionMatrix=new Me,r.transform=null,r}return ur(e,t),e.prototype.update=function(t,e,r,i){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,r,i),this.transform&&this.projectionMatrix.append(this.transform);var n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)},e.prototype.calculateProjection=function(t,e,r,i){var n=this.projectionMatrix,o=i?-1:1;n.identity(),n.a=1/e.width*2,n.d=o*(1/e.height*2),n.tx=-1-e.x*n.a,n.ty=-o-e.y*n.d},e.prototype.setTransform=function(t){},e}(Sr),Ui=new we,Yi=new we,zi=new we,Wi=function(t){function e(e){var r=t.call(this,e)||this;return r.clearColor=e._backgroundColorRgba,r.defaultMaskStack=[],r.current=null,r.sourceFrame=new we,r.destinationFrame=new we,r}return ur(e,t),e.prototype.bind=function(t,e,r){void 0===t&&(t=null);var i,n,o,a=this.renderer;this.current=t,t?(o=(i=t.baseTexture).resolution,e||(Ui.width=t.frame.width,Ui.height=t.frame.height,e=Ui),r||(Yi.x=t.frame.x,Yi.y=t.frame.y,Yi.width=e.width,Yi.height=e.height,r=Yi),n=i.framebuffer):(o=a.resolution,e||(Ui.width=a.screen.width,Ui.height=a.screen.height,e=Ui),r||((r=Ui).width=e.width,r.height=e.height)),zi.x=r.x*o,zi.y=r.y*o,zi.width=r.width*o,zi.height=r.height*o,this.renderer.framebuffer.bind(n,zi),this.renderer.projection.update(r,e,o,!n),t?this.renderer.mask.setMaskStack(i.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(e),this.destinationFrame.copyFrom(r)},e.prototype.clear=function(t,e){t=this.current?t||this.current.baseTexture.clearColor:t||this.clearColor,this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3],e)},e.prototype.resize=function(){this.bind(null)},e.prototype.reset=function(){this.bind(null)},e}(Sr),qi=function(){},Gi=function(){function t(t,e){this.program=t,this.uniformData=e,this.uniformGroups={}}return t.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.program=null},t}(),Hi=0,$i={textureCount:0},Ji=function(t){function e(e){var r=t.call(this,e)||this;return r.destroyed=!1,r.systemCheck(),r.gl=null,r.shader=null,r.program=null,r.cache={},r.id=Hi++,r}return ur(e,t),e.prototype.systemCheck=function(){if(!function(){if("boolean"==typeof Ei)return Ei;try{var t=new Function("param1","param2","param3","return param1[param2] === param3;");Ei=!0===t({a:"b"},"a","b")}catch(t){Ei=!1}return Ei}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},e.prototype.contextChange=function(t){this.gl=t,this.reset()},e.prototype.bind=function(t,e){t.uniforms.globals=this.renderer.globalUniforms;var r=t.program,i=r.glPrograms[this.renderer.CONTEXT_UID]||this.generateShader(t);return this.shader=t,this.program!==r&&(this.program=r,this.gl.useProgram(i.program)),e||($i.textureCount=0,this.syncUniformGroup(t.uniformGroup,$i)),i},e.prototype.setUniforms=function(t){var e=this.shader.program,r=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(r.uniformData,t,this.renderer)},e.prototype.syncUniformGroup=function(t,e){var r=this.getglProgram();t.static&&t.dirtyId===r.uniformGroups[t.id]||(r.uniformGroups[t.id]=t.dirtyId,this.syncUniforms(t,r,e))},e.prototype.syncUniforms=function(t,e,r){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,t.uniforms,this.renderer,r)},e.prototype.createSyncGroups=function(t){var e=this.getSignature(t,this.shader.program.uniformData);return this.cache[e]||(this.cache[e]=function(t,e){var r=["\n        var v = null;\n        var cv = null\n        var t = 0;\n        var gl = renderer.gl\n    "];for(var i in t.uniforms){var n=e[i];if(n){for(var o=t.uniforms[i],a=!1,s=0;s<bi.length;s++)if(bi[s].test(n,o)){r.push(bi[s].code(i,o)),a=!0;break}if(!a){var h=(1===n.size?wi:Ti)[n.type].replace("location",'ud["'+i+'"].location');r.push('\n            cv = ud["'+i+'"].value;\n            v = uv["'+i+'"];\n            '+h+";")}}else t.uniforms[i].group&&r.push('\n                    renderer.shader.syncUniformGroup(uv["'+i+'"], syncData);\n                ')}return new Function("ud","uv","renderer","syncData",r.join("\n"))}(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]},e.prototype.getSignature=function(t,e){var r=t.uniforms,i=[];for(var n in r)i.push(n),e[n]&&i.push(e[n].type);return i.join("-")},e.prototype.getglProgram=function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},e.prototype.generateShader=function(t){var e=this.gl,r=t.program,i={};for(var n in r.attributeData)i[n]=r.attributeData[n].location;var o=hi(e,r.vertexSrc,r.fragmentSrc,i),a={};for(var n in r.uniformData){var s=r.uniformData[n];a[n]={location:e.getUniformLocation(o,n),value:ui(s.type,s.size)}}var h=new Gi(o,a);return r.glPrograms[this.renderer.CONTEXT_UID]=h,h},e.prototype.reset=function(){this.program=null,this.shader=null},e.prototype.destroy=function(){this.destroyed=!0},e}(Sr);var Zi=function(e){function r(r){var i=e.call(this,r)||this;return i.gl=null,i.stateId=0,i.polygonOffset=0,i.blendMode=t.BLEND_MODES.NONE,i._blendEq=!1,i.map=[],i.map[0]=i.setBlend,i.map[1]=i.setOffset,i.map[2]=i.setCullFace,i.map[3]=i.setDepthTest,i.map[4]=i.setFrontFace,i.checks=[],i.defaultState=new Oi,i.defaultState.blend=!0,i}return ur(r,e),r.prototype.contextChange=function(e){this.gl=e,this.blendModes=function(e,r){return void 0===r&&(r=[]),r[t.BLEND_MODES.NORMAL]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],r[t.BLEND_MODES.ADD]=[e.ONE,e.ONE],r[t.BLEND_MODES.MULTIPLY]=[e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],r[t.BLEND_MODES.SCREEN]=[e.ONE,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],r[t.BLEND_MODES.OVERLAY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],r[t.BLEND_MODES.DARKEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],r[t.BLEND_MODES.LIGHTEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],r[t.BLEND_MODES.COLOR_DODGE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],r[t.BLEND_MODES.COLOR_BURN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],r[t.BLEND_MODES.HARD_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],r[t.BLEND_MODES.SOFT_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],r[t.BLEND_MODES.DIFFERENCE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],r[t.BLEND_MODES.EXCLUSION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],r[t.BLEND_MODES.HUE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],r[t.BLEND_MODES.SATURATION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],r[t.BLEND_MODES.COLOR]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],r[t.BLEND_MODES.LUMINOSITY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],r[t.BLEND_MODES.NONE]=[0,0],r[t.BLEND_MODES.NORMAL_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],r[t.BLEND_MODES.ADD_NPM]=[e.SRC_ALPHA,e.ONE,e.ONE,e.ONE],r[t.BLEND_MODES.SCREEN_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],r[t.BLEND_MODES.SRC_IN]=[e.DST_ALPHA,e.ZERO],r[t.BLEND_MODES.SRC_OUT]=[e.ONE_MINUS_DST_ALPHA,e.ZERO],r[t.BLEND_MODES.SRC_ATOP]=[e.DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],r[t.BLEND_MODES.DST_OVER]=[e.ONE_MINUS_DST_ALPHA,e.ONE],r[t.BLEND_MODES.DST_IN]=[e.ZERO,e.SRC_ALPHA],r[t.BLEND_MODES.DST_OUT]=[e.ZERO,e.ONE_MINUS_SRC_ALPHA],r[t.BLEND_MODES.DST_ATOP]=[e.ONE_MINUS_DST_ALPHA,e.SRC_ALPHA],r[t.BLEND_MODES.XOR]=[e.ONE_MINUS_DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],r[t.BLEND_MODES.SUBTRACT]=[e.ONE,e.ONE,e.ONE,e.ONE,e.FUNC_REVERSE_SUBTRACT,e.FUNC_ADD],r}(e),this.set(this.defaultState),this.reset()},r.prototype.set=function(t){if(t=t||this.defaultState,this.stateId!==t.data){for(var e=this.stateId^t.data,r=0;e;)1&e&&this.map[r].call(this,!!(t.data&1<<r)),e>>=1,r++;this.stateId=t.data}for(r=0;r<this.checks.length;r++)this.checks[r](this,t)},r.prototype.forceState=function(t){t=t||this.defaultState;for(var e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(e=0;e<this.checks.length;e++)this.checks[e](this,t);this.stateId=t.data},r.prototype.setBlend=function(t){this.updateCheck(r.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)},r.prototype.setOffset=function(t){this.updateCheck(r.checkPolygonOffset,t),this.gl[t?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},r.prototype.setDepthTest=function(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)},r.prototype.setCullFace=function(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)},r.prototype.setFrontFace=function(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])},r.prototype.setBlendMode=function(t){if(t!==this.blendMode){this.blendMode=t;var e=this.blendModes[t],r=this.gl;2===e.length?r.blendFunc(e[0],e[1]):r.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(this._blendEq=!0,r.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,r.blendEquationSeparate(r.FUNC_ADD,r.FUNC_ADD))}},r.prototype.setPolygonOffset=function(t,e){this.gl.polygonOffset(t,e)},r.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},r.prototype.updateCheck=function(t,e){var r=this.checks.indexOf(t);e&&-1===r?this.checks.push(t):e||-1===r||this.checks.splice(r,1)},r.checkBlendMode=function(t,e){t.setBlendMode(e.blendMode)},r.checkPolygonOffset=function(t,e){t.setPolygonOffset(1,e.polygonOffset)},r}(Sr),Qi=function(e){function r(t){var r=e.call(this,t)||this;return r.count=0,r.checkCount=0,r.maxIdle=O.GC_MAX_IDLE,r.checkCountMax=O.GC_MAX_CHECK_COUNT,r.mode=O.GC_MODE,r}return ur(r,e),r.prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==t.GC_MODES.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},r.prototype.run=function(){for(var t=this.renderer.texture,e=t.managedTextures,r=!1,i=0;i<e.length;i++){var n=e[i];!n.framebuffer&&this.count-n.touched>this.maxIdle&&(t.destroyTexture(n,!0),e[i]=null,r=!0)}if(r){var o=0;for(i=0;i<e.length;i++)null!==e[i]&&(e[o++]=e[i]);e.length=o}},r.prototype.unload=function(t){var e,r=this.renderer.texture;(null===(e=t._texture)||void 0===e?void 0:e.framebuffer)&&r.destroyTexture(t._texture);for(var i=t.children.length-1;i>=0;i--)this.unload(t.children[i])},r}(Sr),Ki=function(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=6408,this.internalFormat=5121},tn=function(e){function r(t){var r=e.call(this,t)||this;return r.boundTextures=[],r.currentLocation=-1,r.managedTextures=[],r._unknownBoundTextures=!1,r.unknownTexture=new fr,r}return ur(r,e),r.prototype.contextChange=function(){var t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion;var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(var r=0;r<e;r++)this.boundTextures[r]=null;this.emptyTextures={};var i=new Ki(t.createTexture());t.bindTexture(t.TEXTURE_2D,i.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=i,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new Ki(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(r=0;r<6;r++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+r,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(r=0;r<this.boundTextures.length;r++)this.bind(null,r)},r.prototype.bind=function(t,e){void 0===e&&(e=0);var r=this.gl;if(t){if((t=t.castToBaseTexture()).parentTextureArray)return;if(t.valid){t.touched=this.renderer.textureGC.count;var i=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),r.bindTexture(t.target,i.texture)),i.dirtyId!==t.dirtyId&&(this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),this.updateTexture(t)),this.boundTextures[e]=t}}else this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),r.bindTexture(r.TEXTURE_2D,this.emptyTextures[r.TEXTURE_2D].texture),this.boundTextures[e]=null},r.prototype.reset=function(){this._unknownBoundTextures=!0,this.currentLocation=-1;for(var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture},r.prototype.unbind=function(t){var e=this.gl,r=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var i=0;i<r.length;i++)r[i]===this.unknownTexture&&this.bind(null,i)}for(i=0;i<r.length;i++)r[i]===t&&(this.currentLocation!==i&&(e.activeTexture(e.TEXTURE0+i),this.currentLocation=i),e.bindTexture(t.target,this.emptyTextures[t.target].texture),r[i]=null)},r.prototype.initTexture=function(t){var e=new Ki(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e},r.prototype.initTextureType=function(e,r){if(r.internalFormat=e.format,r.type=e.type,2===this.webGLVersion){var i=this.renderer.gl;e.type===i.FLOAT&&e.format===i.RGBA&&(r.internalFormat=i.RGBA32F),e.type===t.TYPES.HALF_FLOAT&&(r.type=i.HALF_FLOAT),r.type===i.HALF_FLOAT&&e.format===i.RGBA&&(r.internalFormat=i.RGBA16F)}},r.prototype.updateTexture=function(t){var e=t._glTextures[this.CONTEXT_UID];if(e){var r=this.renderer;if(this.initTextureType(t,e),t.resource&&t.resource.upload(r,t,e));else{var i=t.realWidth,n=t.realHeight,o=r.gl;(e.width!==i||e.height!==n||e.dirtyId<0)&&(e.width=i,e.height=n,o.texImage2D(t.target,0,e.internalFormat,i,n,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId}},r.prototype.destroyTexture=function(t,e){var r=this.gl;if((t=t.castToBaseTexture())._glTextures[this.CONTEXT_UID]&&(this.unbind(t),r.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){var i=this.managedTextures.indexOf(t);-1!==i&&re(this.managedTextures,i,1)}},r.prototype.updateTextureStyle=function(e){var r=e._glTextures[this.CONTEXT_UID];r&&(e.mipmap!==t.MIPMAP_MODES.POW2&&2===this.webGLVersion||e.isPowerOfTwo?r.mipmap=e.mipmap>=1:r.mipmap=!1,2===this.webGLVersion||e.isPowerOfTwo?r.wrapMode=e.wrapMode:r.wrapMode=t.WRAP_MODES.CLAMP,e.resource&&e.resource.style(this.renderer,e,r)||this.setStyle(e,r),r.dirtyStyleId=e.dirtyStyleId)},r.prototype.setStyle=function(e,r){var i=this.gl;if(r.mipmap&&i.generateMipmap(e.target),i.texParameteri(e.target,i.TEXTURE_WRAP_S,r.wrapMode),i.texParameteri(e.target,i.TEXTURE_WRAP_T,r.wrapMode),r.mipmap){i.texParameteri(e.target,i.TEXTURE_MIN_FILTER,e.scaleMode===t.SCALE_MODES.LINEAR?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST);var n=this.renderer.context.extensions.anisotropicFiltering;if(n&&e.anisotropicLevel>0&&e.scaleMode===t.SCALE_MODES.LINEAR){var o=Math.min(e.anisotropicLevel,i.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT));i.texParameterf(e.target,n.TEXTURE_MAX_ANISOTROPY_EXT,o)}}else i.texParameteri(e.target,i.TEXTURE_MIN_FILTER,e.scaleMode===t.SCALE_MODES.LINEAR?i.LINEAR:i.NEAREST);i.texParameteri(e.target,i.TEXTURE_MAG_FILTER,e.scaleMode===t.SCALE_MODES.LINEAR?i.LINEAR:i.NEAREST)},r}(Sr),en={FilterSystem:$r,BatchSystem:Zr,ContextSystem:Kr,FramebufferSystem:ri,GeometrySystem:oi,MaskSystem:Fi,ScissorSystem:Vi,StencilSystem:Xi,ProjectionSystem:ji,RenderTextureSystem:Wi,ShaderSystem:Ji,StateSystem:Zi,TextureGCSystem:Qi,TextureSystem:tn},rn=new Me,nn=function(e){function r(r,i){void 0===r&&(r=t.RENDERER_TYPE.UNKNOWN);var n=e.call(this)||this;return(i=Object.assign({},O.RENDER_OPTIONS,i)).roundPixels&&(O.ROUND_PIXELS=i.roundPixels,se("5.0.0","Renderer roundPixels option is deprecated, please use PIXI.settings.ROUND_PIXELS",2)),n.options=i,n.type=r,n.screen=new we(0,0,i.width,i.height),n.view=i.view||document.createElement("canvas"),n.resolution=i.resolution||O.RESOLUTION,n.transparent=i.transparent,n.autoDensity=i.autoDensity||i.autoResize||!1,n.preserveDrawingBuffer=i.preserveDrawingBuffer,n.clearBeforeRender=i.clearBeforeRender,n._backgroundColor=0,n._backgroundColorRgba=[0,0,0,0],n._backgroundColorString="#000000",n.backgroundColor=i.backgroundColor||n._backgroundColor,n._lastObjectRendered=null,n.plugins={},n}return ur(r,e),r.prototype.initPlugins=function(t){for(var e in t)this.plugins[e]=new t[e](this)},Object.defineProperty(r.prototype,"width",{get:function(){return this.view.width},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"height",{get:function(){return this.view.height},enumerable:!1,configurable:!0}),r.prototype.resize=function(t,e){this.screen.width=t,this.screen.height=e,this.view.width=t*this.resolution,this.view.height=e*this.resolution,this.autoDensity&&(this.view.style.width=t+"px",this.view.style.height=e+"px"),this.emit("resize",t,e)},r.prototype.generateTexture=function(t,e,r,i){0===(i=i||t.getLocalBounds(null,!0)).width&&(i.width=1),0===i.height&&(i.height=1);var n=Dr.create({width:0|i.width,height:0|i.height,scaleMode:e,resolution:r});return rn.tx=-i.x,rn.ty=-i.y,this.render(t,n,!1,rn,!!t.parent),n},r.prototype.destroy=function(e){for(var r in this.plugins)this.plugins[r].destroy(),this.plugins[r]=null;e&&this.view.parentNode&&this.view.parentNode.removeChild(this.view);this.plugins=null,this.type=t.RENDERER_TYPE.UNKNOWN,this.view=null,this.screen=null,this._tempDisplayObjectParent=null,this.options=null,this._backgroundColorRgba=null,this._backgroundColorString=null,this._lastObjectRendered=null},Object.defineProperty(r.prototype,"backgroundColor",{get:function(){return this._backgroundColor},set:function(t){this._backgroundColor=t,this._backgroundColorString=Yt(t),Ut(t,this._backgroundColorRgba)},enumerable:!1,configurable:!0}),r}(D),on=function(e){function r(i){var n=e.call(this,t.RENDERER_TYPE.WEBGL,i)||this;return i=n.options,n.gl=null,n.CONTEXT_UID=0,n.runners={destroy:new ar("destroy"),contextChange:new ar("contextChange"),reset:new ar("reset"),update:new ar("update"),postrender:new ar("postrender"),prerender:new ar("prerender"),resize:new ar("resize")},n.globalUniforms=new Gr({projectionMatrix:new Me},!0),n.addSystem(Fi,"mask").addSystem(Kr,"context").addSystem(Zi,"state").addSystem(Ji,"shader").addSystem(tn,"texture").addSystem(oi,"geometry").addSystem(ri,"framebuffer").addSystem(Vi,"scissor").addSystem(Xi,"stencil").addSystem(ji,"projection").addSystem(Qi,"textureGC").addSystem($r,"filter").addSystem(Wi,"renderTexture").addSystem(Zr,"batch"),n.initPlugins(r.__plugins),i.context?n.context.initFromContext(i.context):n.context.initFromOptions({alpha:!!n.transparent,antialias:i.antialias,premultipliedAlpha:n.transparent&&"notMultiplied"!==n.transparent,stencil:!0,preserveDrawingBuffer:i.preserveDrawingBuffer,powerPreference:n.options.powerPreference}),n.renderingToScreen=!0,Xt(2===n.context.webGLVersion?"WebGL 2":"WebGL 1"),n.resize(n.options.width,n.options.height),n}return ur(r,e),r.create=function(t){if(jt())return new r(t);throw new Error('WebGL unsupported in this browser, use "pixi.js-legacy" for fallback canvas2d support.')},r.prototype.addSystem=function(t,e){e||(e=t.name);var r=new t(this);if(this[e])throw new Error('Whoops! The name "'+e+'" is already in use');for(var i in this[e]=r,this.runners)this.runners[i].add(r);return this},r.prototype.render=function(t,e,r,i,n){if(this.renderingToScreen=!e,this.runners.prerender.emit(),this.emit("prerender"),this.projection.transform=i,!this.context.isLost){if(e||(this._lastObjectRendered=t),!n){var o=t.enableTempParent();t.updateTransform(),t.disableTempParent(o)}this.renderTexture.bind(e),this.batch.currentRenderer.start(),(void 0!==r?r:this.clearBeforeRender)&&this.renderTexture.clear(),t.render(this),this.batch.currentRenderer.flush(),e&&e.baseTexture.update(),this.runners.postrender.emit(),this.projection.transform=null,this.emit("postrender")}},r.prototype.resize=function(t,r){e.prototype.resize.call(this,t,r),this.runners.resize.emit(t,r)},r.prototype.reset=function(){return this.runners.reset.emit(),this},r.prototype.clear=function(){this.renderTexture.bind(),this.renderTexture.clear()},r.prototype.destroy=function(t){for(var r in this.runners.destroy.emit(),this.runners)this.runners[r].destroy();e.prototype.destroy.call(this,t),this.gl=null},r.registerPlugin=function(t,e){r.__plugins=r.__plugins||{},r.__plugins[t]=e},r}(nn);function an(t){return on.create(t)}var sn="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}",hn="attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n",ln=function(){this.texArray=null,this.blend=0,this.type=t.DRAW_MODES.TRIANGLES,this.start=0,this.size=0,this.data=null},un=function(){function t(){this.elements=[],this.ids=[],this.count=0}return t.prototype.clear=function(){for(var t=0;t<this.count;t++)this.elements[t]=null;this.count=0},t}(),cn=function(){function t(t){this.rawBinaryData=new ArrayBuffer(t),this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}return Object.defineProperty(t.prototype,"int8View",{get:function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"uint8View",{get:function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"int16View",{get:function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"uint16View",{get:function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"int32View",{get:function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},enumerable:!1,configurable:!0}),t.prototype.view=function(t){return this[t+"View"]},t.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},t.sizeOf=function(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(t+" isn't a valid view type")}},t}(),pn=function(e){function r(t){var r=e.call(this,t)||this;return r.shaderGenerator=null,r.geometryClass=null,r.vertexSize=null,r.state=Oi.for2d(),r.size=4*O.SPRITE_BATCH_SIZE,r._vertexCount=0,r._indexCount=0,r._bufferedElements=[],r._bufferedTextures=[],r._bufferSize=0,r._shader=null,r._packedGeometries=[],r._packedGeometryPoolSize=2,r._flushId=0,r._aBuffers={},r._iBuffers={},r.MAX_TEXTURES=1,r.renderer.on("prerender",r.onPrerender,r),t.runners.contextChange.add(r),r._dcIndex=0,r._aIndex=0,r._iIndex=0,r._attributeBuffer=null,r._indexBuffer=null,r._tempBoundTextures=[],r}return ur(r,e),r.prototype.contextChange=function(){var e=this.renderer.gl;O.PREFER_ENV===t.ENV.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),O.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=Ii(this.MAX_TEXTURES,e)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var r=0;r<this._packedGeometryPoolSize;r++)this._packedGeometries[r]=new this.geometryClass;this.initFlushBuffers()},r.prototype.initFlushBuffers=function(){for(var t=r._drawCallPool,e=r._textureArrayPool,i=this.size/4,n=Math.floor(i/this.MAX_TEXTURES)+1;t.length<i;)t.push(new ln);for(;e.length<n;)e.push(new un);for(var o=0;o<this.MAX_TEXTURES;o++)this._tempBoundTextures[o]=null},r.prototype.onPrerender=function(){this._flushId=0},r.prototype.render=function(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)},r.prototype.buildTexturesAndDrawCalls=function(){var t=this._bufferedTextures,e=this.MAX_TEXTURES,i=r._textureArrayPool,n=this.renderer.batch,o=this._tempBoundTextures,a=this.renderer.textureGC.count,s=++fr._globalBatch,h=0,l=i[0],u=0;n.copyBoundTextures(o,e);for(var c=0;c<this._bufferSize;++c){var p=t[c];t[c]=null,p._batchEnabled!==s&&(l.count>=e&&(n.boundArray(l,o,s,e),this.buildDrawCalls(l,u,c),u=c,l=i[++h],++s),p._batchEnabled=s,p.touched=a,l.elements[l.count++]=p)}l.count>0&&(n.boundArray(l,o,s,e),this.buildDrawCalls(l,u,this._bufferSize),++h,++s);for(c=0;c<o.length;c++)o[c]=null;fr._globalBatch=s},r.prototype.buildDrawCalls=function(t,e,i){var n=this._bufferedElements,o=this._attributeBuffer,a=this._indexBuffer,s=this.vertexSize,h=r._drawCallPool,l=this._dcIndex,u=this._aIndex,c=this._iIndex,p=h[l];p.start=this._iIndex,p.texArray=t;for(var d=e;d<i;++d){var f=n[d],m=f._texture.baseTexture,v=Wt[m.alphaMode?1:0][f.blendMode];n[d]=null,e<d&&p.blend!==v&&(p.size=c-p.start,e=d,(p=h[++l]).texArray=t,p.start=c),this.packInterleavedGeometry(f,o,a,u,c),u+=f.vertexData.length/2*s,c+=f.indices.length,p.blend=v}e<i&&(p.size=c-p.start,++l),this._dcIndex=l,this._aIndex=u,this._iIndex=c},r.prototype.bindAndClearTexArray=function(t){for(var e=this.renderer.texture,r=0;r<t.count;r++)e.bind(t.elements[r],t.ids[r]),t.elements[r]=null;t.count=0},r.prototype.updateGeometry=function(){var t=this._packedGeometries,e=this._attributeBuffer,r=this._indexBuffer;O.CAN_UPLOAD_SAME_BUFFER?(t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(r),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(r),this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},r.prototype.drawBatches=function(){for(var t=this._dcIndex,e=this.renderer,i=e.gl,n=e.state,o=r._drawCallPool,a=null,s=0;s<t;s++){var h=o[s],l=h.texArray,u=h.type,c=h.size,p=h.start,d=h.blend;a!==l&&(a=l,this.bindAndClearTexArray(l)),this.state.blendMode=d,n.set(this.state),i.drawElements(u,c,i.UNSIGNED_SHORT,2*p)}},r.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},r.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.shader.bind(this._shader),O.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},r.prototype.stop=function(){this.flush()},r.prototype.destroy=function(){for(var t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]&&this._packedGeometries[t].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),e.prototype.destroy.call(this)},r.prototype.getAttributeBuffer=function(t){var e=Kt(Math.ceil(t/8)),r=ee(e),i=8*e;this._aBuffers.length<=r&&(this._iBuffers.length=r+1);var n=this._aBuffers[i];return n||(this._aBuffers[i]=n=new cn(i*this.vertexSize*4)),n},r.prototype.getIndexBuffer=function(t){var e=Kt(Math.ceil(t/12)),r=ee(e),i=12*e;this._iBuffers.length<=r&&(this._iBuffers.length=r+1);var n=this._iBuffers[r];return n||(this._iBuffers[r]=n=new Uint16Array(i)),n},r.prototype.packInterleavedGeometry=function(t,e,r,i,n){for(var o=e.uint32View,a=e.float32View,s=i/this.vertexSize,h=t.uvs,l=t.indices,u=t.vertexData,c=t._texture.baseTexture._batchLocation,p=Math.min(t.worldAlpha,1),d=p<1&&t._texture.baseTexture.alphaMode?Ht(t._tintRGB,p):t._tintRGB+(255*p<<24),f=0;f<u.length;f+=2)a[i++]=u[f],a[i++]=u[f+1],a[i++]=h[f],a[i++]=h[f+1],o[i++]=d,a[i++]=c;for(f=0;f<l.length;f++)r[n++]=s+l[f]},r._drawCallPool=[],r._textureArrayPool=[],r}(Jr),dn=function(){function t(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},e.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(e.indexOf("%forloop%")<0)throw new Error('Fragment template must contain "%forloop%".')}return t.prototype.generateShader=function(t){if(!this.programCache[t]){for(var e=new Int32Array(t),r=0;r<t;r++)e[r]=r;this.defaultGroupCache[t]=Gr.from({uSamplers:e},!0);var i=this.fragTemplate;i=(i=i.replace(/%count%/gi,""+t)).replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new Ci(this.vertexSrc,i)}var n={tint:new Float32Array([1,1,1,1]),translationMatrix:new Me,default:this.defaultGroupCache[t]};return new Ri(this.programCache[t],n)},t.prototype.generateSampleSrc=function(t){var e="";e+="\n",e+="\n";for(var r=0;r<t;r++)r>0&&(e+="\nelse "),r<t-1&&(e+="if(vTextureId < "+r+".5)"),e+="\n{",e+="\n\tcolor = texture2D(uSamplers["+r+"], vTextureCoord);",e+="\n}";return e+="\n",e+="\n"},t}(),fn=function(e){function r(r){void 0===r&&(r=!1);var i=e.call(this)||this;return i._buffer=new Fr(null,r,!1),i._indexBuffer=new Fr(null,r,!0),i.addAttribute("aVertexPosition",i._buffer,2,!1,t.TYPES.FLOAT).addAttribute("aTextureCoord",i._buffer,2,!1,t.TYPES.FLOAT).addAttribute("aColor",i._buffer,4,!0,t.TYPES.UNSIGNED_BYTE).addAttribute("aTextureId",i._buffer,1,!0,t.TYPES.FLOAT).addIndex(i._indexBuffer),i}return ur(r,e),r}(Yr),mn="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n",vn="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",yn=function(){function t(){}return t.create=function(t){var e=Object.assign({vertex:mn,fragment:vn,geometryClass:fn,vertexSize:6},t),r=e.vertex,i=e.fragment,n=e.vertexSize,o=e.geometryClass;return function(t){function e(e){var a=t.call(this,e)||this;return a.shaderGenerator=new dn(r,i),a.geometryClass=o,a.vertexSize=n,a}return ur(e,t),e}(pn)},Object.defineProperty(t,"defaultVertexSrc",{get:function(){return mn},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultFragmentTemplate",{get:function(){return vn},enumerable:!1,configurable:!0}),t}(),gn=yn.create(),_n=function(){function t(e){var r=this;e=Object.assign({forceCanvas:!1},e),this.renderer=an(e),this.stage=new We,t._plugins.forEach((function(t){t.init.call(r,e)}))}return t.registerPlugin=function(e){t._plugins.push(e)},t.prototype.render=function(){this.renderer.render(this.stage)},Object.defineProperty(t.prototype,"view",{get:function(){return this.renderer.view},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"screen",{get:function(){return this.renderer.screen},enumerable:!1,configurable:!0}),t.prototype.destroy=function(e,r){var i=this,n=t._plugins.slice(0);n.reverse(),n.forEach((function(t){t.destroy.call(i)})),this.stage.destroy(r),this.stage=null,this.renderer.destroy(e),this.renderer=null},t}();_n._plugins=[];var xn=function(){function t(){}return t.init=function(t){var e=this;Object.defineProperty(this,"resizeTo",{set:function(t){window.removeEventListener("resize",this.queueResize),this._resizeTo=t,t&&(window.addEventListener("resize",this.queueResize),this.resize())},get:function(){return this._resizeTo}}),this.queueResize=function(){e._resizeTo&&(e.cancelResize(),e._resizeId=requestAnimationFrame((function(){return e.resize()})))},this.cancelResize=function(){e._resizeId&&(cancelAnimationFrame(e._resizeId),e._resizeId=null)},this.resize=function(){if(e._resizeTo){var t,r;if(e.cancelResize(),e._resizeTo===window)t=window.innerWidth,r=window.innerHeight;else{var i=e._resizeTo;t=i.clientWidth,r=i.clientHeight}e.renderer.resize(t,r)}},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null},t.destroy=function(){this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null},t}();_n.registerPlugin(xn);
/*!
	 * @pixi/extract - v5.3.7
	 * Compiled Tue, 29 Dec 2020 19:33:12 UTC
	 *
	 * @pixi/extract is licensed under the MIT License.
	 * http://www.opensource.org/licenses/mit-license
	 */
var bn=new we,wn=function(){function t(t){this.renderer=t,t.extract=this}return t.prototype.image=function(t,e,r){var i=new Image;return i.src=this.base64(t,e,r),i},t.prototype.base64=function(t,e,r){return this.canvas(t).toDataURL(e,r)},t.prototype.canvas=function(e){var r,i,n,o=this.renderer,a=!1,s=!1;e&&(e instanceof Dr?n=e:(n=this.renderer.generateTexture(e),s=!0)),n?(r=n.baseTexture.resolution,i=n.frame,a=!1,o.renderTexture.bind(n)):(r=this.renderer.resolution,a=!0,(i=bn).width=this.renderer.width,i.height=this.renderer.height,o.renderTexture.bind(null));var h=Math.floor(i.width*r+1e-4),l=Math.floor(i.height*r+1e-4),u=new ce(h,l,1),c=new Uint8Array(4*h*l),p=o.gl;p.readPixels(i.x*r,i.y*r,h,l,p.RGBA,p.UNSIGNED_BYTE,c);var d=u.context.getImageData(0,0,h,l);if(t.arrayPostDivide(c,d.data),u.context.putImageData(d,0,0),a){var f=new ce(u.width,u.height,1);f.context.scale(1,-1),f.context.drawImage(u.canvas,0,-l),u.destroy(),u=f}return s&&n.destroy(!0),u.canvas},t.prototype.pixels=function(e){var r,i,n,o=this.renderer,a=!1;e&&(e instanceof Dr?n=e:(n=this.renderer.generateTexture(e),a=!0)),n?(r=n.baseTexture.resolution,i=n.frame,o.renderTexture.bind(n)):(r=o.resolution,(i=bn).width=o.width,i.height=o.height,o.renderTexture.bind(null));var s=i.width*r,h=i.height*r,l=new Uint8Array(4*s*h),u=o.gl;return u.readPixels(i.x*r,i.y*r,s,h,u.RGBA,u.UNSIGNED_BYTE,l),a&&n.destroy(!0),t.arrayPostDivide(l,l),l},t.prototype.destroy=function(){this.renderer.extract=null,this.renderer=null},t.arrayPostDivide=function(t,e){for(var r=0;r<t.length;r+=4){var i=e[r+3]=t[r+3];0!==i?(e[r]=Math.round(Math.min(255*t[r]/i,255)),e[r+1]=Math.round(Math.min(255*t[r+1]/i,255)),e[r+2]=Math.round(Math.min(255*t[r+2]/i,255))):(e[r]=t[r],e[r+1]=t[r+1],e[r+2]=t[r+2])}},t}();var Tn=function(t,e){if(t){e=e||{};for(var r={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},i=r.parser[e.strictMode?"strict":"loose"].exec(t),n={},o=14;o--;)n[r.key[o]]=i[o]||"";return n[r.q.name]={},n[r.key[12]].replace(r.q.parser,(function(t,e,i){e&&(n[r.q.name][e]=i)})),n}},En=function(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}(r((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}();function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var n=function(){function t(e,r,n){void 0===r&&(r=!1),i(this,t),this._fn=e,this._once=r,this._thisArg=n,this._next=this._prev=this._owner=null}return r(t,[{key:"detach",value:function(){return null!==this._owner&&(this._owner.detach(this),!0)}}]),t}();function o(t,e){return t._head?(t._tail._next=e,e._prev=t._tail,t._tail=e):(t._head=e,t._tail=e),e._owner=t,e}var a=function(){function t(){i(this,t),this._head=this._tail=void 0}return r(t,[{key:"handlers",value:function(){var t=!(arguments.length<=0||void 0===arguments[0])&&arguments[0],e=this._head;if(t)return!!e;for(var r=[];e;)r.push(e),e=e._next;return r}},{key:"has",value:function(t){if(!(t instanceof n))throw new Error("MiniSignal#has(): First arg must be a MiniSignalBinding object.");return t._owner===this}},{key:"dispatch",value:function(){var t=arguments,e=this._head;if(!e)return!1;for(;e;)e._once&&this.detach(e),e._fn.apply(e._thisArg,t),e=e._next;return!0}},{key:"add",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if("function"!=typeof t)throw new Error("MiniSignal#add(): First arg must be a Function.");return o(this,new n(t,!1,e))}},{key:"once",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if("function"!=typeof t)throw new Error("MiniSignal#once(): First arg must be a Function.");return o(this,new n(t,!0,e))}},{key:"detach",value:function(t){if(!(t instanceof n))throw new Error("MiniSignal#detach(): First arg must be a MiniSignalBinding object.");return t._owner!==this||(t._prev&&(t._prev._next=t._next),t._next&&(t._next._prev=t._prev),t===this._head?(this._head=t._next,null===t._next&&(this._tail=null)):t===this._tail&&(this._tail=t._prev,this._tail._next=null),t._owner=null),this}},{key:"detachAll",value:function(){var t=this._head;if(!t)return this;for(this._head=this._tail=null;t;)t._owner=null,t=t._next;return this}}]),t}();a.MiniSignalBinding=n,e.default=a,t.exports=e.default})));
/*!
	 * resource-loader - v3.0.1
	 * https://github.com/pixijs/pixi-sound
	 * Compiled Tue, 02 Jul 2019 14:06:18 UTC
	 *
	 * resource-loader is licensed under the MIT license.
	 * http://www.opensource.org/licenses/mit-license
	 */
function Sn(){}function An(t,e,r,i){var n=0,o=t.length;!function a(s){s||n===o?r&&r(s):i?setTimeout((function(){e(t[n++],a)}),1):e(t[n++],a)}()}function In(t){return function(){if(null===t)throw new Error("Callback was already called.");var e=t;t=null,e.apply(this,arguments)}}function Pn(t,e){if(null==e)e=1;else if(0===e)throw new Error("Concurrency must not be zero");var r=0,i={_tasks:[],concurrency:e,saturated:Sn,unsaturated:Sn,buffer:e/4,empty:Sn,drain:Sn,error:Sn,started:!1,paused:!1,push:function(t,e){n(t,!1,e)},kill:function(){r=0,i.drain=Sn,i.started=!1,i._tasks=[]},unshift:function(t,e){n(t,!0,e)},process:function(){for(;!i.paused&&r<i.concurrency&&i._tasks.length;){var e=i._tasks.shift();0===i._tasks.length&&i.empty(),(r+=1)===i.concurrency&&i.saturated(),t(e.data,In(o(e)))}},length:function(){return i._tasks.length},running:function(){return r},idle:function(){return i._tasks.length+r===0},pause:function(){!0!==i.paused&&(i.paused=!0)},resume:function(){if(!1!==i.paused){i.paused=!1;for(var t=1;t<=i.concurrency;t++)i.process()}}};function n(t,e,r){if(null!=r&&"function"!=typeof r)throw new Error("task callback must be a function");if(i.started=!0,null==t&&i.idle())setTimeout((function(){return i.drain()}),1);else{var n={data:t,callback:"function"==typeof r?r:Sn};e?i._tasks.unshift(n):i._tasks.push(n),setTimeout((function(){return i.process()}),1)}}function o(t){return function(){r-=1,t.callback.apply(t,arguments),null!=arguments[0]&&i.error(arguments[0],t.data),r<=i.concurrency-i.buffer&&i.unsaturated(),i.idle()&&i.drain(),i.process()}}return i}var Mn={};function Cn(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Rn(t,e,r){return e&&Cn(t.prototype,e),r&&Cn(t,r),t}var On=!(!window.XDomainRequest||"withCredentials"in new XMLHttpRequest),Dn=null;function Bn(){}var Nn=function(){function t(e,r,i){if("string"!=typeof e||"string"!=typeof r)throw new Error("Both name and url are required for constructing a resource.");i=i||{},this._flags=0,this._setFlag(t.STATUS_FLAGS.DATA_URL,0===r.indexOf("data:")),this.name=e,this.url=r,this.extension=this._getExtension(),this.data=null,this.crossOrigin=!0===i.crossOrigin?"anonymous":i.crossOrigin,this.timeout=i.timeout||0,this.loadType=i.loadType||this._determineLoadType(),this.xhrType=i.xhrType,this.metadata=i.metadata||{},this.error=null,this.xhr=null,this.children=[],this.type=t.TYPE.UNKNOWN,this.progressChunk=0,this._dequeue=Bn,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundOnTimeout=this._onTimeout.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnTimeout=this._xhrOnTimeout.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this.onStart=new En,this.onProgress=new En,this.onComplete=new En,this.onAfterMiddleware=new En}t.setExtensionLoadType=function(e,r){kn(t._loadTypeMap,e,r)},t.setExtensionXhrType=function(e,r){kn(t._xhrTypeMap,e,r)};var e=t.prototype;return e.complete=function(){this._clearEvents(),this._finish()},e.abort=function(e){if(!this.error){if(this.error=new Error(e),this._clearEvents(),this.xhr)this.xhr.abort();else if(this.xdr)this.xdr.abort();else if(this.data)if(this.data.src)this.data.src=t.EMPTY_GIF;else for(;this.data.firstChild;)this.data.removeChild(this.data.firstChild);this._finish()}},e.load=function(e){var r=this;if(!this.isLoading)if(this.isComplete)e&&setTimeout((function(){return e(r)}),1);else switch(e&&this.onComplete.once(e),this._setFlag(t.STATUS_FLAGS.LOADING,!0),this.onStart.dispatch(this),!1!==this.crossOrigin&&"string"==typeof this.crossOrigin||(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case t.LOAD_TYPE.IMAGE:this.type=t.TYPE.IMAGE,this._loadElement("image");break;case t.LOAD_TYPE.AUDIO:this.type=t.TYPE.AUDIO,this._loadSourceElement("audio");break;case t.LOAD_TYPE.VIDEO:this.type=t.TYPE.VIDEO,this._loadSourceElement("video");break;case t.LOAD_TYPE.XHR:default:On&&this.crossOrigin?this._loadXdr():this._loadXhr()}},e._hasFlag=function(t){return 0!=(this._flags&t)},e._setFlag=function(t,e){this._flags=e?this._flags|t:this._flags&~t},e._clearEvents=function(){clearTimeout(this._elementTimer),this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError,!1),this.data.removeEventListener("load",this._boundComplete,!1),this.data.removeEventListener("progress",this._boundOnProgress,!1),this.data.removeEventListener("canplaythrough",this._boundComplete,!1)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError,!1),this.xhr.removeEventListener("timeout",this._boundXhrOnTimeout,!1),this.xhr.removeEventListener("abort",this._boundXhrOnAbort,!1),this.xhr.removeEventListener("progress",this._boundOnProgress,!1),this.xhr.removeEventListener("load",this._boundXhrOnLoad,!1)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null))},e._finish=function(){if(this.isComplete)throw new Error("Complete called again for an already completed resource.");this._setFlag(t.STATUS_FLAGS.COMPLETE,!0),this._setFlag(t.STATUS_FLAGS.LOADING,!1),this.onComplete.dispatch(this)},e._loadElement=function(t){this.metadata.loadElement?this.data=this.metadata.loadElement:"image"===t&&void 0!==window.Image?this.data=new Image:this.data=document.createElement(t),this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.metadata.skipSource||(this.data.src=this.url),this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))},e._loadSourceElement=function(t){if(this.metadata.loadElement?this.data=this.metadata.loadElement:"audio"===t&&void 0!==window.Audio?this.data=new Audio:this.data=document.createElement(t),null!==this.data){if(this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),!this.metadata.skipSource)if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var e=this.metadata.mimeType,r=0;r<this.url.length;++r)this.data.appendChild(this._createSource(t,this.url[r],Array.isArray(e)?e[r]:e));else{var i=this.metadata.mimeType;this.data.appendChild(this._createSource(t,this.url,Array.isArray(i)?i[0]:i))}this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load(),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))}else this.abort("Unsupported element: "+t)},e._loadXhr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var e=this.xhr=new XMLHttpRequest;e.open("GET",this.url,!0),e.timeout=this.timeout,this.xhrType===t.XHR_RESPONSE_TYPE.JSON||this.xhrType===t.XHR_RESPONSE_TYPE.DOCUMENT?e.responseType=t.XHR_RESPONSE_TYPE.TEXT:e.responseType=this.xhrType,e.addEventListener("error",this._boundXhrOnError,!1),e.addEventListener("timeout",this._boundXhrOnTimeout,!1),e.addEventListener("abort",this._boundXhrOnAbort,!1),e.addEventListener("progress",this._boundOnProgress,!1),e.addEventListener("load",this._boundXhrOnLoad,!1),e.send()},e._loadXdr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var t=this.xhr=new XDomainRequest;t.timeout=this.timeout||5e3,t.onerror=this._boundXhrOnError,t.ontimeout=this._boundXhrOnTimeout,t.onprogress=this._boundOnProgress,t.onload=this._boundXhrOnLoad,t.open("GET",this.url,!0),setTimeout((function(){return t.send()}),1)},e._createSource=function(t,e,r){r||(r=t+"/"+this._getExtension(e));var i=document.createElement("source");return i.src=e,i.type=r,i},e._onError=function(t){this.abort("Failed to load element using: "+t.target.nodeName)},e._onProgress=function(t){t&&t.lengthComputable&&this.onProgress.dispatch(this,t.loaded/t.total)},e._onTimeout=function(){this.abort("Load timed out.")},e._xhrOnError=function(){var t=this.xhr;this.abort(Fn(t)+" Request failed. Status: "+t.status+', text: "'+t.statusText+'"')},e._xhrOnTimeout=function(){var t=this.xhr;this.abort(Fn(t)+" Request timed out.")},e._xhrOnAbort=function(){var t=this.xhr;this.abort(Fn(t)+" Request was aborted by the user.")},e._xhrOnLoad=function(){var e=this.xhr,r="",i=void 0===e.status?200:e.status;if(""!==e.responseType&&"text"!==e.responseType&&void 0!==e.responseType||(r=e.responseText),0===i&&(r.length>0||e.responseType===t.XHR_RESPONSE_TYPE.BUFFER)?i=200:1223===i&&(i=204),2===(i/100|0)){if(this.xhrType===t.XHR_RESPONSE_TYPE.TEXT)this.data=r,this.type=t.TYPE.TEXT;else if(this.xhrType===t.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(r),this.type=t.TYPE.JSON}catch(t){return void this.abort("Error trying to parse loaded json: "+t)}else if(this.xhrType===t.XHR_RESPONSE_TYPE.DOCUMENT)try{if(window.DOMParser){var n=new DOMParser;this.data=n.parseFromString(r,"text/xml")}else{var o=document.createElement("div");o.innerHTML=r,this.data=o}this.type=t.TYPE.XML}catch(t){return void this.abort("Error trying to parse loaded xml: "+t)}else this.data=e.response||r;this.complete()}else this.abort("["+e.status+"] "+e.statusText+": "+e.responseURL)},e._determineCrossOrigin=function(t,e){if(0===t.indexOf("data:"))return"";if(window.origin!==window.location.origin)return"anonymous";e=e||window.location,Dn||(Dn=document.createElement("a")),Dn.href=t;var r=!(t=Tn(Dn.href,{strictMode:!0})).port&&""===e.port||t.port===e.port,i=t.protocol?t.protocol+":":"";return t.host===e.hostname&&r&&i===e.protocol?"":"anonymous"},e._determineXhrType=function(){return t._xhrTypeMap[this.extension]||t.XHR_RESPONSE_TYPE.TEXT},e._determineLoadType=function(){return t._loadTypeMap[this.extension]||t.LOAD_TYPE.XHR},e._getExtension=function(){var t=this.url,e="";if(this.isDataUrl){var r=t.indexOf("/");e=t.substring(r+1,t.indexOf(";",r))}else{var i=t.indexOf("?"),n=t.indexOf("#"),o=Math.min(i>-1?i:t.length,n>-1?n:t.length);e=(t=t.substring(0,o)).substring(t.lastIndexOf(".")+1)}return e.toLowerCase()},e._getMimeFromXhrType=function(e){switch(e){case t.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case t.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case t.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case t.XHR_RESPONSE_TYPE.JSON:return"application/json";case t.XHR_RESPONSE_TYPE.DEFAULT:case t.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}},Rn(t,[{key:"isDataUrl",get:function(){return this._hasFlag(t.STATUS_FLAGS.DATA_URL)}},{key:"isComplete",get:function(){return this._hasFlag(t.STATUS_FLAGS.COMPLETE)}},{key:"isLoading",get:function(){return this._hasFlag(t.STATUS_FLAGS.LOADING)}}]),t}();function kn(t,e,r){e&&0===e.indexOf(".")&&(e=e.substring(1)),e&&(t[e]=r)}function Fn(t){return t.toString().replace("object ","")}Nn.STATUS_FLAGS={NONE:0,DATA_URL:1,COMPLETE:2,LOADING:4},Nn.TYPE={UNKNOWN:0,JSON:1,XML:2,IMAGE:3,AUDIO:4,VIDEO:5,TEXT:6},Nn.LOAD_TYPE={XHR:1,IMAGE:2,AUDIO:3,VIDEO:4},Nn.XHR_RESPONSE_TYPE={DEFAULT:"text",BUFFER:"arraybuffer",BLOB:"blob",DOCUMENT:"document",JSON:"json",TEXT:"text"},Nn._loadTypeMap={gif:Nn.LOAD_TYPE.IMAGE,png:Nn.LOAD_TYPE.IMAGE,bmp:Nn.LOAD_TYPE.IMAGE,jpg:Nn.LOAD_TYPE.IMAGE,jpeg:Nn.LOAD_TYPE.IMAGE,tif:Nn.LOAD_TYPE.IMAGE,tiff:Nn.LOAD_TYPE.IMAGE,webp:Nn.LOAD_TYPE.IMAGE,tga:Nn.LOAD_TYPE.IMAGE,svg:Nn.LOAD_TYPE.IMAGE,"svg+xml":Nn.LOAD_TYPE.IMAGE,mp3:Nn.LOAD_TYPE.AUDIO,ogg:Nn.LOAD_TYPE.AUDIO,wav:Nn.LOAD_TYPE.AUDIO,mp4:Nn.LOAD_TYPE.VIDEO,webm:Nn.LOAD_TYPE.VIDEO},Nn._xhrTypeMap={xhtml:Nn.XHR_RESPONSE_TYPE.DOCUMENT,html:Nn.XHR_RESPONSE_TYPE.DOCUMENT,htm:Nn.XHR_RESPONSE_TYPE.DOCUMENT,xml:Nn.XHR_RESPONSE_TYPE.DOCUMENT,tmx:Nn.XHR_RESPONSE_TYPE.DOCUMENT,svg:Nn.XHR_RESPONSE_TYPE.DOCUMENT,tsx:Nn.XHR_RESPONSE_TYPE.DOCUMENT,gif:Nn.XHR_RESPONSE_TYPE.BLOB,png:Nn.XHR_RESPONSE_TYPE.BLOB,bmp:Nn.XHR_RESPONSE_TYPE.BLOB,jpg:Nn.XHR_RESPONSE_TYPE.BLOB,jpeg:Nn.XHR_RESPONSE_TYPE.BLOB,tif:Nn.XHR_RESPONSE_TYPE.BLOB,tiff:Nn.XHR_RESPONSE_TYPE.BLOB,webp:Nn.XHR_RESPONSE_TYPE.BLOB,tga:Nn.XHR_RESPONSE_TYPE.BLOB,json:Nn.XHR_RESPONSE_TYPE.JSON,text:Nn.XHR_RESPONSE_TYPE.TEXT,txt:Nn.XHR_RESPONSE_TYPE.TEXT,ttf:Nn.XHR_RESPONSE_TYPE.BUFFER,otf:Nn.XHR_RESPONSE_TYPE.BUFFER},Nn.EMPTY_GIF="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==";var Ln=window.URL||window.webkitURL;var Vn={caching:function(t,e){var r=this;Mn[t.url]?(t.data=Mn[t.url],t.complete()):t.onComplete.once((function(){return Mn[r.url]=r.data})),e()},parsing:function(t,e){if(t.data){if(t.xhr&&t.xhrType===Nn.XHR_RESPONSE_TYPE.BLOB)if(window.Blob&&"string"!=typeof t.data){if(0===t.data.type.indexOf("image")){var r=Ln.createObjectURL(t.data);return t.blob=t.data,t.data=new Image,t.data.src=r,t.type=Nn.TYPE.IMAGE,void(t.data.onload=function(){Ln.revokeObjectURL(r),t.data.onload=null,e()})}}else{var i=t.xhr.getResponseHeader("content-type");if(i&&0===i.indexOf("image"))return t.data=new Image,t.data.src="data:"+i+";base64,"+function(t){for(var e="",r=0;r<t.length;){for(var i=[0,0,0],n=[0,0,0,0],o=0;o<i.length;++o)r<t.length?i[o]=255&t.charCodeAt(r++):i[o]=0;switch(n[0]=i[0]>>2,n[1]=(3&i[0])<<4|i[1]>>4,n[2]=(15&i[1])<<2|i[2]>>6,n[3]=63&i[2],r-(t.length-1)){case 2:n[3]=64,n[2]=64;break;case 1:n[3]=64}for(var a=0;a<n.length;++a)e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(n[a])}return e}(t.xhr.responseText),t.type=Nn.TYPE.IMAGE,void(t.data.onload=function(){t.data.onload=null,e()})}e()}else e()}},Xn=/(#[\w-]+)?$/,jn=function(){function t(e,r){var i=this;void 0===e&&(e=""),void 0===r&&(r=10),this.baseUrl=e,this.progress=0,this.loading=!1,this.defaultQueryString="",this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(t,e){return i._loadResource(t,e)},this._queue=Pn(this._boundLoadResource,r),this._queue.pause(),this.resources={},this.onProgress=new En,this.onError=new En,this.onLoad=new En,this.onStart=new En,this.onComplete=new En;for(var n=0;n<t._defaultBeforeMiddleware.length;++n)this.pre(t._defaultBeforeMiddleware[n]);for(var o=0;o<t._defaultAfterMiddleware.length;++o)this.use(t._defaultAfterMiddleware[o])}var e=t.prototype;return e.add=function(t,e,r,i){if(Array.isArray(t)){for(var n=0;n<t.length;++n)this.add(t[n]);return this}if("object"==typeof t&&(i=e||t.callback||t.onComplete,r=t,e=t.url,t=t.name||t.key||t.url),"string"!=typeof e&&(i=r,r=e,e=t),"string"!=typeof e)throw new Error("No url passed to add resource to loader.");if("function"==typeof r&&(i=r,r=null),this.loading&&(!r||!r.parentResource))throw new Error("Cannot add resources while the loader is running.");if(this.resources[t])throw new Error('Resource named "'+t+'" already exists.');if(e=this._prepareUrl(e),this.resources[t]=new Nn(t,e,r),"function"==typeof i&&this.resources[t].onAfterMiddleware.once(i),this.loading){for(var o=r.parentResource,a=[],s=0;s<o.children.length;++s)o.children[s].isComplete||a.push(o.children[s]);var h=o.progressChunk*(a.length+1)/(a.length+2);o.children.push(this.resources[t]),o.progressChunk=h;for(var l=0;l<a.length;++l)a[l].progressChunk=h;this.resources[t].progressChunk=h}return this._queue.push(this.resources[t]),this},e.pre=function(t){return this._beforeMiddleware.push(t),this},e.use=function(t){return this._afterMiddleware.push(t),this},e.reset=function(){for(var t in this.progress=0,this.loading=!1,this._queue.kill(),this._queue.pause(),this.resources){var e=this.resources[t];e._onLoadBinding&&e._onLoadBinding.detach(),e.isLoading&&e.abort()}return this.resources={},this},e.load=function(t){if("function"==typeof t&&this.onComplete.once(t),this.loading)return this;if(this._queue.idle())this._onStart(),this._onComplete();else{for(var e=100/this._queue._tasks.length,r=0;r<this._queue._tasks.length;++r)this._queue._tasks[r].data.progressChunk=e;this._onStart(),this._queue.resume()}return this},e._prepareUrl=function(t){var e,r=Tn(t,{strictMode:!0});if(e=r.protocol||!r.path||0===t.indexOf("//")?t:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&"/"!==t.charAt(0)?this.baseUrl+"/"+t:this.baseUrl+t,this.defaultQueryString){var i=Xn.exec(e)[0];-1!==(e=e.substr(0,e.length-i.length)).indexOf("?")?e+="&"+this.defaultQueryString:e+="?"+this.defaultQueryString,e+=i}return e},e._loadResource=function(t,e){var r=this;t._dequeue=e,An(this._beforeMiddleware,(function(e,i){e.call(r,t,(function(){i(t.isComplete?{}:null)}))}),(function(){t.isComplete?r._onLoad(t):(t._onLoadBinding=t.onComplete.once(r._onLoad,r),t.load())}),!0)},e._onStart=function(){this.progress=0,this.loading=!0,this.onStart.dispatch(this)},e._onComplete=function(){this.progress=100,this.loading=!1,this.onComplete.dispatch(this,this.resources)},e._onLoad=function(t){var e=this;t._onLoadBinding=null,this._resourcesParsing.push(t),t._dequeue(),An(this._afterMiddleware,(function(r,i){r.call(e,t,i)}),(function(){t.onAfterMiddleware.dispatch(t),e.progress=Math.min(100,e.progress+t.progressChunk),e.onProgress.dispatch(e,t),t.error?e.onError.dispatch(t.error,e,t):e.onLoad.dispatch(e,t),e._resourcesParsing.splice(e._resourcesParsing.indexOf(t),1),e._queue.idle()&&0===e._resourcesParsing.length&&e._onComplete()}),!0)},Rn(t,[{key:"concurrency",get:function(){return this._queue.concurrency},set:function(t){this._queue.concurrency=t}}]),t}();jn._defaultBeforeMiddleware=[],jn._defaultAfterMiddleware=[],jn.pre=function(t){return jn._defaultBeforeMiddleware.push(t),jn},jn.use=function(t){return jn._defaultAfterMiddleware.push(t),jn};
/*!
	 * @pixi/loaders - v5.3.7
	 * Compiled Tue, 29 Dec 2020 19:33:12 UTC
	 *
	 * @pixi/loaders is licensed under the MIT License.
	 * http://www.opensource.org/licenses/mit-license
	 */
var Un=Nn,Yn=function(t,e){return(Yn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};
/*! *****************************************************************************
	Copyright (c) Microsoft Corporation. All rights reserved.
	Licensed under the Apache License, Version 2.0 (the "License"); you may not use
	this file except in compliance with the License. You may obtain a copy of the
	License at http://www.apache.org/licenses/LICENSE-2.0

	THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
	KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
	WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
	MERCHANTABLITY OR NON-INFRINGEMENT.

	See the Apache Version 2.0 License for specific language governing permissions
	and limitations under the License.
	***************************************************************************** */var zn=function(){function t(){}return t.use=function(t,e){t.data&&t.type===Nn.TYPE.IMAGE&&(t.texture=Rr.fromLoader(t.data,t.url,t.name)),e()},t}(),Wn=function(t){function e(r,i){for(var n=t.call(this,r,i)||this,o=0;o<e._plugins.length;++o){var a=e._plugins[o],s=a.pre,h=a.use;s&&n.pre(s),h&&n.use(h)}return n._protected=!1,n}return function(t,e){function r(){this.constructor=t}Yn(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}(e,t),e.prototype.destroy=function(){this._protected||this.reset()},Object.defineProperty(e,"shared",{get:function(){var t=e._shared;return t||((t=new e)._protected=!0,e._shared=t),t},enumerable:!1,configurable:!0}),e.registerPlugin=function(t){return e._plugins.push(t),t.add&&t.add(),e},e._plugins=[],e}(jn);Wn.registerPlugin({use:Vn.parsing}),Wn.registerPlugin(zn);var qn=function(){function t(){}return t.init=function(t){t=Object.assign({sharedLoader:!1},t),this.loader=t.sharedLoader?Wn.shared:new Wn},t.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},t}(),Gn=function(t,e){return(Gn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};
/*!
	 * @pixi/particles - v5.3.7
	 * Compiled Tue, 29 Dec 2020 19:33:12 UTC
	 *
	 * @pixi/particles is licensed under the MIT License.
	 * http://www.opensource.org/licenses/mit-license
	 */
/*! *****************************************************************************
	Copyright (c) Microsoft Corporation. All rights reserved.
	Licensed under the Apache License, Version 2.0 (the "License"); you may not use
	this file except in compliance with the License. You may obtain a copy of the
	License at http://www.apache.org/licenses/LICENSE-2.0

	THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
	KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
	WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
	MERCHANTABLITY OR NON-INFRINGEMENT.

	See the Apache Version 2.0 License for specific language governing permissions
	and limitations under the License.
	***************************************************************************** */function Hn(t,e){function r(){this.constructor=t}Gn(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var $n,Jn,Zn=function(e){function r(r,i,n,o){void 0===r&&(r=1500),void 0===n&&(n=16384),void 0===o&&(o=!1);var a=e.call(this)||this;return n>16384&&(n=16384),a._properties=[!1,!0,!1,!1,!1],a._maxSize=r,a._batchSize=n,a._buffers=null,a._bufferUpdateIDs=[],a._updateID=0,a.interactiveChildren=!1,a.blendMode=t.BLEND_MODES.NORMAL,a.autoResize=o,a.roundPixels=!0,a.baseTexture=null,a.setProperties(i),a._tint=0,a.tintRgb=new Float32Array(4),a.tint=16777215,a}return Hn(r,e),r.prototype.setProperties=function(t){t&&(this._properties[0]="vertices"in t||"scale"in t?!!t.vertices||!!t.scale:this._properties[0],this._properties[1]="position"in t?!!t.position:this._properties[1],this._properties[2]="rotation"in t?!!t.rotation:this._properties[2],this._properties[3]="uvs"in t?!!t.uvs:this._properties[3],this._properties[4]="tint"in t||"alpha"in t?!!t.tint||!!t.alpha:this._properties[4])},r.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},Object.defineProperty(r.prototype,"tint",{get:function(){return this._tint},set:function(t){this._tint=t,Ut(t,this.tintRgb)},enumerable:!1,configurable:!0}),r.prototype.render=function(t){var e=this;this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable&&(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.valid||this.baseTexture.once("update",(function(){return e.onChildrenChange(0)}))),t.batch.setObjectRenderer(t.plugins.particle),t.plugins.particle.render(this))},r.prototype.onChildrenChange=function(t){for(var e=Math.floor(t/this._batchSize);this._bufferUpdateIDs.length<e;)this._bufferUpdateIDs.push(0);this._bufferUpdateIDs[e]=++this._updateID},r.prototype.dispose=function(){if(this._buffers){for(var t=0;t<this._buffers.length;++t)this._buffers[t].destroy();this._buffers=null}},r.prototype.destroy=function(t){e.prototype.destroy.call(this,t),this.dispose(),this._properties=null,this._buffers=null,this._bufferUpdateIDs=null},r}(We),Qn=function(){function e(e,r,i){this.geometry=new Yr,this.indexBuffer=null,this.size=i,this.dynamicProperties=[],this.staticProperties=[];for(var n=0;n<e.length;++n){var o=e[n];o={attributeName:o.attributeName,size:o.size,uploadFunction:o.uploadFunction,type:o.type||t.TYPES.FLOAT,offset:o.offset},r[n]?this.dynamicProperties.push(o):this.staticProperties.push(o)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}return e.prototype.initBuffers=function(){var e=this.geometry,r=0;this.indexBuffer=new Fr(Jt(this.size),!0,!0),e.addIndex(this.indexBuffer),this.dynamicStride=0;for(var i=0;i<this.dynamicProperties.length;++i){(s=this.dynamicProperties[i]).offset=r,r+=s.size,this.dynamicStride+=s.size}var n=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(n),this.dynamicDataUint32=new Uint32Array(n),this.dynamicBuffer=new Fr(this.dynamicData,!1,!1);var o=0;this.staticStride=0;for(i=0;i<this.staticProperties.length;++i){(s=this.staticProperties[i]).offset=o,o+=s.size,this.staticStride+=s.size}var a=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(a),this.staticDataUint32=new Uint32Array(a),this.staticBuffer=new Fr(this.staticData,!0,!1);for(i=0;i<this.dynamicProperties.length;++i){var s=this.dynamicProperties[i];e.addAttribute(s.attributeName,this.dynamicBuffer,0,s.type===t.TYPES.UNSIGNED_BYTE,s.type,4*this.dynamicStride,4*s.offset)}for(i=0;i<this.staticProperties.length;++i){s=this.staticProperties[i];e.addAttribute(s.attributeName,this.staticBuffer,0,s.type===t.TYPES.UNSIGNED_BYTE,s.type,4*this.staticStride,4*s.offset)}},e.prototype.uploadDynamic=function(e,r,i){for(var n=0;n<this.dynamicProperties.length;n++){var o=this.dynamicProperties[n];o.uploadFunction(e,r,i,o.type===t.TYPES.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,o.offset)}this.dynamicBuffer._updateID++},e.prototype.uploadStatic=function(e,r,i){for(var n=0;n<this.staticProperties.length;n++){var o=this.staticProperties[n];o.uploadFunction(e,r,i,o.type===t.TYPES.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,o.offset)}this.staticBuffer._updateID++},e.prototype.destroy=function(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()},e}(),Kn=function(e){function r(r){var i=e.call(this,r)||this;return i.shader=null,i.properties=null,i.tempMatrix=new Me,i.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:i.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:i.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:i.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:i.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:t.TYPES.UNSIGNED_BYTE,uploadFunction:i.uploadTint,offset:0}],i.shader=Ri.from("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nattribute vec2 aPositionCoord;\nattribute float aRotation;\n\nuniform mat3 translationMatrix;\nuniform vec4 uColor;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvoid main(void){\n    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);\n    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);\n\n    vec2 v = vec2(x, y);\n    v = v + aPositionCoord;\n\n    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vColor = aColor * uColor;\n}\n","varying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;\n    gl_FragColor = color;\n}",{}),i.state=Oi.for2d(),i}return Hn(r,e),r.prototype.render=function(t){var e=t.children,r=t._maxSize,i=t._batchSize,n=this.renderer,o=e.length;if(0!==o){o>r&&!t.autoResize&&(o=r);var a=t._buffers;a||(a=t._buffers=this.generateBuffers(t));var s=e[0]._texture.baseTexture;this.state.blendMode=qt(t.blendMode,s.alphaMode),n.state.set(this.state);var h=n.gl,l=t.worldTransform.copyTo(this.tempMatrix);l.prepend(n.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=l.toArray(!0),this.shader.uniforms.uColor=Gt(t.tintRgb,t.worldAlpha,this.shader.uniforms.uColor,s.alphaMode),this.shader.uniforms.uSampler=s,this.renderer.shader.bind(this.shader);for(var u=!1,c=0,p=0;c<o;c+=i,p+=1){var d=o-c;d>i&&(d=i),p>=a.length&&a.push(this._generateOneMoreBuffer(t));var f=a[p];f.uploadDynamic(e,c,d);var m=t._bufferUpdateIDs[p]||0;(u=u||f._updateID<m)&&(f._updateID=t._updateID,f.uploadStatic(e,c,d)),n.geometry.bind(f.geometry),h.drawElements(h.TRIANGLES,6*d,h.UNSIGNED_SHORT,0)}}},r.prototype.generateBuffers=function(t){for(var e=[],r=t._maxSize,i=t._batchSize,n=t._properties,o=0;o<r;o+=i)e.push(new Qn(this.properties,n,i));return e},r.prototype._generateOneMoreBuffer=function(t){var e=t._batchSize,r=t._properties;return new Qn(this.properties,r,e)},r.prototype.uploadVertices=function(t,e,r,i,n,o){for(var a=0,s=0,h=0,l=0,u=0;u<r;++u){var c=t[e+u],p=c._texture,d=c.scale.x,f=c.scale.y,m=p.trim,v=p.orig;m?(a=(s=m.x-c.anchor.x*v.width)+m.width,h=(l=m.y-c.anchor.y*v.height)+m.height):(a=v.width*(1-c.anchor.x),s=v.width*-c.anchor.x,h=v.height*(1-c.anchor.y),l=v.height*-c.anchor.y),i[o]=s*d,i[o+1]=l*f,i[o+n]=a*d,i[o+n+1]=l*f,i[o+2*n]=a*d,i[o+2*n+1]=h*f,i[o+3*n]=s*d,i[o+3*n+1]=h*f,o+=4*n}},r.prototype.uploadPosition=function(t,e,r,i,n,o){for(var a=0;a<r;a++){var s=t[e+a].position;i[o]=s.x,i[o+1]=s.y,i[o+n]=s.x,i[o+n+1]=s.y,i[o+2*n]=s.x,i[o+2*n+1]=s.y,i[o+3*n]=s.x,i[o+3*n+1]=s.y,o+=4*n}},r.prototype.uploadRotation=function(t,e,r,i,n,o){for(var a=0;a<r;a++){var s=t[e+a].rotation;i[o]=s,i[o+n]=s,i[o+2*n]=s,i[o+3*n]=s,o+=4*n}},r.prototype.uploadUvs=function(t,e,r,i,n,o){for(var a=0;a<r;++a){var s=t[e+a]._texture._uvs;s?(i[o]=s.x0,i[o+1]=s.y0,i[o+n]=s.x1,i[o+n+1]=s.y1,i[o+2*n]=s.x2,i[o+2*n+1]=s.y2,i[o+3*n]=s.x3,i[o+3*n+1]=s.y3,o+=4*n):(i[o]=0,i[o+1]=0,i[o+n]=0,i[o+n+1]=0,i[o+2*n]=0,i[o+2*n+1]=0,i[o+3*n]=0,i[o+3*n+1]=0,o+=4*n)}},r.prototype.uploadTint=function(t,e,r,i,n,o){for(var a=0;a<r;++a){var s=t[e+a],h=s._texture.baseTexture.alphaMode>0,l=s.alpha,u=l<1&&h?Ht(s._tintRGB,l):s._tintRGB+(255*l<<24);i[o]=u,i[o+n]=u,i[o+2*n]=u,i[o+3*n]=u,o+=4*n}},r.prototype.destroy=function(){e.prototype.destroy.call(this),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null},r}(Jr);(
/*!
	 * @pixi/graphics - v5.3.7
	 * Compiled Tue, 29 Dec 2020 19:33:12 UTC
	 *
	 * @pixi/graphics is licensed under the MIT License.
	 * http://www.opensource.org/licenses/mit-license
	 */
$n=t.LINE_JOIN||(t.LINE_JOIN={})).MITER="miter",$n.BEVEL="bevel",$n.ROUND="round",(Jn=t.LINE_CAP||(t.LINE_CAP={})).BUTT="butt",Jn.ROUND="round",Jn.SQUARE="square";var to={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount:function(t,e){if(void 0===e&&(e=20),!this.adaptive||!t||isNaN(t))return e;var r=Math.ceil(t/this.maxLength);return r<this.minSegments?r=this.minSegments:r>this.maxSegments&&(r=this.maxSegments),r}},eo=function(){function t(){this.color=16777215,this.alpha=1,this.texture=Rr.WHITE,this.matrix=null,this.visible=!1,this.reset()}return t.prototype.clone=function(){var e=new t;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e},t.prototype.reset=function(){this.color=16777215,this.alpha=1,this.texture=Rr.WHITE,this.matrix=null,this.visible=!1},t.prototype.destroy=function(){this.texture=null,this.matrix=null},t}(),ro=function(t,e){return(ro=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function io(t,e){function r(){this.constructor=t}ro(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var no={build:function(t){t.points=t.shape.points.slice()},triangulate:function(t,e){var r=t.points,i=t.holes,n=e.points,o=e.indices;if(r.length>=6){for(var a=[],s=0;s<i.length;s++){var h=i[s];a.push(r.length/2),r=r.concat(h.points)}var l=B(r,a,2);if(!l)return;var u=n.length/2;for(s=0;s<l.length;s+=3)o.push(l[s]+u),o.push(l[s+1]+u),o.push(l[s+2]+u);for(s=0;s<r.length;s++)n.push(r[s])}}},oo={build:function(e){var r,i,n=e.shape,o=e.points,a=n.x,s=n.y;if(o.length=0,e.type===t.SHAPES.CIRC)r=n.radius,i=n.radius;else{var h=e.shape;r=h.width,i=h.height}if(0!==r&&0!==i){var l=Math.floor(30*Math.sqrt(n.radius))||Math.floor(15*Math.sqrt(r+i));l/=2.3;for(var u=2*Math.PI/l,c=0;c<l-.5;c++)o.push(a+Math.sin(-u*c)*r,s+Math.cos(-u*c)*i);o.push(o[0],o[1])}},triangulate:function(t,e){var r=t.points,i=e.points,n=e.indices,o=i.length/2,a=o,s=t.shape,h=t.matrix,l=s.x,u=s.y;i.push(t.matrix?h.a*l+h.c*u+h.tx:l,t.matrix?h.b*l+h.d*u+h.ty:u);for(var c=0;c<r.length;c+=2)i.push(r[c],r[c+1]),n.push(o++,a,o)}},ao={build:function(t){var e=t.shape,r=e.x,i=e.y,n=e.width,o=e.height,a=t.points;a.length=0,a.push(r,i,r+n,i,r+n,i+o,r,i+o)},triangulate:function(t,e){var r=t.points,i=e.points,n=i.length/2;i.push(r[0],r[1],r[2],r[3],r[6],r[7],r[4],r[5]),e.indices.push(n,n+1,n+2,n+1,n+2,n+3)}};function so(t,e,r){return t+(e-t)*r}function ho(t,e,r,i,n,o,a){void 0===a&&(a=[]);for(var s=a,h=0,l=0,u=0,c=0,p=0,d=0,f=0,m=0;f<=20;++f)h=so(t,r,m=f/20),l=so(e,i,m),u=so(r,n,m),c=so(i,o,m),p=so(h,u,m),d=so(l,c,m),s.push(p,d);return s}var lo={build:function(t){var e=t.shape,r=t.points,i=e.x,n=e.y,o=e.width,a=e.height,s=Math.max(0,Math.min(e.radius,Math.min(o,a)/2));r.length=0,s?(ho(i,n+s,i,n,i+s,n,r),ho(i+o-s,n,i+o,n,i+o,n+s,r),ho(i+o,n+a-s,i+o,n+a,i+o-s,n+a,r),ho(i+s,n+a,i,n+a,i,n+a-s,r)):r.push(i,n,i+o,n,i+o,n+a,i,n+a)},triangulate:function(t,e){for(var r=t.points,i=e.points,n=e.indices,o=i.length/2,a=B(r,null,2),s=0,h=a.length;s<h;s+=3)n.push(a[s]+o),n.push(a[s+1]+o),n.push(a[s+2]+o);for(s=0,h=r.length;s<h;s++)i.push(r[s],r[++s])}};function uo(t,e,r,i,n,o,a,s){var h,l;a?(h=i,l=-r):(h=-i,l=r);var u=t-r*n+h,c=e-i*n+l,p=t+r*o+h,d=e+i*o+l;return s.push(u,c),s.push(p,d),2}function co(t,e,r,i,n,o,a,s){var h=r-t,l=i-e,u=Math.atan2(h,l),c=Math.atan2(n-t,o-e);s&&u<c?u+=2*Math.PI:!s&&u>c&&(c+=2*Math.PI);var p=u,d=c-u,f=Math.abs(d),m=Math.sqrt(h*h+l*l),v=1+(15*f*Math.sqrt(m)/Math.PI>>0),y=d/v;if(p+=y,s){a.push(t,e),a.push(r,i);for(var g=1,_=p;g<v;g++,_+=y)a.push(t,e),a.push(t+Math.sin(_)*m,e+Math.cos(_)*m);a.push(t,e),a.push(n,o)}else{a.push(r,i),a.push(t,e);for(g=1,_=p;g<v;g++,_+=y)a.push(t+Math.sin(_)*m,e+Math.cos(_)*m),a.push(t,e);a.push(n,o),a.push(t,e)}return 2*v}function po(e,r){e.lineStyle.native?function(e,r){var i=0,n=e.shape,o=e.points||n.points,a=n.type!==t.SHAPES.POLY||n.closeStroke;if(0!==o.length){var s=r.points,h=r.indices,l=o.length/2,u=s.length/2,c=u;for(s.push(o[0],o[1]),i=1;i<l;i++)s.push(o[2*i],o[2*i+1]),h.push(c,c+1),c++;a&&h.push(c,u)}}(e,r):function(e,r){var i=e.shape,n=e.points||i.points.slice(),o=r.closePointEps;if(0!==n.length){var a=e.lineStyle,s=new Ie(n[0],n[1]),h=new Ie(n[n.length-2],n[n.length-1]),l=i.type!==t.SHAPES.POLY||i.closeStroke,u=Math.abs(s.x-h.x)<o&&Math.abs(s.y-h.y)<o;if(l){n=n.slice(),u&&(n.pop(),n.pop(),h.set(n[n.length-2],n[n.length-1]));var c=.5*(s.x+h.x),p=.5*(h.y+s.y);n.unshift(c,p),n.push(c,p)}var d=r.points,f=n.length/2,m=n.length,v=d.length/2,y=a.width/2,g=y*y,_=a.miterLimit*a.miterLimit,x=n[0],b=n[1],w=n[2],T=n[3],E=0,S=0,A=-(b-T),I=x-w,P=0,M=0,C=Math.sqrt(A*A+I*I);A/=C,I/=C,A*=y,I*=y;var R=a.alignment,O=2*(1-R),D=2*R;l||(a.cap===t.LINE_CAP.ROUND?m+=co(x-A*(O-D)*.5,b-I*(O-D)*.5,x-A*O,b-I*O,x+A*D,b+I*D,d,!0)+2:a.cap===t.LINE_CAP.SQUARE&&(m+=uo(x,b,A,I,O,D,!0,d))),d.push(x-A*O,b-I*O),d.push(x+A*D,b+I*D);for(var B=1;B<f-1;++B){x=n[2*(B-1)],b=n[2*(B-1)+1],w=n[2*B],T=n[2*B+1],E=n[2*(B+1)],S=n[2*(B+1)+1],A=-(b-T),I=x-w,A/=C=Math.sqrt(A*A+I*I),I/=C,A*=y,I*=y,P=-(T-S),M=w-E,P/=C=Math.sqrt(P*P+M*M),M/=C,P*=y,M*=y;var N=w-x,k=b-T,F=w-E,L=S-T,V=k*F-L*N,X=V<0;if(Math.abs(V)<.1)d.push(w-A*O,T-I*O),d.push(w+A*D,T+I*D);else{var j=(-A+x)*(-I+T)-(-A+w)*(-I+b),U=(-P+E)*(-M+T)-(-P+w)*(-M+S),Y=(N*U-F*j)/V,z=(L*j-k*U)/V,W=(Y-w)*(Y-w)+(z-T)*(z-T),q=w+(Y-w)*O,G=T+(z-T)*O,H=w-(Y-w)*D,$=T-(z-T)*D,J=X?O:D;W<=Math.min(N*N+k*k,F*F+L*L)+J*J*g?a.join===t.LINE_JOIN.BEVEL||W/g>_?(X?(d.push(q,G),d.push(w+A*D,T+I*D),d.push(q,G),d.push(w+P*D,T+M*D)):(d.push(w-A*O,T-I*O),d.push(H,$),d.push(w-P*O,T-M*O),d.push(H,$)),m+=2):a.join===t.LINE_JOIN.ROUND?X?(d.push(q,G),d.push(w+A*D,T+I*D),m+=co(w,T,w+A*D,T+I*D,w+P*D,T+M*D,d,!0)+4,d.push(q,G),d.push(w+P*D,T+M*D)):(d.push(w-A*O,T-I*O),d.push(H,$),m+=co(w,T,w-A*O,T-I*O,w-P*O,T-M*O,d,!1)+4,d.push(w-P*O,T-M*O),d.push(H,$)):(d.push(q,G),d.push(H,$)):(d.push(w-A*O,T-I*O),d.push(w+A*D,T+I*D),a.join===t.LINE_JOIN.BEVEL||W/g>_||(a.join===t.LINE_JOIN.ROUND?m+=X?co(w,T,w+A*D,T+I*D,w+P*D,T+M*D,d,!0)+2:co(w,T,w-A*O,T-I*O,w-P*O,T-M*O,d,!1)+2:(X?(d.push(H,$),d.push(H,$)):(d.push(q,G),d.push(q,G)),m+=2)),d.push(w-P*O,T-M*O),d.push(w+P*D,T+M*D),m+=2)}}x=n[2*(f-2)],b=n[2*(f-2)+1],w=n[2*(f-1)],A=-(b-(T=n[2*(f-1)+1])),I=x-w,A/=C=Math.sqrt(A*A+I*I),I/=C,A*=y,I*=y,d.push(w-A*O,T-I*O),d.push(w+A*D,T+I*D),l||(a.cap===t.LINE_CAP.ROUND?m+=co(w-A*(O-D)*.5,T-I*(O-D)*.5,w-A*O,T-I*O,w+A*D,T+I*D,d,!1)+2:a.cap===t.LINE_CAP.SQUARE&&(m+=uo(w,T,A,I,O,D,!1,d)));var Z=r.indices,Q=to.epsilon*to.epsilon;for(B=v;B<m+v-2;++B)x=d[2*B],b=d[2*B+1],w=d[2*(B+1)],T=d[2*(B+1)+1],E=d[2*(B+2)],S=d[2*(B+2)+1],Math.abs(x*(T-S)+w*(S-b)+E*(b-T))<Q||Z.push(B,B+1,B+2)}}(e,r)}var fo,mo=function(t){function e(e,r,i,n,o,a){void 0===a&&(a=0);o=o||n/2;for(var s=-1*Math.PI/2+a,h=2*i,l=_e/h,u=[],c=0;c<h;c++){var p=c%2?o:n,d=c*l+s;u.push(e+p*Math.cos(d),r+p*Math.sin(d))}return t.call(this,u)||this}return io(e,t),e}(Se),vo=function(){function t(){}return t.curveTo=function(t,e,r,i,n,o){var a=o[o.length-2],s=o[o.length-1]-e,h=a-t,l=i-e,u=r-t,c=Math.abs(s*u-h*l);if(c<1e-8||0===n)return o[o.length-2]===t&&o[o.length-1]===e||o.push(t,e),null;var p=s*s+h*h,d=l*l+u*u,f=s*l+h*u,m=n*Math.sqrt(p)/c,v=n*Math.sqrt(d)/c,y=m*f/p,g=v*f/d,_=m*u+v*h,x=m*l+v*s,b=h*(v+y),w=s*(v+y),T=u*(m+g),E=l*(m+g);return{cx:_+t,cy:x+e,radius:n,startAngle:Math.atan2(w-x,b-_),endAngle:Math.atan2(E-x,T-_),anticlockwise:h*l>u*s}},t.arc=function(t,e,r,i,n,o,a,s,h){for(var l=a-o,u=to._segmentsCount(Math.abs(l)*n,40*Math.ceil(Math.abs(l)/_e)),c=l/(2*u),p=2*c,d=Math.cos(c),f=Math.sin(c),m=u-1,v=m%1/m,y=0;y<=m;++y){var g=c+o+p*(y+v*y),_=Math.cos(g),x=-Math.sin(g);h.push((d*_+f*x)*n+r,(d*-x+f*_)*n+i)}},t}(),yo=function(){function t(){}return t.curveLength=function(t,e,r,i,n,o,a,s){for(var h=0,l=0,u=0,c=0,p=0,d=0,f=0,m=0,v=0,y=0,g=0,_=t,x=e,b=1;b<=10;++b)y=_-(m=(f=(d=(p=1-(l=b/10))*p)*p)*t+3*d*l*r+3*p*(u=l*l)*n+(c=u*l)*a),g=x-(v=f*e+3*d*l*i+3*p*u*o+c*s),_=m,x=v,h+=Math.sqrt(y*y+g*g);return h},t.curveTo=function(e,r,i,n,o,a,s){var h=s[s.length-2],l=s[s.length-1];s.length-=2;var u=to._segmentsCount(t.curveLength(h,l,e,r,i,n,o,a)),c=0,p=0,d=0,f=0,m=0;s.push(h,l);for(var v=1,y=0;v<=u;++v)d=(p=(c=1-(y=v/u))*c)*c,m=(f=y*y)*y,s.push(d*h+3*p*y*e+3*c*f*i+m*o,d*l+3*p*y*r+3*c*f*n+m*a)},t}(),go=function(){function t(){}return t.curveLength=function(t,e,r,i,n,o){var a=t-2*r+n,s=e-2*i+o,h=2*r-2*t,l=2*i-2*e,u=4*(a*a+s*s),c=4*(a*h+s*l),p=h*h+l*l,d=2*Math.sqrt(u+c+p),f=Math.sqrt(u),m=2*u*f,v=2*Math.sqrt(p),y=c/f;return(m*d+f*c*(d-v)+(4*p*u-c*c)*Math.log((2*f+y+d)/(y+v)))/(4*m)},t.curveTo=function(e,r,i,n,o){for(var a=o[o.length-2],s=o[o.length-1],h=to._segmentsCount(t.curveLength(a,s,e,r,i,n)),l=0,u=0,c=1;c<=h;++c){var p=c/h;l=a+(e-a)*p,u=s+(r-s)*p,o.push(l+(e+(i-e)*p-l)*p,u+(r+(n-r)*p-u)*p)}},t}(),_o=function(){function t(){this.reset()}return t.prototype.begin=function(t,e,r){this.reset(),this.style=t,this.start=e,this.attribStart=r},t.prototype.end=function(t,e){this.attribSize=e-this.attribStart,this.size=t-this.start},t.prototype.reset=function(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0},t}(),xo=((fo={})[t.SHAPES.POLY]=no,fo[t.SHAPES.CIRC]=oo,fo[t.SHAPES.ELIP]=oo,fo[t.SHAPES.RECT]=ao,fo[t.SHAPES.RREC]=lo,fo),bo=[],wo=[],To={buildPoly:no,buildCircle:oo,buildRectangle:ao,buildRoundedRectangle:lo,FILL_COMMANDS:xo,BATCH_POOL:bo,DRAW_CALL_POOL:wo,buildLine:po,Star:mo,ArcUtils:vo,BezierUtils:yo,QuadraticUtils:go,BatchPart:_o},Eo=function(){function t(t,e,r,i){void 0===e&&(e=null),void 0===r&&(r=null),void 0===i&&(i=null),this.shape=t,this.lineStyle=r,this.fillStyle=e,this.matrix=i,this.type=t.type,this.points=[],this.holes=[]}return t.prototype.clone=function(){return new t(this.shape,this.fillStyle,this.lineStyle,this.matrix)},t.prototype.destroy=function(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null},t}(),So=new Ie,Ao=new Ve,Io=function(e){function r(){var t=e.call(this)||this;return t.uvsFloat32=null,t.indicesUint16=null,t.points=[],t.colors=[],t.uvs=[],t.indices=[],t.textureIds=[],t.graphicsData=[],t.dirty=0,t.batchDirty=-1,t.cacheDirty=-1,t.clearDirty=0,t.drawCalls=[],t.batches=[],t.shapeIndex=0,t._bounds=new Ve,t.boundsDirty=-1,t.boundsPadding=0,t.batchable=!1,t.indicesUint16=null,t.uvsFloat32=null,t.closePointEps=1e-4,t}return io(r,e),Object.defineProperty(r.prototype,"bounds",{get:function(){return this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds},enumerable:!1,configurable:!0}),r.prototype.invalidate=function(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(var t=0;t<this.drawCalls.length;t++)this.drawCalls[t].texArray.clear(),wo.push(this.drawCalls[t]);this.drawCalls.length=0;for(t=0;t<this.batches.length;t++){var e=this.batches[t];e.reset(),bo.push(e)}this.batches.length=0},r.prototype.clear=function(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this},r.prototype.drawShape=function(t,e,r,i){void 0===e&&(e=null),void 0===r&&(r=null),void 0===i&&(i=null);var n=new Eo(t,e,r,i);return this.graphicsData.push(n),this.dirty++,this},r.prototype.drawHole=function(t,e){if(void 0===e&&(e=null),!this.graphicsData.length)return null;var r=new Eo(t,null,null,e),i=this.graphicsData[this.graphicsData.length-1];return r.lineStyle=i.lineStyle,i.holes.push(r),this.dirty++,this},r.prototype.destroy=function(){e.prototype.destroy.call(this);for(var t=0;t<this.graphicsData.length;++t)this.graphicsData[t].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null},r.prototype.containsPoint=function(t){for(var e=this.graphicsData,r=0;r<e.length;++r){var i=e[r];if(i.fillStyle.visible&&(i.shape&&(i.matrix?i.matrix.applyInverse(t,So):So.copyFrom(t),i.shape.contains(So.x,So.y)))){var n=!1;if(i.holes)for(var o=0;o<i.holes.length;o++){if(i.holes[o].shape.contains(So.x,So.y)){n=!0;break}}if(!n)return!0}}return!1},r.prototype.updateBatches=function(e){if(this.graphicsData.length){if(this.validateBatching()){this.cacheDirty=this.dirty;var r=this.uvs,i=this.graphicsData,n=null,o=null;this.batches.length>0&&(o=(n=this.batches[this.batches.length-1]).style);for(var a=this.shapeIndex;a<i.length;a++){this.shapeIndex++;var s=i[a],h=s.fillStyle,l=s.lineStyle;xo[s.type].build(s),s.matrix&&this.transformPoints(s.points,s.matrix);for(var u=0;u<2;u++){var c=0===u?h:l;if(c.visible){var p=c.texture.baseTexture,d=this.indices.length,f=this.points.length/2;p.wrapMode=t.WRAP_MODES.REPEAT,0===u?this.processFill(s):this.processLine(s);var m=this.points.length/2-f;0!==m&&(n&&!this._compareStyles(o,c)&&(n.end(d,f),n=null),n||((n=bo.pop()||new _o).begin(c,d,f),this.batches.push(n),o=c),this.addUvs(this.points,r,c.texture,f,m,c.matrix))}}}var v=this.indices.length,y=this.points.length/2;if(n&&n.end(v,y),0!==this.batches.length){if(this.indicesUint16&&this.indices.length===this.indicesUint16.length)this.indicesUint16.set(this.indices);else{var g=y>65535&&e;this.indicesUint16=g?new Uint32Array(this.indices):new Uint16Array(this.indices)}this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}else this.batchable=!0}}else this.batchable=!0},r.prototype._compareStyles=function(t,e){return!(!t||!e)&&(t.texture.baseTexture===e.texture.baseTexture&&(t.color+t.alpha===e.color+e.alpha&&!!t.native==!!e.native))},r.prototype.validateBatching=function(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(var t=0,e=this.graphicsData.length;t<e;t++){var r=this.graphicsData[t],i=r.fillStyle,n=r.lineStyle;if(i&&!i.texture.baseTexture.valid)return!1;if(n&&!n.texture.baseTexture.valid)return!1}return!0},r.prototype.packBatches=function(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);for(var t=this.batches,e=0,r=t.length;e<r;e++)for(var i=t[e],n=0;n<i.size;n++){var o=i.start+n;this.indicesUint16[o]=this.indicesUint16[o]-i.attribStart}},r.prototype.isBatchable=function(){if(this.points.length>131070)return!1;for(var t=this.batches,e=0;e<t.length;e++)if(t[e].style.native)return!1;return this.points.length<2*r.BATCHABLE_SIZE},r.prototype.buildDrawCalls=function(){for(var e=++fr._globalBatch,r=0;r<this.drawCalls.length;r++)this.drawCalls[r].texArray.clear(),wo.push(this.drawCalls[r]);this.drawCalls.length=0;var i=this.colors,n=this.textureIds,o=wo.pop();o||((o=new ln).texArray=new un),o.texArray.count=0,o.start=0,o.size=0,o.type=t.DRAW_MODES.TRIANGLES;var a=0,s=null,h=0,l=!1,u=t.DRAW_MODES.TRIANGLES,c=0;this.drawCalls.push(o);for(r=0;r<this.batches.length;r++){var p=this.batches[r],d=p.style,f=d.texture.baseTexture;l!==!!d.native&&(u=(l=!!d.native)?t.DRAW_MODES.LINES:t.DRAW_MODES.TRIANGLES,s=null,a=8,e++),s!==f&&(s=f,f._batchEnabled!==e&&(8===a&&(e++,a=0,o.size>0&&((o=wo.pop())||((o=new ln).texArray=new un),this.drawCalls.push(o)),o.start=c,o.size=0,o.texArray.count=0,o.type=u),f.touched=1,f._batchEnabled=e,f._batchLocation=a,f.wrapMode=10497,o.texArray.elements[o.texArray.count++]=f,a++)),o.size+=p.size,c+=p.size,h=f._batchLocation,this.addColors(i,d.color,d.alpha,p.attribSize),this.addTextureIds(n,h,p.attribSize)}fr._globalBatch=e,this.packAttributes()},r.prototype.packAttributes=function(){for(var t=this.points,e=this.uvs,r=this.colors,i=this.textureIds,n=new ArrayBuffer(3*t.length*4),o=new Float32Array(n),a=new Uint32Array(n),s=0,h=0;h<t.length/2;h++)o[s++]=t[2*h],o[s++]=t[2*h+1],o[s++]=e[2*h],o[s++]=e[2*h+1],a[s++]=r[h],o[s++]=i[h];this._buffer.update(n),this._indexBuffer.update(this.indicesUint16)},r.prototype.processFill=function(t){t.holes.length?(this.processHoles(t.holes),no.triangulate(t,this)):xo[t.type].triangulate(t,this)},r.prototype.processLine=function(t){po(t,this);for(var e=0;e<t.holes.length;e++)po(t.holes[e],this)},r.prototype.processHoles=function(t){for(var e=0;e<t.length;e++){var r=t[e];xo[r.type].build(r),r.matrix&&this.transformPoints(r.points,r.matrix)}},r.prototype.calculateBounds=function(){var e=this._bounds,r=Ao,i=Me.IDENTITY;this._bounds.clear(),r.clear();for(var n=0;n<this.graphicsData.length;n++){var o=this.graphicsData[n],a=o.shape,s=o.type,h=o.lineStyle,l=o.matrix||Me.IDENTITY,u=0;if(h&&h.visible){var c=h.alignment;u=h.width,s===t.SHAPES.POLY?u*=.5+Math.abs(.5-c):u*=Math.max(0,c)}if(i!==l&&(r.isEmpty()||(e.addBoundsMatrix(r,i),r.clear()),i=l),s===t.SHAPES.RECT||s===t.SHAPES.RREC){var p=a;r.addFramePad(p.x,p.y,p.x+p.width,p.y+p.height,u,u)}else if(s===t.SHAPES.CIRC){var d=a;r.addFramePad(d.x,d.y,d.x,d.y,d.radius+u,d.radius+u)}else if(s===t.SHAPES.ELIP){var f=a;r.addFramePad(f.x,f.y,f.x,f.y,f.width+u,f.height+u)}else{var m=a;e.addVerticesMatrix(i,m.points,0,m.points.length,u,u)}}r.isEmpty()||e.addBoundsMatrix(r,i),e.pad(this.boundsPadding,this.boundsPadding)},r.prototype.transformPoints=function(t,e){for(var r=0;r<t.length/2;r++){var i=t[2*r],n=t[2*r+1];t[2*r]=e.a*i+e.c*n+e.tx,t[2*r+1]=e.b*i+e.d*n+e.ty}},r.prototype.addColors=function(t,e,r,i){for(var n=Ht((e>>16)+(65280&e)+((255&e)<<16),r);i-- >0;)t.push(n)},r.prototype.addTextureIds=function(t,e,r){for(;r-- >0;)t.push(e)},r.prototype.addUvs=function(t,e,r,i,n,o){void 0===o&&(o=null);for(var a=0,s=e.length,h=r.frame;a<n;){var l=t[2*(i+a)],u=t[2*(i+a)+1];if(o){var c=o.a*l+o.c*u+o.tx;u=o.b*l+o.d*u+o.ty,l=c}a++,e.push(l/h.width,u/h.height)}var p=r.baseTexture;(h.width<p.width||h.height<p.height)&&this.adjustUvs(e,r,s,n)},r.prototype.adjustUvs=function(t,e,r,i){for(var n=e.baseTexture,o=1e-6,a=r+2*i,s=e.frame,h=s.width/n.width,l=s.height/n.height,u=s.x/s.width,c=s.y/s.height,p=Math.floor(t[r]+o),d=Math.floor(t[r+1]+o),f=r+2;f<a;f+=2)p=Math.min(p,Math.floor(t[f]+o)),d=Math.min(d,Math.floor(t[f+1]+o));u-=p,c-=d;for(f=r;f<a;f+=2)t[f]=(t[f]+u)*h,t[f+1]=(t[f+1]+c)*l},r.BATCHABLE_SIZE=100,r}(fn),Po=function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.width=0,r.alignment=.5,r.native=!1,r.cap=t.LINE_CAP.BUTT,r.join=t.LINE_JOIN.MITER,r.miterLimit=10,r}return io(r,e),r.prototype.clone=function(){var t=new r;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t},r.prototype.reset=function(){e.prototype.reset.call(this),this.color=0,this.alignment=.5,this.width=0,this.native=!1},r}(eo),Mo=new Float32Array(3),Co={},Ro=function(e){function r(r){void 0===r&&(r=null);var i=e.call(this)||this;return i._geometry=r||new Io,i._geometry.refCount++,i.shader=null,i.state=Oi.for2d(),i._fillStyle=new eo,i._lineStyle=new Po,i._matrix=null,i._holeMode=!1,i.currentPath=null,i.batches=[],i.batchTint=-1,i.batchDirty=-1,i.vertexData=null,i.pluginName="batch",i._transformID=-1,i.tint=16777215,i.blendMode=t.BLEND_MODES.NORMAL,i}return io(r,e),Object.defineProperty(r.prototype,"geometry",{get:function(){return this._geometry},enumerable:!1,configurable:!0}),r.prototype.clone=function(){return this.finishPoly(),new r(this._geometry)},Object.defineProperty(r.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"tint",{get:function(){return this._tint},set:function(t){this._tint=t},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"fill",{get:function(){return this._fillStyle},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"line",{get:function(){return this._lineStyle},enumerable:!1,configurable:!0}),r.prototype.lineStyle=function(t){if(void 0===t&&(t=null),"number"==typeof t){var e=arguments;t={width:e[0]||0,color:e[1]||0,alpha:void 0!==e[2]?e[2]:1,alignment:void 0!==e[3]?e[3]:.5,native:!!e[4]}}return this.lineTextureStyle(t)},r.prototype.lineTextureStyle=function(e){if("number"==typeof e){se("v5.2.0","Please use object-based options for Graphics#lineTextureStyle");var r=arguments,i=r[0],n=r[1],o=r[2],a=r[3],s=r[4],h=r[5],l=r[6];e={width:i,texture:n,color:o,alpha:a,matrix:s,alignment:h,native:l},Object.keys(e).forEach((function(t){return void 0===e[t]&&delete e[t]}))}e=Object.assign({width:0,texture:Rr.WHITE,color:e&&e.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1,cap:t.LINE_CAP.BUTT,join:t.LINE_JOIN.MITER,miterLimit:10},e),this.currentPath&&this.startPoly();var u=e.width>0&&e.alpha>0;return u?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._lineStyle,{visible:u},e)):this._lineStyle.reset(),this},r.prototype.startPoly=function(){if(this.currentPath){var t=this.currentPath.points,e=this.currentPath.points.length;e>2&&(this.drawShape(this.currentPath),this.currentPath=new Se,this.currentPath.closeStroke=!1,this.currentPath.points.push(t[e-2],t[e-1]))}else this.currentPath=new Se,this.currentPath.closeStroke=!1},r.prototype.finishPoly=function(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)},r.prototype.moveTo=function(t,e){return this.startPoly(),this.currentPath.points[0]=t,this.currentPath.points[1]=e,this},r.prototype.lineTo=function(t,e){this.currentPath||this.moveTo(0,0);var r=this.currentPath.points,i=r[r.length-2],n=r[r.length-1];return i===t&&n===e||r.push(t,e),this},r.prototype._initCurve=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.currentPath?0===this.currentPath.points.length&&(this.currentPath.points=[t,e]):this.moveTo(t,e)},r.prototype.quadraticCurveTo=function(t,e,r,i){this._initCurve();var n=this.currentPath.points;return 0===n.length&&this.moveTo(0,0),go.curveTo(t,e,r,i,n),this},r.prototype.bezierCurveTo=function(t,e,r,i,n,o){return this._initCurve(),yo.curveTo(t,e,r,i,n,o,this.currentPath.points),this},r.prototype.arcTo=function(t,e,r,i,n){this._initCurve(t,e);var o=this.currentPath.points,a=vo.curveTo(t,e,r,i,n,o);if(a){var s=a.cx,h=a.cy,l=a.radius,u=a.startAngle,c=a.endAngle,p=a.anticlockwise;this.arc(s,h,l,u,c,p)}return this},r.prototype.arc=function(t,e,r,i,n,o){if(void 0===o&&(o=!1),i===n)return this;if(!o&&n<=i?n+=_e:o&&i<=n&&(i+=_e),0===n-i)return this;var a=t+Math.cos(i)*r,s=e+Math.sin(i)*r,h=this._geometry.closePointEps,l=this.currentPath?this.currentPath.points:null;if(l){var u=Math.abs(l[l.length-2]-a),c=Math.abs(l[l.length-1]-s);u<h&&c<h||l.push(a,s)}else this.moveTo(a,s),l=this.currentPath.points;return vo.arc(a,s,t,e,r,i,n,o,l),this},r.prototype.beginFill=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=1),this.beginTextureFill({texture:Rr.WHITE,color:t,alpha:e})},r.prototype.beginTextureFill=function(t){if(t instanceof Rr){se("v5.2.0","Please use object-based options for Graphics#beginTextureFill");var e=arguments,r=e[0],i=e[1],n=e[2],o=e[3];t={texture:r,color:i,alpha:n,matrix:o},Object.keys(t).forEach((function(e){return void 0===t[e]&&delete t[e]}))}t=Object.assign({texture:Rr.WHITE,color:16777215,alpha:1,matrix:null},t),this.currentPath&&this.startPoly();var a=t.alpha>0;return a?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._fillStyle,{visible:a},t)):this._fillStyle.reset(),this},r.prototype.endFill=function(){return this.finishPoly(),this._fillStyle.reset(),this},r.prototype.drawRect=function(t,e,r,i){return this.drawShape(new we(t,e,r,i))},r.prototype.drawRoundedRect=function(t,e,r,i,n){return this.drawShape(new Ae(t,e,r,i,n))},r.prototype.drawCircle=function(t,e,r){return this.drawShape(new Te(t,e,r))},r.prototype.drawEllipse=function(t,e,r,i){return this.drawShape(new Ee(t,e,r,i))},r.prototype.drawPolygon=function(){for(var t,e=arguments,r=[],i=0;i<arguments.length;i++)r[i]=e[i];var n=!0,o=r[0];o.points?(n=o.closeStroke,t=o.points):t=Array.isArray(r[0])?r[0]:r;var a=new Se(t);return a.closeStroke=n,this.drawShape(a),this},r.prototype.drawShape=function(t){return this._holeMode?this._geometry.drawHole(t,this._matrix):this._geometry.drawShape(t,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this},r.prototype.drawStar=function(t,e,r,i,n,o){return void 0===o&&(o=0),this.drawPolygon(new mo(t,e,r,i,n,o))},r.prototype.clear=function(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this},r.prototype.isFastRect=function(){var e=this._geometry.graphicsData;return 1===e.length&&e[0].shape.type===t.SHAPES.RECT&&!(e[0].lineStyle.visible&&e[0].lineStyle.width)},r.prototype._render=function(t){this.finishPoly();var e=this._geometry,r=t.context.supports.uint32Indices;e.updateBatches(r),e.batchable?(this.batchDirty!==e.batchDirty&&this._populateBatches(),this._renderBatched(t)):(t.batch.flush(),this._renderDirect(t))},r.prototype._populateBatches=function(){var t=this._geometry,e=this.blendMode,r=t.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=t.batchDirty,this.batches.length=r,this.vertexData=new Float32Array(t.points);for(var i=0;i<r;i++){var n=t.batches[i],o=n.style.color,a=new Float32Array(this.vertexData.buffer,4*n.attribStart*2,2*n.attribSize),s=new Float32Array(t.uvsFloat32.buffer,4*n.attribStart*2,2*n.attribSize),h={vertexData:a,blendMode:e,indices:new Uint16Array(t.indicesUint16.buffer,2*n.start,n.size),uvs:s,_batchRGB:Ut(o),_tintRGB:o,_texture:n.style.texture,alpha:n.style.alpha,worldAlpha:1};this.batches[i]=h}},r.prototype._renderBatched=function(t){if(this.batches.length){t.batch.setObjectRenderer(t.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(var e=0,r=this.batches.length;e<r;e++){var i=this.batches[e];i.worldAlpha=this.worldAlpha*i.alpha,t.plugins[this.pluginName].render(i)}}},r.prototype._renderDirect=function(t){var e=this._resolveDirectShader(t),r=this._geometry,i=this.tint,n=this.worldAlpha,o=e.uniforms,a=r.drawCalls;o.translationMatrix=this.transform.worldTransform,o.tint[0]=(i>>16&255)/255*n,o.tint[1]=(i>>8&255)/255*n,o.tint[2]=(255&i)/255*n,o.tint[3]=n,t.shader.bind(e),t.geometry.bind(r,e),t.state.set(this.state);for(var s=0,h=a.length;s<h;s++)this._renderDrawCallDirect(t,r.drawCalls[s])},r.prototype._renderDrawCallDirect=function(t,e){for(var r=e.texArray,i=e.type,n=e.size,o=e.start,a=r.count,s=0;s<a;s++)t.texture.bind(r.elements[s],s);t.geometry.draw(i,n,o)},r.prototype._resolveDirectShader=function(t){var e=this.shader,r=this.pluginName;if(!e){if(!Co[r]){for(var i=t.plugins.batch.MAX_TEXTURES,n=new Int32Array(i),o=0;o<i;o++)n[o]=o;var a={tint:new Float32Array([1,1,1,1]),translationMatrix:new Me,default:Gr.from({uSamplers:n},!0)},s=t.plugins[r]._shader.program;Co[r]=new Ri(s,a)}e=Co[r]}return e},r.prototype._calculateBounds=function(){this.finishPoly();var t=this._geometry;if(t.graphicsData.length){var e=t.bounds,r=e.minX,i=e.minY,n=e.maxX,o=e.maxY;this._bounds.addFrame(this.transform,r,i,n,o)}},r.prototype.containsPoint=function(t){return this.worldTransform.applyInverse(t,r._TEMP_POINT),this._geometry.containsPoint(r._TEMP_POINT)},r.prototype.calculateTints=function(){if(this.batchTint!==this.tint){this.batchTint=this.tint;for(var t=Ut(this.tint,Mo),e=0;e<this.batches.length;e++){var r=this.batches[e],i=r._batchRGB,n=(t[0]*i[0]*255<<16)+(t[1]*i[1]*255<<8)+(0|t[2]*i[2]*255);r._tintRGB=(n>>16)+(65280&n)+((255&n)<<16)}}},r.prototype.calculateVertices=function(){var t=this.transform._worldID;if(this._transformID!==t){this._transformID=t;for(var e=this.transform.worldTransform,r=e.a,i=e.b,n=e.c,o=e.d,a=e.tx,s=e.ty,h=this._geometry.points,l=this.vertexData,u=0,c=0;c<h.length;c+=2){var p=h[c],d=h[c+1];l[u++]=r*p+n*d+a,l[u++]=o*d+i*p+s}}},r.prototype.closePath=function(){var t=this.currentPath;return t&&(t.closeStroke=!0),this},r.prototype.setMatrix=function(t){return this._matrix=t,this},r.prototype.beginHole=function(){return this.finishPoly(),this._holeMode=!0,this},r.prototype.endHole=function(){return this.finishPoly(),this._holeMode=!1,this},r.prototype.destroy=function(t){this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,e.prototype.destroy.call(this,t)},r._TEMP_POINT=new Ie,r}(We),Oo=function(t,e){return(Oo=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};var Do,Bo=new Ie,No=new Uint16Array([0,1,2,0,2,3]),ko=function(e){function r(r){var i=e.call(this)||this;return i._anchor=new Pe(i._onAnchorUpdate,i,r?r.defaultAnchor.x:0,r?r.defaultAnchor.y:0),i._texture=null,i._width=0,i._height=0,i._tint=null,i._tintRGB=null,i.tint=16777215,i.blendMode=t.BLEND_MODES.NORMAL,i._cachedTint=16777215,i.uvs=null,i.texture=r||Rr.EMPTY,i.vertexData=new Float32Array(8),i.vertexTrimmedData=null,i._transformID=-1,i._textureID=-1,i._transformTrimmedID=-1,i._textureTrimmedID=-1,i.indices=No,i.pluginName="batch",i.isSprite=!0,i._roundPixels=O.ROUND_PIXELS,i}return function(t,e){function r(){this.constructor=t}Oo(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}(r,e),r.prototype._onTextureUpdate=function(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=ie(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=ie(this.scale.y)*this._height/this._texture.orig.height)},r.prototype._onAnchorUpdate=function(){this._transformID=-1,this._transformTrimmedID=-1},r.prototype.calculateVertices=function(){var t=this._texture;if(this._transformID!==this.transform._worldID||this._textureID!==t._updateID){this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;var e=this.transform.worldTransform,r=e.a,i=e.b,n=e.c,o=e.d,a=e.tx,s=e.ty,h=this.vertexData,l=t.trim,u=t.orig,c=this._anchor,p=0,d=0,f=0,m=0;if(l?(p=(d=l.x-c._x*u.width)+l.width,f=(m=l.y-c._y*u.height)+l.height):(p=(d=-c._x*u.width)+u.width,f=(m=-c._y*u.height)+u.height),h[0]=r*d+n*m+a,h[1]=o*m+i*d+s,h[2]=r*p+n*m+a,h[3]=o*m+i*p+s,h[4]=r*p+n*f+a,h[5]=o*f+i*p+s,h[6]=r*d+n*f+a,h[7]=o*f+i*d+s,this._roundPixels)for(var v=O.RESOLUTION,y=0;y<h.length;++y)h[y]=Math.round((h[y]*v|0)/v)}},r.prototype.calculateTrimmedVertices=function(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;var t=this._texture,e=this.vertexTrimmedData,r=t.orig,i=this._anchor,n=this.transform.worldTransform,o=n.a,a=n.b,s=n.c,h=n.d,l=n.tx,u=n.ty,c=-i._x*r.width,p=c+r.width,d=-i._y*r.height,f=d+r.height;e[0]=o*c+s*d+l,e[1]=h*d+a*c+u,e[2]=o*p+s*d+l,e[3]=h*d+a*p+u,e[4]=o*p+s*f+l,e[5]=h*f+a*p+u,e[6]=o*c+s*f+l,e[7]=h*f+a*c+u},r.prototype._render=function(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)},r.prototype._calculateBounds=function(){var t=this._texture.trim,e=this._texture.orig;!t||t.width===e.width&&t.height===e.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))},r.prototype.getLocalBounds=function(t){return 0===this.children.length?(this._bounds.minX=this._texture.orig.width*-this._anchor._x,this._bounds.minY=this._texture.orig.height*-this._anchor._y,this._bounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._bounds.maxY=this._texture.orig.height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new we),t=this._localBoundsRect),this._bounds.getRectangle(t)):e.prototype.getLocalBounds.call(this,t)},r.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,Bo);var e=this._texture.orig.width,r=this._texture.orig.height,i=-e*this.anchor.x,n=0;return Bo.x>=i&&Bo.x<i+e&&(n=-r*this.anchor.y,Bo.y>=n&&Bo.y<n+r)},r.prototype.destroy=function(t){if(e.prototype.destroy.call(this,t),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,"boolean"==typeof t?t:t&&t.texture){var r="boolean"==typeof t?t:t&&t.baseTexture;this._texture.destroy(!!r)}this._texture=null},r.from=function(t,e){return new r(t instanceof Rr?t:Rr.from(t,e))},Object.defineProperty(r.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"width",{get:function(){return Math.abs(this.scale.x)*this._texture.orig.width},set:function(t){var e=ie(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"height",{get:function(){return Math.abs(this.scale.y)*this._texture.orig.height},set:function(t){var e=ie(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"anchor",{get:function(){return this._anchor},set:function(t){this._anchor.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"tint",{get:function(){return this._tint},set:function(t){this._tint=t,this._tintRGB=(t>>16)+(65280&t)+((255&t)<<16)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"texture",{get:function(){return this._texture},set:function(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||Rr.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))},enumerable:!1,configurable:!0}),r}(We),Fo=function(t,e){return(Fo=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};(Do=t.TEXT_GRADIENT||(t.TEXT_GRADIENT={}))[Do.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",Do[Do.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL";var Lo={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:t.TEXT_GRADIENT.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100,leading:0},Vo=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],Xo=function(){function t(t){this.styleID=0,this.reset(),Yo(this,t,t)}return t.prototype.clone=function(){var e={};return Yo(e,this,Lo),new t(e)},t.prototype.reset=function(){Yo(this,Lo,Lo)},Object.defineProperty(t.prototype,"align",{get:function(){return this._align},set:function(t){this._align!==t&&(this._align=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"breakWords",{get:function(){return this._breakWords},set:function(t){this._breakWords!==t&&(this._breakWords=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadow",{get:function(){return this._dropShadow},set:function(t){this._dropShadow!==t&&(this._dropShadow=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowAlpha",{get:function(){return this._dropShadowAlpha},set:function(t){this._dropShadowAlpha!==t&&(this._dropShadowAlpha=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowAngle",{get:function(){return this._dropShadowAngle},set:function(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowBlur",{get:function(){return this._dropShadowBlur},set:function(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowColor",{get:function(){return this._dropShadowColor},set:function(t){var e=Uo(t);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowDistance",{get:function(){return this._dropShadowDistance},set:function(t){this._dropShadowDistance!==t&&(this._dropShadowDistance=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fill",{get:function(){return this._fill},set:function(t){var e=Uo(t);this._fill!==e&&(this._fill=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fillGradientType",{get:function(){return this._fillGradientType},set:function(t){this._fillGradientType!==t&&(this._fillGradientType=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fillGradientStops",{get:function(){return this._fillGradientStops},set:function(t){(function(t,e){if(!Array.isArray(t)||!Array.isArray(e))return!1;if(t.length!==e.length)return!1;for(var r=0;r<t.length;++r)if(t[r]!==e[r])return!1;return!0})(this._fillGradientStops,t)||(this._fillGradientStops=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontFamily",{get:function(){return this._fontFamily},set:function(t){this.fontFamily!==t&&(this._fontFamily=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontSize",{get:function(){return this._fontSize},set:function(t){this._fontSize!==t&&(this._fontSize=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontStyle",{get:function(){return this._fontStyle},set:function(t){this._fontStyle!==t&&(this._fontStyle=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontVariant",{get:function(){return this._fontVariant},set:function(t){this._fontVariant!==t&&(this._fontVariant=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(t){this._fontWeight!==t&&(this._fontWeight=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lineHeight",{get:function(){return this._lineHeight},set:function(t){this._lineHeight!==t&&(this._lineHeight=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"leading",{get:function(){return this._leading},set:function(t){this._leading!==t&&(this._leading=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lineJoin",{get:function(){return this._lineJoin},set:function(t){this._lineJoin!==t&&(this._lineJoin=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"miterLimit",{get:function(){return this._miterLimit},set:function(t){this._miterLimit!==t&&(this._miterLimit=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"padding",{get:function(){return this._padding},set:function(t){this._padding!==t&&(this._padding=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"stroke",{get:function(){return this._stroke},set:function(t){var e=Uo(t);this._stroke!==e&&(this._stroke=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"strokeThickness",{get:function(){return this._strokeThickness},set:function(t){this._strokeThickness!==t&&(this._strokeThickness=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textBaseline",{get:function(){return this._textBaseline},set:function(t){this._textBaseline!==t&&(this._textBaseline=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"trim",{get:function(){return this._trim},set:function(t){this._trim!==t&&(this._trim=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"whiteSpace",{get:function(){return this._whiteSpace},set:function(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wordWrap",{get:function(){return this._wordWrap},set:function(t){this._wordWrap!==t&&(this._wordWrap=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wordWrapWidth",{get:function(){return this._wordWrapWidth},set:function(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.styleID++)},enumerable:!1,configurable:!0}),t.prototype.toFontString=function(){var t="number"==typeof this.fontSize?this.fontSize+"px":this.fontSize,e=this.fontFamily;Array.isArray(this.fontFamily)||(e=this.fontFamily.split(","));for(var r=e.length-1;r>=0;r--){var i=e[r].trim();!/([\"\'])[^\'\"]+\1/.test(i)&&Vo.indexOf(i)<0&&(i='"'+i+'"'),e[r]=i}return this.fontStyle+" "+this.fontVariant+" "+this.fontWeight+" "+t+" "+e.join(",")},t}();function jo(t){return"number"==typeof t?Yt(t):("string"==typeof t&&0===t.indexOf("0x")&&(t=t.replace("0x","#")),t)}function Uo(t){if(Array.isArray(t)){for(var e=0;e<t.length;++e)t[e]=jo(t[e]);return t}return jo(t)}function Yo(t,e,r){for(var i in r)Array.isArray(e[i])?t[i]=e[i].slice():t[i]=e[i]}var zo=function(){function t(t,e,r,i,n,o,a,s,h){this.text=t,this.style=e,this.width=r,this.height=i,this.lines=n,this.lineWidths=o,this.lineHeight=a,this.maxLineWidth=s,this.fontProperties=h}return t.measureText=function(e,r,i,n){void 0===n&&(n=t._canvas),i=null==i?r.wordWrap:i;var o=r.toFontString(),a=t.measureFont(o);0===a.fontSize&&(a.fontSize=r.fontSize,a.ascent=r.fontSize);var s=n.getContext("2d");s.font=o;for(var h=(i?t.wordWrap(e,r,n):e).split(/(?:\r\n|\r|\n)/),l=new Array(h.length),u=0,c=0;c<h.length;c++){var p=s.measureText(h[c]).width+(h[c].length-1)*r.letterSpacing;l[c]=p,u=Math.max(u,p)}var d=u+r.strokeThickness;r.dropShadow&&(d+=r.dropShadowDistance);var f=r.lineHeight||a.fontSize+r.strokeThickness,m=Math.max(f,a.fontSize+r.strokeThickness)+(h.length-1)*(f+r.leading);return r.dropShadow&&(m+=r.dropShadowDistance),new t(e,r,d,m,h,l,f+r.leading,u,a)},t.wordWrap=function(e,r,i){void 0===i&&(i=t._canvas);for(var n=i.getContext("2d"),o=0,a="",s="",h=Object.create(null),l=r.letterSpacing,u=r.whiteSpace,c=t.collapseSpaces(u),p=t.collapseNewlines(u),d=!c,f=r.wordWrapWidth+l,m=t.tokenize(e),v=0;v<m.length;v++){var y=m[v];if(t.isNewline(y)){if(!p){s+=t.addLine(a),d=!c,a="",o=0;continue}y=" "}if(c){var g=t.isBreakingSpace(y),_=t.isBreakingSpace(a[a.length-1]);if(g&&_)continue}var x=t.getFromCache(y,l,h,n);if(x>f)if(""!==a&&(s+=t.addLine(a),a="",o=0),t.canBreakWords(y,r.breakWords))for(var b=t.wordWrapSplit(y),w=0;w<b.length;w++){for(var T=b[w],E=1;b[w+E];){var S=b[w+E],A=T[T.length-1];if(t.canBreakChars(A,S,y,w,r.breakWords))break;T+=S,E++}w+=T.length-1;var I=t.getFromCache(T,l,h,n);I+o>f&&(s+=t.addLine(a),d=!1,a="",o=0),a+=T,o+=I}else{a.length>0&&(s+=t.addLine(a),a="",o=0);var P=v===m.length-1;s+=t.addLine(y,!P),d=!1,a="",o=0}else x+o>f&&(d=!1,s+=t.addLine(a),a="",o=0),(a.length>0||!t.isBreakingSpace(y)||d)&&(a+=y,o+=x)}return s+=t.addLine(a,!1)},t.addLine=function(e,r){return void 0===r&&(r=!0),e=t.trimRight(e),e=r?e+"\n":e},t.getFromCache=function(t,e,r,i){var n=r[t];if("number"!=typeof n){var o=t.length*e;n=i.measureText(t).width+o,r[t]=n}return n},t.collapseSpaces=function(t){return"normal"===t||"pre-line"===t},t.collapseNewlines=function(t){return"normal"===t},t.trimRight=function(e){if("string"!=typeof e)return"";for(var r=e.length-1;r>=0;r--){var i=e[r];if(!t.isBreakingSpace(i))break;e=e.slice(0,-1)}return e},t.isNewline=function(e){return"string"==typeof e&&t._newlines.indexOf(e.charCodeAt(0))>=0},t.isBreakingSpace=function(e){return"string"==typeof e&&t._breakingSpaces.indexOf(e.charCodeAt(0))>=0},t.tokenize=function(e){var r=[],i="";if("string"!=typeof e)return r;for(var n=0;n<e.length;n++){var o=e[n];t.isBreakingSpace(o)||t.isNewline(o)?(""!==i&&(r.push(i),i=""),r.push(o)):i+=o}return""!==i&&r.push(i),r},t.canBreakWords=function(t,e){return e},t.canBreakChars=function(t,e,r,i,n){return!0},t.wordWrapSplit=function(t){return t.split("")},t.measureFont=function(e){if(t._fonts[e])return t._fonts[e];var r={ascent:0,descent:0,fontSize:0},i=t._canvas,n=t._context;n.font=e;var o=t.METRICS_STRING+t.BASELINE_SYMBOL,a=Math.ceil(n.measureText(o).width),s=Math.ceil(n.measureText(t.BASELINE_SYMBOL).width),h=2*s;s=s*t.BASELINE_MULTIPLIER|0,i.width=a,i.height=h,n.fillStyle="#f00",n.fillRect(0,0,a,h),n.font=e,n.textBaseline="alphabetic",n.fillStyle="#000",n.fillText(o,0,s);var l=n.getImageData(0,0,a,h).data,u=l.length,c=4*a,p=0,d=0,f=!1;for(p=0;p<s;++p){for(var m=0;m<c;m+=4)if(255!==l[d+m]){f=!0;break}if(f)break;d+=c}for(r.ascent=s-p,d=u-c,f=!1,p=h;p>s;--p){for(m=0;m<c;m+=4)if(255!==l[d+m]){f=!0;break}if(f)break;d-=c}return r.descent=p-s,r.fontSize=r.ascent+r.descent,t._fonts[e]=r,r},t.clearMetrics=function(e){void 0===e&&(e=""),e?delete t._fonts[e]:t._fonts={}},t}(),Wo=function(){try{var t=new OffscreenCanvas(0,0),e=t.getContext("2d");return e&&e.measureText?t:document.createElement("canvas")}catch(t){return document.createElement("canvas")}}();Wo.width=Wo.height=10,zo._canvas=Wo,zo._context=Wo.getContext("2d"),zo._fonts={},zo.METRICS_STRING="|q",zo.BASELINE_SYMBOL="M",zo.BASELINE_MULTIPLIER=1.4,zo._newlines=[10,13],zo._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];var qo={texture:!0,children:!1,baseTexture:!0},Go=function(e){function r(t,r,i){var n=this,o=!1;i||(i=document.createElement("canvas"),o=!0),i.width=3,i.height=3;var a=Rr.from(i);return a.orig=new we,a.trim=new we,(n=e.call(this,a)||this)._ownCanvas=o,n.canvas=i,n.context=n.canvas.getContext("2d"),n._resolution=O.RESOLUTION,n._autoResolution=!0,n._text=null,n._style=null,n._styleListener=null,n._font="",n.text=t,n.style=r,n.localStyleID=-1,n}return function(t,e){function r(){this.constructor=t}Fo(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}(r,e),r.prototype.updateText=function(t){var e=this._style;if(this.localStyleID!==e.styleID&&(this.dirty=!0,this.localStyleID=e.styleID),this.dirty||!t){this._font=this._style.toFontString();var r,i,n=this.context,o=zo.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),a=o.width,s=o.height,h=o.lines,l=o.lineHeight,u=o.lineWidths,c=o.maxLineWidth,p=o.fontProperties;this.canvas.width=Math.ceil((Math.max(1,a)+2*e.padding)*this._resolution),this.canvas.height=Math.ceil((Math.max(1,s)+2*e.padding)*this._resolution),n.scale(this._resolution,this._resolution),n.clearRect(0,0,this.canvas.width,this.canvas.height),n.font=this._font,n.lineWidth=e.strokeThickness,n.textBaseline=e.textBaseline,n.lineJoin=e.lineJoin,n.miterLimit=e.miterLimit;for(var d=e.dropShadow?2:1,f=0;f<d;++f){var m=e.dropShadow&&0===f,v=m?Math.ceil(Math.max(1,s)+2*e.padding):0,y=v*this._resolution;if(m){n.fillStyle="black",n.strokeStyle="black";var g=e.dropShadowColor,_=Ut("number"==typeof g?g:zt(g));n.shadowColor="rgba("+255*_[0]+","+255*_[1]+","+255*_[2]+","+e.dropShadowAlpha+")",n.shadowBlur=e.dropShadowBlur,n.shadowOffsetX=Math.cos(e.dropShadowAngle)*e.dropShadowDistance,n.shadowOffsetY=Math.sin(e.dropShadowAngle)*e.dropShadowDistance+y}else n.fillStyle=this._generateFillStyle(e,h,o),n.strokeStyle=e.stroke,n.shadowColor="black",n.shadowBlur=0,n.shadowOffsetX=0,n.shadowOffsetY=0;for(var x=0;x<h.length;x++)r=e.strokeThickness/2,i=e.strokeThickness/2+x*l+p.ascent,"right"===e.align?r+=c-u[x]:"center"===e.align&&(r+=(c-u[x])/2),e.stroke&&e.strokeThickness&&this.drawLetterSpacing(h[x],r+e.padding,i+e.padding-v,!0),e.fill&&this.drawLetterSpacing(h[x],r+e.padding,i+e.padding-v)}this.updateTexture()}},r.prototype.drawLetterSpacing=function(t,e,r,i){void 0===i&&(i=!1);var n=this._style.letterSpacing;if(0!==n)for(var o=e,a=Array.from?Array.from(t):t.split(""),s=this.context.measureText(t).width,h=0,l=0;l<a.length;++l){var u=a[l];i?this.context.strokeText(u,o,r):this.context.fillText(u,o,r),o+=s-(h=this.context.measureText(t.substring(l+1)).width)+n,s=h}else i?this.context.strokeText(t,e,r):this.context.fillText(t,e,r)},r.prototype.updateTexture=function(){var t=this.canvas;if(this._style.trim){var e=pe(t);e.data&&(t.width=e.width,t.height=e.height,this.context.putImageData(e.data,0,0))}var r=this._texture,i=this._style,n=i.trim?0:i.padding,o=r.baseTexture;r.trim.width=r._frame.width=Math.ceil(t.width/this._resolution),r.trim.height=r._frame.height=Math.ceil(t.height/this._resolution),r.trim.x=-n,r.trim.y=-n,r.orig.width=r._frame.width-2*n,r.orig.height=r._frame.height-2*n,this._onTextureUpdate(),o.setRealSize(t.width,t.height,this._resolution),this._recursivePostUpdateTransform(),this.dirty=!1},r.prototype._render=function(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),e.prototype._render.call(this,t)},r.prototype.getLocalBounds=function(t){return this.updateText(!0),e.prototype.getLocalBounds.call(this,t)},r.prototype._calculateBounds=function(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)},r.prototype._generateFillStyle=function(e,r,i){var n,o=e.fill;if(!Array.isArray(o))return o;if(1===o.length)return o[0];var a=e.dropShadow?e.dropShadowDistance:0,s=e.padding||0,h=Math.ceil(this.canvas.width/this._resolution)-a-2*s,l=Math.ceil(this.canvas.height/this._resolution)-a-2*s,u=o.slice(),c=e.fillGradientStops.slice();if(!c.length)for(var p=u.length+1,d=1;d<p;++d)c.push(d/p);if(u.unshift(o[0]),c.unshift(0),u.push(o[o.length-1]),c.push(1),e.fillGradientType===t.TEXT_GRADIENT.LINEAR_VERTICAL){n=this.context.createLinearGradient(h/2,s,h/2,l+s);var f=0,m=(i.fontProperties.fontSize+e.strokeThickness)/l;for(d=0;d<r.length;d++)for(var v=i.lineHeight*d,y=0;y<u.length;y++){var g=v/l+("number"==typeof c[y]?c[y]:y/u.length)*m,_=Math.max(f,g);_=Math.min(_,1),n.addColorStop(_,u[y]),f=_}}else{n=this.context.createLinearGradient(s,l/2,h+s,l/2);var x=u.length+1,b=1;for(d=0;d<u.length;d++){var w=void 0;w="number"==typeof c[d]?c[d]:b/x,n.addColorStop(w,u[d]),b++}}return n},r.prototype.destroy=function(t){"boolean"==typeof t&&(t={children:t}),t=Object.assign({},qo,t),e.prototype.destroy.call(this,t),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null},Object.defineProperty(r.prototype,"width",{get:function(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width},set:function(t){this.updateText(!0);var e=ie(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"height",{get:function(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height},set:function(t){this.updateText(!0);var e=ie(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"style",{get:function(){return this._style},set:function(t){t=t||{},this._style=t instanceof Xo?t:new Xo(t),this.localStyleID=-1,this.dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"text",{get:function(){return this._text},set:function(t){t=String(null==t?"":t),this._text!==t&&(this._text=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"resolution",{get:function(){return this._resolution},set:function(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)},enumerable:!1,configurable:!0}),r}(ko);
/*!
	 * @pixi/prepare - v5.3.7
	 * Compiled Tue, 29 Dec 2020 19:33:12 UTC
	 *
	 * @pixi/prepare is licensed under the MIT License.
	 * http://www.opensource.org/licenses/mit-license
	 */
O.UPLOADS_PER_FRAME=4;
/*! *****************************************************************************
	Copyright (c) Microsoft Corporation. All rights reserved.
	Licensed under the Apache License, Version 2.0 (the "License"); you may not use
	this file except in compliance with the License. You may obtain a copy of the
	License at http://www.apache.org/licenses/LICENSE-2.0

	THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
	KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
	WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
	MERCHANTABLITY OR NON-INFRINGEMENT.

	See the Apache Version 2.0 License for specific language governing permissions
	and limitations under the License.
	***************************************************************************** */
var Ho=function(t,e){return(Ho=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};var $o=function(){function t(t){this.maxItemsPerFrame=t,this.itemsLeft=0}return t.prototype.beginFrame=function(){this.itemsLeft=this.maxItemsPerFrame},t.prototype.allowedToUpload=function(){return this.itemsLeft-- >0},t}();function Jo(t,e){var r=!1;if(t&&t._textures&&t._textures.length)for(var i=0;i<t._textures.length;i++)if(t._textures[i]instanceof Rr){var n=t._textures[i].baseTexture;-1===e.indexOf(n)&&(e.push(n),r=!0)}return r}function Zo(t,e){if(t.baseTexture instanceof fr){var r=t.baseTexture;return-1===e.indexOf(r)&&e.push(r),!0}return!1}function Qo(t,e){if(t._texture&&t._texture instanceof Rr){var r=t._texture.baseTexture;return-1===e.indexOf(r)&&e.push(r),!0}return!1}function Ko(t,e){return e instanceof Go&&(e.updateText(!0),!0)}function ta(t,e){if(e instanceof Xo){var r=e.toFontString();return zo.measureFont(r),!0}return!1}function ea(t,e){if(t instanceof Go){-1===e.indexOf(t.style)&&e.push(t.style),-1===e.indexOf(t)&&e.push(t);var r=t._texture.baseTexture;return-1===e.indexOf(r)&&e.push(r),!0}return!1}function ra(t,e){return t instanceof Xo&&(-1===e.indexOf(t)&&e.push(t),!0)}var ia=function(){function e(t){var e=this;this.limiter=new $o(O.UPLOADS_PER_FRAME),this.renderer=t,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=function(){e.queue&&e.prepareItems()},this.registerFindHook(ea),this.registerFindHook(ra),this.registerFindHook(Jo),this.registerFindHook(Zo),this.registerFindHook(Qo),this.registerUploadHook(Ko),this.registerUploadHook(ta)}return e.prototype.upload=function(e,r){"function"==typeof e&&(r=e,e=null),e&&this.add(e),this.queue.length?(r&&this.completes.push(r),this.ticking||(this.ticking=!0,Je.system.addOnce(this.tick,this,t.UPDATE_PRIORITY.UTILITY))):r&&r()},e.prototype.tick=function(){setTimeout(this.delayedTick,0)},e.prototype.prepareItems=function(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){var e=this.queue[0],r=!1;if(e&&!e._destroyed)for(var i=0,n=this.uploadHooks.length;i<n;i++)if(this.uploadHooks[i](this.uploadHookHelper,e)){this.queue.shift(),r=!0;break}r||this.queue.shift()}if(this.queue.length)Je.system.addOnce(this.tick,this,t.UPDATE_PRIORITY.UTILITY);else{this.ticking=!1;var o=this.completes.slice(0);this.completes.length=0;for(i=0,n=o.length;i<n;i++)o[i]()}},e.prototype.registerFindHook=function(t){return t&&this.addHooks.push(t),this},e.prototype.registerUploadHook=function(t){return t&&this.uploadHooks.push(t),this},e.prototype.add=function(t){for(var e=0,r=this.addHooks.length;e<r&&!this.addHooks[e](t,this.queue);e++);if(t instanceof We)for(e=t.children.length-1;e>=0;e--)this.add(t.children[e]);return this},e.prototype.destroy=function(){this.ticking&&Je.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null},e}();function na(t,e){return e instanceof fr&&(e._glTextures[t.CONTEXT_UID]||t.texture.bind(e),!0)}function oa(t,e){if(!(e instanceof Ro))return!1;var r=e.geometry;e.finishPoly(),r.updateBatches();for(var i=r.batches,n=0;n<i.length;n++){var o=i[n].style.texture;o&&na(t,o.baseTexture)}return r.batchable||t.geometry.bind(r,e._resolveDirectShader(t)),!0}function aa(t,e){return t instanceof Ro&&(e.push(t),!0)}var sa=function(t){function e(e){var r=t.call(this,e)||this;return r.uploadHookHelper=r.renderer,r.registerFindHook(aa),r.registerUploadHook(na),r.registerUploadHook(oa),r}return function(t,e){function r(){this.constructor=t}Ho(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}(e,t),e}(ia),ha=function(){function t(t){this.maxMilliseconds=t,this.frameStart=0}return t.prototype.beginFrame=function(){this.frameStart=Date.now()},t.prototype.allowedToUpload=function(){return Date.now()-this.frameStart<this.maxMilliseconds},t}(),la=function(){function t(t,e,r){void 0===r&&(r=null),this._texture=t instanceof Rr?t:null,this.baseTexture=t instanceof fr?t:this._texture.baseTexture,this.textures={},this.animations={},this.data=e;var i=this.baseTexture.resource;this.resolution=this._updateResolution(r||(i?i.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}return t.prototype._updateResolution=function(t){void 0===t&&(t=null);var e=this.data.meta.scale,r=ve(t,null);return null===r&&(r=void 0!==e?parseFloat(e):1),1!==r&&this.baseTexture.setResolution(r),r},t.prototype.parse=function(e){this._batchIndex=0,this._callback=e,this._frameKeys.length<=t.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()},t.prototype._processFrames=function(e){for(var r=e,i=t.BATCH_SIZE;r-e<i&&r<this._frameKeys.length;){var n=this._frameKeys[r],o=this._frames[n],a=o.frame;if(a){var s=null,h=null,l=!1!==o.trimmed&&o.sourceSize?o.sourceSize:o.frame,u=new we(0,0,Math.floor(l.w)/this.resolution,Math.floor(l.h)/this.resolution);s=o.rotated?new we(Math.floor(a.x)/this.resolution,Math.floor(a.y)/this.resolution,Math.floor(a.h)/this.resolution,Math.floor(a.w)/this.resolution):new we(Math.floor(a.x)/this.resolution,Math.floor(a.y)/this.resolution,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution),!1!==o.trimmed&&o.spriteSourceSize&&(h=new we(Math.floor(o.spriteSourceSize.x)/this.resolution,Math.floor(o.spriteSourceSize.y)/this.resolution,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution)),this.textures[n]=new Rr(this.baseTexture,s,u,h,o.rotated?2:0,o.anchor),Rr.addToCache(this.textures[n],n)}r++}},t.prototype._processAnimations=function(){var t=this.data.animations||{};for(var e in t){this.animations[e]=[];for(var r=0;r<t[e].length;r++){var i=t[e][r];this.animations[e].push(this.textures[i])}}},t.prototype._parseComplete=function(){var t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)},t.prototype._nextBatch=function(){var e=this;this._processFrames(this._batchIndex*t.BATCH_SIZE),this._batchIndex++,setTimeout((function(){e._batchIndex*t.BATCH_SIZE<e._frameKeys.length?e._nextBatch():(e._processAnimations(),e._parseComplete())}),0)},t.prototype.destroy=function(t){var e;for(var r in void 0===t&&(t=!1),this.textures)this.textures[r].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&(null===(e=this._texture)||void 0===e||e.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null},t.BATCH_SIZE=1e3,t}(),ua=function(){function t(){}return t.use=function(e,r){var i=e.name+"_image";if(e.data&&e.type===Un.TYPE.JSON&&e.data.frames&&!this.resources[i]){var n={crossOrigin:e.crossOrigin,metadata:e.metadata.imageMetadata,parentResource:e},o=t.getResourcePath(e,this.baseUrl);this.add(i,o,n,(function(t){if(t.error)r(t.error);else{var i=new la(t.texture,e.data,e.url);i.parse((function(){e.spritesheet=i,e.textures=i.textures,r()}))}}))}else r()},t.getResourcePath=function(t,e){return t.isDataUrl?t.data.meta.image:Ft.resolve(t.url.replace(e,""),t.data.meta.image)},t}(),ca=function(t,e){return(ca=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function pa(t,e){function r(){this.constructor=t}ca(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var da=new Ie,fa=function(t){function e(e,r,i){void 0===r&&(r=100),void 0===i&&(i=100);var n=t.call(this,e)||this;return n.tileTransform=new Le,n._width=r,n._height=i,n.uvMatrix=n.texture.uvMatrix||new Ni(e),n.pluginName="tilingSprite",n.uvRespectAnchor=!1,n}return pa(e,t),Object.defineProperty(e.prototype,"clampMargin",{get:function(){return this.uvMatrix.clampMargin},set:function(t){this.uvMatrix.clampMargin=t,this.uvMatrix.update(!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tileScale",{get:function(){return this.tileTransform.scale},set:function(t){this.tileTransform.scale.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tilePosition",{get:function(){return this.tileTransform.position},set:function(t){this.tileTransform.position.copyFrom(t)},enumerable:!1,configurable:!0}),e.prototype._onTextureUpdate=function(){this.uvMatrix&&(this.uvMatrix.texture=this._texture),this._cachedTint=16777215},e.prototype._render=function(t){var e=this._texture;e&&e.valid&&(this.tileTransform.updateLocalTransform(),this.uvMatrix.update(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this))},e.prototype._calculateBounds=function(){var t=this._width*-this._anchor._x,e=this._height*-this._anchor._y,r=this._width*(1-this._anchor._x),i=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,t,e,r,i)},e.prototype.getLocalBounds=function(e){return 0===this.children.length?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new we),e=this._localBoundsRect),this._bounds.getRectangle(e)):t.prototype.getLocalBounds.call(this,e)},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,da);var e=this._width,r=this._height,i=-e*this.anchor._x;if(da.x>=i&&da.x<i+e){var n=-r*this.anchor._y;if(da.y>=n&&da.y<n+r)return!0}return!1},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.tileTransform=null,this.uvMatrix=null},e.from=function(t,r){return"number"==typeof r&&(se("5.3.0","TilingSprite.from use options instead of width and height args"),r={width:r,height:arguments[2]}),new e(Rr.from(t,r),r.width,r.height)},Object.defineProperty(e.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t},enumerable:!1,configurable:!0}),e}(ko),ma="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n",va=new Me,ya=function(e){function r(t){var r=e.call(this,t)||this,i={globals:r.renderer.globalUniforms};return r.shader=Ri.from(ma,"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    vec4 texSample = texture2D(uSampler, coord);\n    gl_FragColor = texSample * uColor;\n}\n",i),r.simpleShader=Ri.from(ma,"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\n\nvoid main(void)\n{\n    vec4 sample = texture2D(uSampler, vTextureCoord);\n    gl_FragColor = sample * uColor;\n}\n",i),r.quad=new Wr,r.state=Oi.for2d(),r}return pa(r,e),r.prototype.render=function(e){var r=this.renderer,i=this.quad,n=i.vertices;n[0]=n[6]=e._width*-e.anchor.x,n[1]=n[3]=e._height*-e.anchor.y,n[2]=n[4]=e._width*(1-e.anchor.x),n[5]=n[7]=e._height*(1-e.anchor.y),e.uvRespectAnchor&&((n=i.uvs)[0]=n[6]=-e.anchor.x,n[1]=n[3]=-e.anchor.y,n[2]=n[4]=1-e.anchor.x,n[5]=n[7]=1-e.anchor.y),i.invalidate();var o=e._texture,a=o.baseTexture,s=e.tileTransform.localTransform,h=e.uvMatrix,l=a.isPowerOfTwo&&o.frame.width===a.width&&o.frame.height===a.height;l&&(a._glTextures[r.CONTEXT_UID]?l=a.wrapMode!==t.WRAP_MODES.CLAMP:a.wrapMode===t.WRAP_MODES.CLAMP&&(a.wrapMode=t.WRAP_MODES.REPEAT));var u=l?this.simpleShader:this.shader,c=o.width,p=o.height,d=e._width,f=e._height;va.set(s.a*c/d,s.b*c/f,s.c*p/d,s.d*p/f,s.tx/d,s.ty/f),va.invert(),l?va.prepend(h.mapCoord):(u.uniforms.uMapCoord=h.mapCoord.toArray(!0),u.uniforms.uClampFrame=h.uClampFrame,u.uniforms.uClampOffset=h.uClampOffset),u.uniforms.uTransform=va.toArray(!0),u.uniforms.uColor=$t(e.tint,e.worldAlpha,u.uniforms.uColor,a.alphaMode),u.uniforms.translationMatrix=e.transform.worldTransform.toArray(!0),u.uniforms.uSampler=o,r.shader.bind(u),r.geometry.bind(i),this.state.blendMode=qt(e.blendMode,a.alphaMode),r.state.set(this.state),r.geometry.draw(this.renderer.gl.TRIANGLES,6,0)},r}(Jr),ga=function(t,e){return(ga=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function _a(t,e){function r(){this.constructor=t}ga(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var xa=function(){function t(t,e){this.uvBuffer=t,this.uvMatrix=e,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}return t.prototype.update=function(t){if(t||this._bufferUpdateId!==this.uvBuffer._updateID||this._textureUpdateId!==this.uvMatrix._updateID){this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;var e=this.uvBuffer.data;this.data&&this.data.length===e.length||(this.data=new Float32Array(e.length)),this.uvMatrix.multiplyUvs(e,this.data),this._updateID++}},t}(),ba=new Ie,wa=new Se,Ta=function(e){function r(r,i,n,o){void 0===o&&(o=t.DRAW_MODES.TRIANGLES);var a=e.call(this)||this;return a.geometry=r,r.refCount++,a.shader=i,a.state=n||Oi.for2d(),a.drawMode=o,a.start=0,a.size=0,a.uvs=null,a.indices=null,a.vertexData=new Float32Array(1),a.vertexDirty=0,a._transformID=-1,a._roundPixels=O.ROUND_PIXELS,a.batchUvs=null,a}return _a(r,e),Object.defineProperty(r.prototype,"uvBuffer",{get:function(){return this.geometry.buffers[1]},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"verticesBuffer",{get:function(){return this.geometry.buffers[0]},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"material",{get:function(){return this.shader},set:function(t){this.shader=t},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"tint",{get:function(){return this.shader.tint},set:function(t){this.shader.tint=t},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"texture",{get:function(){return this.shader.texture},set:function(t){this.shader.texture=t},enumerable:!1,configurable:!0}),r.prototype._render=function(e){var i=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===t.DRAW_MODES.TRIANGLES&&i.length<2*r.BATCHABLE_SIZE?this._renderToBatch(e):this._renderDefault(e)},r.prototype._renderDefault=function(t){var e=this.shader;e.alpha=this.worldAlpha,e.update&&e.update(),t.batch.flush(),e.program.uniformData.translationMatrix&&(e.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0)),t.shader.bind(e),t.state.set(this.state),t.geometry.bind(this.geometry,e),t.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)},r.prototype._renderToBatch=function(t){var e=this.geometry;this.shader.uvMatrix&&(this.shader.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=e.indexBuffer.data,this._tintRGB=this.shader._tintRGB,this._texture=this.shader.texture;var r=this.material.pluginName;t.batch.setObjectRenderer(t.plugins[r]),t.plugins[r].render(this)},r.prototype.calculateVertices=function(){var t=this.geometry,e=t.buffers[0].data;if(t.vertexDirtyId!==this.vertexDirty||this._transformID!==this.transform._worldID){this._transformID=this.transform._worldID,this.vertexData.length!==e.length&&(this.vertexData=new Float32Array(e.length));for(var r=this.transform.worldTransform,i=r.a,n=r.b,o=r.c,a=r.d,s=r.tx,h=r.ty,l=this.vertexData,u=0;u<l.length/2;u++){var c=e[2*u],p=e[2*u+1];l[2*u]=i*c+o*p+s,l[2*u+1]=n*c+a*p+h}if(this._roundPixels){var d=O.RESOLUTION;for(u=0;u<l.length;++u)l[u]=Math.round((l[u]*d|0)/d)}this.vertexDirty=t.vertexDirtyId}},r.prototype.calculateUvs=function(){var t=this.geometry.buffers[1];this.shader.uvMatrix.isSimple?this.uvs=t.data:(this.batchUvs||(this.batchUvs=new xa(t,this.shader.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)},r.prototype._calculateBounds=function(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)},r.prototype.containsPoint=function(t){if(!this.getBounds().contains(t.x,t.y))return!1;this.worldTransform.applyInverse(t,ba);for(var e=this.geometry.getBuffer("aVertexPosition").data,r=wa.points,i=this.geometry.getIndex().data,n=i.length,o=4===this.drawMode?3:1,a=0;a+2<n;a+=o){var s=2*i[a],h=2*i[a+1],l=2*i[a+2];if(r[0]=e[s],r[1]=e[s+1],r[2]=e[h],r[3]=e[h+1],r[4]=e[l],r[5]=e[l+1],wa.contains(ba.x,ba.y))return!0}return!1},r.prototype.destroy=function(t){e.prototype.destroy.call(this,t),this.geometry.refCount--,0===this.geometry.refCount&&this.geometry.dispose(),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null},r.BATCHABLE_SIZE=100,r}(We),Ea=function(t){function e(e,r){var i=this,n={uSampler:e,alpha:1,uTextureMatrix:Me.IDENTITY,uColor:new Float32Array([1,1,1,1])};return(r=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},r)).uniforms&&Object.assign(n,r.uniforms),(i=t.call(this,r.program||Ci.from("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTextureMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\n}\n","varying vec2 vTextureCoord;\nuniform vec4 uColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;\n}\n"),n)||this)._colorDirty=!1,i.uvMatrix=new Ni(e),i.batchable=void 0===r.program,i.pluginName=r.pluginName,i.tint=r.tint,i.alpha=r.alpha,i}return _a(e,t),Object.defineProperty(e.prototype,"texture",{get:function(){return this.uniforms.uSampler},set:function(t){this.uniforms.uSampler!==t&&(this.uniforms.uSampler=t,this.uvMatrix.texture=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this._alpha},set:function(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){t!==this._tint&&(this._tint=t,this._tintRGB=(t>>16)+(65280&t)+((255&t)<<16),this._colorDirty=!0)},enumerable:!1,configurable:!0}),e.prototype.update=function(){if(this._colorDirty){this._colorDirty=!1;var t=this.texture.baseTexture;$t(this._tint,this._alpha,this.uniforms.uColor,t.alphaMode)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)},e}(Ri),Sa=function(e){function r(r,i,n){var o=e.call(this)||this,a=new Fr(r),s=new Fr(i,!0),h=new Fr(n,!0,!0);return o.addAttribute("aVertexPosition",a,2,!1,t.TYPES.FLOAT).addAttribute("aTextureCoord",s,2,!1,t.TYPES.FLOAT).addIndex(h),o._updateId=-1,o}return _a(r,e),Object.defineProperty(r.prototype,"vertexDirtyId",{get:function(){return this.buffers[0]._updateID},enumerable:!1,configurable:!0}),r}(Yr),Aa=function(t,e){return(Aa=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};var Ia=function(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[]},Pa=function(){function t(){}return t.test=function(t){return"string"==typeof t&&0===t.indexOf("info face=")},t.parse=function(t){var e=t.match(/^[a-z]+\s+.+$/gm),r={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[]};for(var i in e){var n=e[i].match(/^[a-z]+/gm)[0],o=e[i].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),a={};for(var s in o){var h=o[s].split("="),l=h[0],u=h[1].replace(/"/gm,""),c=parseFloat(u),p=isNaN(c)?u:c;a[l]=p}r[n].push(a)}var d=new Ia;return r.info.forEach((function(t){return d.info.push({face:t.face,size:parseInt(t.size,10)})})),r.common.forEach((function(t){return d.common.push({lineHeight:parseInt(t.lineHeight,10)})})),r.page.forEach((function(t){return d.page.push({id:parseInt(t.id,10),file:t.file})})),r.char.forEach((function(t){return d.char.push({id:parseInt(t.id,10),page:parseInt(t.page,10),x:parseInt(t.x,10),y:parseInt(t.y,10),width:parseInt(t.width,10),height:parseInt(t.height,10),xoffset:parseInt(t.xoffset,10),yoffset:parseInt(t.yoffset,10),xadvance:parseInt(t.xadvance,10)})})),r.kerning.forEach((function(t){return d.kerning.push({first:parseInt(t.first,10),second:parseInt(t.second,10),amount:parseInt(t.amount,10)})})),d},t}(),Ma=function(){function t(){}return t.test=function(t){return t instanceof XMLDocument&&t.getElementsByTagName("page").length&&null!==t.getElementsByTagName("info")[0].getAttribute("face")},t.parse=function(t){for(var e=new Ia,r=t.getElementsByTagName("info"),i=t.getElementsByTagName("common"),n=t.getElementsByTagName("page"),o=t.getElementsByTagName("char"),a=t.getElementsByTagName("kerning"),s=0;s<r.length;s++)e.info.push({face:r[s].getAttribute("face"),size:parseInt(r[s].getAttribute("size"),10)});for(s=0;s<i.length;s++)e.common.push({lineHeight:parseInt(i[s].getAttribute("lineHeight"),10)});for(s=0;s<n.length;s++)e.page.push({id:parseInt(n[s].getAttribute("id"),10)||0,file:n[s].getAttribute("file")});for(s=0;s<o.length;s++){var h=o[s];e.char.push({id:parseInt(h.getAttribute("id"),10),page:parseInt(h.getAttribute("page"),10)||0,x:parseInt(h.getAttribute("x"),10),y:parseInt(h.getAttribute("y"),10),width:parseInt(h.getAttribute("width"),10),height:parseInt(h.getAttribute("height"),10),xoffset:parseInt(h.getAttribute("xoffset"),10),yoffset:parseInt(h.getAttribute("yoffset"),10),xadvance:parseInt(h.getAttribute("xadvance"),10)})}for(s=0;s<a.length;s++)e.kerning.push({first:parseInt(a[s].getAttribute("first"),10),second:parseInt(a[s].getAttribute("second"),10),amount:parseInt(a[s].getAttribute("amount"),10)});return e},t}(),Ca=function(){function t(){}return t.test=function(t){if("string"==typeof t&&t.indexOf("<font>")>-1){var e=(new self.DOMParser).parseFromString(t,"text/xml");return Ma.test(e)}return!1},t.parse=function(t){var e=(new window.DOMParser).parseFromString(t,"text/xml");return Ma.parse(e)},t}(),Ra=[Pa,Ma,Ca];function Oa(t){for(var e=0;e<Ra.length;e++)if(Ra[e].test(t))return Ra[e];return null}function Da(e,r,i,n,o,a){var s,h=i.fill;if(!Array.isArray(h))return h;if(1===h.length)return h[0];var l=i.dropShadow?i.dropShadowDistance:0,u=i.padding||0,c=Math.ceil(e.width/n)-l-2*u,p=Math.ceil(e.height/n)-l-2*u,d=h.slice(),f=i.fillGradientStops.slice();if(!f.length)for(var m=d.length+1,v=1;v<m;++v)f.push(v/m);if(d.unshift(h[0]),f.unshift(0),d.push(h[h.length-1]),f.push(1),i.fillGradientType===t.TEXT_GRADIENT.LINEAR_VERTICAL){s=r.createLinearGradient(c/2,u,c/2,p+u);var y=0,g=(a.fontProperties.fontSize+i.strokeThickness)/p;for(v=0;v<o.length;v++)for(var _=a.lineHeight*v,x=0;x<d.length;x++){var b=_/p+("number"==typeof f[x]?f[x]:x/d.length)*g,w=Math.max(y,b);w=Math.min(w,1),s.addColorStop(w,d[x]),y=w}}else{s=r.createLinearGradient(u,p/2,c+u,p/2);var T=d.length+1,E=1;for(v=0;v<d.length;v++){var S=void 0;S="number"==typeof f[v]?f[v]:E/T,s.addColorStop(S,d[v]),E++}}return s}function Ba(t,e,r,i,n,o,a){var s=r.text,h=r.fontProperties;e.translate(i,n),e.scale(o,o);var l=a.strokeThickness/2,u=-a.strokeThickness/2;e.font=a.toFontString(),e.lineWidth=a.strokeThickness,e.textBaseline=a.textBaseline,e.lineJoin=a.lineJoin,e.miterLimit=a.miterLimit,e.fillStyle=Da(t,e,a,o,[s],r),e.strokeStyle=a.stroke,e.font=a.toFontString(),e.lineWidth=a.strokeThickness,e.textBaseline=a.textBaseline,e.lineJoin=a.lineJoin,e.miterLimit=a.miterLimit,e.fillStyle=Da(t,e,a,o,[s],r),e.strokeStyle=a.stroke;var c=a.dropShadowColor,p=Ut("number"==typeof c?c:zt(c));a.dropShadow?(e.shadowColor="rgba("+255*p[0]+","+255*p[1]+","+255*p[2]+","+a.dropShadowAlpha+")",e.shadowBlur=a.dropShadowBlur,e.shadowOffsetX=Math.cos(a.dropShadowAngle)*a.dropShadowDistance,e.shadowOffsetY=Math.sin(a.dropShadowAngle)*a.dropShadowDistance):(e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0),a.stroke&&a.strokeThickness&&e.strokeText(s,l,u+r.lineHeight-h.descent),a.fill&&e.fillText(s,l,u+r.lineHeight-h.descent),e.setTransform(1,0,0,1,0,0),e.fillStyle="rgba(0, 0, 0, 0)"}var Na=function(){function t(t,e){var r=t.info[0],i=t.common[0],n=ve(t.page[0].file),o={};this.font=r.face,this.size=r.size,this.lineHeight=i.lineHeight/n,this.chars={},this.pageTextures=o;for(var a=0;a<t.page.length;a++){var s=t.page[a],h=s.id,l=s.file;o[h]=e instanceof Array?e[a]:e[l]}for(a=0;a<t.char.length;a++){var u=t.char[a],c=(h=u.id,u.page),p=t.char[a],d=p.x,f=p.y,m=p.width,v=p.height,y=p.xoffset,g=p.yoffset,_=p.xadvance;f/=n,m/=n,v/=n,y/=n,g/=n,_/=n;var x=new we((d/=n)+o[c].frame.x/n,f+o[c].frame.y/n,m,v);this.chars[h]={xOffset:y,yOffset:g,xAdvance:_,kerning:{},texture:new Rr(o[c].baseTexture,x),page:c}}for(a=0;a<t.kerning.length;a++){var b=t.kerning[a],w=b.first,T=b.second,E=b.amount;w/=n,T/=n,E/=n,this.chars[T]&&(this.chars[T].kerning[w]=E)}}return t.prototype.destroy=function(){for(var t in this.chars)this.chars[t].texture.destroy(),this.chars[t].texture=null;for(var t in this.pageTextures)this.pageTextures[t].destroy(!0),this.pageTextures[t]=null;this.chars=null,this.pageTextures=null},t.install=function(e,r){var i;if(e instanceof Ia)i=e;else{var n=Oa(e);if(!n)throw new Error("Unrecognized data format for font.");i=n.parse(e)}r instanceof Rr&&(r=[r]);var o=new t(i,r);return t.available[o.font]=o,o},t.uninstall=function(e){var r=t.available[e];if(!r)throw new Error("No font found named '"+e+"'");r.destroy(),delete t.available[e]},t.from=function(e,r,i){if(!e)throw new Error("[BitmapFont] Property `name` is required.");var n=Object.assign({},t.defaultOptions,i),o=n.chars,a=n.padding,s=n.resolution,h=n.textureWidth,l=n.textureHeight,u=o,c=r instanceof Xo?r:new Xo(r),p=h,d=new Ia;d.info[0]={face:c.fontFamily,size:c.fontSize},d.common[0]={lineHeight:c.fontSize};for(var f,m,v,y=0,g=0,_=0,x=[],b=0;b<u.length;b++){f||((f=document.createElement("canvas")).width=h,f.height=l,m=f.getContext("2d"),v=new fr(f,{resolution:s}),x.push(new Rr(v)),d.page.push({id:x.length-1,file:""}));var w=zo.measureText(u[b],c,!1,f),T=w.width,E=Math.ceil(w.height),S=Math.ceil(("italic"===c.fontStyle?2:1)*T);if(g>=l-E*s){if(0===g)throw new Error("[BitmapFont] textureHeight "+l+"px is too small for "+c.fontSize+"px fonts");--b,f=null,m=null,v=null,g=0,y=0,_=0}else if(_=Math.max(E+w.fontProperties.descent,_),S*s+y>=p)--b,g+=_*s,g=Math.ceil(g),y=0,_=0;else{Ba(f,m,w,y,g,s,c);var A=w.text;d.char.push({id:A,page:x.length-1,x:y/s,y:g/s,width:S,height:E,xoffset:0,yoffset:0,xadvance:Math.ceil(T-(c.dropShadow?c.dropShadowDistance:0)-(c.stroke?c.strokeThickness:0))}),y+=(S+2*a)*s,y=Math.ceil(y)}}var I=new t(d,x);return void 0!==t.available[e]&&t.uninstall(e),t.available[e]=I,I},t.ALPHA=[["a","z"],["A","Z"]," "],t.NUMERIC=[["0","9"]],t.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],t.ASCII=[[" ","~"]],t.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:t.ALPHANUMERIC},t.available={},t}(),ka=[],Fa=[],La=function(t){function e(r,i){void 0===i&&(i={});var n=t.call(this)||this;n._tint=16777215,i.font&&(se("5.3.0","PIXI.BitmapText constructor style.font property is deprecated."),n._upgradeStyle(i));var o=Object.assign({},e.styleDefaults,i),a=o.align,s=o.tint,h=o.maxWidth,l=o.letterSpacing,u=o.fontName,c=o.fontSize;if(!Na.available[u])throw new Error('Missing BitmapFont "'+u+'"');return n._activePagesMeshData=[],n._textWidth=0,n._textHeight=0,n._align=a,n._tint=s,n._fontName=u,n._fontSize=c||Na.available[u].size,n._text=r,n._maxWidth=h,n._maxLineHeight=0,n._letterSpacing=l,n._anchor=new Pe((function(){n.dirty=!0}),n,0,0),n._roundPixels=O.ROUND_PIXELS,n.dirty=!0,n._textureCache={},n}return function(t,e){function r(){this.constructor=t}Aa(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}(e,t),e.prototype.updateText=function(){for(var t,r=Na.available[this._fontName],i=this._fontSize/r.size,n=new Ie,o=[],a=[],s=window.graphemeSplitter.splitGraphemes(this._text.replace(/(?:\r\n|\r)/g,"\n")||" "),h=s.length,l=this._maxWidth*r.size/this._fontSize,u=null,c=0,p=0,d=0,f=-1,m=0,v=0,y=0,g=e.breakWords&&this.breakWords,_=0;_<h;_++){var x=s[_],b=s[_];if(/(?:\s)/.test(b)&&(f=_,m=c),"\r"!==b&&"\n"!==b){var w=r.chars[x];if(w){u&&w.kerning[u]&&(n.x+=w.kerning[u]);var T=Fa.pop()||{texture:Rr.EMPTY,line:0,charCode:0,position:new Ie};T.texture=w.texture,T.line=d,T.charCode=x,T.position.x=n.x+w.xOffset+this._letterSpacing/2,T.position.y=n.y+w.yOffset,o.push(T),n.x+=w.xAdvance+this._letterSpacing,c=n.x,y=Math.max(y,w.yOffset+w.texture.height),u=x,!g&&-1!==f&&l>0&&n.x>l&&(re(o,1+f-++v,1+_-f),_=f,f=-1,a.push(m),p=Math.max(p,m),d++,n.x=0,n.y+=r.lineHeight,u=null),g&&l>0&&n.x>l&&(d++,n.x=0,n.y+=r.lineHeight)}}else a.push(c),p=Math.max(p,c),++d,++v,n.x=0,n.y+=r.lineHeight,u=null}var E=s[s.length-1];"\r"!==E&&"\n"!==E&&(/(?:\s)/.test(E)&&(c=m),a.push(c),p=Math.max(p,c));var S=[];for(_=0;_<=d;_++){var A=0;"right"===this._align?A=p-a[_]:"center"===this._align&&(A=(p-a[_])/2),S.push(A)}var I=o.length,P={},M=[],C=this._activePagesMeshData;for(_=0;_<C.length;_++)ka.push(C[_]);for(_=0;_<I;_++){var R=(X=o[_].texture).baseTexture.uid;if(!P[R]){if(!(G=ka.pop())){var O=new Sa,D=new Ea(Rr.EMPTY);G={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:new Ta(O,D),vertices:null,uvs:null,indices:null}}G.index=0,G.indexCount=0,G.vertexCount=0,G.uvsCount=0,G.total=0;var B=this._textureCache;B[R]=B[R]||new Rr(X.baseTexture),G.mesh.texture=B[R],G.mesh.tint=this._tint,M.push(G),P[R]=G}P[R].total++}for(_=0;_<C.length;_++)-1===M.indexOf(C[_])&&this.removeChild(C[_].mesh);for(_=0;_<M.length;_++)M[_].mesh.parent!==this&&this.addChild(M[_].mesh);for(var _ in this._activePagesMeshData=M,P){var N=(G=P[_]).total;if(!((null===(t=G.indices)||void 0===t?void 0:t.length)>6*N)||G.vertices.length<2*Ta.BATCHABLE_SIZE)G.vertices=new Float32Array(8*N),G.uvs=new Float32Array(8*N),G.indices=new Uint16Array(6*N);else for(var k=G.total,F=G.vertices,L=4*k*2;L<F.length;L++)F[L]=0;G.mesh.size=6*N}for(_=0;_<I;_++){var V=(b=o[_]).position.x+S[b.line];this._roundPixels&&(V=Math.round(V));var X,j=V*i,U=b.position.y*i,Y=P[(X=b.texture).baseTexture.uid],z=X.frame,W=X._uvs,q=Y.index++;Y.indices[6*q+0]=0+4*q,Y.indices[6*q+1]=1+4*q,Y.indices[6*q+2]=2+4*q,Y.indices[6*q+3]=0+4*q,Y.indices[6*q+4]=2+4*q,Y.indices[6*q+5]=3+4*q,Y.vertices[8*q+0]=j,Y.vertices[8*q+1]=U,Y.vertices[8*q+2]=j+z.width*i,Y.vertices[8*q+3]=U,Y.vertices[8*q+4]=j+z.width*i,Y.vertices[8*q+5]=U+z.height*i,Y.vertices[8*q+6]=j,Y.vertices[8*q+7]=U+z.height*i,Y.uvs[8*q+0]=W.x0,Y.uvs[8*q+1]=W.y0,Y.uvs[8*q+2]=W.x1,Y.uvs[8*q+3]=W.y1,Y.uvs[8*q+4]=W.x2,Y.uvs[8*q+5]=W.y2,Y.uvs[8*q+6]=W.x3,Y.uvs[8*q+7]=W.y3}for(var _ in this._textWidth=p*i,this._textHeight=(n.y+r.lineHeight)*i,P){var G=P[_];if(0!==this.anchor.x||0!==this.anchor.y)for(var H=0,$=this._textWidth*this.anchor.x,J=this._textHeight*this.anchor.y,Z=0;Z<G.total;Z++)G.vertices[H++]-=$,G.vertices[H++]-=J,G.vertices[H++]-=$,G.vertices[H++]-=J,G.vertices[H++]-=$,G.vertices[H++]-=J,G.vertices[H++]-=$,G.vertices[H++]-=J;this._maxLineHeight=y*i;var Q=G.mesh.geometry.getBuffer("aVertexPosition"),K=G.mesh.geometry.getBuffer("aTextureCoord"),tt=G.mesh.geometry.getIndex();Q.data=G.vertices,K.data=G.uvs,tt.data=G.indices,Q.update(),K.update(),tt.update()}for(_=0;_<o.length;_++)Fa.push(o[_])},e.prototype.updateTransform=function(){this.validate(),this.containerUpdateTransform()},e.prototype.getLocalBounds=function(){return this.validate(),t.prototype.getLocalBounds.call(this)},e.prototype.validate=function(){this.dirty&&(this.updateText(),this.dirty=!1)},Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){if(this._tint!==t){this._tint=t;for(var e=0;e<this._activePagesMeshData.length;e++)this._activePagesMeshData[e].mesh.tint=t}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"align",{get:function(){return this._align},set:function(t){this._align!==t&&(this._align=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontName",{get:function(){return this._fontName},set:function(t){if(!Na.available[t])throw new Error('Missing BitmapFont "'+t+'"');this._fontName!==t&&(this._fontName=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontSize",{get:function(){return this._fontSize},set:function(t){this._fontSize!==t&&(this._fontSize=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"anchor",{get:function(){return this._anchor},set:function(t){"number"==typeof t?this._anchor.set(t):this._anchor.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this._text},set:function(t){t=String(null==t?"":t),this._text!==t&&(this._text=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxWidth",{get:function(){return this._maxWidth},set:function(t){this._maxWidth!==t&&(this._maxWidth=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxLineHeight",{get:function(){return this.validate(),this._maxLineHeight},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textWidth",{get:function(){return this.validate(),this._textWidth},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(t){t!==this._roundPixels&&(this._roundPixels=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textHeight",{get:function(){return this.validate(),this._textHeight},enumerable:!1,configurable:!0}),e.prototype._upgradeStyle=function(t){if("string"==typeof t.font){var e=t.font.split(" ");t.fontName=1===e.length?e[0]:e.slice(1).join(" "),e.length>=2&&(t.fontSize=parseInt(e[0],10))}else t.fontName=t.font.name,t.fontSize="number"==typeof t.font.size?t.font.size:parseInt(t.font.size,10)},e.prototype.destroy=function(e){var r=this._textureCache;for(var i in r){r[i].destroy(),delete r[i]}this._textureCache=null,t.prototype.destroy.call(this,e)},e.registerFont=function(t,e){return se("5.3.0","PIXI.BitmapText.registerFont is deprecated, use PIXI.BitmapFont.install"),Na.install(t,e)},Object.defineProperty(e,"fonts",{get:function(){return se("5.3.0","PIXI.BitmapText.fonts is deprecated, use PIXI.BitmapFont.available"),Na.available},enumerable:!1,configurable:!0}),e.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0},e}(We),Va=function(){function t(){}return t.add=function(){Un.setExtensionXhrType("fnt",Un.XHR_RESPONSE_TYPE.TEXT)},t.use=function(e,r){var i=Oa(e.data);if(i)for(var n=t.getBaseUrl(this,e),o=i.parse(e.data),a={},s=function(t){a[t.metadata.pageFile]=t.texture,Object.keys(a).length===o.page.length&&(e.bitmapFont=Na.install(o,a),r())},h=0;h<o.page.length;++h){var l=o.page[h].file,u=n+l,c=!1;for(var p in this.resources){var d=this.resources[p];if(d.url===u){d.metadata.pageFile=l,d.texture?s(d):d.onAfterMiddleware.add(s),c=!0;break}}if(!c){var f={crossOrigin:e.crossOrigin,loadType:Un.LOAD_TYPE.IMAGE,metadata:Object.assign({pageFile:l},e.metadata.imageMetadata),parentResource:e};this.add(u,f,s)}}else r()},t.getBaseUrl=function(e,r){var i=r.isDataUrl?"":t.dirname(r.url);return r.isDataUrl&&("."===i&&(i=""),e.baseUrl&&i&&"/"===e.baseUrl.charAt(e.baseUrl.length-1)&&(i+="/")),(i=i.replace(e.baseUrl,""))&&"/"!==i.charAt(i.length-1)&&(i+="/"),i},t.dirname=function(t){var e=t.replace(/\\/g,"/").replace(/\/$/,"").replace(/\/[^\/]*$/,"");return e===t?".":""===e?"/":e},t}(),Xa=function(t,e){return(Xa=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};var ja=function(t){function e(e){void 0===e&&(e=1);var r=t.call(this,sn,"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float uAlpha;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;\n}\n",{uAlpha:1})||this;return r.alpha=e,r}return function(t,e){function r(){this.constructor=t}Xa(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}(e,t),Object.defineProperty(e.prototype,"alpha",{get:function(){return this.uniforms.uAlpha},set:function(t){this.uniforms.uAlpha=t},enumerable:!1,configurable:!0}),e}(Di),Ua=function(t,e){return(Ua=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function Ya(t,e){function r(){this.constructor=t}Ua(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var za,Wa,qa,Ga,Ha,$a,Ja,Za,Qa,Ka,ts,es,rs,is,ns,os,as,ss={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},hs=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join("\n");!function(t){t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2"}(za||(za={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS"}(Wa||(Wa={})),function(t){t[t.COLOR=16384]="COLOR",t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL"}(qa||(qa={})),function(t){t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR"}(Ga||(Ga={})),function(t){t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(Ha||(Ha={})),function(t){t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}($a||($a={})),function(t){t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(Ja||(Ja={})),function(t){t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.FLOAT=5126]="FLOAT",t[t.HALF_FLOAT=36193]="HALF_FLOAT"}(Za||(Za={})),function(t){t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR"}(Qa||(Qa={})),function(t){t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(Ka||(Ka={})),function(t){t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON"}(ts||(ts={})),function(t){t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA"}(es||(es={})),function(t){t[t.NO=0]="NO",t[t.YES=1]="YES",t[t.AUTO=2]="AUTO",t[t.BLEND=0]="BLEND",t[t.CLEAR=1]="CLEAR",t[t.BLIT=2]="BLIT"}(rs||(rs={})),function(t){t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL"}(is||(is={})),function(t){t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp"}(ns||(ns={})),function(t){t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE"}(os||(os={})),function(t){t[t.NONE=0]="NONE",t[t.LOW=2]="LOW",t[t.MEDIUM=4]="MEDIUM",t[t.HIGH=8]="HIGH"}(as||(as={}));var ls=function(t){function e(e,r,i,n,o){void 0===r&&(r=8),void 0===i&&(i=4),void 0===n&&(n=O.FILTER_RESOLUTION),void 0===o&&(o=5);var a=this,s=function(t,e){var r,i=Math.ceil(t/2),n="\n    attribute vec2 aVertexPosition;\n\n    uniform mat3 projectionMatrix;\n\n    uniform float strength;\n\n    varying vec2 vBlurTexCoords[%size%];\n\n    uniform vec4 inputSize;\n    uniform vec4 outputFrame;\n\n    vec4 filterVertexPosition( void )\n    {\n        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n    }\n\n    vec2 filterTextureCoord( void )\n    {\n        return aVertexPosition * (outputFrame.zw * inputSize.zw);\n    }\n\n    void main(void)\n    {\n        gl_Position = filterVertexPosition();\n\n        vec2 textureCoord = filterTextureCoord();\n        %blur%\n    }",o="";r=e?"vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":"vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(var a=0;a<t;a++){var s=r.replace("%index%",a.toString());o+=s=s.replace("%sampleIndex%",a-(i-1)+".0"),o+="\n"}return n=(n=n.replace("%blur%",o)).replace("%size%",t.toString())}(o,e),h=function(t){for(var e,r=ss[t],i=r.length,n=hs,o="",a=0;a<t;a++){var s="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;".replace("%index%",a.toString());e=a,a>=i&&(e=t-a-1),o+=s=s.replace("%value%",r[e].toString()),o+="\n"}return n=(n=n.replace("%blur%",o)).replace("%size%",t.toString())}(o);return(a=t.call(this,s,h)||this).horizontal=e,a.resolution=n,a._quality=0,a.quality=i,a.blur=r,a}return Ya(e,t),e.prototype.apply=function(t,e,r,i){if(r?this.horizontal?this.uniforms.strength=1/r.width*(r.width/e.width):this.uniforms.strength=1/r.height*(r.height/e.height):this.horizontal?this.uniforms.strength=1/t.renderer.width*(t.renderer.width/e.width):this.uniforms.strength=1/t.renderer.height*(t.renderer.height/e.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,1===this.passes)t.applyFilter(this,e,r,i);else{var n=t.getFilterTexture(),o=t.renderer,a=e,s=n;this.state.blend=!1,t.applyFilter(this,a,s,rs.CLEAR);for(var h=1;h<this.passes-1;h++){t.bindAndClear(a,rs.BLIT),this.uniforms.uSampler=s;var l=s;s=a,a=l,o.shader.bind(this),o.geometry.draw(5)}this.state.blend=!0,t.applyFilter(this,s,r,i),t.returnFilterTexture(n)}},Object.defineProperty(e.prototype,"blur",{get:function(){return this.strength},set:function(t){this.padding=1+2*Math.abs(t),this.strength=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"quality",{get:function(){return this._quality},set:function(t){this._quality=t,this.passes=t},enumerable:!1,configurable:!0}),e}(Di),us=function(t){function e(e,r,i,n){void 0===e&&(e=8),void 0===r&&(r=4),void 0===i&&(i=O.FILTER_RESOLUTION),void 0===n&&(n=5);var o=t.call(this)||this;return o.blurXFilter=new ls(!0,e,r,i,n),o.blurYFilter=new ls(!1,e,r,i,n),o.resolution=i,o.quality=r,o.blur=e,o.repeatEdgePixels=!1,o}return Ya(e,t),e.prototype.apply=function(t,e,r,i){var n=Math.abs(this.blurXFilter.strength),o=Math.abs(this.blurYFilter.strength);if(n&&o){var a=t.getFilterTexture();this.blurXFilter.apply(t,e,a,rs.CLEAR),this.blurYFilter.apply(t,a,r,i),t.returnFilterTexture(a)}else o?this.blurYFilter.apply(t,e,r,i):this.blurXFilter.apply(t,e,r,i)},e.prototype.updatePadding=function(){this._repeatEdgePixels?this.padding=0:this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))},Object.defineProperty(e.prototype,"blur",{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"quality",{get:function(){return this.blurXFilter.quality},set:function(t){this.blurXFilter.quality=this.blurYFilter.quality=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blurX",{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=t,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blurY",{get:function(){return this.blurYFilter.blur},set:function(t){this.blurYFilter.blur=t,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.blurYFilter.blendMode},set:function(t){this.blurYFilter.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"repeatEdgePixels",{get:function(){return this._repeatEdgePixels},set:function(t){this._repeatEdgePixels=t,this.updatePadding()},enumerable:!1,configurable:!0}),e}(Di),cs=function(t,e){return(cs=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};var ps=function(t){function e(){var e=this,r={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};return(e=t.call(this,hn,"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[20];\nuniform float uAlpha;\n\nvoid main(void)\n{\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    if (uAlpha == 0.0) {\n        gl_FragColor = c;\n        return;\n    }\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (c.a > 0.0) {\n      c.rgb /= c.a;\n    }\n\n    vec4 result;\n\n    result.r = (m[0] * c.r);\n        result.r += (m[1] * c.g);\n        result.r += (m[2] * c.b);\n        result.r += (m[3] * c.a);\n        result.r += m[4];\n\n    result.g = (m[5] * c.r);\n        result.g += (m[6] * c.g);\n        result.g += (m[7] * c.b);\n        result.g += (m[8] * c.a);\n        result.g += m[9];\n\n    result.b = (m[10] * c.r);\n       result.b += (m[11] * c.g);\n       result.b += (m[12] * c.b);\n       result.b += (m[13] * c.a);\n       result.b += m[14];\n\n    result.a = (m[15] * c.r);\n       result.a += (m[16] * c.g);\n       result.a += (m[17] * c.b);\n       result.a += (m[18] * c.a);\n       result.a += m[19];\n\n    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);\n\n    // Premultiply alpha again.\n    rgb *= result.a;\n\n    gl_FragColor = vec4(rgb, result.a);\n}\n",r)||this).alpha=1,e}return function(t,e){function r(){this.constructor=t}cs(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}(e,t),e.prototype._loadMatrix=function(t,e){void 0===e&&(e=!1);var r=t;e&&(this._multiply(r,this.uniforms.m,t),r=this._colorMatrix(r)),this.uniforms.m=r},e.prototype._multiply=function(t,e,r){return t[0]=e[0]*r[0]+e[1]*r[5]+e[2]*r[10]+e[3]*r[15],t[1]=e[0]*r[1]+e[1]*r[6]+e[2]*r[11]+e[3]*r[16],t[2]=e[0]*r[2]+e[1]*r[7]+e[2]*r[12]+e[3]*r[17],t[3]=e[0]*r[3]+e[1]*r[8]+e[2]*r[13]+e[3]*r[18],t[4]=e[0]*r[4]+e[1]*r[9]+e[2]*r[14]+e[3]*r[19]+e[4],t[5]=e[5]*r[0]+e[6]*r[5]+e[7]*r[10]+e[8]*r[15],t[6]=e[5]*r[1]+e[6]*r[6]+e[7]*r[11]+e[8]*r[16],t[7]=e[5]*r[2]+e[6]*r[7]+e[7]*r[12]+e[8]*r[17],t[8]=e[5]*r[3]+e[6]*r[8]+e[7]*r[13]+e[8]*r[18],t[9]=e[5]*r[4]+e[6]*r[9]+e[7]*r[14]+e[8]*r[19]+e[9],t[10]=e[10]*r[0]+e[11]*r[5]+e[12]*r[10]+e[13]*r[15],t[11]=e[10]*r[1]+e[11]*r[6]+e[12]*r[11]+e[13]*r[16],t[12]=e[10]*r[2]+e[11]*r[7]+e[12]*r[12]+e[13]*r[17],t[13]=e[10]*r[3]+e[11]*r[8]+e[12]*r[13]+e[13]*r[18],t[14]=e[10]*r[4]+e[11]*r[9]+e[12]*r[14]+e[13]*r[19]+e[14],t[15]=e[15]*r[0]+e[16]*r[5]+e[17]*r[10]+e[18]*r[15],t[16]=e[15]*r[1]+e[16]*r[6]+e[17]*r[11]+e[18]*r[16],t[17]=e[15]*r[2]+e[16]*r[7]+e[17]*r[12]+e[18]*r[17],t[18]=e[15]*r[3]+e[16]*r[8]+e[17]*r[13]+e[18]*r[18],t[19]=e[15]*r[4]+e[16]*r[9]+e[17]*r[14]+e[18]*r[19]+e[19],t},e.prototype._colorMatrix=function(t){var e=new Float32Array(t);return e[4]/=255,e[9]/=255,e[14]/=255,e[19]/=255,e},e.prototype.brightness=function(t,e){var r=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(r,e)},e.prototype.greyscale=function(t,e){var r=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(r,e)},e.prototype.blackAndWhite=function(t){this._loadMatrix([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],t)},e.prototype.hue=function(t,e){t=(t||0)/180*Math.PI;var r=Math.cos(t),i=Math.sin(t),n=1/3,o=(0,Math.sqrt)(n),a=[r+(1-r)*n,n*(1-r)-o*i,n*(1-r)+o*i,0,0,n*(1-r)+o*i,r+n*(1-r),n*(1-r)-o*i,0,0,n*(1-r)-o*i,n*(1-r)+o*i,r+n*(1-r),0,0,0,0,0,1,0];this._loadMatrix(a,e)},e.prototype.contrast=function(t,e){var r=(t||0)+1,i=-.5*(r-1),n=[r,0,0,0,i,0,r,0,0,i,0,0,r,0,i,0,0,0,1,0];this._loadMatrix(n,e)},e.prototype.saturate=function(t,e){void 0===t&&(t=0);var r=2*t/3+1,i=-.5*(r-1),n=[r,i,i,0,0,i,r,i,0,0,i,i,r,0,0,0,0,0,1,0];this._loadMatrix(n,e)},e.prototype.desaturate=function(){this.saturate(-1)},e.prototype.negative=function(t){this._loadMatrix([-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0],t)},e.prototype.sepia=function(t){this._loadMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],t)},e.prototype.technicolor=function(t){this._loadMatrix([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],t)},e.prototype.polaroid=function(t){this._loadMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],t)},e.prototype.toBGR=function(t){this._loadMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],t)},e.prototype.kodachrome=function(t){this._loadMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],t)},e.prototype.browni=function(t){this._loadMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],t)},e.prototype.vintage=function(t){this._loadMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],t)},e.prototype.colorTone=function(t,e,r,i,n){var o=((r=r||16770432)>>16&255)/255,a=(r>>8&255)/255,s=(255&r)/255,h=((i=i||3375104)>>16&255)/255,l=(i>>8&255)/255,u=(255&i)/255,c=[.3,.59,.11,0,0,o,a,s,t=t||.2,0,h,l,u,e=e||.15,0,o-h,a-l,s-u,0,0];this._loadMatrix(c,n)},e.prototype.night=function(t,e){var r=[-2*(t=t||.1),-t,0,0,0,-t,0,t,0,0,0,t,2*t,0,0,0,0,0,1,0];this._loadMatrix(r,e)},e.prototype.predator=function(t,e){var r=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(r,e)},e.prototype.lsd=function(t){this._loadMatrix([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],t)},e.prototype.reset=function(){this._loadMatrix([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],!1)},Object.defineProperty(e.prototype,"matrix",{get:function(){return this.uniforms.m},set:function(t){this.uniforms.m=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this.uniforms.uAlpha},set:function(t){this.uniforms.uAlpha=t},enumerable:!1,configurable:!0}),e}(Di);ps.prototype.grayscale=ps.prototype.greyscale;
/*!
	 * @pixi/filter-displacement - v5.3.7
	 * Compiled Tue, 29 Dec 2020 19:33:12 UTC
	 *
	 * @pixi/filter-displacement is licensed under the MIT License.
	 * http://www.opensource.org/licenses/mit-license
	 */
/*! *****************************************************************************
	Copyright (c) Microsoft Corporation. All rights reserved.
	Licensed under the Apache License, Version 2.0 (the "License"); you may not use
	this file except in compliance with the License. You may obtain a copy of the
	License at http://www.apache.org/licenses/LICENSE-2.0

	THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
	KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
	WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
	MERCHANTABLITY OR NON-INFRINGEMENT.

	See the Apache Version 2.0 License for specific language governing permissions
	and limitations under the License.
	***************************************************************************** */
var ds=function(t,e){return(ds=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};var fs=function(t){function e(e,r){var i=this,n=new Me;return e.renderable=!1,(i=t.call(this,"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\nuniform mat3 filterMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n\tgl_Position = filterVertexPosition();\n\tvTextureCoord = filterTextureCoord();\n\tvFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;\n}\n","varying vec2 vFilterCoord;\nvarying vec2 vTextureCoord;\n\nuniform vec2 scale;\nuniform mat2 rotation;\nuniform sampler2D uSampler;\nuniform sampler2D mapSampler;\n\nuniform highp vec4 inputSize;\nuniform vec4 inputClamp;\n\nvoid main(void)\n{\n  vec4 map =  texture2D(mapSampler, vFilterCoord);\n\n  map -= 0.5;\n  map.xy = scale * inputSize.zw * (rotation * map.xy);\n\n  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));\n}\n",{mapSampler:e._texture,filterMatrix:n,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])})||this).maskSprite=e,i.maskMatrix=n,null==r&&(r=20),i.scale=new Ie(r,r),i}return function(t,e){function r(){this.constructor=t}ds(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}(e,t),e.prototype.apply=function(t,e,r,i){this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;var n=this.maskSprite.worldTransform,o=Math.sqrt(n.a*n.a+n.b*n.b),a=Math.sqrt(n.c*n.c+n.d*n.d);0!==o&&0!==a&&(this.uniforms.rotation[0]=n.a/o,this.uniforms.rotation[1]=n.b/o,this.uniforms.rotation[2]=n.c/a,this.uniforms.rotation[3]=n.d/a),t.applyFilter(this,e,r,i)},Object.defineProperty(e.prototype,"map",{get:function(){return this.uniforms.mapSampler},set:function(t){this.uniforms.mapSampler=t},enumerable:!1,configurable:!0}),e}(Di),ms=function(t,e){return(ms=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};var vs=function(t){function e(){return t.call(this,"\nattribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\n\nuniform vec4 inputPixel;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvoid texcoords(vec2 fragCoord, vec2 inverseVP,\n               out vec2 v_rgbNW, out vec2 v_rgbNE,\n               out vec2 v_rgbSW, out vec2 v_rgbSE,\n               out vec2 v_rgbM) {\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvoid main(void) {\n\n   gl_Position = filterVertexPosition();\n\n   vFragCoord = aVertexPosition * outputFrame.zw;\n\n   texcoords(vFragCoord, inputPixel.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}\n",'varying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\nuniform sampler2D uSampler;\nuniform highp vec4 inputPixel;\n\n\n/**\n Basic FXAA implementation based on the code on geeks3d.com with the\n modification that the texture2DLod stuff was removed since it\'s\n unsupported by WebGL.\n\n --\n\n From:\n https://github.com/mitsuhiko/webgl-meincraft\n\n Copyright (c) 2011 by Armin Ronacher.\n\n Some rights reserved.\n\n Redistribution and use in source and binary forms, with or without\n modification, are permitted provided that the following conditions are\n met:\n\n * Redistributions of source code must retain the above copyright\n notice, this list of conditions and the following disclaimer.\n\n * Redistributions in binary form must reproduce the above\n copyright notice, this list of conditions and the following\n disclaimer in the documentation and/or other materials provided\n with the distribution.\n\n * The names of the contributors may not be used to endorse or\n promote products derived from this software without specific\n prior written permission.\n\n THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n#ifndef FXAA_REDUCE_MIN\n#define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n#define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n#define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent\n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,\n          vec2 v_rgbNW, vec2 v_rgbNE,\n          vec2 v_rgbSW, vec2 v_rgbSE,\n          vec2 v_rgbM) {\n    vec4 color;\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n\n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n\n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n\n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n                  dir * rcpDirMin)) * inverseVP;\n\n    vec3 rgbA = 0.5 * (\n                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n\n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\nvoid main() {\n\n      vec4 color;\n\n      color = fxaa(uSampler, vFragCoord, inputPixel.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n      gl_FragColor = color;\n}\n')||this}return function(t,e){function r(){this.constructor=t}ms(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}(e,t),e}(Di),ys=function(t,e){return(ys=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};var gs=function(t){function e(e,r){void 0===e&&(e=.5),void 0===r&&(r=Math.random());var i=t.call(this,hn,"precision highp float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform float uNoise;\nuniform float uSeed;\nuniform sampler2D uSampler;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    float randomValue = rand(gl_FragCoord.xy * uSeed);\n    float diff = (randomValue - 0.5) * uNoise;\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (color.a > 0.0) {\n        color.rgb /= color.a;\n    }\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    // Premultiply alpha again.\n    color.rgb *= color.a;\n\n    gl_FragColor = color;\n}\n",{uNoise:0,uSeed:0})||this;return i.noise=e,i.seed=r,i}return function(t,e){function r(){this.constructor=t}ys(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}(e,t),Object.defineProperty(e.prototype,"noise",{get:function(){return this.uniforms.uNoise},set:function(t){this.uniforms.uNoise=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"seed",{get:function(){return this.uniforms.uSeed},set:function(t){this.uniforms.uSeed=t},enumerable:!1,configurable:!0}),e}(Di),_s=new Me;Ue.prototype._cacheAsBitmap=!1,Ue.prototype._cacheData=null;var xs=function(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null};Object.defineProperties(Ue.prototype,{cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(t){var e;this._cacheAsBitmap!==t&&(this._cacheAsBitmap=t,t?(this._cacheData||(this._cacheData=new xs),(e=this._cacheData).originalRender=this.render,e.originalRenderCanvas=this.renderCanvas,e.originalUpdateTransform=this.updateTransform,e.originalCalculateBounds=this.calculateBounds,e.originalGetLocalBounds=this.getLocalBounds,e.originalDestroy=this.destroy,e.originalContainsPoint=this.containsPoint,e.originalMask=this._mask,e.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):((e=this._cacheData).sprite&&this._destroyCachedDisplayObject(),this.render=e.originalRender,this.renderCanvas=e.originalRenderCanvas,this.calculateBounds=e.originalCalculateBounds,this.getLocalBounds=e.originalGetLocalBounds,this.destroy=e.originalDestroy,this.updateTransform=e.originalUpdateTransform,this.containsPoint=e.originalContainsPoint,this._mask=e.originalMask,this.filterArea=e.originalFilterArea))}}}),Ue.prototype._renderCached=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(t))},Ue.prototype._initCachedDisplayObject=function(t){if(!this._cacheData||!this._cacheData.sprite){var e=this.alpha;this.alpha=1,t.batch.flush();var r=this.getLocalBounds(null,!0).clone();if(this.filters){var i=this.filters[0].padding;r.pad(i)}r.ceil(O.RESOLUTION);var n=t.renderTexture.current,o=t.renderTexture.sourceFrame.clone(),a=t.projection.transform,s=Dr.create({width:r.width,height:r.height}),h="cacheAsBitmap_"+oe();this._cacheData.textureCacheId=h,fr.addToCache(s.baseTexture,h),Rr.addToCache(s,h);var l=this.transform.localTransform.copyTo(_s).invert().translate(-r.x,-r.y);this.render=this._cacheData.originalRender,t.render(this,s,!0,l,!1),t.projection.transform=a,t.renderTexture.bind(n,o),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null;var u=new ko(s);u.transform.worldTransform=this.transform.worldTransform,u.anchor.x=-r.x/r.width,u.anchor.y=-r.y/r.height,u.alpha=e,u._bounds=this._bounds,this._cacheData.sprite=u,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=u.containsPoint.bind(u)}},Ue.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(t))},Ue.prototype._initCachedDisplayObjectCanvas=function(t){if(!this._cacheData||!this._cacheData.sprite){var e=this.getLocalBounds(null,!0),r=this.alpha;this.alpha=1;var i=t.context,n=t._projTransform;e.ceil(O.RESOLUTION);var o=Dr.create({width:e.width,height:e.height}),a="cacheAsBitmap_"+oe();this._cacheData.textureCacheId=a,fr.addToCache(o.baseTexture,a),Rr.addToCache(o,a);var s=_s;this.transform.localTransform.copyTo(s),s.invert(),s.tx-=e.x,s.ty-=e.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,o,!0,s,!1),t.context=i,t._projTransform=n,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null;var h=new ko(o);h.transform.worldTransform=this.transform.worldTransform,h.anchor.x=-e.x/e.width,h.anchor.y=-e.y/e.height,h.alpha=r,h._bounds=this._bounds,this._cacheData.sprite=h,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=h.containsPoint.bind(h)}},Ue.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID},Ue.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)},Ue.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,fr.removeFromCache(this._cacheData.textureCacheId),Rr.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null},Ue.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t)},
/*!
	 * @pixi/mixin-get-child-by-name - v5.3.7
	 * Compiled Tue, 29 Dec 2020 19:33:12 UTC
	 *
	 * @pixi/mixin-get-child-by-name is licensed under the MIT License.
	 * http://www.opensource.org/licenses/mit-license
	 */
Ue.prototype.name=null,We.prototype.getChildByName=function(t,e){for(var r=0,i=this.children.length;r<i;r++)if(this.children[r].name===t)return this.children[r];if(e)for(r=0,i=this.children.length;r<i;r++){if(this.children[r].getChildByName){var n=this.children[r].getChildByName(t,!0);if(n)return n}}return null},
/*!
	 * @pixi/mixin-get-global-position - v5.3.7
	 * Compiled Tue, 29 Dec 2020 19:33:12 UTC
	 *
	 * @pixi/mixin-get-global-position is licensed under the MIT License.
	 * http://www.opensource.org/licenses/mit-license
	 */
Ue.prototype.getGlobalPosition=function(t,e){return void 0===t&&(t=new Ie),void 0===e&&(e=!1),this.parent?this.parent.toGlobal(this.position,t,e):(t.x=this.position.x,t.y=this.position.y),t};
/*! *****************************************************************************
	Copyright (c) Microsoft Corporation. All rights reserved.
	Licensed under the Apache License, Version 2.0 (the "License"); you may not use
	this file except in compliance with the License. You may obtain a copy of the
	License at http://www.apache.org/licenses/LICENSE-2.0

	THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
	KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
	WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
	MERCHANTABLITY OR NON-INFRINGEMENT.

	See the Apache Version 2.0 License for specific language governing permissions
	and limitations under the License.
	***************************************************************************** */
var bs=function(t,e){return(bs=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function ws(t,e){function r(){this.constructor=t}bs(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var Ts="5.0.0";
/*!
	 * @pixi/mesh-extras - v5.3.7
	 * Compiled Tue, 29 Dec 2020 19:33:12 UTC
	 *
	 * @pixi/mesh-extras is licensed under the MIT License.
	 * http://www.opensource.org/licenses/mit-license
	 */
/*! *****************************************************************************
	Copyright (c) Microsoft Corporation. All rights reserved.
	Licensed under the Apache License, Version 2.0 (the "License"); you may not use
	this file except in compliance with the License. You may obtain a copy of the
	License at http://www.apache.org/licenses/LICENSE-2.0

	THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
	KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
	WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
	MERCHANTABLITY OR NON-INFRINGEMENT.

	See the Apache Version 2.0 License for specific language governing permissions
	and limitations under the License.
	***************************************************************************** */
var Es=function(t,e){return(Es=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function Ss(t,e){function r(){this.constructor=t}Es(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var As=function(t){function e(e,r,i,n){void 0===e&&(e=100),void 0===r&&(r=100),void 0===i&&(i=10),void 0===n&&(n=10);var o=t.call(this)||this;return o.segWidth=i,o.segHeight=n,o.width=e,o.height=r,o.build(),o}return Ss(e,t),e.prototype.build=function(){for(var t=this.segWidth*this.segHeight,e=[],r=[],i=[],n=this.segWidth-1,o=this.segHeight-1,a=this.width/n,s=this.height/o,h=0;h<t;h++){var l=h%this.segWidth,u=h/this.segWidth|0;e.push(l*a,u*s),r.push(l/n,u/o)}var c=n*o;for(h=0;h<c;h++){var p=h%n,d=h/n|0,f=d*this.segWidth+p,m=d*this.segWidth+p+1,v=(d+1)*this.segWidth+p,y=(d+1)*this.segWidth+p+1;i.push(f,m,v,m,y,v)}this.buffers[0].data=new Float32Array(e),this.buffers[1].data=new Float32Array(r),this.indexBuffer.data=new Uint16Array(i),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()},e}(Sa),Is=function(t){function e(e,r,i){void 0===e&&(e=200),void 0===i&&(i=0);var n=t.call(this,new Float32Array(4*r.length),new Float32Array(4*r.length),new Uint16Array(6*(r.length-1)))||this;return n.points=r,n._width=e,n.textureScale=i,n.build(),n}return Ss(e,t),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),e.prototype.build=function(){var t=this.points;if(t){var e=this.getBuffer("aVertexPosition"),r=this.getBuffer("aTextureCoord"),i=this.getIndex();if(!(t.length<1)){e.data.length/4!==t.length&&(e.data=new Float32Array(4*t.length),r.data=new Float32Array(4*t.length),i.data=new Uint16Array(6*(t.length-1)));var n=r.data,o=i.data;n[0]=0,n[1]=0,n[2]=0,n[3]=1;for(var a=0,s=t[0],h=this._width*this.textureScale,l=t.length,u=0;u<l;u++){var c=4*u;if(this.textureScale>0){var p=s.x-t[u].x,d=s.y-t[u].y,f=Math.sqrt(p*p+d*d);s=t[u],a+=f/h}else a=u/(l-1);n[c]=a,n[c+1]=0,n[c+2]=a,n[c+3]=1}var m=0;for(u=0;u<l-1;u++){c=2*u;o[m++]=c,o[m++]=c+1,o[m++]=c+2,o[m++]=c+2,o[m++]=c+1,o[m++]=c+3}r.update(),i.update(),this.updateVertices()}}},e.prototype.updateVertices=function(){var t=this.points;if(!(t.length<1)){for(var e,r=t[0],i=0,n=0,o=this.buffers[0].data,a=t.length,s=0;s<a;s++){var h=t[s],l=4*s;n=-((e=s<t.length-1?t[s+1]:h).x-r.x),i=e.y-r.y;var u=Math.sqrt(i*i+n*n),c=this.textureScale>0?this.textureScale*this._width/2:this._width/2;i/=u,n/=u,i*=c,n*=c,o[l]=h.x+i,o[l+1]=h.y+n,o[l+2]=h.x-i,o[l+3]=h.y-n,r=h}this.buffers[0].update()}},e.prototype.update=function(){this.textureScale>0?this.build():this.updateVertices()},e}(Sa),Ps=function(e){function r(r,i,n){void 0===n&&(n=0);var o=this,a=new Is(r.height,i,n),s=new Ea(r);return n>0&&(r.baseTexture.wrapMode=t.WRAP_MODES.REPEAT),(o=e.call(this,a,s)||this).autoUpdate=!0,o}return Ss(r,e),r.prototype._render=function(t){var r=this.geometry;(this.autoUpdate||r._width!==this.shader.texture.height)&&(r._width=this.shader.texture.height,r.update()),e.prototype._render.call(this,t)},r}(Ta),Ms=function(t){function e(e,r,i){var n=this,o=new As(e.width,e.height,r,i),a=new Ea(Rr.WHITE);return(n=t.call(this,o,a)||this).texture=e,n}return Ss(e,t),e.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID;var t=this.geometry;t.width=this.shader.texture.width,t.height=this.shader.texture.height,t.build()},Object.defineProperty(e.prototype,"texture",{get:function(){return this.shader.texture},set:function(t){this.shader.texture!==t&&(this.shader.texture=t,this._textureID=-1,t.baseTexture.valid?this.textureUpdated():t.once("update",this.textureUpdated,this))},enumerable:!1,configurable:!0}),e.prototype._render=function(e){this._textureID!==this.shader.texture._updateID&&this.textureUpdated(),t.prototype._render.call(this,e)},e.prototype.destroy=function(e){this.shader.texture.off("update",this.textureUpdated,this),t.prototype.destroy.call(this,e)},e}(Ta),Cs=function(t){function e(e,r,i,n,o){void 0===e&&(e=Rr.EMPTY);var a=this,s=new Sa(r,i,n);s.getBuffer("aVertexPosition").static=!1;var h=new Ea(e);return(a=t.call(this,s,h,null,o)||this).autoUpdate=!0,a}return Ss(e,t),Object.defineProperty(e.prototype,"vertices",{get:function(){return this.geometry.getBuffer("aVertexPosition").data},set:function(t){this.geometry.getBuffer("aVertexPosition").data=t},enumerable:!1,configurable:!0}),e.prototype._render=function(e){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),t.prototype._render.call(this,e)},e}(Ta),Rs=function(t){function e(e,r,i,n,o){void 0===r&&(r=10),void 0===i&&(i=10),void 0===n&&(n=10),void 0===o&&(o=10);var a=t.call(this,Rr.WHITE,4,4)||this;return a._origWidth=e.orig.width,a._origHeight=e.orig.height,a._width=a._origWidth,a._height=a._origHeight,a._leftWidth=r,a._rightWidth=n,a._topHeight=i,a._bottomHeight=o,a.texture=e,a}return Ss(e,t),e.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID,this._refresh()},Object.defineProperty(e.prototype,"vertices",{get:function(){return this.geometry.getBuffer("aVertexPosition").data},set:function(t){this.geometry.getBuffer("aVertexPosition").data=t},enumerable:!1,configurable:!0}),e.prototype.updateHorizontalVertices=function(){var t=this.vertices,e=this._getMinScale();t[9]=t[11]=t[13]=t[15]=this._topHeight*e,t[17]=t[19]=t[21]=t[23]=this._height-this._bottomHeight*e,t[25]=t[27]=t[29]=t[31]=this._height},e.prototype.updateVerticalVertices=function(){var t=this.vertices,e=this._getMinScale();t[2]=t[10]=t[18]=t[26]=this._leftWidth*e,t[4]=t[12]=t[20]=t[28]=this._width-this._rightWidth*e,t[6]=t[14]=t[22]=t[30]=this._width},e.prototype._getMinScale=function(){var t=this._leftWidth+this._rightWidth,e=this._width>t?1:this._width/t,r=this._topHeight+this._bottomHeight,i=this._height>r?1:this._height/r;return Math.min(e,i)},Object.defineProperty(e.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"leftWidth",{get:function(){return this._leftWidth},set:function(t){this._leftWidth=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rightWidth",{get:function(){return this._rightWidth},set:function(t){this._rightWidth=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"topHeight",{get:function(){return this._topHeight},set:function(t){this._topHeight=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bottomHeight",{get:function(){return this._bottomHeight},set:function(t){this._bottomHeight=t,this._refresh()},enumerable:!1,configurable:!0}),e.prototype._refresh=function(){var t=this.texture,e=this.geometry.buffers[1].data;this._origWidth=t.orig.width,this._origHeight=t.orig.height;var r=1/this._origWidth,i=1/this._origHeight;e[0]=e[8]=e[16]=e[24]=0,e[1]=e[3]=e[5]=e[7]=0,e[6]=e[14]=e[22]=e[30]=1,e[25]=e[27]=e[29]=e[31]=1,e[2]=e[10]=e[18]=e[26]=r*this._leftWidth,e[4]=e[12]=e[20]=e[28]=1-r*this._rightWidth,e[9]=e[11]=e[13]=e[15]=i*this._topHeight,e[17]=e[19]=e[21]=e[23]=1-i*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.geometry.buffers[0].update(),this.geometry.buffers[1].update()},e}(Ms),Os=function(t,e){return(Os=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};var Ds=function(e){function r(t,r){void 0===r&&(r=!0);var i=e.call(this,t[0]instanceof Rr?t[0]:t[0].texture)||this;return i._textures=null,i._durations=null,i._autoUpdate=r,i._isConnectedToTicker=!1,i.animationSpeed=1,i.loop=!0,i.updateAnchor=!1,i.onComplete=null,i.onFrameChange=null,i.onLoop=null,i._currentTime=0,i._playing=!1,i._previousFrame=null,i.textures=t,i}return function(t,e){function r(){this.constructor=t}Os(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}(r,e),r.prototype.stop=function(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(Je.shared.remove(this.update,this),this._isConnectedToTicker=!1))},r.prototype.play=function(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(Je.shared.add(this.update,this,t.UPDATE_PRIORITY.HIGH),this._isConnectedToTicker=!0))},r.prototype.gotoAndStop=function(t){this.stop();var e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this.updateTexture()},r.prototype.gotoAndPlay=function(t){var e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this.updateTexture(),this.play()},r.prototype.update=function(t){var e=this.animationSpeed*t,r=this.currentFrame;if(null!==this._durations){var i=this._currentTime%1*this._durations[this.currentFrame];for(i+=e/60*1e3;i<0;)this._currentTime--,i+=this._durations[this.currentFrame];var n=Math.sign(this.animationSpeed*t);for(this._currentTime=Math.floor(this._currentTime);i>=this._durations[this.currentFrame];)i-=this._durations[this.currentFrame]*n,this._currentTime+=n;this._currentTime+=i/this._durations[this.currentFrame]}else this._currentTime+=e;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):r!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<r||this.animationSpeed<0&&this.currentFrame>r)&&this.onLoop(),this.updateTexture())},r.prototype.updateTexture=function(){var t=this.currentFrame;this._previousFrame!==t&&(this._previousFrame=t,this._texture=this._textures[t],this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this.uvs=this._texture._uvs.uvsFloat32,this.updateAnchor&&this._anchor.copyFrom(this._texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))},r.prototype.destroy=function(t){this.stop(),e.prototype.destroy.call(this,t),this.onComplete=null,this.onFrameChange=null,this.onLoop=null},r.fromFrames=function(t){for(var e=[],i=0;i<t.length;++i)e.push(Rr.from(t[i]));return new r(e)},r.fromImages=function(t){for(var e=[],i=0;i<t.length;++i)e.push(Rr.from(t[i]));return new r(e)},Object.defineProperty(r.prototype,"totalFrames",{get:function(){return this._textures.length},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"textures",{get:function(){return this._textures},set:function(t){if(t[0]instanceof Rr)this._textures=t,this._durations=null;else{this._textures=[],this._durations=[];for(var e=0;e<t.length;e++)this._textures.push(t[e].texture),this._durations.push(t[e].time)}this._previousFrame=null,this.gotoAndStop(0),this.updateTexture()},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"currentFrame",{get:function(){var t=Math.floor(this._currentTime)%this._textures.length;return t<0&&(t+=this._textures.length),t},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"playing",{get:function(){return this._playing},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(Je.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(Je.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),r}(ko);on.registerPlugin("accessibility",He),on.registerPlugin("extract",wn),on.registerPlugin("interaction",or),on.registerPlugin("particle",Kn),on.registerPlugin("prepare",sa),on.registerPlugin("batch",gn),on.registerPlugin("tilingSprite",ya),Wn.registerPlugin(Va),Wn.registerPlugin(ua),_n.registerPlugin(Ze),_n.registerPlugin(qn);var Bs={AlphaFilter:ja,BlurFilter:us,BlurFilterPass:ls,ColorMatrixFilter:ps,DisplacementFilter:fs,FXAAFilter:vs,NoiseFilter:gs};return t.AbstractBatchRenderer=pn,t.AbstractRenderer=nn,t.AccessibilityManager=He,t.AnimatedSprite=Ds,t.AppLoaderPlugin=qn,t.Application=_n,t.Attribute=Nr,t.BasePrepare=ia,t.BaseRenderTexture=Pr,t.BaseTexture=fr,t.BatchDrawCall=ln,t.BatchGeometry=fn,t.BatchPluginFactory=yn,t.BatchRenderer=gn,t.BatchShaderGenerator=dn,t.BatchTextureArray=un,t.BitmapFont=Na,t.BitmapFontData=Ia,t.BitmapFontLoader=Va,t.BitmapText=La,t.Bounds=Ve,t.Buffer=Fr,t.Circle=Te,t.Container=We,t.CountLimiter=$o,t.DEG_TO_RAD=be,t.DisplayObject=Ue,t.Ellipse=Ee,t.Extract=wn,t.FillStyle=eo,t.Filter=Di,t.FilterState=Hr,t.Framebuffer=Ir,t.GLFramebuffer=ti,t.GLProgram=Gi,t.GLTexture=Ki,t.GRAPHICS_CURVES=to,t.Geometry=Yr,t.Graphics=Ro,t.GraphicsData=Eo,t.GraphicsGeometry=Io,t.IGLUniformData=qi,t.InteractionData=Qe,t.InteractionEvent=tr,t.InteractionManager=or,t.InteractionTrackingData=er,t.LineStyle=Po,t.Loader=Wn,t.LoaderResource=Un,t.MaskData=ai,t.Matrix=Me,t.Mesh=Ta,t.MeshBatchUvs=xa,t.MeshGeometry=Sa,t.MeshMaterial=Ea,t.NineSlicePlane=Rs,t.ObjectRenderer=Jr,t.ObservablePoint=Pe,t.PI_2=_e,t.ParticleContainer=Zn,t.ParticleRenderer=Kn,t.PlaneGeometry=As,t.Point=Ie,t.Polygon=Se,t.Prepare=sa,t.Program=Ci,t.Quad=zr,t.QuadUv=Wr,t.RAD_TO_DEG=xe,t.Rectangle=we,t.RenderTexture=Dr,t.RenderTexturePool=Br,t.Renderer=on,t.RopeGeometry=Is,t.RoundedRectangle=Ae,t.Runner=ar,t.Shader=Ri,t.SimpleMesh=Cs,t.SimplePlane=Ms,t.SimpleRope=Ps,t.Sprite=ko,t.SpriteMaskFilter=ki,t.Spritesheet=la,t.SpritesheetLoader=ua,t.State=Oi,t.System=Sr,t.TemporaryDisplayObject=Ye,t.Text=Go,t.TextMetrics=zo,t.TextStyle=Xo,t.Texture=Rr,t.TextureLoader=zn,t.TextureMatrix=Ni,t.TextureUvs=Mr,t.Ticker=Je,t.TickerPlugin=Ze,t.TilingSprite=fa,t.TilingSpriteRenderer=ya,t.TimeLimiter=ha,t.Transform=Le,t.UniformGroup=Gr,t.VERSION="5.3.7",t.ViewableBuffer=cn,t.accessibleTarget=qe,t.autoDetectRenderer=an,t.checkMaxIfStatementsInShader=Ii,t.defaultFilterVertex=hn,t.defaultVertex=sn,t.filters=Bs,t.graphicsUtils=To,t.groupD8=Fe,t.interactiveTarget=ir,t.isMobile=R,t.resources=Er,t.settings=O,t.systems=en,t.uniformParsers=bi,t.useDeprecated=function(){var t=this;Object.defineProperties(t,{SVG_SIZE:{get:function(){return se(Ts,"PIXI.utils.SVG_SIZE property has moved to PIXI.resources.SVGResource.SVG_SIZE"),t.SVGResource.SVG_SIZE}},TransformStatic:{get:function(){return se(Ts,"PIXI.TransformStatic class has been removed, use PIXI.Transform"),t.Transform}},TransformBase:{get:function(){return se(Ts,"PIXI.TransformBase class has been removed, use PIXI.Transform"),t.Transform}},TRANSFORM_MODE:{get:function(){return se(Ts,"PIXI.TRANSFORM_MODE property has been removed"),{STATIC:0,DYNAMIC:1}}},WebGLRenderer:{get:function(){return se(Ts,"PIXI.WebGLRenderer class has moved to PIXI.Renderer"),t.Renderer}},CanvasRenderTarget:{get:function(){return se(Ts,"PIXI.CanvasRenderTarget class has moved to PIXI.utils.CanvasRenderTarget"),t.utils.CanvasRenderTarget}},loader:{get:function(){return se(Ts,"PIXI.loader instance has moved to PIXI.Loader.shared"),t.Loader.shared}},FilterManager:{get:function(){return se(Ts,"PIXI.FilterManager class has moved to PIXI.systems.FilterSystem"),t.systems.FilterSystem}},CanvasTinter:{get:function(){return se("5.2.0","PIXI.CanvasTinter namespace has moved to PIXI.canvasUtils"),t.canvasUtils}},GroupD8:{get:function(){return se("5.2.0","PIXI.GroupD8 namespace has moved to PIXI.groupD8"),t.groupD8}}}),t.accessibility={},Object.defineProperties(t.accessibility,{AccessibilityManager:{get:function(){return se("5.3.0","PIXI.accessibility.AccessibilityManager moved to PIXI.AccessibilityManager"),t.AccessibilityManager}}}),t.interaction={},Object.defineProperties(t.interaction,{InteractionManager:{get:function(){return se("5.3.0","PIXI.interaction.InteractionManager moved to PIXI.InteractionManager"),t.InteractionManager}},InteractionData:{get:function(){return se("5.3.0","PIXI.interaction.InteractionData moved to PIXI.InteractionData"),t.InteractionData}},InteractionEvent:{get:function(){return se("5.3.0","PIXI.interaction.InteractionEvent moved to PIXI.InteractionEvent"),t.InteractionEvent}}}),t.prepare={},Object.defineProperties(t.prepare,{BasePrepare:{get:function(){return se("5.2.1","PIXI.prepare.BasePrepare moved to PIXI.BasePrepare"),t.BasePrepare}},Prepare:{get:function(){return se("5.2.1","PIXI.prepare.Prepare moved to PIXI.Prepare"),t.Prepare}},CanvasPrepare:{get:function(){return se("5.2.1","PIXI.prepare.CanvasPrepare moved to PIXI.CanvasPrepare"),t.CanvasPrepare}}}),t.extract={},Object.defineProperties(t.extract,{Extract:{get:function(){return se("5.2.1","PIXI.extract.Extract moved to PIXI.Extract"),t.Extract}},CanvasExtract:{get:function(){return se("5.2.1","PIXI.extract.CanvasExtract moved to PIXI.CanvasExtract"),t.CanvasExtract}}}),t.extras={},Object.defineProperties(t.extras,{TilingSprite:{get:function(){return se(Ts,"PIXI.extras.TilingSprite class has moved to PIXI.TilingSprite"),t.TilingSprite}},TilingSpriteRenderer:{get:function(){return se(Ts,"PIXI.extras.TilingSpriteRenderer class has moved to PIXI.TilingSpriteRenderer"),t.TilingSpriteRenderer}},AnimatedSprite:{get:function(){return se(Ts,"PIXI.extras.AnimatedSprite class has moved to PIXI.AnimatedSprite"),t.AnimatedSprite}},BitmapText:{get:function(){return se(Ts,"PIXI.extras.BitmapText class has moved to PIXI.BitmapText"),t.BitmapText}}}),t.TilingSprite.fromFrame=function(e,r,i){return se("5.3.0","TilingSprite.fromFrame is deprecated, use TilingSprite.from"),t.TilingSprite.from(e,{width:r,height:i})},t.TilingSprite.fromImage=function(e,r,i,n){return void 0===n&&(n={}),se("5.3.0","TilingSprite.fromImage is deprecated, use TilingSprite.from"),n&&"object"!=typeof n&&(n={scaleMode:arguments[4],resourceOptions:{crossorigin:arguments[3]}}),n.width=r,n.height=i,t.TilingSprite.from(e,n)},Object.defineProperties(t.utils,{getSvgSize:{get:function(){return se(Ts,"PIXI.utils.getSvgSize function has moved to PIXI.resources.SVGResource.getSize"),t.resources.SVGResource.getSize}}}),t.mesh={},Object.defineProperties(t.mesh,{Mesh:{get:function(){return se(Ts,"PIXI.mesh.Mesh class has moved to PIXI.SimpleMesh"),t.SimpleMesh}},NineSlicePlane:{get:function(){return se(Ts,"PIXI.mesh.NineSlicePlane class has moved to PIXI.NineSlicePlane"),t.NineSlicePlane}},Plane:{get:function(){return se(Ts,"PIXI.mesh.Plane class has moved to PIXI.SimplePlane"),t.SimplePlane}},Rope:{get:function(){return se(Ts,"PIXI.mesh.Rope class has moved to PIXI.SimpleRope"),t.SimpleRope}},RawMesh:{get:function(){return se(Ts,"PIXI.mesh.RawMesh class has moved to PIXI.Mesh"),t.Mesh}},CanvasMeshRenderer:{get:function(){return se(Ts,"PIXI.mesh.CanvasMeshRenderer class has moved to PIXI.CanvasMeshRenderer"),t.CanvasMeshRenderer}},MeshRenderer:{get:function(){return se(Ts,"PIXI.mesh.MeshRenderer class has moved to PIXI.MeshRenderer"),t.MeshRenderer}}}),t.particles={},Object.defineProperties(t.particles,{ParticleContainer:{get:function(){return se(Ts,"PIXI.particles.ParticleContainer class has moved to PIXI.ParticleContainer"),t.ParticleContainer}},ParticleRenderer:{get:function(){return se(Ts,"PIXI.particles.ParticleRenderer class has moved to PIXI.ParticleRenderer"),t.ParticleRenderer}}}),t.ticker={},Object.defineProperties(t.ticker,{Ticker:{get:function(){return se(Ts,"PIXI.ticker.Ticker class has moved to PIXI.Ticker"),t.Ticker}},shared:{get:function(){return se(Ts,"PIXI.ticker.shared instance has moved to PIXI.Ticker.shared"),t.Ticker.shared}}}),t.loaders={},Object.defineProperties(t.loaders,{Loader:{get:function(){return se(Ts,"PIXI.loaders.Loader class has moved to PIXI.Loader"),t.Loader}},Resource:{get:function(){return se(Ts,"PIXI.loaders.Resource class has moved to PIXI.LoaderResource"),t.LoaderResource}},bitmapFontParser:{get:function(){return se(Ts,"PIXI.loaders.bitmapFontParser function has moved to PIXI.BitmapFontLoader.use"),t.BitmapFontLoader.use}},parseBitmapFontData:{get:function(){se(Ts,"PIXI.loaders.parseBitmapFontData function has removed")}},spritesheetParser:{get:function(){return se(Ts,"PIXI.loaders.spritesheetParser function has moved to PIXI.SpritesheetLoader.use"),t.SpritesheetLoader.use}},getResourcePath:{get:function(){return se(Ts,"PIXI.loaders.getResourcePath property has moved to PIXI.SpritesheetLoader.getResourcePath"),t.SpritesheetLoader.getResourcePath}}}),t.Loader.addPixiMiddleware=function(e){return se(Ts,"PIXI.loaders.Loader.addPixiMiddleware function is deprecated, use PIXI.loaders.Loader.registerPlugin"),t.loaders.Loader.registerPlugin({use:e()})};var e=function(t){return"on"+t.charAt(0).toUpperCase()+t.slice(1)};Object.assign(t.Loader.prototype,{on:function(t){var r=e(t);se(Ts,"PIXI.Loader#on is completely deprecated, use PIXI.Loader#"+r+".add")},once:function(t){var r=e(t);se(Ts,"PIXI.Loader#once is completely deprecated, use PIXI.Loader#"+r+".once")},off:function(t){var r=e(t);se(Ts,"PIXI.Loader#off is completely deprecated, use PIXI.Loader#"+r+".detach")}}),Object.defineProperty(t.extract,"WebGLExtract",{get:function(){return se(Ts,"PIXI.extract.WebGLExtract method has moved to PIXI.Extract"),t.Extract}}),Object.defineProperty(t.prepare,"WebGLPrepare",{get:function(){return se(Ts,"PIXI.prepare.WebGLPrepare class has moved to PIXI.Prepare"),t.Prepare}}),t.Container.prototype._renderWebGL=function(t){se(Ts,"PIXI.Container._renderWebGL method has moved to PIXI.Container._render"),this._render(t)},t.Container.prototype.renderWebGL=function(t){se(Ts,"PIXI.Container.renderWebGL method has moved to PIXI.Container.render"),this.render(t)},t.DisplayObject.prototype.renderWebGL=function(t){se(Ts,"PIXI.DisplayObject.renderWebGL method has moved to PIXI.DisplayObject.render"),this.render(t)},t.Container.prototype.renderAdvancedWebGL=function(t){se(Ts,"PIXI.Container.renderAdvancedWebGL method has moved to PIXI.Container.renderAdvanced"),this.renderAdvanced(t)},Object.defineProperties(t.settings,{TRANSFORM_MODE:{get:function(){return se(Ts,"PIXI.settings.TRANSFORM_MODE property has been removed"),0},set:function(){se(Ts,"PIXI.settings.TRANSFORM_MODE property has been removed")}}});var r=t.BaseTexture;r.prototype.loadSource=function(e){se(Ts,"PIXI.BaseTexture.loadSource method has been deprecated");var r=t.resources.autoDetectResource(e);r.internal=!0,this.setResource(r),this.update()};var i=!1;Object.defineProperties(r.prototype,{hasLoaded:{get:function(){return se(Ts,"PIXI.BaseTexture.hasLoaded property has been removed, use PIXI.BaseTexture.valid"),this.valid}},imageUrl:{get:function(){var t;return se(Ts,"PIXI.BaseTexture.imageUrl property has been removed, use PIXI.BaseTexture.resource.url"),null===(t=this.resource)||void 0===t?void 0:t.url},set:function(t){se(Ts,"PIXI.BaseTexture.imageUrl property has been removed, use PIXI.BaseTexture.resource.url"),this.resource&&(this.resource.url=t)}},source:{get:function(){return se(Ts,"PIXI.BaseTexture.source property has been moved, use `PIXI.BaseTexture.resource.source`"),this.resource.source},set:function(t){se(Ts,"PIXI.BaseTexture.source property has been moved, use `PIXI.BaseTexture.resource.source` if you want to set HTMLCanvasElement. Otherwise, create new BaseTexture."),this.resource&&(this.resource.source=t)}},premultiplyAlpha:{get:function(){return se("5.2.0","PIXI.BaseTexture.premultiplyAlpha property has been changed to `alphaMode`, see `PIXI.ALPHA_MODES`"),0!==this.alphaMode},set:function(t){se("5.2.0","PIXI.BaseTexture.premultiplyAlpha property has been changed to `alphaMode`, see `PIXI.ALPHA_MODES`"),this.alphaMode=Number(t)}},_id:{get:function(){return i||(se("5.2.0","PIXI.BaseTexture._id batch local field has been changed to `_batchLocation`"),i=!0),this._batchLocation},set:function(t){this._batchLocation=t}}}),r.fromImage=function(t,e,i,n){se(Ts,"PIXI.BaseTexture.fromImage method has been replaced with PIXI.BaseTexture.from");var o={scale:n,crossorigin:e};return r.from(t,{scaleMode:i,resourceOptions:o})},r.fromCanvas=function(t,e){return se(Ts,"PIXI.BaseTexture.fromCanvas method has been replaced with PIXI.BaseTexture.from"),r.from(t,{scaleMode:e})},r.fromSVG=function(t,e,i,n){se(Ts,"PIXI.BaseTexture.fromSVG method has been replaced with PIXI.BaseTexture.from");var o={scale:n,crossorigin:e};return r.from(t,{scaleMode:i,resourceOptions:o})},Object.defineProperties(t.resources.ImageResource.prototype,{premultiplyAlpha:{get:function(){return se("5.2.0","PIXI.resources.ImageResource.premultiplyAlpha property has been changed to `alphaMode`, see `PIXI.ALPHA_MODES`"),0!==this.alphaMode},set:function(t){se("5.2.0","PIXI.resources.ImageResource.premultiplyAlpha property has been changed to `alphaMode`, see `PIXI.ALPHA_MODES`"),this.alphaMode=Number(t)}}}),t.Point.prototype.copy=function(t){return se(Ts,"PIXI.Point.copy method has been replaced with PIXI.Point.copyFrom"),this.copyFrom(t)},t.ObservablePoint.prototype.copy=function(t){return se(Ts,"PIXI.ObservablePoint.copy method has been replaced with PIXI.ObservablePoint.copyFrom"),this.copyFrom(t)},t.Rectangle.prototype.copy=function(t){return se(Ts,"PIXI.Rectangle.copy method has been replaced with PIXI.Rectangle.copyFrom"),this.copyFrom(t)},t.Matrix.prototype.copy=function(t){return se(Ts,"PIXI.Matrix.copy method has been replaced with PIXI.Matrix.copyTo"),this.copyTo(t)},t.systems.StateSystem.prototype.setState=function(t){return se("v5.1.0","StateSystem.setState has been renamed to StateSystem.set"),this.set(t)},Object.assign(t.systems.FilterSystem.prototype,{getRenderTarget:function(t,e){return se(Ts,"PIXI.FilterManager.getRenderTarget method has been replaced with PIXI.systems.FilterSystem#getFilterTexture"),this.getFilterTexture(null,e)},returnRenderTarget:function(t){se(Ts,"PIXI.FilterManager.returnRenderTarget method has been replaced with PIXI.systems.FilterSystem.returnFilterTexture"),this.returnFilterTexture(t)},calculateScreenSpaceMatrix:function(t){se(Ts,"PIXI.systems.FilterSystem.calculateScreenSpaceMatrix method is removed, use `(vTextureCoord * inputSize.xy) + outputFrame.xy` instead");var e=t.identity(),r=this.activeState,i=r.sourceFrame,n=r.destinationFrame;return e.translate(i.x/n.width,i.y/n.height),e.scale(n.width,n.height),e},calculateNormalizedScreenSpaceMatrix:function(t){se(Ts,"PIXI.systems.FilterManager.calculateNormalizedScreenSpaceMatrix method is removed, use `((vTextureCoord * inputSize.xy) + outputFrame.xy) / outputFrame.zw` instead.");var e=this.activeState,r=e.sourceFrame,i=e.destinationFrame,n=t.identity();n.translate(r.x/i.width,r.y/i.height);var o=i.width/r.width,a=i.height/r.height;return n.scale(o,a),n}}),Object.defineProperties(t.RenderTexture.prototype,{sourceFrame:{get:function(){return se(Ts,"PIXI.RenderTexture.sourceFrame property has been removed"),this.filterFrame}},size:{get:function(){return se(Ts,"PIXI.RenderTexture.size property has been removed"),this._frame}}});var n=function(t){function e(e,r,i,n){return se(Ts,"PIXI.filters.BlurXFilter class is deprecated, use PIXI.filters.BlurFilterPass"),t.call(this,!0,e,r,i,n)||this}return ws(e,t),e}(t.filters.BlurFilterPass),o=function(t){function e(e,r,i,n){return se(Ts,"PIXI.filters.BlurYFilter class is deprecated, use PIXI.filters.BlurFilterPass"),t.call(this,!1,e,r,i,n)||this}return ws(e,t),e}(t.filters.BlurFilterPass);Object.assign(t.filters,{BlurXFilter:n,BlurYFilter:o});var a=t.Sprite,s=t.Texture,h=t.Graphics;function l(t,e,r,i){return se(Ts,"PIXI.Sprite."+t+" method is deprecated, use PIXI.Sprite.from"),a.from(e,{resourceOptions:{scale:i,crossorigin:r}})}function u(t,e,r,i){return se(Ts,"PIXI.Texture."+t+" method is deprecated, use PIXI.Texture.from"),s.from(e,{resourceOptions:{scale:i,crossorigin:r}})}h.prototype.generateCanvasTexture||(h.prototype.generateCanvasTexture=function(){se(Ts,'PIXI.Graphics.generateCanvasTexture method is only available in "pixi.js-legacy"')}),Object.defineProperty(h.prototype,"graphicsData",{get:function(){return se(Ts,"PIXI.Graphics.graphicsData property is deprecated, use PIXI.Graphics.geometry.graphicsData"),this.geometry.graphicsData}}),a.fromImage=l.bind(null,"fromImage"),a.fromSVG=l.bind(null,"fromSVG"),a.fromCanvas=l.bind(null,"fromCanvas"),a.fromVideo=l.bind(null,"fromVideo"),a.fromFrame=l.bind(null,"fromFrame"),s.fromImage=u.bind(null,"fromImage"),s.fromSVG=u.bind(null,"fromSVG"),s.fromCanvas=u.bind(null,"fromCanvas"),s.fromVideo=u.bind(null,"fromVideo"),s.fromFrame=u.bind(null,"fromFrame"),Object.defineProperty(t.AbstractRenderer.prototype,"autoResize",{get:function(){return se(Ts,"PIXI.AbstractRenderer.autoResize property is deprecated, use PIXI.AbstractRenderer.autoDensity"),this.autoDensity},set:function(t){se(Ts,"PIXI.AbstractRenderer.autoResize property is deprecated, use PIXI.AbstractRenderer.autoDensity"),this.autoDensity=t}}),Object.defineProperty(t.Renderer.prototype,"textureManager",{get:function(){return se(Ts,"PIXI.Renderer.textureManager property is deprecated, use PIXI.Renderer.texture"),this.texture}}),t.utils.mixins={mixin:function(){se(Ts,"PIXI.utils.mixins.mixin function is no longer available")},delayMixin:function(){se(Ts,"PIXI.utils.mixins.delayMixin function is no longer available")},performMixins:function(){se(Ts,"PIXI.utils.mixins.performMixins function is no longer available")}},Object.defineProperty(t.BitmapText.prototype,"font",{get:function(){return se("5.3.0","PIXI.BitmapText.font property is deprecated, use fontName, fontSize, tint or align properties"),{name:this._fontName,size:this._fontSize,tint:this._tint,align:this._align}},set:function(e){if(se("5.3.0","PIXI.BitmapText.font property is deprecated, use fontName, fontSize, tint or align properties"),e){var r={font:e};this._upgradeStyle(r),r.fontSize=r.fontSize||t.BitmapFont.available[r.fontName].size,this._fontName=r.fontName,this._fontSize=r.fontSize,this.dirty=!0}}})},t.utils=ge,t}({});PIXI.useDeprecated(),
/*!
 * pixi-particles - v4.1.0
 * Compiled Fri, 19 Apr 2019 10:50:22 UTC
 *
 * pixi-particles is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
this.PIXI=this.PIXI||{},function(t,e){"use strict";var r,i=function(){function e(e,r,i){this.value=e,this.time=r,this.next=null,this.isStepped=!1,this.ease=i?"function"==typeof i?i:t.ParticleUtils.generateEase(i):null}return e.createList=function(r){if("list"in r){var i=r.list,n=void 0,o=void 0,a=i[0],s=a.value,h=a.time;if(o=n=new e("string"==typeof s?t.ParticleUtils.hexToRGB(s):s,h,r.ease),i.length>2||2===i.length&&i[1].value!==s)for(var l=1;l<i.length;++l){var u=i[l],c=u.value,p=u.time;n.next=new e("string"==typeof c?t.ParticleUtils.hexToRGB(c):c,p),n=n.next}return o.isStepped=!!r.isStepped,o}var d=new e("string"==typeof r.start?t.ParticleUtils.hexToRGB(r.start):r.start,0);return r.end!==r.start&&(d.next=new e("string"==typeof r.end?t.ParticleUtils.hexToRGB(r.end):r.end,1)),d},e}();(r=t.ParticleUtils||(t.ParticleUtils={})).verbose=!1,r.DEG_TO_RADS=Math.PI/180,r.rotatePoint=function(t,e){if(t){t*=r.DEG_TO_RADS;var i=Math.sin(t),n=Math.cos(t),o=e.x*n-e.y*i,a=e.x*i+e.y*n;e.x=o,e.y=a}},r.combineRGBComponents=function(t,e,r){return t<<16|e<<8|r},r.normalize=function(t){var e=1/r.length(t);t.x*=e,t.y*=e},r.scaleBy=function(t,e){t.x*=e,t.y*=e},r.length=function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},r.hexToRGB=function(t,e){var r;return e||(e={}),"#"==t.charAt(0)?t=t.substr(1):0===t.indexOf("0x")&&(t=t.substr(2)),8==t.length&&(r=t.substr(0,2),t=t.substr(2)),e.r=parseInt(t.substr(0,2),16),e.g=parseInt(t.substr(2,2),16),e.b=parseInt(t.substr(4,2),16),r&&(e.a=parseInt(r,16)),e},r.generateEase=function(t){var e=t.length,r=1/e;return function(i){var n,o,a=e*i|0;return n=(i-a*r)*e,(o=t[a]||t[e-1]).s+n*(2*(1-n)*(o.cp-o.s)+n*(o.e-o.s))}},r.getBlendMode=function(t){if(!t)return e.BLEND_MODES.NORMAL;for(t=t.toUpperCase();t.indexOf(" ")>=0;)t=t.replace(" ","_");return e.BLEND_MODES[t]||e.BLEND_MODES.NORMAL},r.createSteppedGradient=function(t,e){void 0===e&&(e=10),("number"!=typeof e||e<=0)&&(e=10);var n=new i(r.hexToRGB(t[0].value),t[0].time);n.isStepped=!0;for(var o=n,a=t[0],s=1,h=t[s],l=1;l<e;++l){for(var u=l/e;u>h.time;)a=h,h=t[++s];u=(u-a.time)/(h.time-a.time);var c=r.hexToRGB(a.value),p=r.hexToRGB(h.value),d={r:(p.r-c.r)*u+c.r,g:(p.g-c.g)*u+c.g,b:(p.b-c.b)*u+c.b};o.next=new i(d,l/e),o=o.next}return n};
/*! *****************************************************************************
	Copyright (c) Microsoft Corporation. All rights reserved.
	Licensed under the Apache License, Version 2.0 (the "License"); you may not use
	this file except in compliance with the License. You may obtain a copy of the
	License at http://www.apache.org/licenses/LICENSE-2.0

	THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
	KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
	WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
	MERCHANTABLITY OR NON-INFRINGEMENT.

	See the Apache Version 2.0 License for specific language governing permissions
	and limitations under the License.
	***************************************************************************** */
var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function o(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var a=function(){function t(t){void 0===t&&(t=!1),this.current=null,this.next=null,this.isColor=!!t,this.interpolate=null,this.ease=null}return t.prototype.reset=function(t){this.current=t,this.next=t.next,this.next&&this.next.time>=1?this.interpolate=this.isColor?h:s:t.isStepped?this.interpolate=this.isColor?p:c:this.interpolate=this.isColor?u:l,this.ease=this.current.ease},t}();function s(t){return this.ease&&(t=this.ease(t)),(this.next.value-this.current.value)*t+this.current.value}function h(e){this.ease&&(e=this.ease(e));var r=this.current.value,i=this.next.value,n=(i.r-r.r)*e+r.r,o=(i.g-r.g)*e+r.g,a=(i.b-r.b)*e+r.b;return t.ParticleUtils.combineRGBComponents(n,o,a)}function l(t){for(this.ease&&(t=this.ease(t));t>this.next.time;)this.current=this.next,this.next=this.next.next;return t=(t-this.current.time)/(this.next.time-this.current.time),(this.next.value-this.current.value)*t+this.current.value}function u(e){for(this.ease&&(e=this.ease(e));e>this.next.time;)this.current=this.next,this.next=this.next.next;e=(e-this.current.time)/(this.next.time-this.current.time);var r=this.current.value,i=this.next.value,n=(i.r-r.r)*e+r.r,o=(i.g-r.g)*e+r.g,a=(i.b-r.b)*e+r.b;return t.ParticleUtils.combineRGBComponents(n,o,a)}function c(t){for(this.ease&&(t=this.ease(t));this.next&&t>this.next.time;)this.current=this.next,this.next=this.next.next;return this.current.value}function p(e){for(this.ease&&(e=this.ease(e));this.next&&e>this.next.time;)this.current=this.next,this.next=this.next.next;var r=this.current.value;return t.ParticleUtils.combineRGBComponents(r.r,r.g,r.b)}var d,f=function(r){function i(t){var n=r.call(this)||this;return n.emitter=t,n.anchor.x=n.anchor.y=.5,n.velocity=new e.Point,n.rotationSpeed=0,n.rotationAcceleration=0,n.maxLife=0,n.age=0,n.ease=null,n.extraData=null,n.alphaList=new a,n.speedList=new a,n.speedMultiplier=1,n.acceleration=new e.Point,n.maxSpeed=NaN,n.scaleList=new a,n.scaleMultiplier=1,n.colorList=new a(!0),n._doAlpha=!1,n._doScale=!1,n._doSpeed=!1,n._doAcceleration=!1,n._doColor=!1,n._doNormalMovement=!1,n._oneOverLife=0,n.next=null,n.prev=null,n.init=n.init,n.Particle_init=i.prototype.init,n.update=n.update,n.Particle_update=i.prototype.update,n.Sprite_destroy=r.prototype.destroy,n.Particle_destroy=i.prototype.destroy,n.applyArt=n.applyArt,n.kill=n.kill,n}return o(i,r),i.prototype.init=function(){this.age=0,this.velocity.x=this.speedList.current.value*this.speedMultiplier,this.velocity.y=0,t.ParticleUtils.rotatePoint(this.rotation,this.velocity),this.noRotation?this.rotation=0:this.rotation*=t.ParticleUtils.DEG_TO_RADS,this.rotationSpeed*=t.ParticleUtils.DEG_TO_RADS,this.rotationAcceleration*=t.ParticleUtils.DEG_TO_RADS,this.alpha=this.alphaList.current.value,this.scale.x=this.scale.y=this.scaleList.current.value,this._doAlpha=!!this.alphaList.current.next,this._doSpeed=!!this.speedList.current.next,this._doScale=!!this.scaleList.current.next,this._doColor=!!this.colorList.current.next,this._doAcceleration=0!==this.acceleration.x||0!==this.acceleration.y,this._doNormalMovement=this._doSpeed||0!==this.speedList.current.value||this._doAcceleration,this._oneOverLife=1/this.maxLife;var e=this.colorList.current.value;this.tint=t.ParticleUtils.combineRGBComponents(e.r,e.g,e.b),this.visible=!0},i.prototype.applyArt=function(t){this.texture=t||e.Texture.EMPTY},i.prototype.update=function(e){if(this.age+=e,this.age>=this.maxLife||this.age<0)return this.kill(),-1;var r=this.age*this._oneOverLife;if(this.ease&&(r=4==this.ease.length?this.ease(r,0,1,1):this.ease(r)),this._doAlpha&&(this.alpha=this.alphaList.interpolate(r)),this._doScale){var i=this.scaleList.interpolate(r)*this.scaleMultiplier;this.scale.x=this.scale.y=i}if(this._doNormalMovement){var n=void 0,o=void 0;if(this._doSpeed){var a=this.speedList.interpolate(r)*this.speedMultiplier;t.ParticleUtils.normalize(this.velocity),t.ParticleUtils.scaleBy(this.velocity,a),n=this.velocity.x*e,o=this.velocity.y*e}else if(this._doAcceleration){var s=this.velocity.x,h=this.velocity.y;if(this.velocity.x+=this.acceleration.x*e,this.velocity.y+=this.acceleration.y*e,this.maxSpeed){var l=t.ParticleUtils.length(this.velocity);l>this.maxSpeed&&t.ParticleUtils.scaleBy(this.velocity,this.maxSpeed/l)}n=(s+this.velocity.x)/2*e,o=(h+this.velocity.y)/2*e}else n=this.velocity.x*e,o=this.velocity.y*e;this.position.x+=n,this.position.y+=o}if(this._doColor&&(this.tint=this.colorList.interpolate(r)),0!==this.rotationAcceleration){var u=this.rotationSpeed+this.rotationAcceleration*e;this.rotation+=(this.rotationSpeed+u)/2*e,this.rotationSpeed=u}else 0!==this.rotationSpeed?this.rotation+=this.rotationSpeed*e:this.acceleration&&!this.noRotation&&(this.rotation=Math.atan2(this.velocity.y,this.velocity.x));return r},i.prototype.kill=function(){this.emitter.recycle(this)},i.prototype.destroy=function(){this.parent&&this.parent.removeChild(this),this.Sprite_destroy(),this.emitter=this.velocity=this.colorList=this.scaleList=this.alphaList=this.speedList=this.ease=this.next=this.prev=null},i.parseArt=function(r){var i;for(i=r.length;i>=0;--i)"string"==typeof r[i]&&(r[i]=e.Texture.fromImage(r[i]));if(t.ParticleUtils.verbose)for(i=r.length-1;i>0;--i)if(r[i].baseTexture!=r[i-1].baseTexture){window.console&&console.warn("PixiParticles: using particle textures from different images may hinder performance in WebGL");break}return r},i.parseData=function(t){return t},i}(e.Sprite),m=function(){function t(t){this.segments=[],this.countingLengths=[],this.totalLength=0,this.init(t)}return t.prototype.init=function(t){if(t&&t.length)if(Array.isArray(t[0]))for(var e=0;e<t.length;++e)for(var r=t[e],i=r[0],n=1;n<r.length;++n){var o=r[n];this.segments.push({p1:i,p2:o,l:0}),i=o}else for(i=t[0],e=1;e<t.length;++e){o=t[e];this.segments.push({p1:i,p2:o,l:0}),i=o}else this.segments.push({p1:{x:0,y:0},p2:{x:0,y:0},l:0});for(e=0;e<this.segments.length;++e){var a=this.segments[e],s=a.p1,h=a.p2,l=Math.sqrt((h.x-s.x)*(h.x-s.x)+(h.y-s.y)*(h.y-s.y));this.segments[e].l=l,this.totalLength+=l,this.countingLengths.push(this.totalLength)}},t.prototype.getRandomPoint=function(t){var e,r,i=Math.random()*this.totalLength;if(1===this.segments.length)e=this.segments[0],r=i;else for(var n=0;n<this.countingLengths.length;++n)if(i<this.countingLengths[n]){e=this.segments[n],r=0===n?i:i-this.countingLengths[n-1];break}r/=e.l||1;var o=e.p1,a=e.p2;t.x=o.x+r*(a.x-o.x),t.y=o.y+r*(a.y-o.y)},t}(),v=e;d=parseInt(/^(\d+)\./.exec(e.VERSION)[1])<5?v.ticker.shared:v.Ticker.shared;var y=new e.Point,g=function(){function r(t,e,r){this._particleConstructor=f,this.particleImages=null,this.startAlpha=null,this.startSpeed=null,this.minimumSpeedMultiplier=1,this.acceleration=null,this.maxSpeed=NaN,this.startScale=null,this.minimumScaleMultiplier=1,this.startColor=null,this.minLifetime=0,this.maxLifetime=0,this.minStartRotation=0,this.maxStartRotation=0,this.noRotation=!1,this.minRotationSpeed=0,this.maxRotationSpeed=0,this.particleBlendMode=0,this.customEase=null,this.extraData=null,this._frequency=1,this.spawnChance=1,this.maxParticles=1e3,this.emitterLifetime=-1,this.spawnPos=null,this.spawnType=null,this._spawnFunc=null,this.spawnRect=null,this.spawnCircle=null,this.spawnPolygonalChain=null,this.particlesPerWave=1,this.particleSpacing=0,this.angleStart=0,this.rotation=0,this.ownerPos=null,this._prevEmitterPos=null,this._prevPosIsValid=!1,this._posChanged=!1,this._parent=null,this.addAtBack=!1,this.particleCount=0,this._emit=!1,this._spawnTimer=0,this._emitterLife=-1,this._activeParticlesFirst=null,this._activeParticlesLast=null,this._poolFirst=null,this._origConfig=null,this._origArt=null,this._autoUpdate=!1,this._destroyWhenComplete=!1,this._completeCallback=null,this.parent=t,e&&r&&this.init(e,r),this.recycle=this.recycle,this.update=this.update,this.rotate=this.rotate,this.updateSpawnPos=this.updateSpawnPos,this.updateOwnerPos=this.updateOwnerPos}return Object.defineProperty(r.prototype,"frequency",{get:function(){return this._frequency},set:function(t){this._frequency="number"==typeof t&&t>0?t:1},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"particleConstructor",{get:function(){return this._particleConstructor},set:function(t){if(t!=this._particleConstructor){this._particleConstructor=t,this.cleanup();for(var e=this._poolFirst;e;e=e.next)e.destroy();this._poolFirst=null,this._origConfig&&this._origArt&&this.init(this._origArt,this._origConfig)}},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"parent",{get:function(){return this._parent},set:function(t){this.cleanup(),this._parent=t},enumerable:!0,configurable:!0}),r.prototype.init=function(r,n){if(r&&n){this.cleanup(),this._origConfig=n,this._origArt=r,r=Array.isArray(r)?r.slice():[r];var o=this._particleConstructor;this.particleImages=o.parseArt?o.parseArt(r):r,n.alpha?this.startAlpha=i.createList(n.alpha):this.startAlpha=new i(1,0),n.speed?(this.startSpeed=i.createList(n.speed),this.minimumSpeedMultiplier=("minimumSpeedMultiplier"in n?n.minimumSpeedMultiplier:n.speed.minimumSpeedMultiplier)||1):(this.minimumSpeedMultiplier=1,this.startSpeed=new i(0,0));var a,s=n.acceleration;switch(s&&(s.x||s.y)?(this.startSpeed.next=null,this.acceleration=new e.Point(s.x,s.y),this.maxSpeed=n.maxSpeed||NaN):this.acceleration=new e.Point,n.scale?(this.startScale=i.createList(n.scale),this.minimumScaleMultiplier=("minimumScaleMultiplier"in n?n.minimumScaleMultiplier:n.scale.minimumScaleMultiplier)||1):(this.startScale=new i(1,0),this.minimumScaleMultiplier=1),n.color?this.startColor=i.createList(n.color):this.startColor=new i({r:255,g:255,b:255},0),n.startRotation?(this.minStartRotation=n.startRotation.min,this.maxStartRotation=n.startRotation.max):this.minStartRotation=this.maxStartRotation=0,n.noRotation&&(this.minStartRotation||this.maxStartRotation)?this.noRotation=!!n.noRotation:this.noRotation=!1,n.rotationSpeed?(this.minRotationSpeed=n.rotationSpeed.min,this.maxRotationSpeed=n.rotationSpeed.max):this.minRotationSpeed=this.maxRotationSpeed=0,this.rotationAcceleration=n.rotationAcceleration||0,this.minLifetime=n.lifetime.min,this.maxLifetime=n.lifetime.max,this.particleBlendMode=t.ParticleUtils.getBlendMode(n.blendMode),n.ease?this.customEase="function"==typeof n.ease?n.ease:t.ParticleUtils.generateEase(n.ease):this.customEase=null,o.parseData?this.extraData=o.parseData(n.extraData):this.extraData=n.extraData||null,this.spawnRect=this.spawnCircle=null,this.particlesPerWave=1,n.particlesPerWave&&n.particlesPerWave>1&&(this.particlesPerWave=n.particlesPerWave),this.particleSpacing=0,this.angleStart=0,n.spawnType){case"rect":this.spawnType="rect",this._spawnFunc=this._spawnRect;var h=n.spawnRect;this.spawnRect=new e.Rectangle(h.x,h.y,h.w,h.h);break;case"circle":this.spawnType="circle",this._spawnFunc=this._spawnCircle,a=n.spawnCircle,this.spawnCircle=new e.Circle(a.x,a.y,a.r);break;case"ring":this.spawnType="ring",this._spawnFunc=this._spawnRing,a=n.spawnCircle,this.spawnCircle=new e.Circle(a.x,a.y,a.r),this.spawnCircle.minRadius=a.minR;break;case"burst":this.spawnType="burst",this._spawnFunc=this._spawnBurst,this.particleSpacing=n.particleSpacing,this.angleStart=n.angleStart?n.angleStart:0;break;case"point":this.spawnType="point",this._spawnFunc=this._spawnPoint;break;case"polygonalChain":this.spawnType="polygonalChain",this._spawnFunc=this._spawnPolygonalChain,this.spawnPolygonalChain=new m(n.spawnPolygon);break;default:this.spawnType="point",this._spawnFunc=this._spawnPoint}this.frequency=n.frequency,this.spawnChance="number"==typeof n.spawnChance&&n.spawnChance>0?n.spawnChance:1,this.emitterLifetime=n.emitterLifetime||-1,this.maxParticles=n.maxParticles>0?n.maxParticles:1e3,this.addAtBack=!!n.addAtBack,this.rotation=0,this.ownerPos=new e.Point,this.spawnPos=new e.Point(n.pos.x,n.pos.y),this._prevEmitterPos=this.spawnPos.clone(),this._prevPosIsValid=!1,this._spawnTimer=0,this.emit=void 0===n.emit||!!n.emit,this.autoUpdate=!!n.autoUpdate}},r.prototype.recycle=function(t){t.next&&(t.next.prev=t.prev),t.prev&&(t.prev.next=t.next),t==this._activeParticlesLast&&(this._activeParticlesLast=t.prev),t==this._activeParticlesFirst&&(this._activeParticlesFirst=t.next),t.prev=null,t.next=this._poolFirst,this._poolFirst=t,t.parent&&t.parent.removeChild(t),--this.particleCount},r.prototype.rotate=function(e){if(this.rotation!=e){var r=e-this.rotation;this.rotation=e,t.ParticleUtils.rotatePoint(r,this.spawnPos),this._posChanged=!0}},r.prototype.updateSpawnPos=function(t,e){this._posChanged=!0,this.spawnPos.x=t,this.spawnPos.y=e},r.prototype.updateOwnerPos=function(t,e){this._posChanged=!0,this.ownerPos.x=t,this.ownerPos.y=e},r.prototype.resetPositionTracking=function(){this._prevPosIsValid=!1},Object.defineProperty(r.prototype,"emit",{get:function(){return this._emit},set:function(t){this._emit=!!t,this._emitterLife=this.emitterLifetime},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(t){this._autoUpdate&&!t?d.remove(this.update,this):!this._autoUpdate&&t&&d.add(this.update,this),this._autoUpdate=!!t},enumerable:!0,configurable:!0}),r.prototype.playOnceAndDestroy=function(t){this.autoUpdate=!0,this.emit=!0,this._destroyWhenComplete=!0,this._completeCallback=t},r.prototype.playOnce=function(t){this.emit=!0,this._completeCallback=t},r.prototype.update=function(t){if(this._autoUpdate&&(t=t/e.settings.TARGET_FPMS/1e3),this._parent){var r,i,n,o,a;for(i=this._activeParticlesFirst;i;i=n)n=i.next,i.update(t);this._prevPosIsValid&&(o=this._prevEmitterPos.x,a=this._prevEmitterPos.y);var s=this.ownerPos.x+this.spawnPos.x,h=this.ownerPos.y+this.spawnPos.y;if(this._emit)for(this._spawnTimer-=t<0?0:t;this._spawnTimer<=0;){if(this._emitterLife>0&&(this._emitterLife-=this._frequency,this._emitterLife<=0)){this._spawnTimer=0,this._emitterLife=0,this.emit=!1;break}if(this.particleCount>=this.maxParticles)this._spawnTimer+=this._frequency;else{var l=void 0;if(l=this.minLifetime==this.maxLifetime?this.minLifetime:Math.random()*(this.maxLifetime-this.minLifetime)+this.minLifetime,-this._spawnTimer<l){var u=void 0,c=void 0;if(this._prevPosIsValid&&this._posChanged){var p=1+this._spawnTimer/t;u=(s-o)*p+o,c=(h-a)*p+a}else u=s,c=h;r=0;for(var d=Math.min(this.particlesPerWave,this.maxParticles-this.particleCount);r<d;++r)if(!(this.spawnChance<1&&Math.random()>=this.spawnChance)){var f=void 0;if(this._poolFirst?(f=this._poolFirst,this._poolFirst=this._poolFirst.next,f.next=null):f=new this.particleConstructor(this),this.particleImages.length>1?f.applyArt(this.particleImages[Math.floor(Math.random()*this.particleImages.length)]):f.applyArt(this.particleImages[0]),f.alphaList.reset(this.startAlpha),1!=this.minimumSpeedMultiplier&&(f.speedMultiplier=Math.random()*(1-this.minimumSpeedMultiplier)+this.minimumSpeedMultiplier),f.speedList.reset(this.startSpeed),f.acceleration.x=this.acceleration.x,f.acceleration.y=this.acceleration.y,f.maxSpeed=this.maxSpeed,1!=this.minimumScaleMultiplier&&(f.scaleMultiplier=Math.random()*(1-this.minimumScaleMultiplier)+this.minimumScaleMultiplier),f.scaleList.reset(this.startScale),f.colorList.reset(this.startColor),this.minRotationSpeed==this.maxRotationSpeed?f.rotationSpeed=this.minRotationSpeed:f.rotationSpeed=Math.random()*(this.maxRotationSpeed-this.minRotationSpeed)+this.minRotationSpeed,f.rotationAcceleration=this.rotationAcceleration,f.noRotation=this.noRotation,f.maxLife=l,f.blendMode=this.particleBlendMode,f.ease=this.customEase,f.extraData=this.extraData,this._spawnFunc(f,u,c,r),f.init(),f.update(-this._spawnTimer),f.parent){var m=this._parent.children;if(m[0]==f)m.shift();else if(m[m.length-1]==f)m.pop();else{var v=m.indexOf(f);m.splice(v,1)}this.addAtBack?m.unshift(f):m.push(f)}else this.addAtBack?this._parent.addChildAt(f,0):this._parent.addChild(f);this._activeParticlesLast?(this._activeParticlesLast.next=f,f.prev=this._activeParticlesLast,this._activeParticlesLast=f):this._activeParticlesLast=this._activeParticlesFirst=f,++this.particleCount}}this._spawnTimer+=this._frequency}}this._posChanged&&(this._prevEmitterPos.x=s,this._prevEmitterPos.y=h,this._prevPosIsValid=!0,this._posChanged=!1),this._emit||this._activeParticlesFirst||(this._completeCallback&&this._completeCallback(),this._destroyWhenComplete&&this.destroy())}},r.prototype._spawnPoint=function(t,e,r){this.minStartRotation==this.maxStartRotation?t.rotation=this.minStartRotation+this.rotation:t.rotation=Math.random()*(this.maxStartRotation-this.minStartRotation)+this.minStartRotation+this.rotation,t.position.x=e,t.position.y=r},r.prototype._spawnRect=function(e,r,i){this.minStartRotation==this.maxStartRotation?e.rotation=this.minStartRotation+this.rotation:e.rotation=Math.random()*(this.maxStartRotation-this.minStartRotation)+this.minStartRotation+this.rotation,y.x=Math.random()*this.spawnRect.width+this.spawnRect.x,y.y=Math.random()*this.spawnRect.height+this.spawnRect.y,0!==this.rotation&&t.ParticleUtils.rotatePoint(this.rotation,y),e.position.x=r+y.x,e.position.y=i+y.y},r.prototype._spawnCircle=function(e,r,i){this.minStartRotation==this.maxStartRotation?e.rotation=this.minStartRotation+this.rotation:e.rotation=Math.random()*(this.maxStartRotation-this.minStartRotation)+this.minStartRotation+this.rotation,y.x=Math.random()*this.spawnCircle.radius,y.y=0,t.ParticleUtils.rotatePoint(360*Math.random(),y),y.x+=this.spawnCircle.x,y.y+=this.spawnCircle.y,0!==this.rotation&&t.ParticleUtils.rotatePoint(this.rotation,y),e.position.x=r+y.x,e.position.y=i+y.y},r.prototype._spawnRing=function(e,r,i){var n=this.spawnCircle;this.minStartRotation==this.maxStartRotation?e.rotation=this.minStartRotation+this.rotation:e.rotation=Math.random()*(this.maxStartRotation-this.minStartRotation)+this.minStartRotation+this.rotation,n.minRadius!==n.radius?y.x=Math.random()*(n.radius-n.minRadius)+n.minRadius:y.x=n.radius,y.y=0;var o=360*Math.random();e.rotation+=o,t.ParticleUtils.rotatePoint(o,y),y.x+=this.spawnCircle.x,y.y+=this.spawnCircle.y,0!==this.rotation&&t.ParticleUtils.rotatePoint(this.rotation,y),e.position.x=r+y.x,e.position.y=i+y.y},r.prototype._spawnPolygonalChain=function(e,r,i){this.minStartRotation==this.maxStartRotation?e.rotation=this.minStartRotation+this.rotation:e.rotation=Math.random()*(this.maxStartRotation-this.minStartRotation)+this.minStartRotation+this.rotation,this.spawnPolygonalChain.getRandomPoint(y),0!==this.rotation&&t.ParticleUtils.rotatePoint(this.rotation,y),e.position.x=r+y.x,e.position.y=i+y.y},r.prototype._spawnBurst=function(t,e,r,i){0===this.particleSpacing?t.rotation=360*Math.random():t.rotation=this.angleStart+this.particleSpacing*i+this.rotation,t.position.x=e,t.position.y=r},r.prototype.cleanup=function(){var t,e;for(t=this._activeParticlesFirst;t;t=e)e=t.next,this.recycle(t),t.parent&&t.parent.removeChild(t);this._activeParticlesFirst=this._activeParticlesLast=null,this.particleCount=0},r.prototype.destroy=function(){var t;this.autoUpdate=!1,this.cleanup();for(var e=this._poolFirst;e;e=t)t=e.next,e.destroy();this._poolFirst=this._parent=this.particleImages=this.spawnPos=this.ownerPos=this.startColor=this.startScale=this.startAlpha=this.startSpeed=this.customEase=this._completeCallback=null},r}(),_=new e.Point,x=["pow","sqrt","abs","floor","round","ceil","E","PI","sin","cos","tan","asin","acos","atan","atan2","log"],b=new RegExp(["[01234567890\\.\\*\\-\\+\\/\\(\\)x ,]"].concat(x).join("|"),"g"),w=function(r){function i(t){var i=r.call(this,t)||this;return i.path=null,i.initialRotation=0,i.initialPosition=new e.Point,i.movement=0,i}return o(i,r),i.prototype.init=function(){this.initialRotation=this.rotation,this.Particle_init(),this.path=this.extraData.path,this._doNormalMovement=!this.path,this.movement=0,this.initialPosition.x=this.position.x,this.initialPosition.y=this.position.y},i.prototype.update=function(e){var r=this.Particle_update(e);if(r>=0&&this.path){var i=this.speedList.interpolate(r)*this.speedMultiplier;this.movement+=i*e,_.x=this.movement,_.y=this.path(this.movement),t.ParticleUtils.rotatePoint(this.initialRotation,_),this.position.x=this.initialPosition.x+_.x,this.position.y=this.initialPosition.y+_.y}return r},i.prototype.destroy=function(){this.Particle_destroy(),this.path=this.initialPosition=null},i.parseArt=function(t){return f.parseArt(t)},i.parseData=function(e){var r={};if(e&&e.path)try{r.path=function(t){for(var e=t.match(b),r=e.length-1;r>=0;--r)x.indexOf(e[r])>=0&&(e[r]="Math."+e[r]);return t=e.join(""),new Function("x","return "+t+";")}(e.path)}catch(e){t.ParticleUtils.verbose&&console.error("PathParticle: error in parsing path expression"),r.path=null}else t.ParticleUtils.verbose&&console.error("PathParticle requires a path string in extraData!"),r.path=null;return r},i}(f),T=function(t){function r(e){var r=t.call(this,e)||this;return r.textures=null,r.duration=0,r.framerate=0,r.elapsed=0,r.loop=!1,r}return o(r,t),r.prototype.init=function(){this.Particle_init(),this.elapsed=0,this.framerate<0&&(this.duration=this.maxLife,this.framerate=this.textures.length/this.duration)},r.prototype.applyArt=function(t){this.textures=t.textures,this.framerate=t.framerate,this.duration=t.duration,this.loop=t.loop},r.prototype.update=function(t){var r=this.Particle_update(t);if(r>=0){this.elapsed+=t,this.elapsed>this.duration&&(this.loop?this.elapsed=this.elapsed%this.duration:this.elapsed=this.duration-1e-6);var i=this.elapsed*this.framerate+1e-7|0;this.texture=this.textures[i]||e.Texture.EMPTY}return r},r.prototype.destroy=function(){this.Particle_destroy(),this.textures=null},r.parseArt=function(t){for(var r,i,n,o,a,s=[],h=0;h<t.length;++h){r=t[h],s[h]=i={},i.prefix=r.prefix,i.textures=a=[],n=r.textures;for(var l=0;l<n.length;++l)if("string"==typeof(o=n[l]))a.push(e.Texture.fromImage(o));else if(o instanceof e.Texture)a.push(o);else{var u=o.count||1;for(o="string"==typeof o.texture?e.Texture.fromImage(o.texture):o.texture;u>0;--u)a.push(o)}"matchLife"==r.framerate?(i.framerate=-1,i.duration=0,i.loop=!1):(i.loop=!!r.loop,i.framerate=r.framerate>0?r.framerate:60,i.duration=a.length/i.framerate)}return s},r}(f);t.AnimatedParticle=T,t.Emitter=g,t.Particle=f,t.PathParticle=w,t.PolygonalChain=m,t.PropertyList=a,t.PropertyNode=i}(this.PIXI.particles=this.PIXI.particles||{},PIXI),
/*!
 * pixi-spine - v3.1.0
 * Compiled Wed, 03 Aug 2022 17:00:10 UTC
 *
 * pixi-spine is licensed under SPINE-LICENSE
 * http://esotericsoftware.com/spine-runtimes-license
 * 
 * Copyright 2019-2020, Ivan Igorevich Popelyshev <ivan.popelyshev@gmail.com>, All Rights Reserved
 */
this.PIXI=this.PIXI||{},this.PIXI.spine=this.PIXI.spine||{},function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@pixi/loaders"),require("@pixi/core"),require("@pixi/constants"),require("@pixi/math"),require("@pixi/display"),require("@pixi/sprite"),require("@pixi/mesh-extras"),require("@pixi/graphics"),require("@pixi/utils")):"function"==typeof define&&define.amd?define(["exports","@pixi/loaders","@pixi/core","@pixi/constants","@pixi/math","@pixi/display","@pixi/sprite","@pixi/mesh-extras","@pixi/graphics","@pixi/utils"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).pixi_spine={},t.PIXI,t.PIXI,t.PIXI,t.PIXI,t.PIXI,t.PIXI,t.PIXI,t.PIXI,t.PIXI.utils)}(this,(function(t,e,r,i,n,o,a,s,h,l){"use strict";var u;t.AttachmentType=void 0,(u=t.AttachmentType||(t.AttachmentType={}))[u.Region=0]="Region",u[u.BoundingBox=1]="BoundingBox",u[u.Mesh=2]="Mesh",u[u.LinkedMesh=3]="LinkedMesh",u[u.Path=4]="Path",u[u.Point=5]="Point",u[u.Clipping=6]="Clipping";var c,p,d,f,m,v=function(){function t(t,e,r,i){void 0===e&&(e=new Array),void 0===r&&(r=0),void 0===i&&(i=new DataView(t.buffer)),this.strings=e,this.index=r,this.buffer=i}return t.prototype.readByte=function(){return this.buffer.getInt8(this.index++)},t.prototype.readUnsignedByte=function(){return this.buffer.getUint8(this.index++)},t.prototype.readShort=function(){var t=this.buffer.getInt16(this.index);return this.index+=2,t},t.prototype.readInt32=function(){var t=this.buffer.getInt32(this.index);return this.index+=4,t},t.prototype.readInt=function(t){var e=this.readByte(),r=127&e;return 0!=(128&e)&&(r|=(127&(e=this.readByte()))<<7,0!=(128&e)&&(r|=(127&(e=this.readByte()))<<14,0!=(128&e)&&(r|=(127&(e=this.readByte()))<<21,0!=(128&e)&&(r|=(127&(e=this.readByte()))<<28)))),t?r:r>>>1^-(1&r)},t.prototype.readStringRef=function(){var t=this.readInt(!0);return 0==t?null:this.strings[t-1]},t.prototype.readString=function(){var t=this.readInt(!0);switch(t){case 0:return null;case 1:return""}t--;for(var e="",r=0;r<t;){var i=this.readUnsignedByte();switch(i>>4){case 12:case 13:e+=String.fromCharCode((31&i)<<6|63&this.readByte()),r+=2;break;case 14:e+=String.fromCharCode((15&i)<<12|(63&this.readByte())<<6|63&this.readByte()),r+=3;break;default:e+=String.fromCharCode(i),r++}}return e},t.prototype.readFloat=function(){var t=this.buffer.getFloat32(this.index);return this.index+=4,t},t.prototype.readBoolean=function(){return 0!=this.readByte()},t}();t.MixBlend=void 0,(c=t.MixBlend||(t.MixBlend={}))[c.setup=0]="setup",c[c.first=1]="first",c[c.replace=2]="replace",c[c.add=3]="add",t.MixDirection=void 0,(p=t.MixDirection||(t.MixDirection={}))[p.mixIn=0]="mixIn",p[p.mixOut=1]="mixOut",t.PositionMode=void 0,(d=t.PositionMode||(t.PositionMode={}))[d.Fixed=0]="Fixed",d[d.Percent=1]="Percent",t.RotateMode=void 0,(f=t.RotateMode||(t.RotateMode={}))[f.Tangent=0]="Tangent",f[f.Chain=1]="Chain",f[f.ChainScale=2]="ChainScale",t.TransformMode=void 0,(m=t.TransformMode||(t.TransformMode={}))[m.Normal=0]="Normal",m[m.OnlyTranslation=1]="OnlyTranslation",m[m.NoRotationOrReflection=2]="NoRotationOrReflection",m[m.NoScale=3]="NoScale",m[m.NoScaleOrReflection=4]="NoScaleOrReflection";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */
var y,g,_=function(t,e){return(_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)};function x(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}_(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}function b(e){switch(e.toLowerCase()){case"nearest":return t.TextureFilter.Nearest;case"linear":return t.TextureFilter.Linear;case"mipmap":return t.TextureFilter.MipMap;case"mipmapnearestnearest":return t.TextureFilter.MipMapNearestNearest;case"mipmaplinearnearest":return t.TextureFilter.MipMapLinearNearest;case"mipmapnearestlinear":return t.TextureFilter.MipMapNearestLinear;case"mipmaplinearlinear":return t.TextureFilter.MipMapLinearLinear;default:throw new Error("Unknown texture filter "+e)}}t.TextureFilter=void 0,(y=t.TextureFilter||(t.TextureFilter={}))[y.Nearest=9728]="Nearest",y[y.Linear=9729]="Linear",y[y.MipMap=9987]="MipMap",y[y.MipMapNearestNearest=9984]="MipMapNearestNearest",y[y.MipMapLinearNearest=9985]="MipMapLinearNearest",y[y.MipMapNearestLinear=9986]="MipMapNearestLinear",y[y.MipMapLinearLinear=9987]="MipMapLinearLinear",t.TextureWrap=void 0,(g=t.TextureWrap||(t.TextureWrap={}))[g.MirroredRepeat=33648]="MirroredRepeat",g[g.ClampToEdge=33071]="ClampToEdge",g[g.Repeat=10497]="Repeat";var w,T=function(){function t(){this.size=null,this.names=null,this.values=null,this.renderObject=null}return Object.defineProperty(t.prototype,"width",{get:function(){var t=this.texture;return t.trim?t.trim.width:t.orig.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){var t=this.texture;return t.trim?t.trim.height:t.orig.height},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"u",{get:function(){return this.texture._uvs.x0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"v",{get:function(){return this.texture._uvs.y0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"u2",{get:function(){return this.texture._uvs.x2},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"v2",{get:function(){return this.texture._uvs.y2},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"offsetX",{get:function(){var t=this.texture;return t.trim?t.trim.x:0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"offsetY",{get:function(){return this.spineOffsetY},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pixiOffsetY",{get:function(){var t=this.texture;return t.trim?t.trim.y:0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"spineOffsetY",{get:function(){var t=this.texture;return this.originalHeight-this.height-(t.trim?t.trim.y:0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"originalWidth",{get:function(){return this.texture.orig.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"originalHeight",{get:function(){return this.texture.orig.height},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"x",{get:function(){return this.texture.frame.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.texture.frame.y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rotate",{get:function(){return 0!==this.texture.rotate},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"degrees",{get:function(){return(360-45*this.texture.rotate)%360},enumerable:!1,configurable:!0}),t}(),E=function(){this.x=0,this.y=0,this.width=0,this.height=0,this.offsetX=0,this.offsetY=0,this.originalWidth=0,this.originalHeight=0,this.rotate=0,this.index=0},S=function(){function e(t,e,r){this.pages=new Array,this.regions=new Array,t&&this.addSpineAtlas(t,e,r)}return e.prototype.addTexture=function(e,r){for(var i=this.pages,n=null,o=0;o<i.length;o++)if(i[o].baseTexture===r.baseTexture){n=i[o];break}if(null===n){(n=new I).name="texturePage";var a=r.baseTexture;n.width=a.realWidth,n.height=a.realHeight,n.baseTexture=a,n.minFilter=n.magFilter=t.TextureFilter.Nearest,n.uWrap=t.TextureWrap.ClampToEdge,n.vWrap=t.TextureWrap.ClampToEdge,i.push(n)}var s=new P;return s.name=e,s.page=n,s.texture=r,s.index=-1,this.regions.push(s),s},e.prototype.addTextureHash=function(t,e){for(var r in t)t.hasOwnProperty(r)&&this.addTexture(e&&-1!==r.indexOf(".")?r.substr(0,r.lastIndexOf(".")):r,t[r])},e.prototype.addSpineAtlas=function(t,e,r){return this.load(t,e,r)},e.prototype.load=function(e,o,a){var s=this;if(null==o)throw new Error("textureLoader cannot be null.");var h=new A(e),l=new Array(4),u=null,c={},p=null;c.size=function(){u.width=parseInt(l[1]),u.height=parseInt(l[2])},c.format=function(){},c.filter=function(){u.minFilter=b(l[1]),u.magFilter=b(l[2])},c.repeat=function(){-1!=l[1].indexOf("x")&&(u.uWrap=t.TextureWrap.Repeat),-1!=l[1].indexOf("y")&&(u.vWrap=t.TextureWrap.Repeat)},c.pma=function(){u.pma="true"==l[1]};for(var d={xy:function(){p.x=parseInt(l[1]),p.y=parseInt(l[2])},size:function(){p.width=parseInt(l[1]),p.height=parseInt(l[2])},bounds:function(){p.x=parseInt(l[1]),p.y=parseInt(l[2]),p.width=parseInt(l[3]),p.height=parseInt(l[4])},offset:function(){p.offsetX=parseInt(l[1]),p.offsetY=parseInt(l[2])},orig:function(){p.originalWidth=parseInt(l[1]),p.originalHeight=parseInt(l[2])},offsets:function(){p.offsetX=parseInt(l[1]),p.offsetY=parseInt(l[2]),p.originalWidth=parseInt(l[3]),p.originalHeight=parseInt(l[4])},rotate:function(){var t=l[1],e=0;e="true"==t.toLocaleLowerCase()?6:"false"==t.toLocaleLowerCase()?0:(720-parseFloat(t))%360/45,p.rotate=e},index:function(){p.index=parseInt(l[1])}},f=h.readLine();null!=f&&0==f.trim().length;)f=h.readLine();for(;null!=f&&0!=f.trim().length&&0!=h.readEntry(l,f);)f=h.readLine();var m=function(){for(;;){if(null==f)return a&&a(s);if(0==f.trim().length)u=null,f=h.readLine();else{if(null===u){for((u=new I).name=f.trim();0!=h.readEntry(l,f=h.readLine());){(y=c[l[0]])&&y()}s.pages.push(u),o(u.name,(function(t){if(null===t)return s.pages.splice(s.pages.indexOf(u),1),a&&a(null);u.baseTexture=t,u.pma&&(t.alphaMode=i.ALPHA_MODES.PMA),t.valid||t.setSize(u.width,u.height),u.setFilters(),u.width&&u.height||(u.width=t.realWidth,u.height=t.realHeight,u.width&&u.height||console.log("ERROR spine atlas page "+u.name+": meshes wont work if you dont specify size in atlas (http://www.html5gamedevs.com/topic/18888-pixi-spines-and-meshes/?p=107121)")),m()}));break}p=new E;var t=new P;t.name=f,t.page=u;for(var e=null,v=null;;){var y,g=h.readEntry(l,f=h.readLine());if(0==g)break;if(y=d[l[0]])y();else{null==e&&(e=[],v=[]),e.push(l[0]);for(var _=[],x=0;x<g;x++)_.push(parseInt(l[x+1]));v.push(_)}}0==p.originalWidth&&0==p.originalHeight&&(p.originalWidth=p.width,p.originalHeight=p.height);var b=u.baseTexture.resolution;p.x/=b,p.y/=b,p.width/=b,p.height/=b,p.originalWidth/=b,p.originalHeight/=b,p.offsetX/=b,p.offsetY/=b;var w=p.rotate%4!=0,T=new n.Rectangle(p.x,p.y,w?p.height:p.width,w?p.width:p.height),S=new n.Rectangle(0,0,p.originalWidth,p.originalHeight),A=new n.Rectangle(p.offsetX,p.originalHeight-p.height-p.offsetY,p.width,p.height);t.texture=new r.Texture(t.page.baseTexture,T,S,A,p.rotate),t.index=p.index,t.texture.updateUvs(),s.regions.push(t)}}};m()},e.prototype.findRegion=function(t){for(var e=0;e<this.regions.length;e++)if(this.regions[e].name==t)return this.regions[e];return null},e.prototype.dispose=function(){for(var t=0;t<this.pages.length;t++)this.pages[t].baseTexture.dispose()},e}(),A=function(){function t(t){this.index=0,this.lines=t.split(/\r\n|\r|\n/)}return t.prototype.readLine=function(){return this.index>=this.lines.length?null:this.lines[this.index++]},t.prototype.readEntry=function(t,e){if(null==e)return 0;if(0==(e=e.trim()).length)return 0;var r=e.indexOf(":");if(-1==r)return 0;t[0]=e.substr(0,r).trim();for(var i=1,n=r+1;;i++){var o=e.indexOf(",",n);if(-1==o)return t[i]=e.substr(n).trim(),i;if(t[i]=e.substr(n,o-n).trim(),n=o+1,4==i)return 4}},t}(),I=function(){function e(){this.minFilter=t.TextureFilter.Nearest,this.magFilter=t.TextureFilter.Nearest,this.uWrap=t.TextureWrap.ClampToEdge,this.vWrap=t.TextureWrap.ClampToEdge}return e.prototype.setFilters=function(){var e=this.baseTexture,r=this.minFilter;r==t.TextureFilter.Linear?e.scaleMode=i.SCALE_MODES.LINEAR:this.minFilter==t.TextureFilter.Nearest?e.scaleMode=i.SCALE_MODES.NEAREST:(e.mipmap=i.MIPMAP_MODES.POW2,r==t.TextureFilter.MipMapNearestNearest?e.scaleMode=i.SCALE_MODES.NEAREST:e.scaleMode=i.SCALE_MODES.LINEAR)},e}(),P=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return x(e,t),e}(T),M=(w=new Float32Array(1),function(t){return w[0]=t,w[0]}),C=Math.fround||M,R=function(){function t(){this.array=new Array}return t.prototype.add=function(t){var e=this.contains(t);return this.array[0|t]=0|t,!e},t.prototype.contains=function(t){return null!=this.array[0|t]},t.prototype.remove=function(t){this.array[0|t]=void 0},t.prototype.clear=function(){this.array.length=0},t}(),O=function(){function t(){this.entries={},this.size=0}return t.prototype.add=function(t){var e=this.entries[t];return this.entries[t]=!0,!e&&(this.size++,!0)},t.prototype.addAll=function(t){for(var e=this.size,r=0,i=t.length;r<i;r++)this.add(t[r]);return e!=this.size},t.prototype.contains=function(t){return this.entries[t]},t.prototype.clear=function(){this.entries={},this.size=0},t}(),D=function(){function t(t,e,r,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=0),this.r=t,this.g=e,this.b=r,this.a=i}return t.prototype.set=function(t,e,r,i){return this.r=t,this.g=e,this.b=r,this.a=i,this.clamp()},t.prototype.setFromColor=function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this},t.prototype.setFromString=function(t){return t="#"==t.charAt(0)?t.substr(1):t,this.r=parseInt(t.substr(0,2),16)/255,this.g=parseInt(t.substr(2,2),16)/255,this.b=parseInt(t.substr(4,2),16)/255,this.a=8!=t.length?1:parseInt(t.substr(6,2),16)/255,this},t.prototype.add=function(t,e,r,i){return this.r+=t,this.g+=e,this.b+=r,this.a+=i,this.clamp()},t.prototype.clamp=function(){return this.r<0?this.r=0:this.r>1&&(this.r=1),this.g<0?this.g=0:this.g>1&&(this.g=1),this.b<0?this.b=0:this.b>1&&(this.b=1),this.a<0?this.a=0:this.a>1&&(this.a=1),this},t.rgba8888ToColor=function(t,e){t.r=((4278190080&e)>>>24)/255,t.g=((16711680&e)>>>16)/255,t.b=((65280&e)>>>8)/255,t.a=(255&e)/255},t.rgb888ToColor=function(t,e){t.r=((16711680&e)>>>16)/255,t.g=((65280&e)>>>8)/255,t.b=(255&e)/255},t.fromString=function(e){return(new t).setFromString(e)},t.WHITE=new t(1,1,1,1),t.RED=new t(1,0,0,1),t.GREEN=new t(0,1,0,1),t.BLUE=new t(0,0,1,1),t.MAGENTA=new t(1,0,1,1),t}(),B=function(){function t(){}return t.clamp=function(t,e,r){return t<e?e:t>r?r:t},t.cosDeg=function(e){return Math.cos(e*t.degRad)},t.sinDeg=function(e){return Math.sin(e*t.degRad)},t.signum=function(t){return t>0?1:t<0?-1:0},t.toInt=function(t){return t>0?Math.floor(t):Math.ceil(t)},t.cbrt=function(t){var e=Math.pow(Math.abs(t),1/3);return t<0?-e:e},t.randomTriangular=function(e,r){return t.randomTriangularWith(e,r,.5*(e+r))},t.randomTriangularWith=function(t,e,r){var i=Math.random(),n=e-t;return i<=(r-t)/n?t+Math.sqrt(i*n*(r-t)):e-Math.sqrt((1-i)*n*(e-r))},t.isPowerOfTwo=function(t){return t&&0==(t&t-1)},t.PI=3.1415927,t.PI2=2*t.PI,t.radiansToDegrees=180/t.PI,t.radDeg=t.radiansToDegrees,t.degreesToRadians=t.PI/180,t.degRad=t.degreesToRadians,t}(),N=function(){function t(){}return t.prototype.apply=function(t,e,r){return t+(e-t)*this.applyInternal(r)},t}(),k=function(t){function e(e){var r=t.call(this)||this;return r.power=2,r.power=e,r}return x(e,t),e.prototype.applyInternal=function(t){return t<=.5?Math.pow(2*t,this.power)/2:Math.pow(2*(t-1),this.power)/(this.power%2==0?-2:2)+1},e}(N),F=function(t){function e(e){return t.call(this,e)||this}return x(e,t),e.prototype.applyInternal=function(t){return Math.pow(t-1,this.power)*(this.power%2==0?-1:1)+1},e}(k),L=function(){function t(){}return t.arrayCopy=function(t,e,r,i,n){for(var o=e,a=i;o<e+n;o++,a++)r[a]=t[o]},t.arrayFill=function(t,e,r,i){for(var n=e;n<r;n++)t[n]=i},t.setArraySize=function(t,e,r){void 0===r&&(r=0);var i=t.length;if(i==e)return t;if(t.length=e,i<e)for(var n=i;n<e;n++)t[n]=r;return t},t.ensureArrayCapacity=function(e,r,i){return void 0===i&&(i=0),e.length>=r?e:t.setArraySize(e,r,i)},t.newArray=function(t,e){for(var r=new Array(t),i=0;i<t;i++)r[i]=e;return r},t.newFloatArray=function(e){if(t.SUPPORTS_TYPED_ARRAYS)return new Float32Array(e);for(var r=new Array(e),i=0;i<r.length;i++)r[i]=0;return r},t.newShortArray=function(e){if(t.SUPPORTS_TYPED_ARRAYS)return new Int16Array(e);for(var r=new Array(e),i=0;i<r.length;i++)r[i]=0;return r},t.toFloatArray=function(e){return t.SUPPORTS_TYPED_ARRAYS?new Float32Array(e):e},t.toSinglePrecision=function(e){return t.SUPPORTS_TYPED_ARRAYS?C(e):e},t.webkit602BugfixHelper=function(t,e){},t.contains=function(t,e,r){for(var i=0;i<t.length;i++)if(t[i]==e)return!0;return!1},t.enumValue=function(t,e){return t[e[0].toUpperCase()+e.slice(1)]},t.SUPPORTS_TYPED_ARRAYS="undefined"!=typeof Float32Array,t}(),V=function(){function t(){}return t.logBones=function(t){for(var e=0;e<t.bones.length;e++){var r=t.bones[e],i=r.matrix;console.log(r.data.name+", "+i.a+", "+i.b+", "+i.c+", "+i.d+", "+i.tx+", "+i.ty)}},t}(),X=function(){function t(t){this.items=new Array,this.instantiator=t}return t.prototype.obtain=function(){return this.items.length>0?this.items.pop():this.instantiator()},t.prototype.free=function(t){t.reset&&t.reset(),this.items.push(t)},t.prototype.freeAll=function(t){for(var e=0;e<t.length;e++)this.free(t[e])},t.prototype.clear=function(){this.items.length=0},t}(),j=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return t.prototype.set=function(t,e){return this.x=t,this.y=e,this},t.prototype.length=function(){var t=this.x,e=this.y;return Math.sqrt(t*t+e*e)},t.prototype.normalize=function(){var t=this.length();return 0!=t&&(this.x/=t,this.y/=t),this},t}(),U=function(){function t(){this.maxDelta=.064,this.framesPerSecond=0,this.delta=0,this.totalTime=0,this.lastTime=Date.now()/1e3,this.frameCount=0,this.frameTime=0}return t.prototype.update=function(){var t=Date.now()/1e3;this.delta=t-this.lastTime,this.frameTime+=this.delta,this.totalTime+=this.delta,this.delta>this.maxDelta&&(this.delta=this.maxDelta),this.lastTime=t,this.frameCount++,this.frameTime>1&&(this.framesPerSecond=this.frameCount/this.frameTime,this.frameTime=0,this.frameCount=0)},t}(),Y=function(){function t(t){void 0===t&&(t=32),this.addedValues=0,this.lastValue=0,this.mean=0,this.dirty=!0,this.values=new Array(t)}return t.prototype.hasEnoughData=function(){return this.addedValues>=this.values.length},t.prototype.addValue=function(t){this.addedValues<this.values.length&&this.addedValues++,this.values[this.lastValue++]=t,this.lastValue>this.values.length-1&&(this.lastValue=0),this.dirty=!0},t.prototype.getMean=function(){if(this.hasEnoughData()){if(this.dirty){for(var t=0,e=0;e<this.values.length;e++)t+=this.values[e];this.mean=t/this.values.length,this.dirty=!1}return this.mean}return 0},t}(),z={yDown:!0,FAIL_ON_NON_EXISTING_SKIN:!1,GLOBAL_AUTO_UPDATE:!0,GLOBAL_DELAY_LIMIT:0},W=[0,0,0],q=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.region=null,e.attachment=null,e}return x(e,t),e}(a.Sprite),G=function(t){function e(e,r,i,n,o){var a=t.call(this,e,r,i,n,o)||this;return a.region=null,a.attachment=null,a}return x(e,t),e}(s.SimpleMesh),H=function(e){function r(r){var i=e.call(this)||this;if(!r)throw new Error("The spineData param is required.");if("string"==typeof r)throw new Error('spineData param cant be string. Please use spine.Spine.fromAtlas("YOUR_RESOURCE_NAME") from now on.');i.spineData=r,i.createSkeleton(r),i.slotContainers=[],i.tempClipContainers=[];for(var n=0,o=i.skeleton.slots.length;n<o;n++){var a=i.skeleton.slots[n],s=a.getAttachment(),h=i.newContainer();if(i.slotContainers.push(h),i.addChild(h),i.tempClipContainers.push(null),s)if(s.type===t.AttachmentType.Region){var l=s.name,u=i.createSprite(a,s,l);a.currentSprite=u,a.currentSpriteName=l,h.addChild(u)}else if(s.type===t.AttachmentType.Mesh){var c=i.createMesh(a,s);a.currentMesh=c,a.currentMeshId=s.id,a.currentMeshName=s.name,h.addChild(c)}else s.type===t.AttachmentType.Clipping&&(i.createGraphics(a,s),h.addChild(a.clippingContainer),h.addChild(a.currentGraphics))}return i.tintRgb=new Float32Array([1,1,1]),i.autoUpdate=!0,i.visible=!0,i}return x(r,e),Object.defineProperty(r.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(t){t!==this._autoUpdate&&(this._autoUpdate=t,this.updateTransform=t?r.prototype.autoUpdateTransform:o.Container.prototype.updateTransform)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"tint",{get:function(){return l.rgb2hex(this.tintRgb)},set:function(t){this.tintRgb=l.hex2rgb(t,this.tintRgb)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"delayLimit",{get:function(){return(void 0!==this.localDelayLimit?this.localDelayLimit:z.GLOBAL_DELAY_LIMIT)||Number.MAX_VALUE},enumerable:!1,configurable:!0}),r.prototype.update=function(e){var r=this.delayLimit;if(e>r&&(e=r),this.state.update(e),this.state.apply(this.skeleton),this.skeleton){this.skeleton.updateWorldTransform();var i=this.skeleton.slots,o=this.color,a=null,s=null;o?(a=o.light,s=o.dark):a=this.tintRgb;for(var h=0,u=i.length;h<u;h++){var c=(P=i[h]).getAttachment(),p=this.slotContainers[h];if(c){var d=null;c.sequence&&c.sequence.apply(P,c);var f=c.region,m=c.color;switch(c.type){case t.AttachmentType.Region:if(p.transform.setFromMatrix(P.bone.matrix),f=c.region,P.currentMesh&&(P.currentMesh.visible=!1,P.currentMesh=null,P.currentMeshId=void 0,P.currentMeshName=void 0),!f){P.currentSprite&&(P.currentSprite.renderable=!1);break}if(!P.currentSpriteName||P.currentSpriteName!==c.name){var v=c.name;if(P.currentSprite&&(P.currentSprite.visible=!1),P.sprites=P.sprites||{},void 0!==P.sprites[v])P.sprites[v].visible=!0;else{var y=this.createSprite(P,c,v);p.addChild(y)}P.currentSprite=P.sprites[v],P.currentSpriteName=v}P.currentSprite.renderable=!0,P.hackRegion||this.setSpriteRegion(c,P.currentSprite,f),P.currentSprite.color?d=P.currentSprite.color:(W[0]=a[0]*P.color.r*m.r,W[1]=a[1]*P.color.g*m.g,W[2]=a[2]*P.color.b*m.b,P.currentSprite.tint=l.rgb2hex(W)),P.currentSprite.blendMode=P.blendMode;break;case t.AttachmentType.Mesh:if(P.currentSprite){P.currentSprite.visible=!1,P.currentSprite=null,P.currentSpriteName=void 0;var g=new n.Transform;g._parentID=-1,g._worldID=p.transform._worldID,p.transform=g}if(!f){P.currentMesh&&(P.currentMesh.renderable=!1);break}var _=c.id;if(!P.currentMeshId||P.currentMeshId!==_){var x=_;if(P.currentMesh&&(P.currentMesh.visible=!1),P.meshes=P.meshes||{},void 0!==P.meshes[x])P.meshes[x].visible=!0;else{var b=this.createMesh(P,c);p.addChild(b)}P.currentMesh=P.meshes[x],P.currentMeshName=c.name,P.currentMeshId=x}P.currentMesh.renderable=!0,c.computeWorldVerticesOld(P,P.currentMesh.vertices),P.currentMesh.color?d=P.currentMesh.color:(W[0]=a[0]*P.color.r*m.r,W[1]=a[1]*P.color.g*m.g,W[2]=a[2]*P.color.b*m.b,P.currentMesh.tint=l.rgb2hex(W)),P.currentMesh.blendMode=P.blendMode,P.hackRegion||this.setMeshRegion(c,P.currentMesh,f);break;case t.AttachmentType.Clipping:P.currentGraphics||(this.createGraphics(P,c),p.addChild(P.clippingContainer),p.addChild(P.currentGraphics)),this.updateGraphics(P,c),p.alpha=1,p.visible=!0;continue;default:p.visible=!1;continue}if(p.visible=!0,d){var w=P.color.r*m.r,T=P.color.g*m.g,E=P.color.b*m.b;d.setLight(a[0]*w+s[0]*(1-w),a[1]*T+s[1]*(1-T),a[2]*E+s[2]*(1-E)),P.darkColor?(w=P.darkColor.r,T=P.darkColor.g,E=P.darkColor.b):(w=0,T=0,E=0),d.setDark(a[0]*w+s[0]*(1-w),a[1]*T+s[1]*(1-T),a[2]*E+s[2]*(1-E))}p.alpha=P.color.a}else p.visible=!1}var S=this.skeleton.drawOrder,A=null,I=null;for(h=0,u=S.length;h<u;h++){var P=i[S[h].data.index];p=this.slotContainers[S[h].data.index];if(I||null!==p.parent&&p.parent!==this&&(p.parent.removeChild(p),p.parent=this),P.currentGraphics&&P.getAttachment())I=P.clippingContainer,A=P.getAttachment(),I.children.length=0,this.children[h]=p,A.endSlot===P.data&&(A.endSlot=null);else if(I){var M=this.tempClipContainers[h];M||((M=this.tempClipContainers[h]=this.newContainer()).visible=!1),this.children[h]=M,p.parent=null,I.addChild(p),A.endSlot==P.data&&(I.renderable=!0,I=null,A=null)}else this.children[h]=p}}},r.prototype.setSpriteRegion=function(t,e,r){e.attachment===t&&e.region===r||(e.region=r,e.attachment=t,e.texture=r.texture,e.rotation=t.rotation*B.degRad,e.position.x=t.x,e.position.y=t.y,e.alpha=t.color.a,r.size?(e.scale.x=r.size.width/r.originalWidth,e.scale.y=-r.size.height/r.originalHeight):(e.scale.x=t.scaleX*t.width/r.originalWidth,e.scale.y=-t.scaleY*t.height/r.originalHeight))},r.prototype.setMeshRegion=function(t,e,r){e.attachment===t&&e.region===r||(e.region=r,e.attachment=t,e.texture=r.texture,r.texture.updateUvs(),e.uvBuffer.update(t.regionUVs))},r.prototype.autoUpdateTransform=function(){if(z.GLOBAL_AUTO_UPDATE){this.lastTime=this.lastTime||Date.now();var t=.001*(Date.now()-this.lastTime);this.lastTime=Date.now(),this.update(t)}else this.lastTime=0;o.Container.prototype.updateTransform.call(this)},r.prototype.createSprite=function(t,e,r){var i=e.region;t.hackAttachment===e&&(i=t.hackRegion);var n=i?i.texture:null,o=this.newSprite(n);return o.anchor.set(.5),i&&this.setSpriteRegion(e,o,e.region),t.sprites=t.sprites||{},t.sprites[r]=o,o},r.prototype.createMesh=function(t,e){var r=e.region;t.hackAttachment===e&&(r=t.hackRegion,t.hackAttachment=null,t.hackRegion=null);var n=this.newMesh(r?r.texture:null,new Float32Array(e.regionUVs.length),e.regionUVs,new Uint16Array(e.triangles),i.DRAW_MODES.TRIANGLES);return void 0!==n._canvasPadding&&(n._canvasPadding=1.5),n.alpha=e.color.a,n.region=e.region,r&&this.setMeshRegion(e,n,r),t.meshes=t.meshes||{},t.meshes[e.id]=n,n},r.prototype.createGraphics=function(t,e){var r=this.newGraphics(),i=new n.Polygon([]);return r.clear(),r.beginFill(16777215,1),r.drawPolygon(i),r.renderable=!1,t.currentGraphics=r,t.clippingContainer=this.newContainer(),t.clippingContainer.mask=t.currentGraphics,r},r.prototype.updateGraphics=function(t,e){var r=t.currentGraphics.geometry,i=r.graphicsData[0].shape.points,n=e.worldVerticesLength;i.length=n,e.computeWorldVertices(t,0,n,i,0,2),r.invalidate()},r.prototype.hackTextureBySlotIndex=function(t,e,r){void 0===e&&(e=null),void 0===r&&(r=null);var i=this.skeleton.slots[t];if(!i)return!1;var n=i.getAttachment(),o=n.region;return e?((o=new T).texture=e,o.size=r,i.hackRegion=o,i.hackAttachment=n):(i.hackRegion=null,i.hackAttachment=null),i.currentSprite?this.setSpriteRegion(n,i.currentSprite,o):i.currentMesh&&this.setMeshRegion(n,i.currentMesh,o),!0},r.prototype.hackTextureBySlotName=function(t,e,r){void 0===e&&(e=null),void 0===r&&(r=null);var i=this.skeleton.findSlotIndex(t);return-1!=i&&this.hackTextureBySlotIndex(i,e,r)},r.prototype.hackTextureAttachment=function(t,e,r,i){void 0===i&&(i=null);var n=this.skeleton.findSlotIndex(t),o=this.skeleton.getAttachmentByName(t,e);o.region.texture=r;var a=this.skeleton.slots[n];if(!a)return!1;var s=a.getAttachment();if(e===s.name){var h=o.region;return r?((h=new T).texture=r,h.size=i,a.hackRegion=h,a.hackAttachment=s):(a.hackRegion=null,a.hackAttachment=null),a.currentSprite&&a.currentSprite.region!=h?(this.setSpriteRegion(s,a.currentSprite,h),a.currentSprite.region=h):a.currentMesh&&a.currentMesh.region!=h&&this.setMeshRegion(s,a.currentMesh,h),!0}return!1},r.prototype.newContainer=function(){return new o.Container},r.prototype.newSprite=function(t){return new q(t)},r.prototype.newGraphics=function(){return new h.Graphics},r.prototype.newMesh=function(t,e,r,i,n){return new G(t,e,r,i,n)},r.prototype.transformHack=function(){return 1},r.prototype.hackAttachmentGroups=function(t,e,r){if(t){for(var i=[],n=[],o=0,a=this.skeleton.slots.length;o<a;o++){var s=this.skeleton.slots[o],h=s.currentSpriteName||s.currentMeshName||"",l=s.currentSprite||s.currentMesh;h.endsWith(t)?(l.parentGroup=e,n.push(l)):r&&l&&(l.parentGroup=r,i.push(l))}return[i,n]}},r.prototype.destroy=function(t){for(var r=0,i=this.skeleton.slots.length;r<i;r++){var n=this.skeleton.slots[r];for(var o in n.meshes)n.meshes[o].destroy(t);for(var a in n.meshes=null,n.sprites)n.sprites[a].destroy(t);n.sprites=null}for(r=0,i=this.slotContainers.length;r<i;r++)this.slotContainers[r].destroy(t);this.spineData=null,this.skeleton=null,this.slotContainers=null,this.stateData=null,this.state=null,this.tempClipContainers=null,e.prototype.destroy.call(this,t)},r.clippingPolygon=[],r}(o.Container);Object.defineProperty(H.prototype,"visible",{get:function(){return this._visible},set:function(t){t!==this._visible&&(this._visible=t,t&&(this.lastTime=0))}}),e.LoaderResource.setExtensionXhrType("skel",e.LoaderResource.XHR_RESPONSE_TYPE.BUFFER);var $=function(){function t(){}return t.prototype.genMiddleware=function(){var t=this;return{use:function(r,n){if(!r.data)return n();var o=function(t){return t.type===e.LoaderResource.TYPE.JSON}(r)&&r.data.bones,a=function(t){return t.xhrType===e.LoaderResource.XHR_RESPONSE_TYPE.BUFFER}(r)&&("skel"===r.extension||r.metadata&&r.metadata.spineMetadata);if(!o&&!a)return n();var s=null,h=r.data;o?s=t.createJsonParser():(s=t.createBinaryParser(),r.data instanceof ArrayBuffer&&(h=new Uint8Array(r.data)));var l=r.metadata||{},u=l?l.spineSkeletonScale:null;u&&(s.scale=u);var c=l.spineAtlas;if(!1===c)return n();if(c&&c.pages)return t.parseData(r,s,c,h),n();var p=l.spineAtlasSuffix||".atlas",d=r.url,f=d.indexOf("?");f>0&&(d=d.substr(0,f)),d=d.substr(0,d.lastIndexOf("."))+p,l.spineAtlasFile&&(d=l.spineAtlasFile),d=d.replace(this.baseUrl,"");var m={crossOrigin:r.crossOrigin,xhrType:e.LoaderResource.XHR_RESPONSE_TYPE.TEXT,metadata:l.spineMetadata||null,parentResource:r},v={crossOrigin:r.crossOrigin,metadata:l.imageMetadata||null,parentResource:r},y=r.url.substr(0,r.url.lastIndexOf("/")+1);y=y.replace(this.baseUrl,"");var g=l.imageNamePrefix||r.name+"_atlas_page_",_=l.images?J(l.images):l.image?J({default:l.image}):l.imageLoader?l.imageLoader(this,g,y,v):function(t,e,r,n){r&&r.lastIndexOf("/")!==r.length-1&&(r+="/");return function(o,a){var s=e+o,h=r+o,l=t.resources[s];if(l){var u=function(){a(l.texture.baseTexture)};l.texture?u():l.onAfterMiddleware.add(u)}else t.add(s,h,n,(function(t){t.error?a(null):(o.indexOf("-pma.")>=0&&(t.texture.baseTexture.alphaMode=i.ALPHA_MODES.PMA),a(t.texture.baseTexture))}))}}(this,g,y,v);function x(e){new S(e,_,(function(e){e&&t.parseData(r,s,e,h),n()}))}l.atlasRawData?x(l.atlasRawData):this.add(r.name+"_atlas",d,m,(function(t){t.error?n():x(t.data)}))}}},t}();function J(t){return function(e,r){var i=t[e]||t.default;i&&i.baseTexture?r(i.baseTexture):r(i)}}
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var Z=function(t,e){return(Z=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)};function Q(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}Z(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var K,tt=function(t){if(null==t)throw new Error("name cannot be null.");this.name=t},et=function(t){function e(r){var i=t.call(this,r)||this;return i.id=(65535&e.nextID++)<<11,i.worldVerticesLength=0,i.deformAttachment=i,i}return Q(e,t),e.prototype.computeWorldVerticesOld=function(t,e){this.computeWorldVertices(t,0,this.worldVerticesLength,e,0,2)},e.prototype.computeWorldVertices=function(t,e,r,i,n,o){r=n+(r>>1)*o;var a=t.bone.skeleton,s=t.deform,h=this.vertices,l=this.bones;if(null!=l){for(var u=0,c=0,p=0;p<e;p+=2){u+=(v=l[u])+1,c+=v}var d=a.bones;if(0==s.length)for(P=n,E=3*c;P<r;P+=o){var f=0,m=0,v=l[u++];for(v+=u;u<v;u++,E+=3){x=d[l[u]].matrix,M=h[E],C=h[E+1];var y=h[E+2];f+=(M*x.a+C*x.c+x.tx)*y,m+=(M*x.b+C*x.d+x.ty)*y}i[P]=f,i[P+1]=m}else for(var g=s,_=(P=n,E=3*c,c<<1);P<r;P+=o){f=0,m=0,v=l[u++];for(v+=u;u<v;u++,E+=3,_+=2){x=d[l[u]].matrix,M=h[E]+g[_],C=h[E+1]+g[_+1],y=h[E+2];f+=(M*x.a+C*x.c+x.tx)*y,m+=(M*x.b+C*x.d+x.ty)*y}i[P]=f,i[P+1]=m}}else{s.length>0&&(h=s);for(var x,b=(x=t.bone.matrix).tx,w=x.ty,T=x.a,E=x.c,S=x.b,A=x.d,I=e,P=n;P<r;I+=2,P+=o){var M=h[I],C=h[I+1];i[P]=M*T+C*E+b,i[P+1]=M*S+C*A+w}}},e.prototype.copyTo=function(t){null!=this.bones?(t.bones=new Array(this.bones.length),L.arrayCopy(this.bones,0,t.bones,0,this.bones.length)):t.bones=null,null!=this.vertices?(t.vertices=L.newFloatArray(this.vertices.length),L.arrayCopy(this.vertices,0,t.vertices,0,this.vertices.length)):t.vertices=null,t.worldVerticesLength=this.worldVerticesLength,t.deformAttachment=this.deformAttachment},e.nextID=0,e}(tt),rt=function(e){function r(r){var i=e.call(this,r)||this;return i.type=t.AttachmentType.BoundingBox,i.color=new D(1,1,1,1),i}return Q(r,e),r.prototype.copy=function(){var t=new r(this.name);return this.copyTo(t),t.color.setFromColor(this.color),t},r}(et),it=function(e){function r(r){var i=e.call(this,r)||this;return i.type=t.AttachmentType.Clipping,i.color=new D(.2275,.2275,.8078,1),i}return Q(r,e),r.prototype.copy=function(){var t=new r(this.name);return this.copyTo(t),t.endSlot=this.endSlot,t.color.setFromColor(this.color),t},r}(et),nt=function(e){function r(r){var i=e.call(this,r)||this;return i.type=t.AttachmentType.Mesh,i.color=new D(1,1,1,1),i.tempColor=new D(0,0,0,0),i}return Q(r,e),r.prototype.getParentMesh=function(){return this.parentMesh},r.prototype.setParentMesh=function(t){this.parentMesh=t,null!=t&&(this.bones=t.bones,this.vertices=t.vertices,this.worldVerticesLength=t.worldVerticesLength,this.regionUVs=t.regionUVs,this.triangles=t.triangles,this.hullLength=t.hullLength,this.worldVerticesLength=t.worldVerticesLength)},r.prototype.copy=function(){if(null!=this.parentMesh)return this.newLinkedMesh();var t=new r(this.name);return t.region=this.region,t.path=this.path,t.color.setFromColor(this.color),this.copyTo(t),t.regionUVs=new Float32Array(this.regionUVs.length),L.arrayCopy(this.regionUVs,0,t.regionUVs,0,this.regionUVs.length),t.triangles=new Array(this.triangles.length),L.arrayCopy(this.triangles,0,t.triangles,0,this.triangles.length),t.hullLength=this.hullLength,null!=this.edges&&(t.edges=new Array(this.edges.length),L.arrayCopy(this.edges,0,t.edges,0,this.edges.length)),t.width=this.width,t.height=this.height,t},r.prototype.newLinkedMesh=function(){var t=new r(this.name);return t.region=this.region,t.path=this.path,t.color.setFromColor(this.color),t.deformAttachment=this.deformAttachment,t.setParentMesh(null!=this.parentMesh?this.parentMesh:this),t},r}(et),ot=function(e){function r(r){var i=e.call(this,r)||this;return i.type=t.AttachmentType.Path,i.closed=!1,i.constantSpeed=!1,i.color=new D(1,1,1,1),i}return Q(r,e),r.prototype.copy=function(){var t=new r(this.name);return this.copyTo(t),t.lengths=new Array(this.lengths.length),L.arrayCopy(this.lengths,0,t.lengths,0,this.lengths.length),t.closed=closed,t.constantSpeed=this.constantSpeed,t.color.setFromColor(this.color),t},r}(et),at=function(e){function r(r){var i=e.call(this,r)||this;return i.type=t.AttachmentType.Point,i.color=new D(.38,.94,0,1),i}return Q(r,e),r.prototype.computeWorldPosition=function(t,e){var r=t.matrix;return e.x=this.x*r.a+this.y*r.c+t.worldX,e.y=this.x*r.b+this.y*r.d+t.worldY,e},r.prototype.computeWorldRotation=function(t){var e=t.matrix,r=B.cosDeg(this.rotation),i=B.sinDeg(this.rotation),n=r*e.a+i*e.c,o=r*e.b+i*e.d;return Math.atan2(o,n)*B.radDeg},r.prototype.copy=function(){var t=new r(this.name);return t.x=this.x,t.y=this.y,t.rotation=this.rotation,t.color.setFromColor(this.color),t},r}(et),st=function(e){function r(r){var i=e.call(this,r)||this;return i.type=t.AttachmentType.Region,i.x=0,i.y=0,i.scaleX=1,i.scaleY=1,i.rotation=0,i.width=0,i.height=0,i.color=new D(1,1,1,1),i.offset=L.newFloatArray(8),i.uvs=L.newFloatArray(8),i.tempColor=new D(1,1,1,1),i}return Q(r,e),r.prototype.updateOffset=function(){var t=this.width/this.region.originalWidth*this.scaleX,e=this.height/this.region.originalHeight*this.scaleY,i=-this.width/2*this.scaleX+this.region.offsetX*t,n=-this.height/2*this.scaleY+this.region.offsetY*e,o=i+this.region.width*t,a=n+this.region.height*e,s=this.rotation*Math.PI/180,h=Math.cos(s),l=Math.sin(s),u=i*h+this.x,c=i*l,p=n*h+this.y,d=n*l,f=o*h+this.x,m=o*l,v=a*h+this.y,y=a*l,g=this.offset;g[r.OX1]=u-d,g[r.OY1]=p+c,g[r.OX2]=u-y,g[r.OY2]=v+c,g[r.OX3]=f-y,g[r.OY3]=v+m,g[r.OX4]=f-d,g[r.OY4]=p+m},r.prototype.setRegion=function(t){this.region=t;var e=this.uvs;t.rotate?(e[2]=t.u,e[3]=t.v2,e[4]=t.u,e[5]=t.v,e[6]=t.u2,e[7]=t.v,e[0]=t.u2,e[1]=t.v2):(e[0]=t.u,e[1]=t.v2,e[2]=t.u,e[3]=t.v,e[4]=t.u2,e[5]=t.v,e[6]=t.u2,e[7]=t.v2)},r.prototype.computeWorldVertices=function(t,e,i,n){var o=this.offset,a=t.matrix,s=a.tx,h=a.ty,l=a.a,u=a.c,c=a.b,p=a.d,d=0,f=0;d=o[r.OX1],f=o[r.OY1],e[i]=d*l+f*u+s,e[i+1]=d*c+f*p+h,i+=n,d=o[r.OX2],f=o[r.OY2],e[i]=d*l+f*u+s,e[i+1]=d*c+f*p+h,i+=n,d=o[r.OX3],f=o[r.OY3],e[i]=d*l+f*u+s,e[i+1]=d*c+f*p+h,i+=n,d=o[r.OX4],f=o[r.OY4],e[i]=d*l+f*u+s,e[i+1]=d*c+f*p+h},r.prototype.copy=function(){var t=new r(this.name);return t.region=this.region,t.rendererObject=this.rendererObject,t.path=this.path,t.x=this.x,t.y=this.y,t.scaleX=this.scaleX,t.scaleY=this.scaleY,t.rotation=this.rotation,t.width=this.width,t.height=this.height,L.arrayCopy(this.uvs,0,t.uvs,0,8),L.arrayCopy(this.offset,0,t.offset,0,8),t.color.setFromColor(this.color),t},r.OX1=0,r.OY1=1,r.OX2=2,r.OY2=3,r.OX3=4,r.OY3=5,r.OX4=6,r.OY4=7,r.X1=0,r.Y1=1,r.C1R=2,r.C1G=3,r.C1B=4,r.C1A=5,r.U1=6,r.V1=7,r.X2=8,r.Y2=9,r.C2R=10,r.C2G=11,r.C2B=12,r.C2A=13,r.U2=14,r.V2=15,r.X3=16,r.Y3=17,r.C3R=18,r.C3G=19,r.C3B=20,r.C3A=21,r.U3=22,r.V3=23,r.X4=24,r.Y4=25,r.C4R=26,r.C4G=27,r.C4B=28,r.C4A=29,r.U4=30,r.V4=31,r}(tt),ht=function(){function t(t,e){this.jitterX=0,this.jitterY=0,this.jitterX=t,this.jitterY=e}return t.prototype.begin=function(t){},t.prototype.transform=function(t,e,r,i){t.x+=B.randomTriangular(-this.jitterX,this.jitterY),t.y+=B.randomTriangular(-this.jitterX,this.jitterY)},t.prototype.end=function(){},t}(),lt=function(){function t(t){this.centerX=0,this.centerY=0,this.radius=0,this.angle=0,this.worldX=0,this.worldY=0,this.radius=t}return t.prototype.begin=function(t){this.worldX=t.x+this.centerX,this.worldY=t.y+this.centerY},t.prototype.transform=function(e,r,i,n){var o=this.angle*B.degreesToRadians,a=e.x-this.worldX,s=e.y-this.worldY,h=Math.sqrt(a*a+s*s);if(h<this.radius){var l=t.interpolation.apply(0,o,(this.radius-h)/this.radius),u=Math.cos(l),c=Math.sin(l);e.x=u*a-c*s+this.worldX,e.y=c*a+u*s+this.worldY}},t.prototype.end=function(){},t.interpolation=new F(2),t}(),ut=function(){function t(t,e,r){if(null==t)throw new Error("name cannot be null.");if(null==e)throw new Error("timelines cannot be null.");this.name=t,this.timelines=e,this.timelineIds=[];for(var i=0;i<e.length;i++)this.timelineIds[e[i].getPropertyId()]=!0;this.duration=r}return t.prototype.hasTimeline=function(t){return 1==this.timelineIds[t]},t.prototype.apply=function(t,e,r,i,n,o,a,s){if(null==t)throw new Error("skeleton cannot be null.");i&&0!=this.duration&&(r%=this.duration,e>0&&(e%=this.duration));for(var h=this.timelines,l=0,u=h.length;l<u;l++)h[l].apply(t,e,r,n,o,a,s)},t.binarySearch=function(t,e,r){void 0===r&&(r=1);var i=0,n=t.length/r-2;if(0==n)return r;for(var o=n>>>1;;){if(t[(o+1)*r]<=e?i=o+1:n=o,i==n)return(i+1)*r;o=i+n>>>1}},t.linearSearch=function(t,e,r){for(var i=0,n=t.length-r;i<=n;i+=r)if(t[i]>e)return i;return-1},t}();!function(t){t[t.rotate=0]="rotate",t[t.translate=1]="translate",t[t.scale=2]="scale",t[t.shear=3]="shear",t[t.attachment=4]="attachment",t[t.color=5]="color",t[t.deform=6]="deform",t[t.event=7]="event",t[t.drawOrder=8]="drawOrder",t[t.ikConstraint=9]="ikConstraint",t[t.transformConstraint=10]="transformConstraint",t[t.pathConstraintPosition=11]="pathConstraintPosition",t[t.pathConstraintSpacing=12]="pathConstraintSpacing",t[t.pathConstraintMix=13]="pathConstraintMix",t[t.twoColor=14]="twoColor"}(K||(K={}));var ct,pt=function(){function t(e){if(e<=0)throw new Error("frameCount must be > 0: "+e);this.curves=L.newFloatArray((e-1)*t.BEZIER_SIZE)}return t.prototype.getFrameCount=function(){return this.curves.length/t.BEZIER_SIZE+1},t.prototype.setLinear=function(e){this.curves[e*t.BEZIER_SIZE]=t.LINEAR},t.prototype.setStepped=function(e){this.curves[e*t.BEZIER_SIZE]=t.STEPPED},t.prototype.getCurveType=function(e){var r=e*t.BEZIER_SIZE;if(r==this.curves.length)return t.LINEAR;var i=this.curves[r];return i==t.LINEAR?t.LINEAR:i==t.STEPPED?t.STEPPED:t.BEZIER},t.prototype.setCurve=function(e,r,i,n,o){var a=.03*(2*-r+n),s=.03*(2*-i+o),h=.006*(3*(r-n)+1),l=.006*(3*(i-o)+1),u=2*a+h,c=2*s+l,p=.3*r+a+.16666667*h,d=.3*i+s+.16666667*l,f=e*t.BEZIER_SIZE,m=this.curves;m[f++]=t.BEZIER;for(var v=p,y=d,g=f+t.BEZIER_SIZE-1;f<g;f+=2)m[f]=v,m[f+1]=y,p+=u,d+=c,u+=h,c+=l,v+=p,y+=d},t.prototype.getCurvePercent=function(e,r){r=B.clamp(r,0,1);var i=this.curves,n=e*t.BEZIER_SIZE,o=i[n];if(o==t.LINEAR)return r;if(o==t.STEPPED)return 0;for(var a=0,s=++n,h=n+t.BEZIER_SIZE-1;n<h;n+=2)if((a=i[n])>=r){var l=void 0,u=void 0;return n==s?(l=0,u=0):(l=i[n-2],u=i[n-1]),u+(i[n+1]-u)*(r-l)/(a-l)}var c=i[n-1];return c+(1-c)*(r-a)/(1-a)},t.LINEAR=0,t.STEPPED=1,t.BEZIER=2,t.BEZIER_SIZE=19,t}(),dt=function(e){function r(t){var r=e.call(this,t)||this;return r.frames=L.newFloatArray(t<<1),r}return Q(r,e),r.prototype.getPropertyId=function(){return(K.rotate<<24)+this.boneIndex},r.prototype.setFrame=function(t,e,i){t<<=1,this.frames[t]=e,this.frames[t+r.ROTATION]=i},r.prototype.apply=function(e,i,n,o,a,s,h){var l=this.frames,u=e.bones[this.boneIndex];if(u.active)if(n<l[0])switch(s){case t.MixBlend.setup:return void(u.rotation=u.data.rotation);case t.MixBlend.first:var c=u.data.rotation-u.rotation;u.rotation+=(c-360*(16384-(16384.499999999996-c/360|0)))*a}else if(n>=l[l.length-r.ENTRIES]){var p=l[l.length+r.PREV_ROTATION];switch(s){case t.MixBlend.setup:u.rotation=u.data.rotation+p*a;break;case t.MixBlend.first:case t.MixBlend.replace:p+=u.data.rotation-u.rotation,p-=360*(16384-(16384.499999999996-p/360|0));case t.MixBlend.add:u.rotation+=p*a}}else{var d=ut.binarySearch(l,n,r.ENTRIES),f=l[d+r.PREV_ROTATION],m=l[d],v=this.getCurvePercent((d>>1)-1,1-(n-m)/(l[d+r.PREV_TIME]-m)),y=l[d+r.ROTATION]-f;switch(y=f+(y-360*(16384-(16384.499999999996-y/360|0)))*v,s){case t.MixBlend.setup:u.rotation=u.data.rotation+(y-360*(16384-(16384.499999999996-y/360|0)))*a;break;case t.MixBlend.first:case t.MixBlend.replace:y+=u.data.rotation-u.rotation;case t.MixBlend.add:u.rotation+=(y-360*(16384-(16384.499999999996-y/360|0)))*a}}},r.ENTRIES=2,r.PREV_TIME=-2,r.PREV_ROTATION=-1,r.ROTATION=1,r}(pt),ft=function(e){function r(t){var i=e.call(this,t)||this;return i.frames=L.newFloatArray(t*r.ENTRIES),i}return Q(r,e),r.prototype.getPropertyId=function(){return(K.translate<<24)+this.boneIndex},r.prototype.setFrame=function(t,e,i,n){t*=r.ENTRIES,this.frames[t]=e,this.frames[t+r.X]=i,this.frames[t+r.Y]=n},r.prototype.apply=function(e,i,n,o,a,s,h){var l=this.frames,u=e.bones[this.boneIndex];if(u.active)if(n<l[0])switch(s){case t.MixBlend.setup:return u.x=u.data.x,void(u.y=u.data.y);case t.MixBlend.first:u.x+=(u.data.x-u.x)*a,u.y+=(u.data.y-u.y)*a}else{var c=0,p=0;if(n>=l[l.length-r.ENTRIES])c=l[l.length+r.PREV_X],p=l[l.length+r.PREV_Y];else{var d=ut.binarySearch(l,n,r.ENTRIES);c=l[d+r.PREV_X],p=l[d+r.PREV_Y];var f=l[d],m=this.getCurvePercent(d/r.ENTRIES-1,1-(n-f)/(l[d+r.PREV_TIME]-f));c+=(l[d+r.X]-c)*m,p+=(l[d+r.Y]-p)*m}switch(s){case t.MixBlend.setup:u.x=u.data.x+c*a,u.y=u.data.y+p*a;break;case t.MixBlend.first:case t.MixBlend.replace:u.x+=(u.data.x+c-u.x)*a,u.y+=(u.data.y+p-u.y)*a;break;case t.MixBlend.add:u.x+=c*a,u.y+=p*a}}},r.ENTRIES=3,r.PREV_TIME=-3,r.PREV_X=-2,r.PREV_Y=-1,r.X=1,r.Y=2,r}(pt),mt=function(e){function r(t){return e.call(this,t)||this}return Q(r,e),r.prototype.getPropertyId=function(){return(K.scale<<24)+this.boneIndex},r.prototype.apply=function(e,i,n,o,a,s,h){var l=this.frames,u=e.bones[this.boneIndex];if(u.active)if(n<l[0])switch(s){case t.MixBlend.setup:return u.scaleX=u.data.scaleX,void(u.scaleY=u.data.scaleY);case t.MixBlend.first:u.scaleX+=(u.data.scaleX-u.scaleX)*a,u.scaleY+=(u.data.scaleY-u.scaleY)*a}else{var c=0,p=0;if(n>=l[l.length-r.ENTRIES])c=l[l.length+r.PREV_X]*u.data.scaleX,p=l[l.length+r.PREV_Y]*u.data.scaleY;else{var d=ut.binarySearch(l,n,r.ENTRIES);c=l[d+r.PREV_X],p=l[d+r.PREV_Y];var f=l[d],m=this.getCurvePercent(d/r.ENTRIES-1,1-(n-f)/(l[d+r.PREV_TIME]-f));c=(c+(l[d+r.X]-c)*m)*u.data.scaleX,p=(p+(l[d+r.Y]-p)*m)*u.data.scaleY}if(1==a)s==t.MixBlend.add?(u.scaleX+=c-u.data.scaleX,u.scaleY+=p-u.data.scaleY):(u.scaleX=c,u.scaleY=p);else{var v=0,y=0;if(h==t.MixDirection.mixOut)switch(s){case t.MixBlend.setup:v=u.data.scaleX,y=u.data.scaleY,u.scaleX=v+(Math.abs(c)*B.signum(v)-v)*a,u.scaleY=y+(Math.abs(p)*B.signum(y)-y)*a;break;case t.MixBlend.first:case t.MixBlend.replace:v=u.scaleX,y=u.scaleY,u.scaleX=v+(Math.abs(c)*B.signum(v)-v)*a,u.scaleY=y+(Math.abs(p)*B.signum(y)-y)*a;break;case t.MixBlend.add:v=u.scaleX,y=u.scaleY,u.scaleX=v+(Math.abs(c)*B.signum(v)-u.data.scaleX)*a,u.scaleY=y+(Math.abs(p)*B.signum(y)-u.data.scaleY)*a}else switch(s){case t.MixBlend.setup:v=Math.abs(u.data.scaleX)*B.signum(c),y=Math.abs(u.data.scaleY)*B.signum(p),u.scaleX=v+(c-v)*a,u.scaleY=y+(p-y)*a;break;case t.MixBlend.first:case t.MixBlend.replace:v=Math.abs(u.scaleX)*B.signum(c),y=Math.abs(u.scaleY)*B.signum(p),u.scaleX=v+(c-v)*a,u.scaleY=y+(p-y)*a;break;case t.MixBlend.add:v=B.signum(c),y=B.signum(p),u.scaleX=Math.abs(u.scaleX)*v+(c-Math.abs(u.data.scaleX)*v)*a,u.scaleY=Math.abs(u.scaleY)*y+(p-Math.abs(u.data.scaleY)*y)*a}}}},r}(ft),vt=function(e){function r(t){return e.call(this,t)||this}return Q(r,e),r.prototype.getPropertyId=function(){return(K.shear<<24)+this.boneIndex},r.prototype.apply=function(e,i,n,o,a,s,h){var l=this.frames,u=e.bones[this.boneIndex];if(u.active)if(n<l[0])switch(s){case t.MixBlend.setup:return u.shearX=u.data.shearX,void(u.shearY=u.data.shearY);case t.MixBlend.first:u.shearX+=(u.data.shearX-u.shearX)*a,u.shearY+=(u.data.shearY-u.shearY)*a}else{var c=0,p=0;if(n>=l[l.length-r.ENTRIES])c=l[l.length+r.PREV_X],p=l[l.length+r.PREV_Y];else{var d=ut.binarySearch(l,n,r.ENTRIES);c=l[d+r.PREV_X],p=l[d+r.PREV_Y];var f=l[d],m=this.getCurvePercent(d/r.ENTRIES-1,1-(n-f)/(l[d+r.PREV_TIME]-f));c+=(l[d+r.X]-c)*m,p+=(l[d+r.Y]-p)*m}switch(s){case t.MixBlend.setup:u.shearX=u.data.shearX+c*a,u.shearY=u.data.shearY+p*a;break;case t.MixBlend.first:case t.MixBlend.replace:u.shearX+=(u.data.shearX+c-u.shearX)*a,u.shearY+=(u.data.shearY+p-u.shearY)*a;break;case t.MixBlend.add:u.shearX+=c*a,u.shearY+=p*a}}},r}(ft),yt=function(e){function r(t){var i=e.call(this,t)||this;return i.frames=L.newFloatArray(t*r.ENTRIES),i}return Q(r,e),r.prototype.getPropertyId=function(){return(K.color<<24)+this.slotIndex},r.prototype.setFrame=function(t,e,i,n,o,a){t*=r.ENTRIES,this.frames[t]=e,this.frames[t+r.R]=i,this.frames[t+r.G]=n,this.frames[t+r.B]=o,this.frames[t+r.A]=a},r.prototype.apply=function(e,i,n,o,a,s,h){var l=e.slots[this.slotIndex];if(l.bone.active){var u=this.frames;if(n<u[0])switch(s){case t.MixBlend.setup:return void l.color.setFromColor(l.data.color);case t.MixBlend.first:var c=l.color,p=l.data.color;c.add((p.r-c.r)*a,(p.g-c.g)*a,(p.b-c.b)*a,(p.a-c.a)*a)}else{var d=0,f=0,m=0,v=0;if(n>=u[u.length-r.ENTRIES]){var y=u.length;d=u[y+r.PREV_R],f=u[y+r.PREV_G],m=u[y+r.PREV_B],v=u[y+r.PREV_A]}else{var g=ut.binarySearch(u,n,r.ENTRIES);d=u[g+r.PREV_R],f=u[g+r.PREV_G],m=u[g+r.PREV_B],v=u[g+r.PREV_A];var _=u[g],x=this.getCurvePercent(g/r.ENTRIES-1,1-(n-_)/(u[g+r.PREV_TIME]-_));d+=(u[g+r.R]-d)*x,f+=(u[g+r.G]-f)*x,m+=(u[g+r.B]-m)*x,v+=(u[g+r.A]-v)*x}if(1==a)l.color.set(d,f,m,v);else{c=l.color;s==t.MixBlend.setup&&c.setFromColor(l.data.color),c.add((d-c.r)*a,(f-c.g)*a,(m-c.b)*a,(v-c.a)*a)}}}},r.ENTRIES=5,r.PREV_TIME=-5,r.PREV_R=-4,r.PREV_G=-3,r.PREV_B=-2,r.PREV_A=-1,r.R=1,r.G=2,r.B=3,r.A=4,r}(pt),gt=function(e){function r(t){var i=e.call(this,t)||this;return i.frames=L.newFloatArray(t*r.ENTRIES),i}return Q(r,e),r.prototype.getPropertyId=function(){return(K.twoColor<<24)+this.slotIndex},r.prototype.setFrame=function(t,e,i,n,o,a,s,h,l){t*=r.ENTRIES,this.frames[t]=e,this.frames[t+r.R]=i,this.frames[t+r.G]=n,this.frames[t+r.B]=o,this.frames[t+r.A]=a,this.frames[t+r.R2]=s,this.frames[t+r.G2]=h,this.frames[t+r.B2]=l},r.prototype.apply=function(e,i,n,o,a,s,h){var l=e.slots[this.slotIndex];if(l.bone.active){var u=this.frames;if(n<u[0])switch(s){case t.MixBlend.setup:return l.color.setFromColor(l.data.color),void l.darkColor.setFromColor(l.data.darkColor);case t.MixBlend.first:var c=l.color,p=l.darkColor,d=l.data.color,f=l.data.darkColor;c.add((d.r-c.r)*a,(d.g-c.g)*a,(d.b-c.b)*a,(d.a-c.a)*a),p.add((f.r-p.r)*a,(f.g-p.g)*a,(f.b-p.b)*a,0)}else{var m=0,v=0,y=0,g=0,_=0,x=0,b=0;if(n>=u[u.length-r.ENTRIES]){var w=u.length;m=u[w+r.PREV_R],v=u[w+r.PREV_G],y=u[w+r.PREV_B],g=u[w+r.PREV_A],_=u[w+r.PREV_R2],x=u[w+r.PREV_G2],b=u[w+r.PREV_B2]}else{var T=ut.binarySearch(u,n,r.ENTRIES);m=u[T+r.PREV_R],v=u[T+r.PREV_G],y=u[T+r.PREV_B],g=u[T+r.PREV_A],_=u[T+r.PREV_R2],x=u[T+r.PREV_G2],b=u[T+r.PREV_B2];var E=u[T],S=this.getCurvePercent(T/r.ENTRIES-1,1-(n-E)/(u[T+r.PREV_TIME]-E));m+=(u[T+r.R]-m)*S,v+=(u[T+r.G]-v)*S,y+=(u[T+r.B]-y)*S,g+=(u[T+r.A]-g)*S,_+=(u[T+r.R2]-_)*S,x+=(u[T+r.G2]-x)*S,b+=(u[T+r.B2]-b)*S}if(1==a)l.color.set(m,v,y,g),l.darkColor.set(_,x,b,1);else{c=l.color,p=l.darkColor;s==t.MixBlend.setup&&(c.setFromColor(l.data.color),p.setFromColor(l.data.darkColor)),c.add((m-c.r)*a,(v-c.g)*a,(y-c.b)*a,(g-c.a)*a),p.add((_-p.r)*a,(x-p.g)*a,(b-p.b)*a,0)}}}},r.ENTRIES=8,r.PREV_TIME=-8,r.PREV_R=-7,r.PREV_G=-6,r.PREV_B=-5,r.PREV_A=-4,r.PREV_R2=-3,r.PREV_G2=-2,r.PREV_B2=-1,r.R=1,r.G=2,r.B=3,r.A=4,r.R2=5,r.G2=6,r.B2=7,r}(pt),_t=function(){function e(t){this.frames=L.newFloatArray(t),this.attachmentNames=new Array(t)}return e.prototype.getPropertyId=function(){return(K.attachment<<24)+this.slotIndex},e.prototype.getFrameCount=function(){return this.frames.length},e.prototype.setFrame=function(t,e,r){this.frames[t]=e,this.attachmentNames[t]=r},e.prototype.apply=function(e,r,i,n,o,a,s){var h=e.slots[this.slotIndex];if(h.bone.active)if(s!=t.MixDirection.mixOut){var l=this.frames;if(i<l[0])a!=t.MixBlend.setup&&a!=t.MixBlend.first||this.setAttachment(e,h,h.data.attachmentName);else{var u=0;u=i>=l[l.length-1]?l.length-1:ut.binarySearch(l,i,1)-1;var c=this.attachmentNames[u];e.slots[this.slotIndex].setAttachment(null==c?null:e.getAttachment(this.slotIndex,c))}}else a==t.MixBlend.setup&&this.setAttachment(e,h,h.data.attachmentName)},e.prototype.setAttachment=function(t,e,r){e.setAttachment(null==r?null:t.getAttachment(this.slotIndex,r))},e}(),xt=null,bt=function(e){function r(t){var r=e.call(this,t)||this;return r.frames=L.newFloatArray(t),r.frameVertices=new Array(t),null==xt&&(xt=L.newFloatArray(64)),r}return Q(r,e),r.prototype.getPropertyId=function(){return(K.deform<<27)+ +this.attachment.id+this.slotIndex},r.prototype.setFrame=function(t,e,r){this.frames[t]=e,this.frameVertices[t]=r},r.prototype.apply=function(e,r,i,n,o,a,s){var h=e.slots[this.slotIndex];if(h.bone.active){var l=h.getAttachment();if(l instanceof et&&l.deformAttachment==this.attachment){var u=h.deform;0==u.length&&(a=t.MixBlend.setup);var c=this.frameVertices,p=c[0].length,d=this.frames;if(i<d[0]){var f=l;switch(a){case t.MixBlend.setup:return void(u.length=0);case t.MixBlend.first:if(1==o){u.length=0;break}var m=L.setArraySize(u,p);if(null==f.bones)for(var v=f.vertices,y=0;y<p;y++)m[y]+=(v[y]-m[y])*o;else{o=1-o;for(y=0;y<p;y++)m[y]*=o}}}else{var g=L.setArraySize(u,p);if(i>=d[d.length-1]){var _=c[d.length-1];if(1==o)if(a==t.MixBlend.add)if(null==(f=l).bones){v=f.vertices;for(var x=0;x<p;x++)g[x]+=_[x]-v[x]}else for(var b=0;b<p;b++)g[b]+=_[b];else L.arrayCopy(_,0,g,0,p);else switch(a){case t.MixBlend.setup:var w=l;if(null==w.bones){v=w.vertices;for(var T=0;T<p;T++){var E=v[T];g[T]=E+(_[T]-E)*o}}else for(var S=0;S<p;S++)g[S]=_[S]*o;break;case t.MixBlend.first:case t.MixBlend.replace:for(var A=0;A<p;A++)g[A]+=(_[A]-g[A])*o;break;case t.MixBlend.add:if(null==(f=l).bones){v=f.vertices;for(var I=0;I<p;I++)g[I]+=(_[I]-v[I])*o}else for(var P=0;P<p;P++)g[P]+=_[P]*o}}else{var M=ut.binarySearch(d,i),C=c[M-1],R=c[M],O=d[M],D=this.getCurvePercent(M-1,1-(i-O)/(d[M-1]-O));if(1==o)if(a==t.MixBlend.add)if(null==(f=l).bones){v=f.vertices;for(var B=0;B<p;B++){var N=C[B];g[B]+=N+(R[B]-N)*D-v[B]}}else for(var k=0;k<p;k++){N=C[k];g[k]+=N+(R[k]-N)*D}else for(var F=0;F<p;F++){N=C[F];g[F]=N+(R[F]-N)*D}else switch(a){case t.MixBlend.setup:var V=l;if(null==V.bones){v=V.vertices;for(var X=0;X<p;X++){N=C[X],E=v[X];g[X]=E+(N+(R[X]-N)*D-E)*o}}else for(var j=0;j<p;j++){N=C[j];g[j]=(N+(R[j]-N)*D)*o}break;case t.MixBlend.first:case t.MixBlend.replace:for(var U=0;U<p;U++){N=C[U];g[U]+=(N+(R[U]-N)*D-g[U])*o}break;case t.MixBlend.add:if(null==(f=l).bones){v=f.vertices;for(var Y=0;Y<p;Y++){N=C[Y];g[Y]+=(N+(R[Y]-N)*D-v[Y])*o}}else for(var z=0;z<p;z++){N=C[z];g[z]+=(N+(R[z]-N)*D)*o}}}}}}},r}(pt),wt=function(){function t(t){this.frames=L.newFloatArray(t),this.events=new Array(t)}return t.prototype.getPropertyId=function(){return K.event<<24},t.prototype.getFrameCount=function(){return this.frames.length},t.prototype.setFrame=function(t,e){this.frames[t]=e.time,this.events[t]=e},t.prototype.apply=function(t,e,r,i,n,o,a){if(null!=i){var s=this.frames,h=this.frames.length;if(e>r)this.apply(t,e,Number.MAX_VALUE,i,n,o,a),e=-1;else if(e>=s[h-1])return;if(!(r<s[0])){var l=0;if(e<s[0])l=0;else for(var u=s[l=ut.binarySearch(s,e)];l>0&&s[l-1]==u;)l--;for(;l<h&&r>=s[l];l++)i.push(this.events[l])}}},t}(),Tt=function(){function e(t){this.frames=L.newFloatArray(t),this.drawOrders=new Array(t)}return e.prototype.getPropertyId=function(){return K.drawOrder<<24},e.prototype.getFrameCount=function(){return this.frames.length},e.prototype.setFrame=function(t,e,r){this.frames[t]=e,this.drawOrders[t]=r},e.prototype.apply=function(e,r,i,n,o,a,s){var h=e.drawOrder,l=e.slots;if(s!=t.MixDirection.mixOut||a!=t.MixBlend.setup){var u=this.frames;if(i<u[0])a!=t.MixBlend.setup&&a!=t.MixBlend.first||L.arrayCopy(e.slots,0,e.drawOrder,0,e.slots.length);else{var c=0;c=i>=u[u.length-1]?u.length-1:ut.binarySearch(u,i)-1;var p=this.drawOrders[c];if(null==p)L.arrayCopy(l,0,h,0,l.length);else for(var d=0,f=p.length;d<f;d++)h[d]=l[p[d]]}}else L.arrayCopy(e.slots,0,e.drawOrder,0,e.slots.length)},e}(),Et=function(e){function r(t){var i=e.call(this,t)||this;return i.frames=L.newFloatArray(t*r.ENTRIES),i}return Q(r,e),r.prototype.getPropertyId=function(){return(K.ikConstraint<<24)+this.ikConstraintIndex},r.prototype.setFrame=function(t,e,i,n,o,a,s){t*=r.ENTRIES,this.frames[t]=e,this.frames[t+r.MIX]=i,this.frames[t+r.SOFTNESS]=n,this.frames[t+r.BEND_DIRECTION]=o,this.frames[t+r.COMPRESS]=a?1:0,this.frames[t+r.STRETCH]=s?1:0},r.prototype.apply=function(e,i,n,o,a,s,h){var l=this.frames,u=e.ikConstraints[this.ikConstraintIndex];if(u.active)if(n<l[0])switch(s){case t.MixBlend.setup:return u.mix=u.data.mix,u.softness=u.data.softness,u.bendDirection=u.data.bendDirection,u.compress=u.data.compress,void(u.stretch=u.data.stretch);case t.MixBlend.first:u.mix+=(u.data.mix-u.mix)*a,u.softness+=(u.data.softness-u.softness)*a,u.bendDirection=u.data.bendDirection,u.compress=u.data.compress,u.stretch=u.data.stretch}else if(n>=l[l.length-r.ENTRIES])s==t.MixBlend.setup?(u.mix=u.data.mix+(l[l.length+r.PREV_MIX]-u.data.mix)*a,u.softness=u.data.softness+(l[l.length+r.PREV_SOFTNESS]-u.data.softness)*a,h==t.MixDirection.mixOut?(u.bendDirection=u.data.bendDirection,u.compress=u.data.compress,u.stretch=u.data.stretch):(u.bendDirection=l[l.length+r.PREV_BEND_DIRECTION],u.compress=0!=l[l.length+r.PREV_COMPRESS],u.stretch=0!=l[l.length+r.PREV_STRETCH])):(u.mix+=(l[l.length+r.PREV_MIX]-u.mix)*a,u.softness+=(l[l.length+r.PREV_SOFTNESS]-u.softness)*a,h==t.MixDirection.mixIn&&(u.bendDirection=l[l.length+r.PREV_BEND_DIRECTION],u.compress=0!=l[l.length+r.PREV_COMPRESS],u.stretch=0!=l[l.length+r.PREV_STRETCH]));else{var c=ut.binarySearch(l,n,r.ENTRIES),p=l[c+r.PREV_MIX],d=l[c+r.PREV_SOFTNESS],f=l[c],m=this.getCurvePercent(c/r.ENTRIES-1,1-(n-f)/(l[c+r.PREV_TIME]-f));s==t.MixBlend.setup?(u.mix=u.data.mix+(p+(l[c+r.MIX]-p)*m-u.data.mix)*a,u.softness=u.data.softness+(d+(l[c+r.SOFTNESS]-d)*m-u.data.softness)*a,h==t.MixDirection.mixOut?(u.bendDirection=u.data.bendDirection,u.compress=u.data.compress,u.stretch=u.data.stretch):(u.bendDirection=l[c+r.PREV_BEND_DIRECTION],u.compress=0!=l[c+r.PREV_COMPRESS],u.stretch=0!=l[c+r.PREV_STRETCH])):(u.mix+=(p+(l[c+r.MIX]-p)*m-u.mix)*a,u.softness+=(d+(l[c+r.SOFTNESS]-d)*m-u.softness)*a,h==t.MixDirection.mixIn&&(u.bendDirection=l[c+r.PREV_BEND_DIRECTION],u.compress=0!=l[c+r.PREV_COMPRESS],u.stretch=0!=l[c+r.PREV_STRETCH]))}},r.ENTRIES=6,r.PREV_TIME=-6,r.PREV_MIX=-5,r.PREV_SOFTNESS=-4,r.PREV_BEND_DIRECTION=-3,r.PREV_COMPRESS=-2,r.PREV_STRETCH=-1,r.MIX=1,r.SOFTNESS=2,r.BEND_DIRECTION=3,r.COMPRESS=4,r.STRETCH=5,r}(pt),St=function(e){function r(t){var i=e.call(this,t)||this;return i.frames=L.newFloatArray(t*r.ENTRIES),i}return Q(r,e),r.prototype.getPropertyId=function(){return(K.transformConstraint<<24)+this.transformConstraintIndex},r.prototype.setFrame=function(t,e,i,n,o,a){t*=r.ENTRIES,this.frames[t]=e,this.frames[t+r.ROTATE]=i,this.frames[t+r.TRANSLATE]=n,this.frames[t+r.SCALE]=o,this.frames[t+r.SHEAR]=a},r.prototype.apply=function(e,i,n,o,a,s,h){var l=this.frames,u=e.transformConstraints[this.transformConstraintIndex];if(u.active)if(n<l[0]){var c=u.data;switch(s){case t.MixBlend.setup:return u.rotateMix=c.rotateMix,u.translateMix=c.translateMix,u.scaleMix=c.scaleMix,void(u.shearMix=c.shearMix);case t.MixBlend.first:u.rotateMix+=(c.rotateMix-u.rotateMix)*a,u.translateMix+=(c.translateMix-u.translateMix)*a,u.scaleMix+=(c.scaleMix-u.scaleMix)*a,u.shearMix+=(c.shearMix-u.shearMix)*a}}else{var p=0,d=0,f=0,m=0;if(n>=l[l.length-r.ENTRIES]){var v=l.length;p=l[v+r.PREV_ROTATE],d=l[v+r.PREV_TRANSLATE],f=l[v+r.PREV_SCALE],m=l[v+r.PREV_SHEAR]}else{var y=ut.binarySearch(l,n,r.ENTRIES);p=l[y+r.PREV_ROTATE],d=l[y+r.PREV_TRANSLATE],f=l[y+r.PREV_SCALE],m=l[y+r.PREV_SHEAR];var g=l[y],_=this.getCurvePercent(y/r.ENTRIES-1,1-(n-g)/(l[y+r.PREV_TIME]-g));p+=(l[y+r.ROTATE]-p)*_,d+=(l[y+r.TRANSLATE]-d)*_,f+=(l[y+r.SCALE]-f)*_,m+=(l[y+r.SHEAR]-m)*_}if(s==t.MixBlend.setup){c=u.data;u.rotateMix=c.rotateMix+(p-c.rotateMix)*a,u.translateMix=c.translateMix+(d-c.translateMix)*a,u.scaleMix=c.scaleMix+(f-c.scaleMix)*a,u.shearMix=c.shearMix+(m-c.shearMix)*a}else u.rotateMix+=(p-u.rotateMix)*a,u.translateMix+=(d-u.translateMix)*a,u.scaleMix+=(f-u.scaleMix)*a,u.shearMix+=(m-u.shearMix)*a}},r.ENTRIES=5,r.PREV_TIME=-5,r.PREV_ROTATE=-4,r.PREV_TRANSLATE=-3,r.PREV_SCALE=-2,r.PREV_SHEAR=-1,r.ROTATE=1,r.TRANSLATE=2,r.SCALE=3,r.SHEAR=4,r}(pt),At=function(e){function r(t){var i=e.call(this,t)||this;return i.frames=L.newFloatArray(t*r.ENTRIES),i}return Q(r,e),r.prototype.getPropertyId=function(){return(K.pathConstraintPosition<<24)+this.pathConstraintIndex},r.prototype.setFrame=function(t,e,i){t*=r.ENTRIES,this.frames[t]=e,this.frames[t+r.VALUE]=i},r.prototype.apply=function(e,i,n,o,a,s,h){var l=this.frames,u=e.pathConstraints[this.pathConstraintIndex];if(u.active)if(n<l[0])switch(s){case t.MixBlend.setup:return void(u.position=u.data.position);case t.MixBlend.first:u.position+=(u.data.position-u.position)*a}else{var c=0;if(n>=l[l.length-r.ENTRIES])c=l[l.length+r.PREV_VALUE];else{var p=ut.binarySearch(l,n,r.ENTRIES);c=l[p+r.PREV_VALUE];var d=l[p],f=this.getCurvePercent(p/r.ENTRIES-1,1-(n-d)/(l[p+r.PREV_TIME]-d));c+=(l[p+r.VALUE]-c)*f}s==t.MixBlend.setup?u.position=u.data.position+(c-u.data.position)*a:u.position+=(c-u.position)*a}},r.ENTRIES=2,r.PREV_TIME=-2,r.PREV_VALUE=-1,r.VALUE=1,r}(pt),It=function(e){function r(t){return e.call(this,t)||this}return Q(r,e),r.prototype.getPropertyId=function(){return(K.pathConstraintSpacing<<24)+this.pathConstraintIndex},r.prototype.apply=function(e,i,n,o,a,s,h){var l=this.frames,u=e.pathConstraints[this.pathConstraintIndex];if(u.active)if(n<l[0])switch(s){case t.MixBlend.setup:return void(u.spacing=u.data.spacing);case t.MixBlend.first:u.spacing+=(u.data.spacing-u.spacing)*a}else{var c=0;if(n>=l[l.length-r.ENTRIES])c=l[l.length+r.PREV_VALUE];else{var p=ut.binarySearch(l,n,r.ENTRIES);c=l[p+r.PREV_VALUE];var d=l[p],f=this.getCurvePercent(p/r.ENTRIES-1,1-(n-d)/(l[p+r.PREV_TIME]-d));c+=(l[p+r.VALUE]-c)*f}s==t.MixBlend.setup?u.spacing=u.data.spacing+(c-u.data.spacing)*a:u.spacing+=(c-u.spacing)*a}},r}(At),Pt=function(e){function r(t){var i=e.call(this,t)||this;return i.frames=L.newFloatArray(t*r.ENTRIES),i}return Q(r,e),r.prototype.getPropertyId=function(){return(K.pathConstraintMix<<24)+this.pathConstraintIndex},r.prototype.setFrame=function(t,e,i,n){t*=r.ENTRIES,this.frames[t]=e,this.frames[t+r.ROTATE]=i,this.frames[t+r.TRANSLATE]=n},r.prototype.apply=function(e,i,n,o,a,s,h){var l=this.frames,u=e.pathConstraints[this.pathConstraintIndex];if(u.active)if(n<l[0])switch(s){case t.MixBlend.setup:return u.rotateMix=u.data.rotateMix,void(u.translateMix=u.data.translateMix);case t.MixBlend.first:u.rotateMix+=(u.data.rotateMix-u.rotateMix)*a,u.translateMix+=(u.data.translateMix-u.translateMix)*a}else{var c=0,p=0;if(n>=l[l.length-r.ENTRIES])c=l[l.length+r.PREV_ROTATE],p=l[l.length+r.PREV_TRANSLATE];else{var d=ut.binarySearch(l,n,r.ENTRIES);c=l[d+r.PREV_ROTATE],p=l[d+r.PREV_TRANSLATE];var f=l[d],m=this.getCurvePercent(d/r.ENTRIES-1,1-(n-f)/(l[d+r.PREV_TIME]-f));c+=(l[d+r.ROTATE]-c)*m,p+=(l[d+r.TRANSLATE]-p)*m}s==t.MixBlend.setup?(u.rotateMix=u.data.rotateMix+(c-u.data.rotateMix)*a,u.translateMix=u.data.translateMix+(p-u.data.translateMix)*a):(u.rotateMix+=(c-u.rotateMix)*a,u.translateMix+=(p-u.translateMix)*a)}},r.ENTRIES=3,r.PREV_TIME=-3,r.PREV_ROTATE=-2,r.PREV_TRANSLATE=-1,r.ROTATE=1,r.TRANSLATE=2,r}(pt),Mt=function(){function e(t){this.tracks=new Array,this.timeScale=1,this.unkeyedState=0,this.events=new Array,this.listeners=new Array,this.queue=new Rt(this),this.propertyIDs=new R,this.animationsChanged=!1,this.trackEntryPool=new X((function(){return new Ct})),this.data=t}return e.prototype.update=function(t){t*=this.timeScale;for(var e=this.tracks,r=0,i=e.length;r<i;r++){var n=e[r];if(null!=n){n.animationLast=n.nextAnimationLast,n.trackLast=n.nextTrackLast;var o=t*n.timeScale;if(n.delay>0){if(n.delay-=o,n.delay>0)continue;o=-n.delay,n.delay=0}var a=n.next;if(null!=a){var s=n.trackLast-a.delay;if(s>=0){for(a.delay=0,a.trackTime+=0==n.timeScale?0:(s/n.timeScale+t)*a.timeScale,n.trackTime+=o,this.setCurrent(r,a,!0);null!=a.mixingFrom;)a.mixTime+=t,a=a.mixingFrom;continue}}else if(n.trackLast>=n.trackEnd&&null==n.mixingFrom){e[r]=null,this.queue.end(n),this.disposeNext(n);continue}if(null!=n.mixingFrom&&this.updateMixingFrom(n,t)){var h=n.mixingFrom;for(n.mixingFrom=null,null!=h&&(h.mixingTo=null);null!=h;)this.queue.end(h),h=h.mixingFrom}n.trackTime+=o}}this.queue.drain()},e.prototype.updateMixingFrom=function(t,e){var r=t.mixingFrom;if(null==r)return!0;var i=this.updateMixingFrom(r,e);return r.animationLast=r.nextAnimationLast,r.trackLast=r.nextTrackLast,t.mixTime>0&&t.mixTime>=t.mixDuration?(0!=r.totalAlpha&&0!=t.mixDuration||(t.mixingFrom=r.mixingFrom,null!=r.mixingFrom&&(r.mixingFrom.mixingTo=t),t.interruptAlpha=r.interruptAlpha,this.queue.end(r)),i):(r.trackTime+=e*r.timeScale,t.mixTime+=e,!1)},e.prototype.apply=function(r){if(null==r)throw new Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();for(var i=this.events,n=this.tracks,o=!1,a=0,s=n.length;a<s;a++){var h=n[a];if(!(null==h||h.delay>0)){o=!0;var l=0==a?t.MixBlend.first:h.mixBlend,u=h.alpha;null!=h.mixingFrom?u*=this.applyMixingFrom(h,r,l):h.trackTime>=h.trackEnd&&null==h.next&&(u=0);var c=h.animationLast,p=h.getAnimationTime(),d=h.animation.timelines.length,f=h.animation.timelines;if(0==a&&1==u||l==t.MixBlend.add)for(var m=0;m<d;m++){L.webkit602BugfixHelper(u,l);var v=f[m];v instanceof _t?this.applyAttachmentTimeline(v,r,p,l,!0):v.apply(r,c,p,i,u,l,t.MixDirection.mixIn)}else{var y=h.timelineMode,g=0==h.timelinesRotation.length;g&&L.setArraySize(h.timelinesRotation,d<<1,null);var _=h.timelinesRotation;for(m=0;m<d;m++){var x=f[m],b=y[m]==e.SUBSEQUENT?l:t.MixBlend.setup;x instanceof dt?this.applyRotateTimeline(x,r,p,u,b,_,m<<1,g):x instanceof _t?this.applyAttachmentTimeline(x,r,p,l,!0):(L.webkit602BugfixHelper(u,l),x.apply(r,c,p,i,u,b,t.MixDirection.mixIn))}}this.queueEvents(h,p),i.length=0,h.nextAnimationLast=p,h.nextTrackLast=h.trackTime}}for(var w=this.unkeyedState+e.SETUP,T=r.slots,E=0,S=r.slots.length;E<S;E++){var A=T[E];if(A.attachmentState==w){var I=A.data.attachmentName;A.setAttachment(null==I?null:r.getAttachment(A.data.index,I))}}return this.unkeyedState+=2,this.queue.drain(),o},e.prototype.applyMixingFrom=function(r,i,n){var o=r.mixingFrom;null!=o.mixingFrom&&this.applyMixingFrom(o,i,n);var a=0;0==r.mixDuration?(a=1,n==t.MixBlend.first&&(n=t.MixBlend.setup)):((a=r.mixTime/r.mixDuration)>1&&(a=1),n!=t.MixBlend.first&&(n=o.mixBlend));var s=a<o.eventThreshold?this.events:null,h=a<o.attachmentThreshold,l=a<o.drawOrderThreshold,u=o.animationLast,c=o.getAnimationTime(),p=o.animation.timelines.length,d=o.animation.timelines,f=o.alpha*r.interruptAlpha,m=f*(1-a);if(n==t.MixBlend.add)for(var v=0;v<p;v++)d[v].apply(i,u,c,s,m,n,t.MixDirection.mixOut);else{var y=o.timelineMode,g=o.timelineHoldMix,_=0==o.timelinesRotation.length;_&&L.setArraySize(o.timelinesRotation,p<<1,null);var x=o.timelinesRotation;o.totalAlpha=0;for(v=0;v<p;v++){var b=d[v],w=t.MixDirection.mixOut,T=void 0,E=0;switch(y[v]){case e.SUBSEQUENT:if(!l&&b instanceof Tt)continue;T=n,E=m;break;case e.FIRST:T=t.MixBlend.setup,E=m;break;case e.HOLD_SUBSEQUENT:T=n,E=f;break;case e.HOLD_FIRST:T=t.MixBlend.setup,E=f;break;default:T=t.MixBlend.setup;var S=g[v];E=f*Math.max(0,1-S.mixTime/S.mixDuration)}o.totalAlpha+=E,b instanceof dt?this.applyRotateTimeline(b,i,c,E,T,x,v<<1,_):b instanceof _t?this.applyAttachmentTimeline(b,i,c,T,h):(L.webkit602BugfixHelper(E,n),l&&b instanceof Tt&&T==t.MixBlend.setup&&(w=t.MixDirection.mixIn),b.apply(i,u,c,s,E,T,w))}}return r.mixDuration>0&&this.queueEvents(o,c),this.events.length=0,o.nextAnimationLast=c,o.nextTrackLast=o.trackTime,a},e.prototype.applyAttachmentTimeline=function(r,i,n,o,a){var s=i.slots[r.slotIndex];if(s.bone.active){var h,l=r.frames;if(n<l[0])o!=t.MixBlend.setup&&o!=t.MixBlend.first||this.setAttachment(i,s,s.data.attachmentName,a);else h=n>=l[l.length-1]?l.length-1:ut.binarySearch(l,n)-1,this.setAttachment(i,s,r.attachmentNames[h],a);s.attachmentState<=this.unkeyedState&&(s.attachmentState=this.unkeyedState+e.SETUP)}},e.prototype.setAttachment=function(t,r,i,n){r.setAttachment(null==i?null:t.getAttachment(r.data.index,i)),n&&(r.attachmentState=this.unkeyedState+e.CURRENT)},e.prototype.applyRotateTimeline=function(e,r,i,n,o,a,s,h){if(h&&(a[s]=0),1!=n){var l=e,u=l.frames,c=r.bones[l.boneIndex];if(c.active){var p=0,d=0;if(i<u[0])switch(o){case t.MixBlend.setup:c.rotation=c.data.rotation;default:return;case t.MixBlend.first:p=c.rotation,d=c.data.rotation}else if(p=o==t.MixBlend.setup?c.data.rotation:c.rotation,i>=u[u.length-dt.ENTRIES])d=c.data.rotation+u[u.length+dt.PREV_ROTATION];else{var f=ut.binarySearch(u,i,dt.ENTRIES),m=u[f+dt.PREV_ROTATION],v=u[f],y=l.getCurvePercent((f>>1)-1,1-(i-v)/(u[f+dt.PREV_TIME]-v));d=u[f+dt.ROTATION]-m,d=m+(d-=360*(16384-(16384.499999999996-d/360|0)))*y+c.data.rotation,d-=360*(16384-(16384.499999999996-d/360|0))}var g=0,_=d-p;if(0==(_-=360*(16384-(16384.499999999996-_/360|0))))g=a[s];else{var x=0,b=0;h?(x=0,b=_):(x=a[s],b=a[s+1]);var w=_>0,T=x>=0;B.signum(b)!=B.signum(_)&&Math.abs(b)<=90&&(Math.abs(x)>180&&(x+=360*B.signum(x)),T=w),g=_+x-x%360,T!=w&&(g+=360*B.signum(x)),a[s]=g}a[s+1]=_,p+=g*n,c.rotation=p-360*(16384-(16384.499999999996-p/360|0))}}else e.apply(r,0,i,null,1,o,t.MixDirection.mixIn)},e.prototype.queueEvents=function(t,e){for(var r=t.animationStart,i=t.animationEnd,n=i-r,o=t.trackLast%n,a=this.events,s=0,h=a.length;s<h;s++){var l=a[s];if(l.time<o)break;l.time>i||this.queue.event(t,l)}for((t.loop?0==n||o>t.trackTime%n:e>=i&&t.animationLast<i)&&this.queue.complete(t);s<h;s++){a[s].time<r||this.queue.event(t,a[s])}},e.prototype.clearTracks=function(){var t=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(var e=0,r=this.tracks.length;e<r;e++)this.clearTrack(e);this.tracks.length=0,this.queue.drainDisabled=t,this.queue.drain()},e.prototype.clearTrack=function(t){if(!(t>=this.tracks.length)){var e=this.tracks[t];if(null!=e){this.queue.end(e),this.disposeNext(e);for(var r=e;;){var i=r.mixingFrom;if(null==i)break;this.queue.end(i),r.mixingFrom=null,r.mixingTo=null,r=i}this.tracks[e.trackIndex]=null,this.queue.drain()}}},e.prototype.setCurrent=function(t,e,r){var i=this.expandToIndex(t);this.tracks[t]=e,null!=i&&(r&&this.queue.interrupt(i),e.mixingFrom=i,i.mixingTo=e,e.mixTime=0,null!=i.mixingFrom&&i.mixDuration>0&&(e.interruptAlpha*=Math.min(1,i.mixTime/i.mixDuration)),i.timelinesRotation.length=0),this.queue.start(e)},e.prototype.setAnimation=function(t,e,r){var i=this.data.skeletonData.findAnimation(e);if(null==i)throw new Error("Animation not found: "+e);return this.setAnimationWith(t,i,r)},e.prototype.setAnimationWith=function(t,e,r){if(null==e)throw new Error("animation cannot be null.");var i=!0,n=this.expandToIndex(t);null!=n&&(-1==n.nextTrackLast?(this.tracks[t]=n.mixingFrom,this.queue.interrupt(n),this.queue.end(n),this.disposeNext(n),n=n.mixingFrom,i=!1):this.disposeNext(n));var o=this.trackEntry(t,e,r,n);return this.setCurrent(t,o,i),this.queue.drain(),o},e.prototype.addAnimation=function(t,e,r,i){var n=this.data.skeletonData.findAnimation(e);if(null==n)throw new Error("Animation not found: "+e);return this.addAnimationWith(t,n,r,i)},e.prototype.addAnimationWith=function(t,e,r,i){if(null==e)throw new Error("animation cannot be null.");var n=this.expandToIndex(t);if(null!=n)for(;null!=n.next;)n=n.next;var o=this.trackEntry(t,e,r,n);if(null==n)this.setCurrent(t,o,!0),this.queue.drain();else if(n.next=o,i<=0){var a=n.animationEnd-n.animationStart;0!=a?(n.loop?i+=a*(1+(n.trackTime/a|0)):i+=Math.max(a,n.trackTime),i-=this.data.getMix(n.animation,e)):i=n.trackTime}return o.delay=i,o},e.prototype.setEmptyAnimation=function(t,r){var i=this.setAnimationWith(t,e.emptyAnimation,!1);return i.mixDuration=r,i.trackEnd=r,i},e.prototype.addEmptyAnimation=function(t,r,i){i<=0&&(i-=r);var n=this.addAnimationWith(t,e.emptyAnimation,!1,i);return n.mixDuration=r,n.trackEnd=r,n},e.prototype.setEmptyAnimations=function(t){var e=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(var r=0,i=this.tracks.length;r<i;r++){var n=this.tracks[r];null!=n&&this.setEmptyAnimation(n.trackIndex,t)}this.queue.drainDisabled=e,this.queue.drain()},e.prototype.expandToIndex=function(t){return t<this.tracks.length?this.tracks[t]:(L.ensureArrayCapacity(this.tracks,t+1,null),this.tracks.length=t+1,null)},e.prototype.trackEntry=function(e,r,i,n){var o=this.trackEntryPool.obtain();return o.trackIndex=e,o.animation=r,o.loop=i,o.holdPrevious=!1,o.eventThreshold=0,o.attachmentThreshold=0,o.drawOrderThreshold=0,o.animationStart=0,o.animationEnd=r.duration,o.animationLast=-1,o.nextAnimationLast=-1,o.delay=0,o.trackTime=0,o.trackLast=-1,o.nextTrackLast=-1,o.trackEnd=Number.MAX_VALUE,o.timeScale=1,o.alpha=1,o.interruptAlpha=1,o.mixTime=0,o.mixDuration=null==n?0:this.data.getMix(n.animation,r),o.mixBlend=t.MixBlend.replace,o},e.prototype.disposeNext=function(t){for(var e=t.next;null!=e;)this.queue.dispose(e),e=e.next;t.next=null},e.prototype._animationsChanged=function(){this.animationsChanged=!1,this.propertyIDs.clear();for(var e=0,r=this.tracks.length;e<r;e++){var i=this.tracks[e];if(null!=i){for(;null!=i.mixingFrom;)i=i.mixingFrom;do{null!=i.mixingFrom&&i.mixBlend==t.MixBlend.add||this.computeHold(i),i=i.mixingTo}while(null!=i)}}},e.prototype.computeHold=function(t){var r=t.mixingTo,i=t.animation.timelines,n=t.animation.timelines.length,o=L.setArraySize(t.timelineMode,n);t.timelineHoldMix.length=0;var a=L.setArraySize(t.timelineHoldMix,n),s=this.propertyIDs;if(null!=r&&r.holdPrevious)for(var h=0;h<n;h++)o[h]=s.add(i[h].getPropertyId())?e.HOLD_FIRST:e.HOLD_SUBSEQUENT;else t:for(h=0;h<n;h++){var l=i[h],u=l.getPropertyId();if(s.add(u))if(null==r||l instanceof _t||l instanceof Tt||l instanceof wt||!r.animation.hasTimeline(u))o[h]=e.FIRST;else{for(var c=r.mixingTo;null!=c;c=c.mixingTo)if(!c.animation.hasTimeline(u)){if(t.mixDuration>0){o[h]=e.HOLD_MIX,a[h]=c;continue t}break}o[h]=e.HOLD_FIRST}else o[h]=e.SUBSEQUENT}},e.prototype.getCurrent=function(t){return t>=this.tracks.length?null:this.tracks[t]},e.prototype.addListener=function(t){if(null==t)throw new Error("listener cannot be null.");this.listeners.push(t)},e.prototype.removeListener=function(t){var e=this.listeners.indexOf(t);e>=0&&this.listeners.splice(e,1)},e.prototype.clearListeners=function(){this.listeners.length=0},e.prototype.clearListenerNotifications=function(){this.queue.clear()},e.prototype.setAnimationByName=function(t,r,i){e.deprecatedWarning1||(e.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: AnimationState.setAnimationByName is deprecated, please use setAnimation from now on.")),this.setAnimation(t,r,i)},e.prototype.addAnimationByName=function(t,r,i,n){e.deprecatedWarning2||(e.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: AnimationState.addAnimationByName is deprecated, please use addAnimation from now on.")),this.addAnimation(t,r,i,n)},e.prototype.hasAnimation=function(t){return null!==this.data.skeletonData.findAnimation(t)},e.prototype.hasAnimationByName=function(t){return e.deprecatedWarning3||(e.deprecatedWarning3=!0,console.warn("Spine Deprecation Warning: AnimationState.hasAnimationByName is deprecated, please use hasAnimation from now on.")),this.hasAnimation(t)},e.emptyAnimation=new ut("<empty>",[],0),e.SUBSEQUENT=0,e.FIRST=1,e.HOLD_SUBSEQUENT=2,e.HOLD_FIRST=3,e.HOLD_MIX=4,e.SETUP=1,e.CURRENT=2,e.deprecatedWarning1=!1,e.deprecatedWarning2=!1,e.deprecatedWarning3=!1,e}(),Ct=function(){function e(){this.mixBlend=t.MixBlend.replace,this.timelineMode=new Array,this.timelineHoldMix=new Array,this.timelinesRotation=new Array}return e.prototype.reset=function(){this.next=null,this.mixingFrom=null,this.mixingTo=null,this.animation=null,this.listener=null,this.timelineMode.length=0,this.timelineHoldMix.length=0,this.timelinesRotation.length=0},e.prototype.getAnimationTime=function(){if(this.loop){var t=this.animationEnd-this.animationStart;return 0==t?this.animationStart:this.trackTime%t+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)},e.prototype.setAnimationLast=function(t){this.animationLast=t,this.nextAnimationLast=t},e.prototype.isComplete=function(){return this.trackTime>=this.animationEnd-this.animationStart},e.prototype.resetRotationDirections=function(){this.timelinesRotation.length=0},Object.defineProperty(e.prototype,"time",{get:function(){return e.deprecatedWarning1||(e.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime},set:function(t){e.deprecatedWarning1||(e.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"endTime",{get:function(){return e.deprecatedWarning2||(e.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime},set:function(t){e.deprecatedWarning2||(e.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime=t},enumerable:!1,configurable:!0}),e.prototype.loopsCount=function(){return Math.floor(this.trackTime/this.trackEnd)},e.deprecatedWarning1=!1,e.deprecatedWarning2=!1,e}(),Rt=function(){function t(t){this.objects=[],this.drainDisabled=!1,this.animState=t}return t.prototype.start=function(t){this.objects.push(ct.start),this.objects.push(t),this.animState.animationsChanged=!0},t.prototype.interrupt=function(t){this.objects.push(ct.interrupt),this.objects.push(t)},t.prototype.end=function(t){this.objects.push(ct.end),this.objects.push(t),this.animState.animationsChanged=!0},t.prototype.dispose=function(t){this.objects.push(ct.dispose),this.objects.push(t)},t.prototype.complete=function(t){this.objects.push(ct.complete),this.objects.push(t)},t.prototype.event=function(t,e){this.objects.push(ct.event),this.objects.push(t),this.objects.push(e)},t.prototype.deprecateStuff=function(){return t.deprecatedWarning1||(t.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: onComplete, onStart, onEnd, onEvent art deprecated, please use listeners from now on. 'state.addListener({ complete: function(track, event) { } })'")),!0},t.prototype.drain=function(){if(!this.drainDisabled){this.drainDisabled=!0;for(var t=this.objects,e=this.animState.listeners,r=0;r<t.length;r+=2){var i=t[r],n=t[r+1];switch(i){case ct.start:null!=n.listener&&n.listener.start&&n.listener.start(n);for(var o=0;o<e.length;o++)e[o].start&&e[o].start(n);n.onStart&&this.deprecateStuff()&&n.onStart(n.trackIndex),this.animState.onStart&&this.deprecateStuff()&&this.deprecateStuff&&this.animState.onStart(n.trackIndex);break;case ct.interrupt:null!=n.listener&&n.listener.interrupt&&n.listener.interrupt(n);for(o=0;o<e.length;o++)e[o].interrupt&&e[o].interrupt(n);break;case ct.end:null!=n.listener&&n.listener.end&&n.listener.end(n);for(o=0;o<e.length;o++)e[o].end&&e[o].end(n);n.onEnd&&this.deprecateStuff()&&n.onEnd(n.trackIndex),this.animState.onEnd&&this.deprecateStuff()&&this.animState.onEnd(n.trackIndex);case ct.dispose:null!=n.listener&&n.listener.dispose&&n.listener.dispose(n);for(o=0;o<e.length;o++)e[o].dispose&&e[o].dispose(n);this.animState.trackEntryPool.free(n);break;case ct.complete:null!=n.listener&&n.listener.complete&&n.listener.complete(n);for(o=0;o<e.length;o++)e[o].complete&&e[o].complete(n);var a=B.toInt(n.loopsCount());n.onComplete&&this.deprecateStuff()&&n.onComplete(n.trackIndex,a),this.animState.onComplete&&this.deprecateStuff()&&this.animState.onComplete(n.trackIndex,a);break;case ct.event:var s=t[2+r++];null!=n.listener&&n.listener.event&&n.listener.event(n,s);for(o=0;o<e.length;o++)e[o].event&&e[o].event(n,s);n.onEvent&&this.deprecateStuff()&&n.onEvent(n.trackIndex,s),this.animState.onEvent&&this.deprecateStuff()&&this.animState.onEvent(n.trackIndex,s)}}this.clear(),this.drainDisabled=!1}},t.prototype.clear=function(){this.objects.length=0},t.deprecatedWarning1=!1,t}();!function(t){t[t.start=0]="start",t[t.interrupt=1]="interrupt",t[t.end=2]="end",t[t.dispose=3]="dispose",t[t.complete=4]="complete",t[t.event=5]="event"}(ct||(ct={}));var Ot,Dt=function(){function t(){}return t.prototype.start=function(t){},t.prototype.interrupt=function(t){},t.prototype.end=function(t){},t.prototype.dispose=function(t){},t.prototype.complete=function(t){},t.prototype.event=function(t,e){},t}(),Bt=function(){function t(t){if(this.animationToMixTime={},this.defaultMix=0,null==t)throw new Error("skeletonData cannot be null.");this.skeletonData=t}return t.prototype.setMix=function(t,e,r){var i=this.skeletonData.findAnimation(t);if(null==i)throw new Error("Animation not found: "+t);var n=this.skeletonData.findAnimation(e);if(null==n)throw new Error("Animation not found: "+e);this.setMixWith(i,n,r)},t.prototype.setMixByName=function(e,r,i){t.deprecatedWarning1||(t.deprecatedWarning1=!0,console.warn("Deprecation Warning: AnimationStateData.setMixByName is deprecated, please use setMix from now on.")),this.setMix(e,r,i)},t.prototype.setMixWith=function(t,e,r){if(null==t)throw new Error("from cannot be null.");if(null==e)throw new Error("to cannot be null.");var i=t.name+"."+e.name;this.animationToMixTime[i]=r},t.prototype.getMix=function(t,e){var r=t.name+"."+e.name,i=this.animationToMixTime[r];return void 0===i?this.defaultMix:i},t.deprecatedWarning1=!1,t}(),Nt=function(){function t(t){this.atlas=t}return t.prototype.newRegionAttachment=function(t,e,r){var i=this.atlas.findRegion(r);if(null==i)throw new Error("Region not found in atlas: "+r+" (region attachment: "+e+")");var n=new st(e);return n.region=i,n},t.prototype.newMeshAttachment=function(t,e,r){var i=this.atlas.findRegion(r);if(null==i)throw new Error("Region not found in atlas: "+r+" (mesh attachment: "+e+")");var n=new nt(e);return n.region=i,n},t.prototype.newBoundingBoxAttachment=function(t,e){return new rt(e)},t.prototype.newPathAttachment=function(t,e){return new ot(e)},t.prototype.newPointAttachment=function(t,e){return new at(e)},t.prototype.newClippingAttachment=function(t,e){return new it(e)},t}(),kt=function(){function e(t,e,r){if(this.matrix=new n.Matrix,this.children=new Array,this.x=0,this.y=0,this.rotation=0,this.scaleX=0,this.scaleY=0,this.shearX=0,this.shearY=0,this.ax=0,this.ay=0,this.arotation=0,this.ascaleX=0,this.ascaleY=0,this.ashearX=0,this.ashearY=0,this.appliedValid=!1,this.sorted=!1,this.active=!1,null==t)throw new Error("data cannot be null.");if(null==e)throw new Error("skeleton cannot be null.");this.data=t,this.skeleton=e,this.parent=r,this.setToSetupPose()}return Object.defineProperty(e.prototype,"worldX",{get:function(){return this.matrix.tx},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"worldY",{get:function(){return this.matrix.ty},enumerable:!1,configurable:!0}),e.prototype.isActive=function(){return this.active},e.prototype.update=function(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)},e.prototype.updateWorldTransform=function(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)},e.prototype.updateWorldTransformWith=function(e,r,i,n,o,a,s){this.ax=e,this.ay=r,this.arotation=i,this.ascaleX=n,this.ascaleY=o,this.ashearX=a,this.ashearY=s,this.appliedValid=!0;var h=this.parent,l=this.matrix,u=this.skeleton.scaleX,c=z.yDown?-this.skeleton.scaleY:this.skeleton.scaleY;if(null==h){var p=this.skeleton,d=i+90+s;return l.a=B.cosDeg(i+a)*n*u,l.c=B.cosDeg(d)*o*u,l.b=B.sinDeg(i+a)*n*c,l.d=B.sinDeg(d)*o*c,l.tx=e*u+p.x,void(l.ty=r*c+p.y)}var f=h.matrix.a,m=h.matrix.c,v=h.matrix.b,y=h.matrix.d;switch(l.tx=f*e+m*r+h.matrix.tx,l.ty=v*e+y*r+h.matrix.ty,this.data.transformMode){case t.TransformMode.Normal:d=i+90+s;var g=B.cosDeg(i+a)*n,_=B.cosDeg(d)*o,x=B.sinDeg(i+a)*n,b=B.sinDeg(d)*o;return l.a=f*g+m*x,l.c=f*_+m*b,l.b=v*g+y*x,void(l.d=v*_+y*b);case t.TransformMode.OnlyTranslation:d=i+90+s;l.a=B.cosDeg(i+a)*n,l.c=B.cosDeg(d)*o,l.b=B.sinDeg(i+a)*n,l.d=B.sinDeg(d)*o;break;case t.TransformMode.NoRotationOrReflection:var w=0;(S=f*f+v*v)>1e-4?(S=Math.abs(f*y-m*v)/S,f/=this.skeleton.scaleX,m=(v/=this.skeleton.scaleY)*S,y=f*S,w=Math.atan2(v,f)*B.radDeg):(f=0,v=0,w=90-Math.atan2(y,m)*B.radDeg);var T=i+a-w,E=i+s-w+90;g=B.cosDeg(T)*n,_=B.cosDeg(E)*o,x=B.sinDeg(T)*n,b=B.sinDeg(E)*o;l.a=f*g-m*x,l.c=f*_-m*b,l.b=v*g+y*x,l.d=v*_+y*b;break;case t.TransformMode.NoScale:case t.TransformMode.NoScaleOrReflection:var S,A=B.cosDeg(i),I=B.sinDeg(i),P=(f*A+m*I)/u,M=(v*A+y*I)/c;(S=Math.sqrt(P*P+M*M))>1e-5&&(S=1/S),P*=S,M*=S,S=Math.sqrt(P*P+M*M),this.data.transformMode==t.TransformMode.NoScale&&f*y-m*v<0!=(z.yDown?this.skeleton.scaleX<0!=this.skeleton.scaleY>0:this.skeleton.scaleX<0!=this.skeleton.scaleY<0)&&(S=-S);var C=Math.PI/2+Math.atan2(M,P),R=Math.cos(C)*S,O=Math.sin(C)*S;g=B.cosDeg(a)*n,_=B.cosDeg(90+s)*o,x=B.sinDeg(a)*n,b=B.sinDeg(90+s)*o;l.a=P*g+R*x,l.c=P*_+R*b,l.b=M*g+O*x,l.d=M*_+O*b}l.a*=u,l.c*=u,l.b*=c,l.d*=c},e.prototype.setToSetupPose=function(){var t=this.data;this.x=t.x,this.y=t.y,this.rotation=t.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this.shearX=t.shearX,this.shearY=t.shearY},e.prototype.getWorldRotationX=function(){return Math.atan2(this.matrix.b,this.matrix.a)*B.radDeg},e.prototype.getWorldRotationY=function(){return Math.atan2(this.matrix.d,this.matrix.c)*B.radDeg},e.prototype.getWorldScaleX=function(){var t=this.matrix;return Math.sqrt(t.a*t.a+t.c*t.c)},e.prototype.getWorldScaleY=function(){var t=this.matrix;return Math.sqrt(t.b*t.b+t.d*t.d)},e.prototype.updateAppliedTransform=function(){this.appliedValid=!0;var t=this.parent,e=this.matrix;if(null==t)return this.ax=e.tx,this.ay=e.ty,this.arotation=Math.atan2(e.b,e.a)*B.radDeg,this.ascaleX=Math.sqrt(e.a*e.a+e.b*e.b),this.ascaleY=Math.sqrt(e.c*e.c+e.d*e.d),this.ashearX=0,void(this.ashearY=Math.atan2(e.a*e.c+e.b*e.d,e.a*e.d-e.b*e.c)*B.radDeg);var r=t.matrix,i=1/(r.a*r.d-r.b*r.c),n=e.tx-r.tx,o=e.ty-r.ty;this.ax=n*r.d*i-o*r.c*i,this.ay=o*r.a*i-n*r.b*i;var a=i*r.d,s=i*r.a,h=i*r.c,l=i*r.b,u=a*e.a-h*e.b,c=a*e.c-h*e.d,p=s*e.b-l*e.a,d=s*e.d-l*e.c;if(this.ashearX=0,this.ascaleX=Math.sqrt(u*u+p*p),this.ascaleX>1e-4){var f=u*d-c*p;this.ascaleY=f/this.ascaleX,this.ashearY=Math.atan2(u*c+p*d,f)*B.radDeg,this.arotation=Math.atan2(p,u)*B.radDeg}else this.ascaleX=0,this.ascaleY=Math.sqrt(c*c+d*d),this.ashearY=0,this.arotation=90-Math.atan2(d,c)*B.radDeg},e.prototype.worldToLocal=function(t){var e=this.matrix,r=e.a,i=e.c,n=e.b,o=e.d,a=1/(r*o-i*n),s=t.x-e.tx,h=t.y-e.ty;return t.x=s*o*a-h*i*a,t.y=h*r*a-s*n*a,t},e.prototype.localToWorld=function(t){var e=this.matrix,r=t.x,i=t.y;return t.x=r*e.a+i*e.c+e.tx,t.y=r*e.b+i*e.d+e.ty,t},e.prototype.worldToLocalRotation=function(t){var e=B.sinDeg(t),r=B.cosDeg(t),i=this.matrix;return Math.atan2(i.a*e-i.b*r,i.d*r-i.c*e)*B.radDeg},e.prototype.localToWorldRotation=function(t){var e=B.sinDeg(t),r=B.cosDeg(t),i=this.matrix;return Math.atan2(r*i.b+e*i.d,r*i.a+e*i.c)*B.radDeg},e.prototype.rotateWorld=function(t){var e=this.matrix,r=e.a,i=e.c,n=e.b,o=e.d,a=B.cosDeg(t),s=B.sinDeg(t);e.a=a*r-s*n,e.c=a*i-s*o,e.b=s*r+a*n,e.d=s*i+a*o,this.appliedValid=!1},e}(),Ft=function(e,r,i){if(this.x=0,this.y=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.shearX=0,this.shearY=0,this.transformMode=t.TransformMode.Normal,this.skinRequired=!1,this.color=new D,e<0)throw new Error("index must be >= 0.");if(null==r)throw new Error("name cannot be null.");this.index=e,this.name=r,this.parent=i},Lt=function(t,e,r){this.name=t,this.order=e,this.skinRequired=r},Vt=function(t,e){if(null==e)throw new Error("data cannot be null.");this.time=t,this.data=e},Xt=function(t){this.name=t},jt=function(){function e(t,e){if(this.bendDirection=0,this.compress=!1,this.stretch=!1,this.mix=1,this.softness=0,this.active=!1,null==t)throw new Error("data cannot be null.");if(null==e)throw new Error("skeleton cannot be null.");this.data=t,this.mix=t.mix,this.softness=t.softness,this.bendDirection=t.bendDirection,this.compress=t.compress,this.stretch=t.stretch,this.bones=new Array;for(var r=0;r<t.bones.length;r++)this.bones.push(e.findBone(t.bones[r].name));this.target=e.findBone(t.target.name)}return e.prototype.isActive=function(){return this.active},e.prototype.apply=function(){this.update()},e.prototype.update=function(){var t=this.target,e=this.bones;switch(e.length){case 1:this.apply1(e[0],t.worldX,t.worldY,this.compress,this.stretch,this.data.uniform,this.mix);break;case 2:this.apply2(e[0],e[1],t.worldX,t.worldY,this.bendDirection,this.stretch,this.softness,this.mix)}},e.prototype.apply1=function(e,r,i,n,o,a,s){e.appliedValid||e.updateAppliedTransform();var h=e.parent.matrix,l=h.a,u=h.c,c=h.b,p=h.d,d=-e.ashearX-e.arotation,f=0,m=0;switch(e.data.transformMode){case t.TransformMode.OnlyTranslation:f=r-e.worldX,m=i-e.worldY;break;case t.TransformMode.NoRotationOrReflection:var v=Math.abs(l*p-u*c)/(l*l+c*c),y=l/e.skeleton.scaleX,g=c/e.skeleton.scaleY;u=-g*v*e.skeleton.scaleX,p=y*v*e.skeleton.scaleY,d+=Math.atan2(g,y)*B.radDeg;default:var _=r-h.tx,x=i-h.ty,b=l*p-u*c;f=(_*p-x*u)/b-e.ax,m=(x*l-_*c)/b-e.ay}d+=Math.atan2(m,f)*B.radDeg,e.ascaleX<0&&(d+=180),d>180?d-=360:d<-180&&(d+=360);var w=e.ascaleX,T=e.ascaleY;if(n||o){switch(e.data.transformMode){case t.TransformMode.NoScale:case t.TransformMode.NoScaleOrReflection:f=r-e.worldX,m=i-e.worldY}var E=e.data.length*w,S=Math.sqrt(f*f+m*m);if(n&&S<E||o&&S>E&&E>1e-4)w*=v=(S/E-1)*s+1,a&&(T*=v)}e.updateWorldTransformWith(e.ax,e.ay,e.arotation+d*s,w,T,e.ashearX,e.ashearY)},e.prototype.apply2=function(t,e,r,i,n,o,a,s){if(0!=s){t.appliedValid||t.updateAppliedTransform(),e.appliedValid||e.updateAppliedTransform();var h=t.ax,l=t.ay,u=t.ascaleX,c=u,p=t.ascaleY,d=e.ascaleX,f=t.matrix,m=0,v=0,y=0;u<0?(u=-u,m=180,y=-1):(m=0,y=1),p<0&&(p=-p,y=-y),d<0?(d=-d,v=180):v=0;var g=e.ax,_=0,x=0,b=0,w=f.a,T=f.c,E=f.b,S=f.d,A=Math.abs(u-p)<=1e-4;A?(x=w*g+T*(_=e.ay)+f.tx,b=E*g+S*_+f.ty):(_=0,x=w*g+f.tx,b=E*g+f.ty);var I=t.parent.matrix;w=I.a,T=I.c,E=I.b;var P,M,C=1/(w*(S=I.d)-T*E),R=x-I.tx,O=b-I.ty,D=(R*S-O*T)*C-h,N=(O*w-R*E)*C-l,k=Math.sqrt(D*D+N*N),F=e.data.length*d;if(k<1e-4)return this.apply1(t,r,i,!1,o,!1,s),void e.updateWorldTransformWith(g,_,0,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY);var L=((R=r-I.tx)*S-(O=i-I.ty)*T)*C-h,V=(O*w-R*E)*C-l,X=L*L+V*V;if(0!=a){a*=u*(d+1)/2;var j=Math.sqrt(X),U=j-k-F*u+a;if(U>0){var Y=Math.min(1,U/(2*a))-1;X=(L-=(Y=(U-a*(1-Y*Y))/j)*L)*L+(V-=Y*V)*V}}t:if(A){var z=(X-k*k-(F*=u)*F)/(2*k*F);z<-1?z=-1:z>1&&(z=1,o&&(c*=(Math.sqrt(X)/(k+F)-1)*s+1)),M=Math.acos(z)*n,w=k+F*z,T=F*Math.sin(M),P=Math.atan2(V*w-L*T,L*w+V*T)}else{var W=(w=u*F)*w,q=(T=p*F)*T,G=Math.atan2(V,L),H=-2*q*k,$=q-W;if((S=H*H-4*$*(E=q*k*k+W*X-W*q))>=0){var J=Math.sqrt(S);H<0&&(J=-J);var Z=(J=-(H+J)/2)/$,Q=E/J,K=Math.abs(Z)<Math.abs(Q)?Z:Q;if(K*K<=X){O=Math.sqrt(X-K*K)*n,P=G-Math.atan2(O,K),M=Math.atan2(O/p,(K-k)/u);break t}}var tt=B.PI,et=k-w,rt=et*et,it=0,nt=0,ot=k+w,at=ot*ot,st=0;(E=-w*k/(W-q))>=-1&&E<=1&&(E=Math.acos(E),(S=(R=w*Math.cos(E)+k)*R+(O=T*Math.sin(E))*O)<rt&&(tt=E,rt=S,et=R,it=O),S>at&&(nt=E,at=S,ot=R,st=O)),X<=(rt+at)/2?(P=G-Math.atan2(it*n,et),M=tt*n):(P=G-Math.atan2(st*n,ot),M=nt*n)}var ht=Math.atan2(_,g)*y,lt=t.arotation;(P=(P-ht)*B.radDeg+m-lt)>180?P-=360:P<-180&&(P+=360),t.updateWorldTransformWith(h,l,lt+P*s,c,t.ascaleY,0,0),lt=e.arotation,(M=((M+ht)*B.radDeg-e.ashearX)*y+v-lt)>180?M-=360:M<-180&&(M+=360),e.updateWorldTransformWith(g,_,lt+M*s,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY)}else e.updateWorldTransform()},e}(),Ut=function(t){function e(e){var r=t.call(this,e,0,!1)||this;return r.bones=new Array,r.bendDirection=1,r.compress=!1,r.stretch=!1,r.uniform=!1,r.mix=1,r.softness=0,r}return Q(e,t),e}(Lt),Yt=function(t){function e(e){var r=t.call(this,e,0,!1)||this;return r.bones=new Array,r}return Q(e,t),e}(Lt);!function(t){t[t.Length=0]="Length",t[t.Fixed=1]="Fixed",t[t.Percent=2]="Percent"}(Ot||(Ot={}));var zt=function(){function e(t,e){if(this.position=0,this.spacing=0,this.rotateMix=0,this.translateMix=0,this.spaces=new Array,this.positions=new Array,this.world=new Array,this.curves=new Array,this.lengths=new Array,this.segments=new Array,this.active=!1,null==t)throw new Error("data cannot be null.");if(null==e)throw new Error("skeleton cannot be null.");this.data=t,this.bones=new Array;for(var r=0,i=t.bones.length;r<i;r++)this.bones.push(e.findBone(t.bones[r].name));this.target=e.findSlot(t.target.name),this.position=t.position,this.spacing=t.spacing,this.rotateMix=t.rotateMix,this.translateMix=t.translateMix}return e.prototype.isActive=function(){return this.active},e.prototype.apply=function(){this.update()},e.prototype.update=function(){var r=this.target.getAttachment();if(r instanceof ot){var i=this.rotateMix,n=this.translateMix,o=i>0;if(n>0||o){var a=this.data,s=a.spacingMode,h=s==Ot.Length,l=a.rotateMode,u=l==t.RotateMode.Tangent,c=l==t.RotateMode.ChainScale,p=this.bones.length,d=u?p:p+1,f=this.bones,m=L.setArraySize(this.spaces,d),v=null,y=this.spacing;if(c||h){c&&(v=L.setArraySize(this.lengths,p));for(var g=0,_=d-1;g<_;){var x=(C=f[g]).data.length;if(x<e.epsilon)c&&(v[g]=0),m[++g]=0;else{var b=x*C.matrix.a,w=x*C.matrix.b,T=Math.sqrt(b*b+w*w);c&&(v[g]=T),m[++g]=(h?x+y:y)*T/x}}}else for(g=1;g<d;g++)m[g]=y;var E=this.computeWorldPositions(r,d,u,a.positionMode==t.PositionMode.Percent,s==Ot.Percent),S=E[0],A=E[1],I=a.offsetRotation,P=!1;if(0==I)P=l==t.RotateMode.Chain;else P=!1,I*=(M=this.target.bone.matrix).a*M.d-M.b*M.c>0?B.degRad:-B.degRad;g=0;for(var M=3;g<p;g++,M+=3){var C,R=(C=f[g]).matrix;R.tx+=(S-R.tx)*n,R.ty+=(A-R.ty)*n;var O=(b=E[M])-S,D=(w=E[M+1])-A;if(c){var N=v[g];if(0!=N){var k=(Math.sqrt(O*O+D*D)/N-1)*i+1;R.a*=k,R.b*=k}}if(S=b,A=w,o){var F=R.a,V=R.c,X=R.b,j=R.d,U=0,Y=0,z=0;if(U=u?E[M-1]:0==m[g+1]?E[M+2]:Math.atan2(D,O),U-=Math.atan2(X,F),P){Y=Math.cos(U),z=Math.sin(U);var W=C.data.length;S+=(W*(Y*F-z*X)-O)*i,A+=(W*(z*F+Y*X)-D)*i}else U+=I;U>B.PI?U-=B.PI2:U<-B.PI&&(U+=B.PI2),U*=i,Y=Math.cos(U),z=Math.sin(U),R.a=Y*F-z*X,R.c=Y*V-z*j,R.b=z*F+Y*X,R.d=z*V+Y*j}C.appliedValid=!1}}}},e.prototype.computeWorldPositions=function(t,r,i,n,o){var a=this.target,s=this.position,h=this.spaces,l=L.setArraySize(this.positions,3*r+2),u=null,c=t.closed,p=t.worldVerticesLength,d=p/6,f=e.NONE;if(!t.constantSpeed){var m=t.lengths,v=m[d-=c?1:2];if(n&&(s*=v),o)for(var y=0;y<r;y++)h[y]*=v;u=L.setArraySize(this.world,8);y=0;for(var g=0,_=0;y<r;y++,g+=3){var x=s+=W=h[y];if(c)(x%=v)<0&&(x+=v),_=0;else{if(x<0){f!=e.BEFORE&&(f=e.BEFORE,t.computeWorldVertices(a,2,4,u,0,2)),this.addBeforePosition(x,u,0,l,g);continue}if(x>v){f!=e.AFTER&&(f=e.AFTER,t.computeWorldVertices(a,p-6,4,u,0,2)),this.addAfterPosition(x-v,u,0,l,g);continue}}for(;;_++){var b=m[_];if(!(x>b)){if(0==_)x/=b;else x=(x-($=m[_-1]))/(b-$);break}}_!=f&&(f=_,c&&_==d?(t.computeWorldVertices(a,p-4,4,u,0,2),t.computeWorldVertices(a,0,4,u,4,2)):t.computeWorldVertices(a,6*_+2,8,u,0,2)),this.addCurvePosition(x,u[0],u[1],u[2],u[3],u[4],u[5],u[6],u[7],l,g,i||y>0&&0==W)}return l}c?(p+=2,u=L.setArraySize(this.world,p),t.computeWorldVertices(a,2,p-4,u,0,2),t.computeWorldVertices(a,0,2,u,p-4,2),u[p-2]=u[0],u[p-1]=u[1]):(d--,p-=4,u=L.setArraySize(this.world,p),t.computeWorldVertices(a,2,p,u,0,2));for(var w=L.setArraySize(this.curves,d),T=0,E=u[0],S=u[1],A=0,I=0,P=0,M=0,C=0,R=0,O=0,D=0,B=0,N=0,k=0,F=0,V=0,X=0,j=(y=0,2);y<d;y++,j+=6)A=u[j],I=u[j+1],P=u[j+2],M=u[j+3],k=2*(O=.1875*(E-2*A+P))+(B=.09375*(3*(A-P)-E+(C=u[j+4]))),F=2*(D=.1875*(S-2*I+M))+(N=.09375*(3*(I-M)-S+(R=u[j+5]))),V=.75*(A-E)+O+.16666667*B,X=.75*(I-S)+D+.16666667*N,T+=Math.sqrt(V*V+X*X),V+=k,X+=F,k+=B,F+=N,T+=Math.sqrt(V*V+X*X),V+=k,X+=F,T+=Math.sqrt(V*V+X*X),V+=k+B,X+=F+N,T+=Math.sqrt(V*V+X*X),w[y]=T,E=C,S=R;if(n&&(s*=T),o)for(y=0;y<r;y++)h[y]*=T;for(var U=this.segments,Y=0,z=(y=0,g=0,_=0,0);y<r;y++,g+=3){var W;x=s+=W=h[y];if(c)(x%=T)<0&&(x+=T),_=0;else{if(x<0){this.addBeforePosition(x,u,0,l,g);continue}if(x>T){this.addAfterPosition(x-T,u,p-4,l,g);continue}}for(;;_++){var q=w[_];if(!(x>q)){if(0==_)x/=q;else x=(x-($=w[_-1]))/(q-$);break}}if(_!=f){f=_;var G=6*_;for(E=u[G],S=u[G+1],A=u[G+2],I=u[G+3],P=u[G+4],M=u[G+5],k=2*(O=.03*(E-2*A+P))+(B=.006*(3*(A-P)-E+(C=u[G+6]))),F=2*(D=.03*(S-2*I+M))+(N=.006*(3*(I-M)-S+(R=u[G+7]))),V=.3*(A-E)+O+.16666667*B,X=.3*(I-S)+D+.16666667*N,Y=Math.sqrt(V*V+X*X),U[0]=Y,G=1;G<8;G++)V+=k,X+=F,k+=B,F+=N,Y+=Math.sqrt(V*V+X*X),U[G]=Y;V+=k,X+=F,Y+=Math.sqrt(V*V+X*X),U[8]=Y,V+=k+B,X+=F+N,Y+=Math.sqrt(V*V+X*X),U[9]=Y,z=0}for(x*=Y;;z++){var H=U[z];if(!(x>H)){var $;if(0==z)x/=H;else x=z+(x-($=U[z-1]))/(H-$);break}}this.addCurvePosition(.1*x,E,S,A,I,P,M,C,R,l,g,i||y>0&&0==W)}return l},e.prototype.addBeforePosition=function(t,e,r,i,n){var o=e[r],a=e[r+1],s=e[r+2]-o,h=e[r+3]-a,l=Math.atan2(h,s);i[n]=o+t*Math.cos(l),i[n+1]=a+t*Math.sin(l),i[n+2]=l},e.prototype.addAfterPosition=function(t,e,r,i,n){var o=e[r+2],a=e[r+3],s=o-e[r],h=a-e[r+1],l=Math.atan2(h,s);i[n]=o+t*Math.cos(l),i[n+1]=a+t*Math.sin(l),i[n+2]=l},e.prototype.addCurvePosition=function(t,e,r,i,n,o,a,s,h,l,u,c){(0==t||isNaN(t))&&(t=1e-4);var p=t*t,d=p*t,f=1-t,m=f*f,v=m*f,y=f*t,g=3*y,_=f*g,x=g*t,b=e*v+i*_+o*x+s*d,w=r*v+n*_+a*x+h*d;l[u]=b,l[u+1]=w,c&&(l[u+2]=Math.atan2(w-(r*m+n*y*2+a*p),b-(e*m+i*y*2+o*p)))},e.NONE=-1,e.BEFORE=-2,e.AFTER=-3,e.epsilon=1e-5,e}(),Wt=function(){function t(t,e){if(this.deform=new Array,null==t)throw new Error("data cannot be null.");if(null==e)throw new Error("bone cannot be null.");this.data=t,this.bone=e,this.color=new D,this.darkColor=null==t.darkColor?null:new D,this.setToSetupPose(),this.blendMode=this.data.blendMode}return t.prototype.getAttachment=function(){return this.attachment},t.prototype.setAttachment=function(t){this.attachment!=t&&(this.attachment=t,this.attachmentTime=this.bone.skeleton.time,this.deform.length=0)},t.prototype.setAttachmentTime=function(t){this.attachmentTime=this.bone.skeleton.time-t},t.prototype.getAttachmentTime=function(){return this.bone.skeleton.time-this.attachmentTime},t.prototype.setToSetupPose=function(){this.color.setFromColor(this.data.color),null!=this.darkColor&&this.darkColor.setFromColor(this.data.darkColor),null==this.data.attachmentName?this.attachment=null:(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName)))},t}(),qt=function(){function t(t,e){if(this.rotateMix=0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.temp=new j,this.active=!1,null==t)throw new Error("data cannot be null.");if(null==e)throw new Error("skeleton cannot be null.");this.data=t,this.rotateMix=t.rotateMix,this.translateMix=t.translateMix,this.scaleMix=t.scaleMix,this.shearMix=t.shearMix,this.bones=new Array;for(var r=0;r<t.bones.length;r++)this.bones.push(e.findBone(t.bones[r].name));this.target=e.findBone(t.target.name)}return t.prototype.isActive=function(){return this.active},t.prototype.apply=function(){this.update()},t.prototype.update=function(){this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld()},t.prototype.applyAbsoluteWorld=function(){for(var t=this.rotateMix,e=this.translateMix,r=this.scaleMix,i=this.shearMix,n=this.target,o=n.matrix,a=o.a,s=o.c,h=o.b,l=o.d,u=a*l-s*h>0?B.degRad:-B.degRad,c=this.data.offsetRotation*u,p=this.data.offsetShearY*u,d=this.bones,f=0,m=d.length;f<m;f++){var v=d[f],y=!1,g=v.matrix;if(0!=t){var _=g.a,x=g.c,b=g.b,w=g.d;(P=Math.atan2(h,a)-Math.atan2(b,_)+c)>B.PI?P-=B.PI2:P<-B.PI&&(P+=B.PI2),P*=t;var T=Math.cos(P),E=Math.sin(P);g.a=T*_-E*b,g.c=T*x-E*w,g.b=E*_+T*b,g.d=E*x+T*w,y=!0}if(0!=e){var S=this.temp;n.localToWorld(S.set(this.data.offsetX,this.data.offsetY)),g.tx+=(S.x-g.tx)*e,g.ty+=(S.y-g.ty)*e,y=!0}if(r>0){var A=Math.sqrt(g.a*g.a+g.b*g.b),I=Math.sqrt(a*a+h*h);A>1e-5&&(A=(A+(I-A+this.data.offsetScaleX)*r)/A),g.a*=A,g.b*=A,A=Math.sqrt(g.c*g.c+g.d*g.d),I=Math.sqrt(s*s+l*l),A>1e-5&&(A=(A+(I-A+this.data.offsetScaleY)*r)/A),g.c*=A,g.d*=A,y=!0}if(i>0){x=g.c,w=g.d;var P,M=Math.atan2(w,x);(P=Math.atan2(l,s)-Math.atan2(h,a)-(M-Math.atan2(g.b,g.a)))>B.PI?P-=B.PI2:P<-B.PI&&(P+=B.PI2),P=M+(P+p)*i;A=Math.sqrt(x*x+w*w);g.c=Math.cos(P)*A,g.d=Math.sin(P)*A,y=!0}y&&(v.appliedValid=!1)}},t.prototype.applyRelativeWorld=function(){for(var t=this.rotateMix,e=this.translateMix,r=this.scaleMix,i=this.shearMix,n=this.target,o=n.matrix,a=o.a,s=o.c,h=o.b,l=o.d,u=a*l-s*h>0?B.degRad:-B.degRad,c=this.data.offsetRotation*u,p=this.data.offsetShearY*u,d=this.bones,f=0,m=d.length;f<m;f++){var v=d[f],y=!1,g=v.matrix;if(0!=t){var _=g.a,x=g.c,b=g.b,w=g.d;(I=Math.atan2(h,a)+c)>B.PI?I-=B.PI2:I<-B.PI&&(I+=B.PI2),I*=t;var T=Math.cos(I),E=Math.sin(I);g.a=T*_-E*b,g.c=T*x-E*w,g.b=E*_+T*b,g.d=E*x+T*w,y=!0}if(0!=e){var S=this.temp;n.localToWorld(S.set(this.data.offsetX,this.data.offsetY)),g.tx+=S.x*e,g.ty+=S.y*e,y=!0}if(r>0){var A=(Math.sqrt(a*a+h*h)-1+this.data.offsetScaleX)*r+1;g.a*=A,g.b*=A,A=(Math.sqrt(s*s+l*l)-1+this.data.offsetScaleY)*r+1,g.c*=A,g.d*=A,y=!0}if(i>0){var I;(I=Math.atan2(l,s)-Math.atan2(h,a))>B.PI?I-=B.PI2:I<-B.PI&&(I+=B.PI2);x=g.c,w=g.d;I=Math.atan2(w,x)+(I-B.PI/2+p)*i;A=Math.sqrt(x*x+w*w);g.c=Math.cos(I)*A,g.d=Math.sin(I)*A,y=!0}y&&(v.appliedValid=!1)}},t.prototype.applyAbsoluteLocal=function(){var t=this.rotateMix,e=this.translateMix,r=this.scaleMix,i=this.shearMix,n=this.target;n.appliedValid||n.updateAppliedTransform();for(var o=this.bones,a=0,s=o.length;a<s;a++){var h=o[a];h.appliedValid||h.updateAppliedTransform();var l=h.arotation;if(0!=t){var u=n.arotation-l+this.data.offsetRotation;l+=(u-=360*(16384-(16384.499999999996-u/360|0)))*t}var c=h.ax,p=h.ay;0!=e&&(c+=(n.ax-c+this.data.offsetX)*e,p+=(n.ay-p+this.data.offsetY)*e);var d=h.ascaleX,f=h.ascaleY;r>0&&(d>1e-5&&(d=(d+(n.ascaleX-d+this.data.offsetScaleX)*r)/d),f>1e-5&&(f=(f+(n.ascaleY-f+this.data.offsetScaleY)*r)/f));var m=h.ashearY;if(i>0){u=n.ashearY-m+this.data.offsetShearY;u-=360*(16384-(16384.499999999996-u/360|0)),h.shearY+=u*i}h.updateWorldTransformWith(c,p,l,d,f,h.ashearX,m)}},t.prototype.applyRelativeLocal=function(){var t=this.rotateMix,e=this.translateMix,r=this.scaleMix,i=this.shearMix,n=this.target;n.appliedValid||n.updateAppliedTransform();for(var o=this.bones,a=0,s=o.length;a<s;a++){var h=o[a];h.appliedValid||h.updateAppliedTransform();var l=h.arotation;0!=t&&(l+=(n.arotation+this.data.offsetRotation)*t);var u=h.ax,c=h.ay;0!=e&&(u+=(n.ax+this.data.offsetX)*e,c+=(n.ay+this.data.offsetY)*e);var p=h.ascaleX,d=h.ascaleY;r>0&&(p>1e-5&&(p*=(n.ascaleX-1+this.data.offsetScaleX)*r+1),d>1e-5&&(d*=(n.ascaleY-1+this.data.offsetScaleY)*r+1));var f=h.ashearY;i>0&&(f+=(n.ashearY+this.data.offsetShearY)*i),h.updateWorldTransformWith(u,c,l,p,d,h.ashearX,f)}},t}(),Gt=function(){function t(t){if(this._updateCache=new Array,this.updateCacheReset=new Array,this.time=0,this.scaleX=1,this.scaleY=1,this.x=0,this.y=0,null==t)throw new Error("data cannot be null.");this.data=t,this.bones=new Array;for(var e=0;e<t.bones.length;e++){var r=t.bones[e],i=void 0;if(null==r.parent)i=new kt(r,this,null);else{var n=this.bones[r.parent.index];i=new kt(r,this,n),n.children.push(i)}this.bones.push(i)}this.slots=new Array,this.drawOrder=new Array;for(e=0;e<t.slots.length;e++){var o=t.slots[e],a=(i=this.bones[o.boneData.index],new Wt(o,i));this.slots.push(a),this.drawOrder.push(a)}this.ikConstraints=new Array;for(e=0;e<t.ikConstraints.length;e++){var s=t.ikConstraints[e];this.ikConstraints.push(new jt(s,this))}this.transformConstraints=new Array;for(e=0;e<t.transformConstraints.length;e++){var h=t.transformConstraints[e];this.transformConstraints.push(new qt(h,this))}this.pathConstraints=new Array;for(e=0;e<t.pathConstraints.length;e++){var l=t.pathConstraints[e];this.pathConstraints.push(new zt(l,this))}this.color=new D(1,1,1,1),this.updateCache()}return t.prototype.updateCache=function(){this._updateCache.length=0,this.updateCacheReset.length=0;for(var t=this.bones,e=0,r=t.length;e<r;e++){(n=t[e]).sorted=n.data.skinRequired,n.active=!n.sorted}if(null!=this.skin){var i=this.skin.bones;for(e=0,r=this.skin.bones.length;e<r;e++){var n=this.bones[i[e].index];do{n.sorted=!1,n.active=!0,n=n.parent}while(null!=n)}}var o=this.ikConstraints,a=this.transformConstraints,s=this.pathConstraints,h=o.length,l=a.length,u=s.length,c=h+l+u;t:for(e=0;e<c;e++){for(var p=0;p<h;p++){if((d=o[p]).data.order==e){this.sortIkConstraint(d);continue t}}for(p=0;p<l;p++){if((d=a[p]).data.order==e){this.sortTransformConstraint(d);continue t}}for(p=0;p<u;p++){var d;if((d=s[p]).data.order==e){this.sortPathConstraint(d);continue t}}}for(e=0,r=t.length;e<r;e++)this.sortBone(t[e])},t.prototype.sortIkConstraint=function(t){if(t.active=t.target.isActive()&&(!t.data.skinRequired||null!=this.skin&&L.contains(this.skin.constraints,t.data,!0)),t.active){var e=t.target;this.sortBone(e);var r=t.bones,i=r[0];if(this.sortBone(i),r.length>1){var n=r[r.length-1];this._updateCache.indexOf(n)>-1||this.updateCacheReset.push(n)}this._updateCache.push(t),this.sortReset(i.children),r[r.length-1].sorted=!0}},t.prototype.sortPathConstraint=function(t){if(t.active=t.target.bone.isActive()&&(!t.data.skinRequired||null!=this.skin&&L.contains(this.skin.constraints,t.data,!0)),t.active){var e=t.target,r=e.data.index,i=e.bone;null!=this.skin&&this.sortPathConstraintAttachment(this.skin,r,i),null!=this.data.defaultSkin&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,r,i);for(var n=0,o=this.data.skins.length;n<o;n++)this.sortPathConstraintAttachment(this.data.skins[n],r,i);var a=e.getAttachment();a instanceof ot&&this.sortPathConstraintAttachmentWith(a,i);var s=t.bones,h=s.length;for(n=0;n<h;n++)this.sortBone(s[n]);this._updateCache.push(t);for(n=0;n<h;n++)this.sortReset(s[n].children);for(n=0;n<h;n++)s[n].sorted=!0}},t.prototype.sortTransformConstraint=function(t){if(t.active=t.target.isActive()&&(!t.data.skinRequired||null!=this.skin&&L.contains(this.skin.constraints,t.data,!0)),t.active){this.sortBone(t.target);var e=t.bones,r=e.length;if(t.data.local)for(var i=0;i<r;i++){var n=e[i];this.sortBone(n.parent),this._updateCache.indexOf(n)>-1||this.updateCacheReset.push(n)}else for(i=0;i<r;i++)this.sortBone(e[i]);this._updateCache.push(t);for(var o=0;o<r;o++)this.sortReset(e[o].children);for(o=0;o<r;o++)e[o].sorted=!0}},t.prototype.sortPathConstraintAttachment=function(t,e,r){var i=t.attachments[e];if(i)for(var n in i)this.sortPathConstraintAttachmentWith(i[n],r)},t.prototype.sortPathConstraintAttachmentWith=function(t,e){if(t instanceof ot){var r=t.bones;if(null==r)this.sortBone(e);else for(var i=this.bones,n=0;n<r.length;)for(var o=r[n++],a=n+o;n<a;n++){var s=r[n];this.sortBone(i[s])}}},t.prototype.sortBone=function(t){if(!t.sorted){var e=t.parent;null!=e&&this.sortBone(e),t.sorted=!0,this._updateCache.push(t)}},t.prototype.sortReset=function(t){for(var e=0,r=t.length;e<r;e++){var i=t[e];i.active&&(i.sorted&&this.sortReset(i.children),i.sorted=!1)}},t.prototype.updateWorldTransform=function(){for(var t=this.updateCacheReset,e=0,r=t.length;e<r;e++){var i=t[e];i.ax=i.x,i.ay=i.y,i.arotation=i.rotation,i.ascaleX=i.scaleX,i.ascaleY=i.scaleY,i.ashearX=i.shearX,i.ashearY=i.shearY,i.appliedValid=!0}var n=this._updateCache;for(e=0,r=n.length;e<r;e++)n[e].update()},t.prototype.setToSetupPose=function(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()},t.prototype.setBonesToSetupPose=function(){for(var t=this.bones,e=0,r=t.length;e<r;e++)t[e].setToSetupPose();var i=this.ikConstraints;for(e=0,r=i.length;e<r;e++){(s=i[e]).mix=s.data.mix,s.softness=s.data.softness,s.bendDirection=s.data.bendDirection,s.compress=s.data.compress,s.stretch=s.data.stretch}var n=this.transformConstraints;for(e=0,r=n.length;e<r;e++){var o=(s=n[e]).data;s.rotateMix=o.rotateMix,s.translateMix=o.translateMix,s.scaleMix=o.scaleMix,s.shearMix=o.shearMix}var a=this.pathConstraints;for(e=0,r=a.length;e<r;e++){var s;o=(s=a[e]).data;s.position=o.position,s.spacing=o.spacing,s.rotateMix=o.rotateMix,s.translateMix=o.translateMix}},t.prototype.setSlotsToSetupPose=function(){var t=this.slots;L.arrayCopy(t,0,this.drawOrder,0,t.length);for(var e=0,r=t.length;e<r;e++)t[e].setToSetupPose()},t.prototype.getRootBone=function(){return 0==this.bones.length?null:this.bones[0]},t.prototype.findBone=function(t){if(null==t)throw new Error("boneName cannot be null.");for(var e=this.bones,r=0,i=e.length;r<i;r++){var n=e[r];if(n.data.name==t)return n}return null},t.prototype.findBoneIndex=function(t){if(null==t)throw new Error("boneName cannot be null.");for(var e=this.bones,r=0,i=e.length;r<i;r++)if(e[r].data.name==t)return r;return-1},t.prototype.findSlot=function(t){if(null==t)throw new Error("slotName cannot be null.");for(var e=this.slots,r=0,i=e.length;r<i;r++){var n=e[r];if(n.data.name==t)return n}return null},t.prototype.findSlotIndex=function(t){if(null==t)throw new Error("slotName cannot be null.");for(var e=this.slots,r=0,i=e.length;r<i;r++)if(e[r].data.name==t)return r;return-1},t.prototype.setSkinByName=function(t){var e=this.data.findSkin(t);if(null==e)throw new Error("Skin not found: "+t);this.setSkin(e)},t.prototype.setSkin=function(t){if(t!=this.skin){if(null!=t)if(null!=this.skin)t.attachAll(this,this.skin);else for(var e=this.slots,r=0,i=e.length;r<i;r++){var n=e[r],o=n.data.attachmentName;if(null!=o){var a=t.getAttachment(r,o);null!=a&&n.setAttachment(a)}}this.skin=t,this.updateCache()}},t.prototype.getAttachmentByName=function(t,e){return this.getAttachment(this.data.findSlotIndex(t),e)},t.prototype.getAttachment=function(t,e){if(null==e)throw new Error("attachmentName cannot be null.");if(null!=this.skin){var r=this.skin.getAttachment(t,e);if(null!=r)return r}return null!=this.data.defaultSkin?this.data.defaultSkin.getAttachment(t,e):null},t.prototype.setAttachment=function(t,e){if(null==t)throw new Error("slotName cannot be null.");for(var r=this.slots,i=0,n=r.length;i<n;i++){var o=r[i];if(o.data.name==t){var a=null;if(null!=e&&null==(a=this.getAttachment(i,e)))throw new Error("Attachment not found: "+e+", for slot: "+t);return void o.setAttachment(a)}}throw new Error("Slot not found: "+t)},t.prototype.findIkConstraint=function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.ikConstraints,r=0,i=e.length;r<i;r++){var n=e[r];if(n.data.name==t)return n}return null},t.prototype.findTransformConstraint=function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.transformConstraints,r=0,i=e.length;r<i;r++){var n=e[r];if(n.data.name==t)return n}return null},t.prototype.findPathConstraint=function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.pathConstraints,r=0,i=e.length;r<i;r++){var n=e[r];if(n.data.name==t)return n}return null},t.prototype.getBounds=function(t,e,r){if(void 0===r&&(r=new Array(2)),null==t)throw new Error("offset cannot be null.");if(null==e)throw new Error("size cannot be null.");for(var i=this.drawOrder,n=Number.POSITIVE_INFINITY,o=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY,s=Number.NEGATIVE_INFINITY,h=0,l=i.length;h<l;h++){var u=i[h];if(u.bone.active){var c=0,p=null,d=u.getAttachment();if(d instanceof st)c=8,p=L.setArraySize(r,c,0),d.computeWorldVertices(u.bone,p,0,2);else if(d instanceof nt){var f=d;c=f.worldVerticesLength,p=L.setArraySize(r,c,0),f.computeWorldVertices(u,0,c,p,0,2)}if(null!=p)for(var m=0,v=p.length;m<v;m+=2){var y=p[m],g=p[m+1];n=Math.min(n,y),o=Math.min(o,g),a=Math.max(a,y),s=Math.max(s,g)}}}t.set(n,o),e.set(a-n,s-o)},t.prototype.update=function(t){this.time+=t},Object.defineProperty(t.prototype,"flipX",{get:function(){return-1==this.scaleX},set:function(e){t.deprecatedWarning1||(t.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleX=e?1:-1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"flipY",{get:function(){return-1==this.scaleY},set:function(e){t.deprecatedWarning1||(t.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleY=e?1:-1},enumerable:!1,configurable:!0}),t.deprecatedWarning1=!1,t}(),Ht=function(){function t(){this.bones=new Array,this.slots=new Array,this.skins=new Array,this.events=new Array,this.animations=new Array,this.ikConstraints=new Array,this.transformConstraints=new Array,this.pathConstraints=new Array,this.fps=0}return t.prototype.findBone=function(t){if(null==t)throw new Error("boneName cannot be null.");for(var e=this.bones,r=0,i=e.length;r<i;r++){var n=e[r];if(n.name==t)return n}return null},t.prototype.findBoneIndex=function(t){if(null==t)throw new Error("boneName cannot be null.");for(var e=this.bones,r=0,i=e.length;r<i;r++)if(e[r].name==t)return r;return-1},t.prototype.findSlot=function(t){if(null==t)throw new Error("slotName cannot be null.");for(var e=this.slots,r=0,i=e.length;r<i;r++){var n=e[r];if(n.name==t)return n}return null},t.prototype.findSlotIndex=function(t){if(null==t)throw new Error("slotName cannot be null.");for(var e=this.slots,r=0,i=e.length;r<i;r++)if(e[r].name==t)return r;return-1},t.prototype.findSkin=function(t){if(null==t)throw new Error("skinName cannot be null.");for(var e=this.skins,r=0,i=e.length;r<i;r++){var n=e[r];if(n.name==t)return n}return null},t.prototype.findEvent=function(t){if(null==t)throw new Error("eventDataName cannot be null.");for(var e=this.events,r=0,i=e.length;r<i;r++){var n=e[r];if(n.name==t)return n}return null},t.prototype.findAnimation=function(t){if(null==t)throw new Error("animationName cannot be null.");for(var e=this.animations,r=0,i=e.length;r<i;r++){var n=e[r];if(n.name==t)return n}return null},t.prototype.findIkConstraint=function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.ikConstraints,r=0,i=e.length;r<i;r++){var n=e[r];if(n.name==t)return n}return null},t.prototype.findTransformConstraint=function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.transformConstraints,r=0,i=e.length;r<i;r++){var n=e[r];if(n.name==t)return n}return null},t.prototype.findPathConstraint=function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.pathConstraints,r=0,i=e.length;r<i;r++){var n=e[r];if(n.name==t)return n}return null},t.prototype.findPathConstraintIndex=function(t){if(null==t)throw new Error("pathConstraintName cannot be null.");for(var e=this.pathConstraints,r=0,i=e.length;r<i;r++)if(e[r].name==t)return r;return-1},t}(),$t=function(t,e,r){if(this.color=new D(1,1,1,1),t<0)throw new Error("index must be >= 0.");if(null==e)throw new Error("name cannot be null.");if(null==r)throw new Error("boneData cannot be null.");this.index=t,this.name=e,this.boneData=r},Jt=function(t){function e(e){var r=t.call(this,e,0,!1)||this;return r.bones=new Array,r.rotateMix=0,r.translateMix=0,r.scaleMix=0,r.shearMix=0,r.offsetRotation=0,r.offsetX=0,r.offsetY=0,r.offsetScaleX=0,r.offsetScaleY=0,r.offsetShearY=0,r.relative=!1,r.local=!1,r}return Q(e,t),e}(Lt),Zt=function(t,e,r){this.slotIndex=t,this.name=e,this.attachment=r},Qt=function(){function t(t){if(this.attachments=new Array,this.bones=Array(),this.constraints=new Array,null==t)throw new Error("name cannot be null.");this.name=t}return t.prototype.setAttachment=function(t,e,r){if(null==r)throw new Error("attachment cannot be null.");var i=this.attachments;t>=i.length&&(i.length=t+1),i[t]||(i[t]={}),i[t][e]=r},t.prototype.addSkin=function(t){for(var e=0;e<t.bones.length;e++){for(var r=t.bones[e],i=!1,n=0;n<this.bones.length;n++)if(this.bones[n]==r){i=!0;break}i||this.bones.push(r)}for(e=0;e<t.constraints.length;e++){var o=t.constraints[e];for(i=!1,n=0;n<this.constraints.length;n++)if(this.constraints[n]==o){i=!0;break}i||this.constraints.push(o)}var a=t.getAttachments();for(e=0;e<a.length;e++){var s=a[e];this.setAttachment(s.slotIndex,s.name,s.attachment)}},t.prototype.copySkin=function(t){for(var e=0;e<t.bones.length;e++){for(var r=t.bones[e],i=!1,n=0;n<this.bones.length;n++)if(this.bones[n]==r){i=!0;break}i||this.bones.push(r)}for(e=0;e<t.constraints.length;e++){var o=t.constraints[e];for(i=!1,n=0;n<this.constraints.length;n++)if(this.constraints[n]==o){i=!0;break}i||this.constraints.push(o)}var a=t.getAttachments();for(e=0;e<a.length;e++){var s=a[e];null!=s.attachment&&(s.attachment instanceof nt?(s.attachment=s.attachment.newLinkedMesh(),this.setAttachment(s.slotIndex,s.name,s.attachment)):(s.attachment=s.attachment.copy(),this.setAttachment(s.slotIndex,s.name,s.attachment)))}},t.prototype.getAttachment=function(t,e){var r=this.attachments[t];return r?r[e]:null},t.prototype.removeAttachment=function(t,e){var r=this.attachments[t];r&&(r[e]=null)},t.prototype.getAttachments=function(){for(var t=new Array,e=0;e<this.attachments.length;e++){var r=this.attachments[e];if(r)for(var i in r){var n=r[i];n&&t.push(new Zt(e,i,n))}}return t},t.prototype.getAttachmentsForSlot=function(t,e){var r=this.attachments[t];if(r)for(var i in r){var n=r[i];n&&e.push(new Zt(t,i,n))}},t.prototype.clear=function(){this.attachments.length=0,this.bones.length=0,this.constraints.length=0},t.prototype.attachAll=function(t,e){for(var r=0,i=0;i<t.slots.length;i++){var n=t.slots[i],o=n.getAttachment();if(o&&r<e.attachments.length){var a=e.attachments[r];for(var s in a){if(o==a[s]){var h=this.getAttachment(r,s);null!=h&&n.setAttachment(h);break}}}r++}},t}(),Kt=function(){function e(t){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=t}return e.prototype.readSkeletonData=function(r){var i=this.scale,n=new Ht;n.name="";var o=new v(r);if(n.hash=o.readString(),n.version=o.readString(),"3.8.75"===n.version){console.error("Unsupported skeleton data, 3.8.75 is deprecated, please export with a newer version of Spine.")}n.x=o.readFloat(),n.y=o.readFloat(),n.width=o.readFloat(),n.height=o.readFloat();var a=o.readBoolean();a&&(n.fps=o.readFloat(),n.imagesPath=o.readString(),n.audioPath=o.readString());var s=0;s=o.readInt(!0);for(var h=0;h<s;h++)o.strings.push(o.readString());s=o.readInt(!0);for(h=0;h<s;h++){var l=o.readString(),u=0==h?null:n.bones[o.readInt(!0)];(d=new Ft(h,l,u)).rotation=o.readFloat(),d.x=o.readFloat()*i,d.y=o.readFloat()*i,d.scaleX=o.readFloat(),d.scaleY=o.readFloat(),d.shearX=o.readFloat(),d.shearY=o.readFloat(),d.length=o.readFloat()*i,d.transformMode=e.TransformModeValues[o.readInt(!0)],d.skinRequired=o.readBoolean(),a&&D.rgba8888ToColor(d.color,o.readInt32()),n.bones.push(d)}s=o.readInt(!0);for(h=0;h<s;h++){var c=o.readString(),p=n.bones[o.readInt(!0)],d=new $t(h,c,p);D.rgba8888ToColor(d.color,o.readInt32());var f=o.readInt32();-1!=f&&D.rgb888ToColor(d.darkColor=new D,f),d.attachmentName=o.readStringRef(),d.blendMode=e.BlendModeValues[o.readInt(!0)],n.slots.push(d)}s=o.readInt(!0);h=0;for(var m=void 0;h<s;h++){(d=new Ut(o.readString())).order=o.readInt(!0),d.skinRequired=o.readBoolean(),m=o.readInt(!0);for(var y=0;y<m;y++)d.bones.push(n.bones[o.readInt(!0)]);d.target=n.bones[o.readInt(!0)],d.mix=o.readFloat(),d.softness=o.readFloat()*i,d.bendDirection=o.readByte(),d.compress=o.readBoolean(),d.stretch=o.readBoolean(),d.uniform=o.readBoolean(),n.ikConstraints.push(d)}s=o.readInt(!0);for(h=0,m=void 0;h<s;h++){(d=new Jt(o.readString())).order=o.readInt(!0),d.skinRequired=o.readBoolean(),m=o.readInt(!0);for(y=0;y<m;y++)d.bones.push(n.bones[o.readInt(!0)]);d.target=n.bones[o.readInt(!0)],d.local=o.readBoolean(),d.relative=o.readBoolean(),d.offsetRotation=o.readFloat(),d.offsetX=o.readFloat()*i,d.offsetY=o.readFloat()*i,d.offsetScaleX=o.readFloat(),d.offsetScaleY=o.readFloat(),d.offsetShearY=o.readFloat(),d.rotateMix=o.readFloat(),d.translateMix=o.readFloat(),d.scaleMix=o.readFloat(),d.shearMix=o.readFloat(),n.transformConstraints.push(d)}s=o.readInt(!0);for(h=0,m=void 0;h<s;h++){(d=new Yt(o.readString())).order=o.readInt(!0),d.skinRequired=o.readBoolean(),m=o.readInt(!0);for(y=0;y<m;y++)d.bones.push(n.bones[o.readInt(!0)]);d.target=n.slots[o.readInt(!0)],d.positionMode=e.PositionModeValues[o.readInt(!0)],d.spacingMode=e.SpacingModeValues[o.readInt(!0)],d.rotateMode=e.RotateModeValues[o.readInt(!0)],d.offsetRotation=o.readFloat(),d.position=o.readFloat(),d.positionMode==t.PositionMode.Fixed&&(d.position*=i),d.spacing=o.readFloat(),d.spacingMode!=Ot.Length&&d.spacingMode!=Ot.Fixed||(d.spacing*=i),d.rotateMix=o.readFloat(),d.translateMix=o.readFloat(),n.pathConstraints.push(d)}var g=this.readSkin(o,n,!0,a);null!=g&&(n.defaultSkin=g,n.skins.push(g));h=n.skins.length;for(L.setArraySize(n.skins,s=h+o.readInt(!0));h<s;h++)n.skins[h]=this.readSkin(o,n,!1,a);s=this.linkedMeshes.length;for(h=0;h<s;h++){var _=this.linkedMeshes[h],x=null==_.skin?n.defaultSkin:n.findSkin(_.skin);if(null==x)throw new Error("Skin not found: "+_.skin);var b=x.getAttachment(_.slotIndex,_.parent);if(null==b)throw new Error("Parent mesh not found: "+_.parent);_.mesh.deformAttachment=_.inheritDeform?b:_.mesh,_.mesh.setParentMesh(b)}this.linkedMeshes.length=0,s=o.readInt(!0);for(h=0;h<s;h++){(d=new Xt(o.readStringRef())).intValue=o.readInt(!1),d.floatValue=o.readFloat(),d.stringValue=o.readString(),d.audioPath=o.readString(),null!=d.audioPath&&(d.volume=o.readFloat(),d.balance=o.readFloat()),n.events.push(d)}s=o.readInt(!0);for(h=0;h<s;h++)n.animations.push(this.readAnimation(o,o.readString(),n));return n},e.prototype.readSkin=function(t,e,r,i){var n=null,o=0;if(r){if(0==(o=t.readInt(!0)))return null;n=new Qt("default")}else{(n=new Qt(t.readStringRef())).bones.length=t.readInt(!0);for(var a=0,s=n.bones.length;a<s;a++)n.bones[a]=e.bones[t.readInt(!0)];for(a=0,s=t.readInt(!0);a<s;a++)n.constraints.push(e.ikConstraints[t.readInt(!0)]);for(a=0,s=t.readInt(!0);a<s;a++)n.constraints.push(e.transformConstraints[t.readInt(!0)]);for(a=0,s=t.readInt(!0);a<s;a++)n.constraints.push(e.pathConstraints[t.readInt(!0)]);o=t.readInt(!0)}for(a=0;a<o;a++)for(var h=t.readInt(!0),l=0,u=t.readInt(!0);l<u;l++){var c=t.readStringRef(),p=this.readAttachment(t,e,n,h,c,i);null!=p&&n.setAttachment(h,c,p)}return n},e.prototype.readAttachment=function(r,i,n,o,a,s){var h=this.scale,l=r.readStringRef();null==l&&(l=a);var u=r.readByte();switch(e.AttachmentTypeValues[u]){case t.AttachmentType.Region:var c=r.readStringRef(),p=r.readFloat(),d=r.readFloat(),f=r.readFloat(),m=r.readFloat(),v=r.readFloat(),y=r.readFloat(),g=r.readFloat(),_=r.readInt32();null==c&&(c=l);var x=this.attachmentLoader.newRegionAttachment(n,l,c);return null==x?null:(x.path=c,x.x=d*h,x.y=f*h,x.scaleX=m,x.scaleY=v,x.rotation=p,x.width=y*h,x.height=g*h,D.rgba8888ToColor(x.color,_),x);case t.AttachmentType.BoundingBox:var b=r.readInt(!0),w=this.readVertices(r,b),T=(_=s?r.readInt32():0,this.attachmentLoader.newBoundingBoxAttachment(n,l));return null==T?null:(T.worldVerticesLength=b<<1,T.vertices=w.vertices,T.bones=w.bones,s&&D.rgba8888ToColor(T.color,_),T);case t.AttachmentType.Mesh:c=r.readStringRef(),_=r.readInt32(),b=r.readInt(!0);var E=this.readFloatArray(r,b<<1,1),S=this.readShortArray(r),A=(w=this.readVertices(r,b),r.readInt(!0)),I=null;y=0,g=0;return s&&(I=this.readShortArray(r),y=r.readFloat(),g=r.readFloat()),null==c&&(c=l),null==(P=this.attachmentLoader.newMeshAttachment(n,l,c))?null:(P.path=c,D.rgba8888ToColor(P.color,_),P.bones=w.bones,P.vertices=w.vertices,P.worldVerticesLength=b<<1,P.triangles=S,P.regionUVs=new Float32Array(E),P.hullLength=A<<1,s&&(P.edges=I,P.width=y*h,P.height=g*h),P);case t.AttachmentType.LinkedMesh:c=r.readStringRef(),_=r.readInt32();var P,M=r.readStringRef(),C=r.readStringRef(),R=r.readBoolean();y=0,g=0;return s&&(y=r.readFloat(),g=r.readFloat()),null==c&&(c=l),null==(P=this.attachmentLoader.newMeshAttachment(n,l,c))?null:(P.path=c,D.rgba8888ToColor(P.color,_),s&&(P.width=y*h,P.height=g*h),this.linkedMeshes.push(new te(P,M,o,C,R)),P);case t.AttachmentType.Path:for(var O=r.readBoolean(),B=r.readBoolean(),N=(b=r.readInt(!0),w=this.readVertices(r,b),L.newArray(b/3,0)),k=0,F=N.length;k<F;k++)N[k]=r.readFloat()*h;_=s?r.readInt32():0;return null==(c=this.attachmentLoader.newPathAttachment(n,l))?null:(c.closed=O,c.constantSpeed=B,c.worldVerticesLength=b<<1,c.vertices=w.vertices,c.bones=w.bones,c.lengths=N,s&&D.rgba8888ToColor(c.color,_),c);case t.AttachmentType.Point:p=r.readFloat(),d=r.readFloat(),f=r.readFloat(),_=s?r.readInt32():0;var V=this.attachmentLoader.newPointAttachment(n,l);return null==V?null:(V.x=d*h,V.y=f*h,V.rotation=p,s&&D.rgba8888ToColor(V.color,_),V);case t.AttachmentType.Clipping:var X=r.readInt(!0),j=(b=r.readInt(!0),w=this.readVertices(r,b),_=s?r.readInt32():0,this.attachmentLoader.newClippingAttachment(n,l));return null==j?null:(j.endSlot=i.slots[X],j.worldVerticesLength=b<<1,j.vertices=w.vertices,j.bones=w.bones,s&&D.rgba8888ToColor(j.color,_),j)}return null},e.prototype.readVertices=function(t,e){var r=e<<1,i=new ee,n=this.scale;if(!t.readBoolean())return i.vertices=this.readFloatArray(t,r,n),i;for(var o=new Array,a=new Array,s=0;s<e;s++){var h=t.readInt(!0);a.push(h);for(var l=0;l<h;l++)a.push(t.readInt(!0)),o.push(t.readFloat()*n),o.push(t.readFloat()*n),o.push(t.readFloat())}return i.vertices=L.toFloatArray(o),i.bones=a,i},e.prototype.readFloatArray=function(t,e,r){var i=new Array(e);if(1==r)for(var n=0;n<e;n++)i[n]=t.readFloat();else for(n=0;n<e;n++)i[n]=t.readFloat()*r;return i},e.prototype.readShortArray=function(t){for(var e=t.readInt(!0),r=new Array(e),i=0;i<e;i++)r[i]=t.readShort();return r},e.prototype.readAnimation=function(r,i,n){for(var o=new Array,a=this.scale,s=0,h=new D,l=new D,u=0,c=r.readInt(!0);u<c;u++)for(var p=r.readInt(!0),d=0,f=r.readInt(!0);d<f;d++){var m=r.readByte(),v=r.readInt(!0);switch(m){case e.SLOT_ATTACHMENT:(x=new _t(v)).slotIndex=p;for(var y=0;y<v;y++)x.setFrame(y,r.readFloat(),r.readStringRef());o.push(x),s=Math.max(s,x.frames[v-1]);break;case e.SLOT_COLOR:(x=new yt(v)).slotIndex=p;for(y=0;y<v;y++){var g=r.readFloat();D.rgba8888ToColor(h,r.readInt32()),x.setFrame(y,g,h.r,h.g,h.b,h.a),y<v-1&&this.readCurve(r,y,x)}o.push(x),s=Math.max(s,x.frames[(v-1)*yt.ENTRIES]);break;case e.SLOT_TWO_COLOR:(x=new gt(v)).slotIndex=p;for(y=0;y<v;y++){g=r.readFloat();D.rgba8888ToColor(h,r.readInt32()),D.rgb888ToColor(l,r.readInt32()),x.setFrame(y,g,h.r,h.g,h.b,h.a,l.r,l.g,l.b),y<v-1&&this.readCurve(r,y,x)}o.push(x),s=Math.max(s,x.frames[(v-1)*gt.ENTRIES])}}for(u=0,c=r.readInt(!0);u<c;u++){var _=r.readInt(!0);for(d=0,f=r.readInt(!0);d<f;d++){m=r.readByte(),v=r.readInt(!0);switch(m){case e.BONE_ROTATE:(x=new dt(v)).boneIndex=_;for(y=0;y<v;y++)x.setFrame(y,r.readFloat(),r.readFloat()),y<v-1&&this.readCurve(r,y,x);o.push(x),s=Math.max(s,x.frames[(v-1)*dt.ENTRIES]);break;case e.BONE_TRANSLATE:case e.BONE_SCALE:case e.BONE_SHEAR:var x=void 0,b=1;m==e.BONE_SCALE?x=new mt(v):m==e.BONE_SHEAR?x=new vt(v):(x=new ft(v),b=a),x.boneIndex=_;for(y=0;y<v;y++)x.setFrame(y,r.readFloat(),r.readFloat()*b,r.readFloat()*b),y<v-1&&this.readCurve(r,y,x);o.push(x),s=Math.max(s,x.frames[(v-1)*ft.ENTRIES])}}}for(u=0,c=r.readInt(!0);u<c;u++){var w=r.readInt(!0);v=r.readInt(!0);(x=new Et(v)).ikConstraintIndex=w;for(y=0;y<v;y++)x.setFrame(y,r.readFloat(),r.readFloat(),r.readFloat()*a,r.readByte(),r.readBoolean(),r.readBoolean()),y<v-1&&this.readCurve(r,y,x);o.push(x),s=Math.max(s,x.frames[(v-1)*Et.ENTRIES])}for(u=0,c=r.readInt(!0);u<c;u++){w=r.readInt(!0),v=r.readInt(!0);(x=new St(v)).transformConstraintIndex=w;for(y=0;y<v;y++)x.setFrame(y,r.readFloat(),r.readFloat(),r.readFloat(),r.readFloat(),r.readFloat()),y<v-1&&this.readCurve(r,y,x);o.push(x),s=Math.max(s,x.frames[(v-1)*St.ENTRIES])}for(u=0,c=r.readInt(!0);u<c;u++){w=r.readInt(!0);var T=n.pathConstraints[w];for(d=0,f=r.readInt(!0);d<f;d++){m=r.readByte(),v=r.readInt(!0);switch(m){case e.PATH_POSITION:case e.PATH_SPACING:x=void 0,b=1;m==e.PATH_SPACING?(x=new It(v),T.spacingMode!=Ot.Length&&T.spacingMode!=Ot.Fixed||(b=a)):(x=new At(v),T.positionMode==t.PositionMode.Fixed&&(b=a)),x.pathConstraintIndex=w;for(y=0;y<v;y++)x.setFrame(y,r.readFloat(),r.readFloat()*b),y<v-1&&this.readCurve(r,y,x);o.push(x),s=Math.max(s,x.frames[(v-1)*At.ENTRIES]);break;case e.PATH_MIX:(x=new Pt(v)).pathConstraintIndex=w;for(y=0;y<v;y++)x.setFrame(y,r.readFloat(),r.readFloat(),r.readFloat()),y<v-1&&this.readCurve(r,y,x);o.push(x),s=Math.max(s,x.frames[(v-1)*Pt.ENTRIES])}}}for(u=0,c=r.readInt(!0);u<c;u++){var E=n.skins[r.readInt(!0)];for(d=0,f=r.readInt(!0);d<f;d++){p=r.readInt(!0);for(var S=0,A=r.readInt(!0);S<A;S++){var I=E.getAttachment(p,r.readStringRef()),P=null!=I.bones,M=I.vertices,C=P?M.length/3*2:M.length;v=r.readInt(!0);(x=new bt(v)).slotIndex=p,x.attachment=I;for(y=0;y<v;y++){g=r.readFloat();var R=void 0,O=r.readInt(!0);if(0==O)R=P?L.newFloatArray(C):M;else{R=L.newFloatArray(C);var B=r.readInt(!0);if(O+=B,1==a)for(var N=B;N<O;N++)R[N]=r.readFloat();else for(N=B;N<O;N++)R[N]=r.readFloat()*a;if(!P){N=0;for(var k=R.length;N<k;N++)R[N]+=M[N]}}x.setFrame(y,g,R),y<v-1&&this.readCurve(r,y,x)}o.push(x),s=Math.max(s,x.frames[v-1])}}}var F=r.readInt(!0);if(F>0){x=new Tt(F);var V=n.slots.length;for(u=0;u<F;u++){g=r.readFloat();var X=r.readInt(!0),j=L.newArray(V,0);for(d=V-1;d>=0;d--)j[d]=-1;var U=L.newArray(V-X,0),Y=0,z=0;for(d=0;d<X;d++){for(p=r.readInt(!0);Y!=p;)U[z++]=Y++;j[Y+r.readInt(!0)]=Y++}for(;Y<V;)U[z++]=Y++;for(d=V-1;d>=0;d--)-1==j[d]&&(j[d]=U[--z]);x.setFrame(u,g,j)}o.push(x),s=Math.max(s,x.frames[F-1])}var W=r.readInt(!0);if(W>0){for(x=new wt(W),u=0;u<W;u++){g=r.readFloat();var q=n.events[r.readInt(!0)],G=new Vt(g,q);G.intValue=r.readInt(!1),G.floatValue=r.readFloat(),G.stringValue=r.readBoolean()?r.readString():q.stringValue,null!=G.data.audioPath&&(G.volume=r.readFloat(),G.balance=r.readFloat()),x.setFrame(u,G)}o.push(x),s=Math.max(s,x.frames[W-1])}return new ut(i,o,s)},e.prototype.readCurve=function(t,r,i){switch(t.readByte()){case e.CURVE_STEPPED:i.setStepped(r);break;case e.CURVE_BEZIER:this.setCurve(i,r,t.readFloat(),t.readFloat(),t.readFloat(),t.readFloat())}},e.prototype.setCurve=function(t,e,r,i,n,o){t.setCurve(e,r,i,n,o)},e.AttachmentTypeValues=[0,1,2,3,4,5,6],e.TransformModeValues=[t.TransformMode.Normal,t.TransformMode.OnlyTranslation,t.TransformMode.NoRotationOrReflection,t.TransformMode.NoScale,t.TransformMode.NoScaleOrReflection],e.PositionModeValues=[t.PositionMode.Fixed,t.PositionMode.Percent],e.SpacingModeValues=[Ot.Length,Ot.Fixed,Ot.Percent],e.RotateModeValues=[t.RotateMode.Tangent,t.RotateMode.Chain,t.RotateMode.ChainScale],e.BlendModeValues=[i.BLEND_MODES.NORMAL,i.BLEND_MODES.ADD,i.BLEND_MODES.MULTIPLY,i.BLEND_MODES.SCREEN],e.BONE_ROTATE=0,e.BONE_TRANSLATE=1,e.BONE_SCALE=2,e.BONE_SHEAR=3,e.SLOT_ATTACHMENT=0,e.SLOT_COLOR=1,e.SLOT_TWO_COLOR=2,e.PATH_POSITION=0,e.PATH_SPACING=1,e.PATH_MIX=2,e.CURVE_LINEAR=0,e.CURVE_STEPPED=1,e.CURVE_BEZIER=2,e}(),te=function(t,e,r,i,n){this.mesh=t,this.skin=e,this.slotIndex=r,this.parent=i,this.inheritDeform=n},ee=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),this.bones=t,this.vertices=e},re=function(){function t(){this.minX=0,this.minY=0,this.maxX=0,this.maxY=0,this.boundingBoxes=new Array,this.polygons=new Array,this.polygonPool=new X((function(){return L.newFloatArray(16)}))}return t.prototype.update=function(t,e){if(null==t)throw new Error("skeleton cannot be null.");var r=this.boundingBoxes,i=this.polygons,n=this.polygonPool,o=t.slots,a=o.length;r.length=0,n.freeAll(i),i.length=0;for(var s=0;s<a;s++){var h=o[s];if(h.bone.active){var l=h.getAttachment();if(l instanceof rt){var u=l;r.push(u);var c=n.obtain();c.length!=u.worldVerticesLength&&(c=L.newFloatArray(u.worldVerticesLength)),i.push(c),u.computeWorldVertices(h,0,u.worldVerticesLength,c,0,2)}}}e?this.aabbCompute():(this.minX=Number.POSITIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY)},t.prototype.aabbCompute=function(){for(var t=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY,i=Number.NEGATIVE_INFINITY,n=this.polygons,o=0,a=n.length;o<a;o++)for(var s=n[o],h=s,l=0,u=s.length;l<u;l+=2){var c=h[l],p=h[l+1];t=Math.min(t,c),e=Math.min(e,p),r=Math.max(r,c),i=Math.max(i,p)}this.minX=t,this.minY=e,this.maxX=r,this.maxY=i},t.prototype.aabbContainsPoint=function(t,e){return t>=this.minX&&t<=this.maxX&&e>=this.minY&&e<=this.maxY},t.prototype.aabbIntersectsSegment=function(t,e,r,i){var n=this.minX,o=this.minY,a=this.maxX,s=this.maxY;if(t<=n&&r<=n||e<=o&&i<=o||t>=a&&r>=a||e>=s&&i>=s)return!1;var h=(i-e)/(r-t),l=h*(n-t)+e;if(l>o&&l<s)return!0;if((l=h*(a-t)+e)>o&&l<s)return!0;var u=(o-e)/h+t;return u>n&&u<a||(u=(s-e)/h+t)>n&&u<a},t.prototype.aabbIntersectsSkeleton=function(t){return this.minX<t.maxX&&this.maxX>t.minX&&this.minY<t.maxY&&this.maxY>t.minY},t.prototype.containsPoint=function(t,e){for(var r=this.polygons,i=0,n=r.length;i<n;i++)if(this.containsPointPolygon(r[i],t,e))return this.boundingBoxes[i];return null},t.prototype.containsPointPolygon=function(t,e,r){for(var i=t,n=t.length,o=n-2,a=!1,s=0;s<n;s+=2){var h=i[s+1],l=i[o+1];if(h<r&&l>=r||l<r&&h>=r){var u=i[s];u+(r-h)/(l-h)*(i[o]-u)<e&&(a=!a)}o=s}return a},t.prototype.intersectsSegment=function(t,e,r,i){for(var n=this.polygons,o=0,a=n.length;o<a;o++)if(this.intersectsSegmentPolygon(n[o],t,e,r,i))return this.boundingBoxes[o];return null},t.prototype.intersectsSegmentPolygon=function(t,e,r,i,n){for(var o=t,a=t.length,s=e-i,h=r-n,l=e*n-r*i,u=o[a-2],c=o[a-1],p=0;p<a;p+=2){var d=o[p],f=o[p+1],m=u*f-c*d,v=u-d,y=c-f,g=s*y-h*v,_=(l*v-s*m)/g;if((_>=u&&_<=d||_>=d&&_<=u)&&(_>=e&&_<=i||_>=i&&_<=e)){var x=(l*y-h*m)/g;if((x>=c&&x<=f||x>=f&&x<=c)&&(x>=r&&x<=n||x>=n&&x<=r))return!0}u=d,c=f}return!1},t.prototype.getPolygon=function(t){if(null==t)throw new Error("boundingBox cannot be null.");var e=this.boundingBoxes.indexOf(t);return-1==e?null:this.polygons[e]},t.prototype.getWidth=function(){return this.maxX-this.minX},t.prototype.getHeight=function(){return this.maxY-this.minY},t}(),ie=function(){function e(t){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=t}return e.prototype.readSkeletonData=function(r){var i=this.scale,n=new Ht,o="string"==typeof r?JSON.parse(r):r,a=o.skeleton;if(null!=a){if(n.hash=a.hash,n.version=a.spine,"3.8"!==n.version.substr(0,3)){var s="Spine 3.8 loader cant load version "+a.spine+". Please configure your pixi-spine bundle";console.error(s)}if("3.8.75"===n.version){s="Unsupported skeleton data, 3.8.75 is deprecated, please export with a newer version of Spine.";console.error(s)}n.x=a.x,n.y=a.y,n.width=a.width,n.height=a.height,n.fps=a.fps,n.imagesPath=a.images}if(o.bones)for(var h=0;h<o.bones.length;h++){var l=o.bones[h],u=null,c=this.getValue(l,"parent",null);if(null!=c&&null==(u=n.findBone(c)))throw new Error("Parent bone not found: "+c);(m=new Ft(n.bones.length,l.name,u)).length=this.getValue(l,"length",0)*i,m.x=this.getValue(l,"x",0)*i,m.y=this.getValue(l,"y",0)*i,m.rotation=this.getValue(l,"rotation",0),m.scaleX=this.getValue(l,"scaleX",1),m.scaleY=this.getValue(l,"scaleY",1),m.shearX=this.getValue(l,"shearX",0),m.shearY=this.getValue(l,"shearY",0),m.transformMode=e.transformModeFromString(this.getValue(l,"transform","normal")),m.skinRequired=this.getValue(l,"skin",!1),n.bones.push(m)}if(o.slots)for(h=0;h<o.slots.length;h++){var p=(I=o.slots[h]).name,d=I.bone,f=n.findBone(d);if(null==f)throw new Error("Slot bone not found: "+d);var m=new $t(n.slots.length,p,f),v=this.getValue(I,"color",null);null!=v&&m.color.setFromString(v);var y=this.getValue(I,"dark",null);null!=y&&(m.darkColor=new D(1,1,1,1),m.darkColor.setFromString(y)),m.attachmentName=this.getValue(I,"attachment",null),m.blendMode=e.blendModeFromString(this.getValue(I,"blend","normal")),n.slots.push(m)}if(o.ik)for(h=0;h<o.ik.length;h++){var g=o.ik[h];(m=new Ut(g.name)).order=this.getValue(g,"order",0),m.skinRequired=this.getValue(g,"skin",!1);for(var _=0;_<g.bones.length;_++){d=g.bones[_];if(null==(E=n.findBone(d)))throw new Error("IK bone not found: "+d);m.bones.push(E)}var x=g.target;if(m.target=n.findBone(x),null==m.target)throw new Error("IK target bone not found: "+x);m.mix=this.getValue(g,"mix",1),m.softness=this.getValue(g,"softness",0)*i,m.bendDirection=this.getValue(g,"bendPositive",!0)?1:-1,m.compress=this.getValue(g,"compress",!1),m.stretch=this.getValue(g,"stretch",!1),m.uniform=this.getValue(g,"uniform",!1),n.ikConstraints.push(m)}if(o.transform)for(h=0;h<o.transform.length;h++){g=o.transform[h];(m=new Jt(g.name)).order=this.getValue(g,"order",0),m.skinRequired=this.getValue(g,"skin",!1);for(_=0;_<g.bones.length;_++){d=g.bones[_];if(null==(E=n.findBone(d)))throw new Error("Transform constraint bone not found: "+d);m.bones.push(E)}x=g.target;if(m.target=n.findBone(x),null==m.target)throw new Error("Transform constraint target bone not found: "+x);m.local=this.getValue(g,"local",!1),m.relative=this.getValue(g,"relative",!1),m.offsetRotation=this.getValue(g,"rotation",0),m.offsetX=this.getValue(g,"x",0)*i,m.offsetY=this.getValue(g,"y",0)*i,m.offsetScaleX=this.getValue(g,"scaleX",0),m.offsetScaleY=this.getValue(g,"scaleY",0),m.offsetShearY=this.getValue(g,"shearY",0),m.rotateMix=this.getValue(g,"rotateMix",1),m.translateMix=this.getValue(g,"translateMix",1),m.scaleMix=this.getValue(g,"scaleMix",1),m.shearMix=this.getValue(g,"shearMix",1),n.transformConstraints.push(m)}if(o.path)for(h=0;h<o.path.length;h++){g=o.path[h];(m=new Yt(g.name)).order=this.getValue(g,"order",0),m.skinRequired=this.getValue(g,"skin",!1);for(_=0;_<g.bones.length;_++){d=g.bones[_];if(null==(E=n.findBone(d)))throw new Error("Transform constraint bone not found: "+d);m.bones.push(E)}x=g.target;if(m.target=n.findSlot(x),null==m.target)throw new Error("Path target slot not found: "+x);m.positionMode=e.positionModeFromString(this.getValue(g,"positionMode","percent")),m.spacingMode=e.spacingModeFromString(this.getValue(g,"spacingMode","length")),m.rotateMode=e.rotateModeFromString(this.getValue(g,"rotateMode","tangent")),m.offsetRotation=this.getValue(g,"rotation",0),m.position=this.getValue(g,"position",0),m.positionMode==t.PositionMode.Fixed&&(m.position*=i),m.spacing=this.getValue(g,"spacing",0),m.spacingMode!=Ot.Length&&m.spacingMode!=Ot.Fixed||(m.spacing*=i),m.rotateMix=this.getValue(g,"rotateMix",1),m.translateMix=this.getValue(g,"translateMix",1),n.pathConstraints.push(m)}if(o.skins)for(h=0;h<o.skins.length;h++){var b=o.skins[h],w=new Qt(b.name);if(b.bones)for(var T=0;T<b.bones.length;T++){var E;if(null==(E=n.findBone(b.bones[T])))throw new Error("Skin bone not found: "+b.bones[h]);w.bones.push(E)}if(b.ik)for(T=0;T<b.ik.length;T++){if(null==(S=n.findIkConstraint(b.ik[T])))throw new Error("Skin IK constraint not found: "+b.ik[h]);w.constraints.push(S)}if(b.transform)for(T=0;T<b.transform.length;T++){if(null==(S=n.findTransformConstraint(b.transform[T])))throw new Error("Skin transform constraint not found: "+b.transform[h]);w.constraints.push(S)}if(b.path)for(T=0;T<b.path.length;T++){var S;if(null==(S=n.findPathConstraint(b.path[T])))throw new Error("Skin path constraint not found: "+b.path[h]);w.constraints.push(S)}for(var p in b.attachments){var A=n.findSlot(p);if(null==A)throw new Error("Slot not found: "+p);var I=b.attachments[p];for(var P in I){var M=this.readAttachment(I[P],w,A.index,P,n);null!=M&&w.setAttachment(A.index,P,M)}}n.skins.push(w),"default"==w.name&&(n.defaultSkin=w)}h=0;for(var C=this.linkedMeshes.length;h<C;h++){var R=this.linkedMeshes[h];if(null==(w=null==R.skin?n.defaultSkin:n.findSkin(R.skin)))throw new Error("Skin not found: "+R.skin);var O=w.getAttachment(R.slotIndex,R.parent);if(null==O)throw new Error("Parent mesh not found: "+R.parent);R.mesh.deformAttachment=R.inheritDeform?O:R.mesh,R.mesh.setParentMesh(O)}if(this.linkedMeshes.length=0,o.events)for(var B in o.events){var N=o.events[B];(m=new Xt(B)).intValue=this.getValue(N,"int",0),m.floatValue=this.getValue(N,"float",0),m.stringValue=this.getValue(N,"string",""),m.audioPath=this.getValue(N,"audio",null),null!=m.audioPath&&(m.volume=this.getValue(N,"volume",1),m.balance=this.getValue(N,"balance",0)),n.events.push(m)}if(o.animations)for(var k in o.animations){var F=o.animations[k];this.readAnimation(F,k,n)}return n},e.prototype.readAttachment=function(t,e,r,i,n){var o=this.scale;switch(i=this.getValue(t,"name",i),this.getValue(t,"type","region")){case"region":var a=this.getValue(t,"path",i),s=this.attachmentLoader.newRegionAttachment(e,i,a);return null==s?null:(s.path=a,s.x=this.getValue(t,"x",0)*o,s.y=this.getValue(t,"y",0)*o,s.scaleX=this.getValue(t,"scaleX",1),s.scaleY=this.getValue(t,"scaleY",1),s.rotation=this.getValue(t,"rotation",0),s.width=t.width*o,s.height=t.height*o,null!=(_=this.getValue(t,"color",null))&&s.color.setFromString(_),s);case"boundingbox":var h=this.attachmentLoader.newBoundingBoxAttachment(e,i);return null==h?null:(this.readVertices(t,h,t.vertexCount<<1),null!=(_=this.getValue(t,"color",null))&&h.color.setFromString(_),h);case"mesh":case"linkedmesh":a=this.getValue(t,"path",i);var l=this.attachmentLoader.newMeshAttachment(e,i,a);if(null==l)return null;l.path=a,null!=(_=this.getValue(t,"color",null))&&l.color.setFromString(_),l.width=this.getValue(t,"width",0)*o,l.height=this.getValue(t,"height",0)*o;var u=this.getValue(t,"parent",null);if(null!=u)return this.linkedMeshes.push(new ne(l,this.getValue(t,"skin",null),r,u,this.getValue(t,"deform",!0))),l;var c=t.uvs;return this.readVertices(t,l,c.length),l.triangles=t.triangles,l.regionUVs=new Float32Array(c),l.edges=this.getValue(t,"edges",null),l.hullLength=2*this.getValue(t,"hull",0),l;case"path":if(null==(a=this.attachmentLoader.newPathAttachment(e,i)))return null;a.closed=this.getValue(t,"closed",!1),a.constantSpeed=this.getValue(t,"constantSpeed",!0);var p=t.vertexCount;this.readVertices(t,a,p<<1);for(var d=L.newArray(p/3,0),f=0;f<t.lengths.length;f++)d[f]=t.lengths[f]*o;return a.lengths=d,null!=(_=this.getValue(t,"color",null))&&a.color.setFromString(_),a;case"point":var m=this.attachmentLoader.newPointAttachment(e,i);return null==m?null:(m.x=this.getValue(t,"x",0)*o,m.y=this.getValue(t,"y",0)*o,m.rotation=this.getValue(t,"rotation",0),null!=(_=this.getValue(t,"color",null))&&m.color.setFromString(_),m);case"clipping":var v=this.attachmentLoader.newClippingAttachment(e,i);if(null==v)return null;var y=this.getValue(t,"end",null);if(null!=y){var g=n.findSlot(y);if(null==g)throw new Error("Clipping end slot not found: "+y);v.endSlot=g}var _;p=t.vertexCount;return this.readVertices(t,v,p<<1),null!=(_=this.getValue(t,"color",null))&&v.color.setFromString(_),v}return null},e.prototype.readVertices=function(t,e,r){var i=this.scale;e.worldVerticesLength=r;var n=t.vertices;if(r!=n.length){var o=new Array,a=new Array;for(u=0,c=n.length;u<c;){var s=n[u++];a.push(s);for(var h=u+4*s;u<h;u+=4)a.push(n[u]),o.push(n[u+1]*i),o.push(n[u+2]*i),o.push(n[u+3])}e.bones=a,e.vertices=L.toFloatArray(o)}else{var l=L.toFloatArray(n);if(1!=i)for(var u=0,c=n.length;u<c;u++)l[u]*=i;e.vertices=l}},e.prototype.readAnimation=function(e,r,i){var n=this.scale,o=new Array,a=0;if(e.slots)for(var s in e.slots){var h=e.slots[s];if(-1==(K=i.findSlotIndex(s)))throw new Error("Slot not found: "+s);for(var l in h){var u=h[l];if("attachment"==l){(x=new _t(u.length)).slotIndex=K;for(var c=0,p=0;p<u.length;p++){var d=u[p];x.setFrame(c++,this.getValue(d,"time",0),d.name)}o.push(x),a=Math.max(a,x.frames[x.getFrameCount()-1])}else if("color"==l){(x=new yt(u.length)).slotIndex=K;for(c=0,p=0;p<u.length;p++){d=u[p];var f=new D;f.setFromString(d.color||"ffffffff"),x.setFrame(c,this.getValue(d,"time",0),f.r,f.g,f.b,f.a),this.readCurve(d,x,c),c++}o.push(x),a=Math.max(a,x.frames[(x.getFrameCount()-1)*yt.ENTRIES])}else{if("twoColor"!=l)throw new Error("Invalid timeline type for a slot: "+l+" ("+s+")");(x=new gt(u.length)).slotIndex=K;for(c=0,p=0;p<u.length;p++){d=u[p];var m=new D,v=new D;m.setFromString(d.light),v.setFromString(d.dark),x.setFrame(c,this.getValue(d,"time",0),m.r,m.g,m.b,m.a,v.r,v.g,v.b),this.readCurve(d,x,c),c++}o.push(x),a=Math.max(a,x.frames[(x.getFrameCount()-1)*gt.ENTRIES])}}}if(e.bones)for(var y in e.bones){var g=e.bones[y],_=i.findBoneIndex(y);if(-1==_)throw new Error("Bone not found: "+y);for(var l in g){u=g[l];if("rotate"===l){(x=new dt(u.length)).boneIndex=_;for(c=0,p=0;p<u.length;p++){d=u[p];x.setFrame(c,this.getValue(d,"time",0),this.getValue(d,"angle",0)),this.readCurve(d,x,c),c++}o.push(x),a=Math.max(a,x.frames[(x.getFrameCount()-1)*dt.ENTRIES])}else{if("translate"!==l&&"scale"!==l&&"shear"!==l)throw new Error("Invalid timeline type for a bone: "+l+" ("+y+")");var x=null,b=1,w=0;"scale"===l?(x=new mt(u.length),w=1):"shear"===l?x=new vt(u.length):(x=new ft(u.length),b=n),x.boneIndex=_;for(c=0,p=0;p<u.length;p++){d=u[p];var T=this.getValue(d,"x",w),E=this.getValue(d,"y",w);x.setFrame(c,this.getValue(d,"time",0),T*b,E*b),this.readCurve(d,x,c),c++}o.push(x),a=Math.max(a,x.frames[(x.getFrameCount()-1)*ft.ENTRIES])}}}if(e.ik)for(var S in e.ik){var A=e.ik[S],I=i.findIkConstraint(S);(x=new Et(A.length)).ikConstraintIndex=i.ikConstraints.indexOf(I);for(c=0,p=0;p<A.length;p++){d=A[p];x.setFrame(c,this.getValue(d,"time",0),this.getValue(d,"mix",1),this.getValue(d,"softness",0)*n,this.getValue(d,"bendPositive",!0)?1:-1,this.getValue(d,"compress",!1),this.getValue(d,"stretch",!1)),this.readCurve(d,x,c),c++}o.push(x),a=Math.max(a,x.frames[(x.getFrameCount()-1)*Et.ENTRIES])}if(e.transform)for(var S in e.transform){A=e.transform[S],I=i.findTransformConstraint(S);(x=new St(A.length)).transformConstraintIndex=i.transformConstraints.indexOf(I);for(c=0,p=0;p<A.length;p++){d=A[p];x.setFrame(c,this.getValue(d,"time",0),this.getValue(d,"rotateMix",1),this.getValue(d,"translateMix",1),this.getValue(d,"scaleMix",1),this.getValue(d,"shearMix",1)),this.readCurve(d,x,c),c++}o.push(x),a=Math.max(a,x.frames[(x.getFrameCount()-1)*St.ENTRIES])}if(e.path)for(var S in e.path){A=e.path[S];var P=i.findPathConstraintIndex(S);if(-1==P)throw new Error("Path constraint not found: "+S);var M=i.pathConstraints[P];for(var l in A){u=A[l];if("position"===l||"spacing"===l){x=null,b=1;"spacing"===l?(x=new It(u.length),M.spacingMode!=Ot.Length&&M.spacingMode!=Ot.Fixed||(b=n)):(x=new At(u.length),M.positionMode==t.PositionMode.Fixed&&(b=n)),x.pathConstraintIndex=P;for(c=0,p=0;p<u.length;p++){d=u[p];x.setFrame(c,this.getValue(d,"time",0),this.getValue(d,l,0)*b),this.readCurve(d,x,c),c++}o.push(x),a=Math.max(a,x.frames[(x.getFrameCount()-1)*At.ENTRIES])}else if("mix"===l){(x=new Pt(u.length)).pathConstraintIndex=P;for(c=0,p=0;p<u.length;p++){d=u[p];x.setFrame(c,this.getValue(d,"time",0),this.getValue(d,"rotateMix",1),this.getValue(d,"translateMix",1)),this.readCurve(d,x,c),c++}o.push(x),a=Math.max(a,x.frames[(x.getFrameCount()-1)*Pt.ENTRIES])}}}if(e.deform)for(var C in e.deform){var R=e.deform[C],O=i.findSkin(C);if(null!=O)for(var s in R){h=R[s];if(-1==(K=i.findSlotIndex(s)))throw new Error("Slot not found: "+h.name);for(var l in h){u=h[l];var B=O.getAttachment(K,l);if(null==B)throw new Error("Deform attachment not found: "+u.name);var N=null!=B.bones,k=B.vertices,F=N?k.length/3*2:k.length;(x=new bt(u.length)).slotIndex=K,x.attachment=B;c=0;for(var V=0;V<u.length;V++){d=u[V];var X=void 0,j=this.getValue(d,"vertices",null);if(null==j)X=N?L.newFloatArray(F):k;else{X=L.newFloatArray(F);var U=this.getValue(d,"offset",0);if(L.arrayCopy(j,0,X,U,j.length),1!=n)for(var Y=(p=U)+j.length;p<Y;p++)X[p]*=n;if(!N)for(p=0;p<F;p++)X[p]+=k[p]}x.setFrame(c,this.getValue(d,"time",0),X),this.readCurve(d,x,c),c++}o.push(x),a=Math.max(a,x.frames[x.getFrameCount()-1])}}else if(z.FAIL_ON_NON_EXISTING_SKIN)throw new Error("Skin not found: "+C)}var W=e.drawOrder;if(null==W&&(W=e.draworder),null!=W){x=new Tt(W.length);var q=i.slots.length;for(c=0,V=0;V<W.length;V++){var G=W[V],H=null,$=this.getValue(G,"offsets",null);if(null!=$){H=L.newArray(q,-1);var J=L.newArray(q-$.length,0),Z=0,Q=0;for(p=0;p<$.length;p++){var K,tt=$[p];if(-1==(K=i.findSlotIndex(tt.slot)))throw new Error("Slot not found: "+tt.slot);for(;Z!=K;)J[Q++]=Z++;H[Z+tt.offset]=Z++}for(;Z<q;)J[Q++]=Z++;for(p=q-1;p>=0;p--)-1==H[p]&&(H[p]=J[--Q])}x.setFrame(c++,this.getValue(G,"time",0),H)}o.push(x),a=Math.max(a,x.frames[x.getFrameCount()-1])}if(e.events){for(x=new wt(e.events.length),c=0,p=0;p<e.events.length;p++){var et=e.events[p],rt=i.findEvent(et.name);if(null==rt)throw new Error("Event not found: "+et.name);var it=new Vt(L.toSinglePrecision(this.getValue(et,"time",0)),rt);it.intValue=this.getValue(et,"int",rt.intValue),it.floatValue=this.getValue(et,"float",rt.floatValue),it.stringValue=this.getValue(et,"string",rt.stringValue),null!=it.data.audioPath&&(it.volume=this.getValue(et,"volume",1),it.balance=this.getValue(et,"balance",0)),x.setFrame(c++,it)}o.push(x),a=Math.max(a,x.frames[x.getFrameCount()-1])}if(isNaN(a))throw new Error("Error while parsing animation, duration is NaN");i.animations.push(new ut(r,o,a))},e.prototype.readCurve=function(t,e,r){if(t.hasOwnProperty("curve"))if("stepped"===t.curve)e.setStepped(r);else{var i=t.curve;e.setCurve(r,i,this.getValue(t,"c2",0),this.getValue(t,"c3",1),this.getValue(t,"c4",1))}},e.prototype.getValue=function(t,e,r){return void 0!==t[e]?t[e]:r},e.blendModeFromString=function(t){if("normal"==(t=t.toLowerCase()))return i.BLEND_MODES.NORMAL;if("additive"==t)return i.BLEND_MODES.ADD;if("multiply"==t)return i.BLEND_MODES.MULTIPLY;if("screen"==t)return i.BLEND_MODES.SCREEN;throw new Error("Unknown blend mode: "+t)},e.positionModeFromString=function(e){if("fixed"==(e=e.toLowerCase()))return t.PositionMode.Fixed;if("percent"==e)return t.PositionMode.Percent;throw new Error("Unknown position mode: "+e)},e.spacingModeFromString=function(t){if("length"==(t=t.toLowerCase()))return Ot.Length;if("fixed"==t)return Ot.Fixed;if("percent"==t)return Ot.Percent;throw new Error("Unknown position mode: "+t)},e.rotateModeFromString=function(e){if("tangent"==(e=e.toLowerCase()))return t.RotateMode.Tangent;if("chain"==e)return t.RotateMode.Chain;if("chainscale"==e)return t.RotateMode.ChainScale;throw new Error("Unknown rotate mode: "+e)},e.transformModeFromString=function(e){if("normal"==(e=e.toLowerCase()))return t.TransformMode.Normal;if("onlytranslation"==e)return t.TransformMode.OnlyTranslation;if("norotationorreflection"==e)return t.TransformMode.NoRotationOrReflection;if("noscale"==e)return t.TransformMode.NoScale;if("noscaleorreflection"==e)return t.TransformMode.NoScaleOrReflection;throw new Error("Unknown transform mode: "+e)},e}(),ne=function(t,e,r,i,n){this.mesh=t,this.skin=e,this.slotIndex=r,this.parent=i,this.inheritDeform=n},oe=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Q(e,t),e.prototype.createSkeleton=function(t){this.skeleton=new Gt(t),this.skeleton.updateWorldTransform(),this.stateData=new Bt(t),this.state=new Mt(this.stateData)},e}(H),ae=Object.freeze({__proto__:null,Animation:ut,AnimationState:Mt,AnimationStateAdapter:Dt,AnimationStateData:Bt,AtlasAttachmentLoader:Nt,Attachment:tt,AttachmentTimeline:_t,Bone:kt,BoneData:Ft,BoundingBoxAttachment:rt,ClippingAttachment:it,ColorTimeline:yt,ConstraintData:Lt,CurveTimeline:pt,DeformTimeline:bt,DrawOrderTimeline:Tt,Event:Vt,EventData:Xt,EventQueue:Rt,EventTimeline:wt,get EventType(){return ct},IkConstraint:jt,IkConstraintData:Ut,IkConstraintTimeline:Et,JitterEffect:ht,MeshAttachment:nt,PathAttachment:ot,PathConstraint:zt,PathConstraintData:Yt,PathConstraintMixTimeline:Pt,PathConstraintPositionTimeline:At,PathConstraintSpacingTimeline:It,PointAttachment:at,RegionAttachment:st,RotateTimeline:dt,ScaleTimeline:mt,ShearTimeline:vt,Skeleton:Gt,SkeletonBinary:Kt,SkeletonBounds:re,SkeletonData:Ht,SkeletonJson:ie,Skin:Qt,SkinEntry:Zt,Slot:Wt,SlotData:$t,get SpacingMode(){return Ot},Spine:oe,SwirlEffect:lt,get TimelineType(){return K},TrackEntry:Ct,TransformConstraint:qt,TransformConstraintData:Jt,TransformConstraintTimeline:St,TranslateTimeline:ft,TwoColorTimeline:gt,VertexAttachment:et}),se=function(t,e){return(se=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)};function he(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}se(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var le,ue=function(t){if(null==t)throw new Error("name cannot be null.");this.name=t},ce=function(t){function e(r){var i=t.call(this,r)||this;return i.id=(65535&e.nextID++)<<11,i.worldVerticesLength=0,i}return he(e,t),e.prototype.computeWorldVerticesOld=function(t,e){this.computeWorldVertices(t,0,this.worldVerticesLength,e,0,2)},e.prototype.computeWorldVertices=function(t,e,r,i,n,o){r=n+(r>>1)*o;var a=t.bone.skeleton,s=t.attachmentVertices,h=this.vertices,l=this.bones;if(null!=l){for(var u=0,c=0,p=0;p<e;p+=2){u+=(v=l[u])+1,c+=v}var d=a.bones;if(0==s.length)for(P=n,E=3*c;P<r;P+=o){var f=0,m=0,v=l[u++];for(v+=u;u<v;u++,E+=3){x=d[l[u]].matrix,M=h[E],C=h[E+1];var y=h[E+2];f+=(M*x.a+C*x.c+x.tx)*y,m+=(M*x.b+C*x.d+x.ty)*y}i[P]=f,i[P+1]=m}else for(var g=s,_=(P=n,E=3*c,c<<1);P<r;P+=o){f=0,m=0,v=l[u++];for(v+=u;u<v;u++,E+=3,_+=2){x=d[l[u]].matrix,M=h[E]+g[_],C=h[E+1]+g[_+1],y=h[E+2];f+=(M*x.a+C*x.c+x.tx)*y,m+=(M*x.b+C*x.d+x.ty)*y}i[P]=f,i[P+1]=m}}else{s.length>0&&(h=s);for(var x,b=(x=t.bone.matrix).tx,w=x.ty,T=x.a,E=x.c,S=x.b,A=x.d,I=e,P=n;P<r;I+=2,P+=o){var M=h[I],C=h[I+1];i[P]=M*T+C*E+b,i[P+1]=M*S+C*A+w}}},e.prototype.applyDeform=function(t){return this==t},e.nextID=0,e}(ue),pe=function(e){function r(r){var i=e.call(this,r)||this;return i.type=t.AttachmentType.BoundingBox,i.color=new D(1,1,1,1),i}return he(r,e),r}(ce),de=function(e){function r(r){var i=e.call(this,r)||this;return i.type=t.AttachmentType.Clipping,i.color=new D(.2275,.2275,.8078,1),i}return he(r,e),r}(ce),fe=function(e){function r(r){var i=e.call(this,r)||this;return i.type=t.AttachmentType.Mesh,i.color=new D(1,1,1,1),i.inheritDeform=!1,i.tempColor=new D(0,0,0,0),i}return he(r,e),r.prototype.applyDeform=function(t){return this==t||this.inheritDeform&&this.parentMesh==t},r.prototype.getParentMesh=function(){return this.parentMesh},r.prototype.setParentMesh=function(t){this.parentMesh=t,null!=t&&(this.bones=t.bones,this.vertices=t.vertices,this.worldVerticesLength=t.worldVerticesLength,this.regionUVs=t.regionUVs,this.triangles=t.triangles,this.hullLength=t.hullLength,this.worldVerticesLength=t.worldVerticesLength)},r}(ce),me=function(e){function r(r){var i=e.call(this,r)||this;return i.type=t.AttachmentType.Path,i.closed=!1,i.constantSpeed=!1,i.color=new D(1,1,1,1),i}return he(r,e),r}(ce),ve=function(e){function r(r){var i=e.call(this,r)||this;return i.type=t.AttachmentType.Point,i.color=new D(.38,.94,0,1),i}return he(r,e),r.prototype.computeWorldPosition=function(t,e){var r=t.matrix;return e.x=this.x*r.a+this.y*r.c+t.worldX,e.y=this.x*r.b+this.y*r.d+t.worldY,e},r.prototype.computeWorldRotation=function(t){var e=t.matrix,r=B.cosDeg(this.rotation),i=B.sinDeg(this.rotation),n=r*e.a+i*e.c,o=r*e.b+i*e.d;return Math.atan2(o,n)*B.radDeg},r}(ce),ye=function(e){function r(r){var i=e.call(this,r)||this;return i.type=t.AttachmentType.Region,i.x=0,i.y=0,i.scaleX=1,i.scaleY=1,i.rotation=0,i.width=0,i.height=0,i.color=new D(1,1,1,1),i.offset=L.newFloatArray(8),i.uvs=L.newFloatArray(8),i.tempColor=new D(1,1,1,1),i}return he(r,e),r.prototype.updateOffset=function(){var t=this.width/this.region.originalWidth*this.scaleX,e=this.height/this.region.originalHeight*this.scaleY,i=-this.width/2*this.scaleX+this.region.offsetX*t,n=-this.height/2*this.scaleY+this.region.offsetY*e,o=i+this.region.width*t,a=n+this.region.height*e,s=this.rotation*Math.PI/180,h=Math.cos(s),l=Math.sin(s),u=i*h+this.x,c=i*l,p=n*h+this.y,d=n*l,f=o*h+this.x,m=o*l,v=a*h+this.y,y=a*l,g=this.offset;g[r.OX1]=u-d,g[r.OY1]=p+c,g[r.OX2]=u-y,g[r.OY2]=v+c,g[r.OX3]=f-y,g[r.OY3]=v+m,g[r.OX4]=f-d,g[r.OY4]=p+m},r.prototype.setRegion=function(t){this.region=t;var e=this.uvs;t.rotate?(e[2]=t.u,e[3]=t.v2,e[4]=t.u,e[5]=t.v,e[6]=t.u2,e[7]=t.v,e[0]=t.u2,e[1]=t.v2):(e[0]=t.u,e[1]=t.v2,e[2]=t.u,e[3]=t.v,e[4]=t.u2,e[5]=t.v,e[6]=t.u2,e[7]=t.v2)},r.prototype.computeWorldVertices=function(t,e,i,n){var o=this.offset,a=t.matrix,s=a.tx,h=a.ty,l=a.a,u=a.c,c=a.b,p=a.d,d=0,f=0;d=o[r.OX1],f=o[r.OY1],e[i]=d*l+f*u+s,e[i+1]=d*c+f*p+h,i+=n,d=o[r.OX2],f=o[r.OY2],e[i]=d*l+f*u+s,e[i+1]=d*c+f*p+h,i+=n,d=o[r.OX3],f=o[r.OY3],e[i]=d*l+f*u+s,e[i+1]=d*c+f*p+h,i+=n,d=o[r.OX4],f=o[r.OY4],e[i]=d*l+f*u+s,e[i+1]=d*c+f*p+h},r.OX1=0,r.OY1=1,r.OX2=2,r.OY2=3,r.OX3=4,r.OY3=5,r.OX4=6,r.OY4=7,r.X1=0,r.Y1=1,r.C1R=2,r.C1G=3,r.C1B=4,r.C1A=5,r.U1=6,r.V1=7,r.X2=8,r.Y2=9,r.C2R=10,r.C2G=11,r.C2B=12,r.C2A=13,r.U2=14,r.V2=15,r.X3=16,r.Y3=17,r.C3R=18,r.C3G=19,r.C3B=20,r.C3A=21,r.U3=22,r.V3=23,r.X4=24,r.Y4=25,r.C4R=26,r.C4G=27,r.C4B=28,r.C4A=29,r.U4=30,r.V4=31,r}(ue),ge=function(){function t(t,e){this.jitterX=0,this.jitterY=0,this.jitterX=t,this.jitterY=e}return t.prototype.begin=function(t){},t.prototype.transform=function(t,e,r,i){t.x+=B.randomTriangular(-this.jitterX,this.jitterY),t.y+=B.randomTriangular(-this.jitterX,this.jitterY)},t.prototype.end=function(){},t}(),_e=function(){function t(t){this.centerX=0,this.centerY=0,this.radius=0,this.angle=0,this.worldX=0,this.worldY=0,this.radius=t}return t.prototype.begin=function(t){this.worldX=t.x+this.centerX,this.worldY=t.y+this.centerY},t.prototype.transform=function(e,r,i,n){var o=this.angle*B.degreesToRadians,a=e.x-this.worldX,s=e.y-this.worldY,h=Math.sqrt(a*a+s*s);if(h<this.radius){var l=t.interpolation.apply(0,o,(this.radius-h)/this.radius),u=Math.cos(l),c=Math.sin(l);e.x=u*a-c*s+this.worldX,e.y=c*a+u*s+this.worldY}},t.prototype.end=function(){},t.interpolation=new F(2),t}(),xe=function(){function t(t,e,r){if(null==t)throw new Error("name cannot be null.");if(null==e)throw new Error("timelines cannot be null.");this.name=t,this.timelines=e,this.duration=r}return t.prototype.apply=function(t,e,r,i,n,o,a,s){if(null==t)throw new Error("skeleton cannot be null.");i&&0!=this.duration&&(r%=this.duration,e>0&&(e%=this.duration));for(var h=this.timelines,l=0,u=h.length;l<u;l++)h[l].apply(t,e,r,n,o,a,s)},t.binarySearch=function(t,e,r){void 0===r&&(r=1);var i=0,n=t.length/r-2;if(0==n)return r;for(var o=n>>>1;;){if(t[(o+1)*r]<=e?i=o+1:n=o,i==n)return(i+1)*r;o=i+n>>>1}},t.linearSearch=function(t,e,r){for(var i=0,n=t.length-r;i<=n;i+=r)if(t[i]>e)return i;return-1},t}();!function(t){t[t.rotate=0]="rotate",t[t.translate=1]="translate",t[t.scale=2]="scale",t[t.shear=3]="shear",t[t.attachment=4]="attachment",t[t.color=5]="color",t[t.deform=6]="deform",t[t.event=7]="event",t[t.drawOrder=8]="drawOrder",t[t.ikConstraint=9]="ikConstraint",t[t.transformConstraint=10]="transformConstraint",t[t.pathConstraintPosition=11]="pathConstraintPosition",t[t.pathConstraintSpacing=12]="pathConstraintSpacing",t[t.pathConstraintMix=13]="pathConstraintMix",t[t.twoColor=14]="twoColor"}(le||(le={}));var be,we=function(){function t(e){if(e<=0)throw new Error("frameCount must be > 0: "+e);this.curves=L.newFloatArray((e-1)*t.BEZIER_SIZE)}return t.prototype.getFrameCount=function(){return this.curves.length/t.BEZIER_SIZE+1},t.prototype.setLinear=function(e){this.curves[e*t.BEZIER_SIZE]=t.LINEAR},t.prototype.setStepped=function(e){this.curves[e*t.BEZIER_SIZE]=t.STEPPED},t.prototype.getCurveType=function(e){var r=e*t.BEZIER_SIZE;if(r==this.curves.length)return t.LINEAR;var i=this.curves[r];return i==t.LINEAR?t.LINEAR:i==t.STEPPED?t.STEPPED:t.BEZIER},t.prototype.setCurve=function(e,r,i,n,o){var a=.03*(2*-r+n),s=.03*(2*-i+o),h=.006*(3*(r-n)+1),l=.006*(3*(i-o)+1),u=2*a+h,c=2*s+l,p=.3*r+a+.16666667*h,d=.3*i+s+.16666667*l,f=e*t.BEZIER_SIZE,m=this.curves;m[f++]=t.BEZIER;for(var v=p,y=d,g=f+t.BEZIER_SIZE-1;f<g;f+=2)m[f]=v,m[f+1]=y,p+=u,d+=c,u+=h,c+=l,v+=p,y+=d},t.prototype.getCurvePercent=function(e,r){r=B.clamp(r,0,1);var i=this.curves,n=e*t.BEZIER_SIZE,o=i[n];if(o==t.LINEAR)return r;if(o==t.STEPPED)return 0;for(var a=0,s=++n,h=n+t.BEZIER_SIZE-1;n<h;n+=2)if((a=i[n])>=r){var l=void 0,u=void 0;return n==s?(l=0,u=0):(l=i[n-2],u=i[n-1]),u+(i[n+1]-u)*(r-l)/(a-l)}var c=i[n-1];return c+(1-c)*(r-a)/(1-a)},t.LINEAR=0,t.STEPPED=1,t.BEZIER=2,t.BEZIER_SIZE=19,t}(),Te=function(e){function r(t){var r=e.call(this,t)||this;return r.frames=L.newFloatArray(t<<1),r}return he(r,e),r.prototype.getPropertyId=function(){return(le.rotate<<24)+this.boneIndex},r.prototype.setFrame=function(t,e,i){t<<=1,this.frames[t]=e,this.frames[t+r.ROTATION]=i},r.prototype.apply=function(e,i,n,o,a,s,h){var l=this.frames,u=e.bones[this.boneIndex];if(n<l[0])switch(s){case t.MixBlend.setup:return void(u.rotation=u.data.rotation);case t.MixBlend.first:var c=u.data.rotation-u.rotation;u.rotation+=(c-360*(16384-(16384.499999999996-c/360|0)))*a}else if(n>=l[l.length-r.ENTRIES]){var p=l[l.length+r.PREV_ROTATION];switch(s){case t.MixBlend.setup:u.rotation=u.data.rotation+p*a;break;case t.MixBlend.first:case t.MixBlend.replace:p+=u.data.rotation-u.rotation,p-=360*(16384-(16384.499999999996-p/360|0));case t.MixBlend.add:u.rotation+=p*a}}else{var d=xe.binarySearch(l,n,r.ENTRIES),f=l[d+r.PREV_ROTATION],m=l[d],v=this.getCurvePercent((d>>1)-1,1-(n-m)/(l[d+r.PREV_TIME]-m)),y=l[d+r.ROTATION]-f;switch(y=f+(y-360*(16384-(16384.499999999996-y/360|0)))*v,s){case t.MixBlend.setup:u.rotation=u.data.rotation+(y-360*(16384-(16384.499999999996-y/360|0)))*a;break;case t.MixBlend.first:case t.MixBlend.replace:y+=u.data.rotation-u.rotation;case t.MixBlend.add:u.rotation+=(y-360*(16384-(16384.499999999996-y/360|0)))*a}}},r.ENTRIES=2,r.PREV_TIME=-2,r.PREV_ROTATION=-1,r.ROTATION=1,r}(we),Ee=function(e){function r(t){var i=e.call(this,t)||this;return i.frames=L.newFloatArray(t*r.ENTRIES),i}return he(r,e),r.prototype.getPropertyId=function(){return(le.translate<<24)+this.boneIndex},r.prototype.setFrame=function(t,e,i,n){t*=r.ENTRIES,this.frames[t]=e,this.frames[t+r.X]=i,this.frames[t+r.Y]=n},r.prototype.apply=function(e,i,n,o,a,s,h){var l=this.frames,u=e.bones[this.boneIndex];if(n<l[0])switch(s){case t.MixBlend.setup:return u.x=u.data.x,void(u.y=u.data.y);case t.MixBlend.first:u.x+=(u.data.x-u.x)*a,u.y+=(u.data.y-u.y)*a}else{var c=0,p=0;if(n>=l[l.length-r.ENTRIES])c=l[l.length+r.PREV_X],p=l[l.length+r.PREV_Y];else{var d=xe.binarySearch(l,n,r.ENTRIES);c=l[d+r.PREV_X],p=l[d+r.PREV_Y];var f=l[d],m=this.getCurvePercent(d/r.ENTRIES-1,1-(n-f)/(l[d+r.PREV_TIME]-f));c+=(l[d+r.X]-c)*m,p+=(l[d+r.Y]-p)*m}switch(s){case t.MixBlend.setup:u.x=u.data.x+c*a,u.y=u.data.y+p*a;break;case t.MixBlend.first:case t.MixBlend.replace:u.x+=(u.data.x+c-u.x)*a,u.y+=(u.data.y+p-u.y)*a;break;case t.MixBlend.add:u.x+=c*a,u.y+=p*a}}},r.ENTRIES=3,r.PREV_TIME=-3,r.PREV_X=-2,r.PREV_Y=-1,r.X=1,r.Y=2,r}(we),Se=function(e){function r(t){return e.call(this,t)||this}return he(r,e),r.prototype.getPropertyId=function(){return(le.scale<<24)+this.boneIndex},r.prototype.apply=function(e,i,n,o,a,s,h){var l=this.frames,u=e.bones[this.boneIndex];if(n<l[0])switch(s){case t.MixBlend.setup:return u.scaleX=u.data.scaleX,void(u.scaleY=u.data.scaleY);case t.MixBlend.first:u.scaleX+=(u.data.scaleX-u.scaleX)*a,u.scaleY+=(u.data.scaleY-u.scaleY)*a}else{var c=0,p=0;if(n>=l[l.length-r.ENTRIES])c=l[l.length+r.PREV_X]*u.data.scaleX,p=l[l.length+r.PREV_Y]*u.data.scaleY;else{var d=xe.binarySearch(l,n,r.ENTRIES);c=l[d+r.PREV_X],p=l[d+r.PREV_Y];var f=l[d],m=this.getCurvePercent(d/r.ENTRIES-1,1-(n-f)/(l[d+r.PREV_TIME]-f));c=(c+(l[d+r.X]-c)*m)*u.data.scaleX,p=(p+(l[d+r.Y]-p)*m)*u.data.scaleY}if(1==a)s==t.MixBlend.add?(u.scaleX+=c-u.data.scaleX,u.scaleY+=p-u.data.scaleY):(u.scaleX=c,u.scaleY=p);else{var v=0,y=0;if(h==t.MixDirection.mixOut)switch(s){case t.MixBlend.setup:v=u.data.scaleX,y=u.data.scaleY,u.scaleX=v+(Math.abs(c)*B.signum(v)-v)*a,u.scaleY=y+(Math.abs(p)*B.signum(y)-y)*a;break;case t.MixBlend.first:case t.MixBlend.replace:v=u.scaleX,y=u.scaleY,u.scaleX=v+(Math.abs(c)*B.signum(v)-v)*a,u.scaleY=y+(Math.abs(p)*B.signum(y)-y)*a;break;case t.MixBlend.add:v=u.scaleX,y=u.scaleY,u.scaleX=v+(Math.abs(c)*B.signum(v)-u.data.scaleX)*a,u.scaleY=y+(Math.abs(p)*B.signum(y)-u.data.scaleY)*a}else switch(s){case t.MixBlend.setup:v=Math.abs(u.data.scaleX)*B.signum(c),y=Math.abs(u.data.scaleY)*B.signum(p),u.scaleX=v+(c-v)*a,u.scaleY=y+(p-y)*a;break;case t.MixBlend.first:case t.MixBlend.replace:v=Math.abs(u.scaleX)*B.signum(c),y=Math.abs(u.scaleY)*B.signum(p),u.scaleX=v+(c-v)*a,u.scaleY=y+(p-y)*a;break;case t.MixBlend.add:v=B.signum(c),y=B.signum(p),u.scaleX=Math.abs(u.scaleX)*v+(c-Math.abs(u.data.scaleX)*v)*a,u.scaleY=Math.abs(u.scaleY)*y+(p-Math.abs(u.data.scaleY)*y)*a}}}},r}(Ee),Ae=function(e){function r(t){return e.call(this,t)||this}return he(r,e),r.prototype.getPropertyId=function(){return(le.shear<<24)+this.boneIndex},r.prototype.apply=function(e,i,n,o,a,s,h){var l=this.frames,u=e.bones[this.boneIndex];if(n<l[0])switch(s){case t.MixBlend.setup:return u.shearX=u.data.shearX,void(u.shearY=u.data.shearY);case t.MixBlend.first:u.shearX+=(u.data.shearX-u.shearX)*a,u.shearY+=(u.data.shearY-u.shearY)*a}else{var c=0,p=0;if(n>=l[l.length-r.ENTRIES])c=l[l.length+r.PREV_X],p=l[l.length+r.PREV_Y];else{var d=xe.binarySearch(l,n,r.ENTRIES);c=l[d+r.PREV_X],p=l[d+r.PREV_Y];var f=l[d],m=this.getCurvePercent(d/r.ENTRIES-1,1-(n-f)/(l[d+r.PREV_TIME]-f));c+=(l[d+r.X]-c)*m,p+=(l[d+r.Y]-p)*m}switch(s){case t.MixBlend.setup:u.shearX=u.data.shearX+c*a,u.shearY=u.data.shearY+p*a;break;case t.MixBlend.first:case t.MixBlend.replace:u.shearX+=(u.data.shearX+c-u.shearX)*a,u.shearY+=(u.data.shearY+p-u.shearY)*a;break;case t.MixBlend.add:u.shearX+=c*a,u.shearY+=p*a}}},r}(Ee),Ie=function(e){function r(t){var i=e.call(this,t)||this;return i.frames=L.newFloatArray(t*r.ENTRIES),i}return he(r,e),r.prototype.getPropertyId=function(){return(le.color<<24)+this.slotIndex},r.prototype.setFrame=function(t,e,i,n,o,a){t*=r.ENTRIES,this.frames[t]=e,this.frames[t+r.R]=i,this.frames[t+r.G]=n,this.frames[t+r.B]=o,this.frames[t+r.A]=a},r.prototype.apply=function(e,i,n,o,a,s,h){var l=e.slots[this.slotIndex],u=this.frames;if(n<u[0])switch(s){case t.MixBlend.setup:return void l.color.setFromColor(l.data.color);case t.MixBlend.first:var c=l.color,p=l.data.color;c.add((p.r-c.r)*a,(p.g-c.g)*a,(p.b-c.b)*a,(p.a-c.a)*a)}else{var d=0,f=0,m=0,v=0;if(n>=u[u.length-r.ENTRIES]){var y=u.length;d=u[y+r.PREV_R],f=u[y+r.PREV_G],m=u[y+r.PREV_B],v=u[y+r.PREV_A]}else{var g=xe.binarySearch(u,n,r.ENTRIES);d=u[g+r.PREV_R],f=u[g+r.PREV_G],m=u[g+r.PREV_B],v=u[g+r.PREV_A];var _=u[g],x=this.getCurvePercent(g/r.ENTRIES-1,1-(n-_)/(u[g+r.PREV_TIME]-_));d+=(u[g+r.R]-d)*x,f+=(u[g+r.G]-f)*x,m+=(u[g+r.B]-m)*x,v+=(u[g+r.A]-v)*x}if(1==a)l.color.set(d,f,m,v);else{c=l.color;s==t.MixBlend.setup&&c.setFromColor(l.data.color),c.add((d-c.r)*a,(f-c.g)*a,(m-c.b)*a,(v-c.a)*a)}}},r.ENTRIES=5,r.PREV_TIME=-5,r.PREV_R=-4,r.PREV_G=-3,r.PREV_B=-2,r.PREV_A=-1,r.R=1,r.G=2,r.B=3,r.A=4,r}(we),Pe=function(e){function r(t){var i=e.call(this,t)||this;return i.frames=L.newFloatArray(t*r.ENTRIES),i}return he(r,e),r.prototype.getPropertyId=function(){return(le.twoColor<<24)+this.slotIndex},r.prototype.setFrame=function(t,e,i,n,o,a,s,h,l){t*=r.ENTRIES,this.frames[t]=e,this.frames[t+r.R]=i,this.frames[t+r.G]=n,this.frames[t+r.B]=o,this.frames[t+r.A]=a,this.frames[t+r.R2]=s,this.frames[t+r.G2]=h,this.frames[t+r.B2]=l},r.prototype.apply=function(e,i,n,o,a,s,h){var l=e.slots[this.slotIndex],u=this.frames;if(n<u[0])switch(s){case t.MixBlend.setup:return l.color.setFromColor(l.data.color),void l.darkColor.setFromColor(l.data.darkColor);case t.MixBlend.first:var c=l.color,p=l.darkColor,d=l.data.color,f=l.data.darkColor;c.add((d.r-c.r)*a,(d.g-c.g)*a,(d.b-c.b)*a,(d.a-c.a)*a),p.add((f.r-p.r)*a,(f.g-p.g)*a,(f.b-p.b)*a,0)}else{var m=0,v=0,y=0,g=0,_=0,x=0,b=0;if(n>=u[u.length-r.ENTRIES]){var w=u.length;m=u[w+r.PREV_R],v=u[w+r.PREV_G],y=u[w+r.PREV_B],g=u[w+r.PREV_A],_=u[w+r.PREV_R2],x=u[w+r.PREV_G2],b=u[w+r.PREV_B2]}else{var T=xe.binarySearch(u,n,r.ENTRIES);m=u[T+r.PREV_R],v=u[T+r.PREV_G],y=u[T+r.PREV_B],g=u[T+r.PREV_A],_=u[T+r.PREV_R2],x=u[T+r.PREV_G2],b=u[T+r.PREV_B2];var E=u[T],S=this.getCurvePercent(T/r.ENTRIES-1,1-(n-E)/(u[T+r.PREV_TIME]-E));m+=(u[T+r.R]-m)*S,v+=(u[T+r.G]-v)*S,y+=(u[T+r.B]-y)*S,g+=(u[T+r.A]-g)*S,_+=(u[T+r.R2]-_)*S,x+=(u[T+r.G2]-x)*S,b+=(u[T+r.B2]-b)*S}if(1==a)l.color.set(m,v,y,g),l.darkColor.set(_,x,b,1);else{c=l.color,p=l.darkColor;s==t.MixBlend.setup&&(c.setFromColor(l.data.color),p.setFromColor(l.data.darkColor)),c.add((m-c.r)*a,(v-c.g)*a,(y-c.b)*a,(g-c.a)*a),p.add((_-p.r)*a,(x-p.g)*a,(b-p.b)*a,0)}}},r.ENTRIES=8,r.PREV_TIME=-8,r.PREV_R=-7,r.PREV_G=-6,r.PREV_B=-5,r.PREV_A=-4,r.PREV_R2=-3,r.PREV_G2=-2,r.PREV_B2=-1,r.R=1,r.G=2,r.B=3,r.A=4,r.R2=5,r.G2=6,r.B2=7,r}(we),Me=function(){function e(t){this.frames=L.newFloatArray(t),this.attachmentNames=new Array(t)}return e.prototype.getPropertyId=function(){return(le.attachment<<24)+this.slotIndex},e.prototype.getFrameCount=function(){return this.frames.length},e.prototype.setFrame=function(t,e,r){this.frames[t]=e,this.attachmentNames[t]=r},e.prototype.apply=function(e,r,i,n,o,a,s){var h=e.slots[this.slotIndex];if(s!=t.MixDirection.mixOut||a!=t.MixBlend.setup){var l=this.frames;if(i<l[0]){if(a==t.MixBlend.setup||a==t.MixBlend.first){var u=h.data.attachmentName;h.setAttachment(null==u?null:e.getAttachment(this.slotIndex,u))}}else{var c=0;c=i>=l[l.length-1]?l.length-1:xe.binarySearch(l,i,1)-1;var p=this.attachmentNames[c];e.slots[this.slotIndex].setAttachment(null==p?null:e.getAttachment(this.slotIndex,p))}}else{var d=h.data.attachmentName;h.setAttachment(null==d?null:e.getAttachment(this.slotIndex,d))}},e}(),Ce=null,Re=function(e){function r(t){var r=e.call(this,t)||this;return r.frames=L.newFloatArray(t),r.frameVertices=new Array(t),null==Ce&&(Ce=L.newFloatArray(64)),r}return he(r,e),r.prototype.getPropertyId=function(){return(le.deform<<27)+ +this.attachment.id+this.slotIndex},r.prototype.setFrame=function(t,e,r){this.frames[t]=e,this.frameVertices[t]=r},r.prototype.apply=function(e,r,i,n,o,a,s){var h=e.slots[this.slotIndex],l=h.getAttachment();if(l instanceof ce&&l.applyDeform(this.attachment)){var u=h.attachmentVertices;0==u.length&&(a=t.MixBlend.setup);var c=this.frameVertices,p=c[0].length,d=this.frames;if(i<d[0]){var f=l;switch(a){case t.MixBlend.setup:return void(u.length=0);case t.MixBlend.first:if(1==o){u.length=0;break}var m=L.setArraySize(u,p);if(null==f.bones)for(var v=f.vertices,y=0;y<p;y++)m[y]+=(v[y]-m[y])*o;else{o=1-o;for(y=0;y<p;y++)m[y]*=o}}}else{var g=L.setArraySize(u,p);if(i>=d[d.length-1]){var _=c[d.length-1];if(1==o)if(a==t.MixBlend.add)if(null==(f=l).bones)for(v=f.vertices,y=0;y<p;y++)g[y]+=_[y]-v[y];else for(y=0;y<p;y++)g[y]+=_[y];else L.arrayCopy(_,0,g,0,p);else switch(a){case t.MixBlend.setup:var x=l;if(null==x.bones)for(v=x.vertices,y=0;y<p;y++){var b=v[y];g[y]=b+(_[y]-b)*o}else for(y=0;y<p;y++)g[y]=_[y]*o;break;case t.MixBlend.first:case t.MixBlend.replace:for(y=0;y<p;y++)g[y]+=(_[y]-g[y])*o;case t.MixBlend.add:if(null==(f=l).bones)for(v=f.vertices,y=0;y<p;y++)g[y]+=(_[y]-v[y])*o;else for(y=0;y<p;y++)g[y]+=_[y]*o}}else{var w=xe.binarySearch(d,i),T=c[w-1],E=c[w],S=d[w],A=this.getCurvePercent(w-1,1-(i-S)/(d[w-1]-S));if(1==o)if(a==t.MixBlend.add)if(null==(f=l).bones)for(v=f.vertices,y=0;y<p;y++){var I=T[y];g[y]+=I+(E[y]-I)*A-v[y]}else for(y=0;y<p;y++){I=T[y];g[y]+=I+(E[y]-I)*A}else for(y=0;y<p;y++){I=T[y];g[y]=I+(E[y]-I)*A}else switch(a){case t.MixBlend.setup:var P=l;if(null==P.bones)for(v=P.vertices,y=0;y<p;y++){I=T[y],b=v[y];g[y]=b+(I+(E[y]-I)*A-b)*o}else for(y=0;y<p;y++){I=T[y];g[y]=(I+(E[y]-I)*A)*o}break;case t.MixBlend.first:case t.MixBlend.replace:for(y=0;y<p;y++){I=T[y];g[y]+=(I+(E[y]-I)*A-g[y])*o}break;case t.MixBlend.add:if(null==(f=l).bones)for(v=f.vertices,y=0;y<p;y++){I=T[y];g[y]+=(I+(E[y]-I)*A-v[y])*o}else for(y=0;y<p;y++){I=T[y];g[y]+=(I+(E[y]-I)*A)*o}}}}}},r}(we),Oe=function(){function t(t){this.frames=L.newFloatArray(t),this.events=new Array(t)}return t.prototype.getPropertyId=function(){return le.event<<24},t.prototype.getFrameCount=function(){return this.frames.length},t.prototype.setFrame=function(t,e){this.frames[t]=e.time,this.events[t]=e},t.prototype.apply=function(t,e,r,i,n,o,a){if(null!=i){var s=this.frames,h=this.frames.length;if(e>r)this.apply(t,e,Number.MAX_VALUE,i,n,o,a),e=-1;else if(e>=s[h-1])return;if(!(r<s[0])){var l=0;if(e<s[0])l=0;else for(var u=s[l=xe.binarySearch(s,e)];l>0&&s[l-1]==u;)l--;for(;l<h&&r>=s[l];l++)i.push(this.events[l])}}},t}(),De=function(){function e(t){this.frames=L.newFloatArray(t),this.drawOrders=new Array(t)}return e.prototype.getPropertyId=function(){return le.drawOrder<<24},e.prototype.getFrameCount=function(){return this.frames.length},e.prototype.setFrame=function(t,e,r){this.frames[t]=e,this.drawOrders[t]=r},e.prototype.apply=function(e,r,i,n,o,a,s){var h=e.drawOrder,l=e.slots;if(s!=t.MixDirection.mixOut||a!=t.MixBlend.setup){var u=this.frames;if(i<u[0])a!=t.MixBlend.setup&&a!=t.MixBlend.first||L.arrayCopy(e.slots,0,e.drawOrder,0,e.slots.length);else{var c=0;c=i>=u[u.length-1]?u.length-1:xe.binarySearch(u,i)-1;var p=this.drawOrders[c];if(null==p)L.arrayCopy(l,0,h,0,l.length);else for(var d=0,f=p.length;d<f;d++)h[d]=l[p[d]]}}else L.arrayCopy(e.slots,0,e.drawOrder,0,e.slots.length)},e}(),Be=function(e){function r(t){var i=e.call(this,t)||this;return i.frames=L.newFloatArray(t*r.ENTRIES),i}return he(r,e),r.prototype.getPropertyId=function(){return(le.ikConstraint<<24)+this.ikConstraintIndex},r.prototype.setFrame=function(t,e,i,n,o,a){t*=r.ENTRIES,this.frames[t]=e,this.frames[t+r.MIX]=i,this.frames[t+r.BEND_DIRECTION]=n,this.frames[t+r.COMPRESS]=o?1:0,this.frames[t+r.STRETCH]=a?1:0},r.prototype.apply=function(e,i,n,o,a,s,h){var l=this.frames,u=e.ikConstraints[this.ikConstraintIndex];if(n<l[0])switch(s){case t.MixBlend.setup:return u.mix=u.data.mix,u.bendDirection=u.data.bendDirection,u.compress=u.data.compress,void(u.stretch=u.data.stretch);case t.MixBlend.first:u.mix+=(u.data.mix-u.mix)*a,u.bendDirection=u.data.bendDirection,u.compress=u.data.compress,u.stretch=u.data.stretch}else if(n>=l[l.length-r.ENTRIES])s==t.MixBlend.setup?(u.mix=u.data.mix+(l[l.length+r.PREV_MIX]-u.data.mix)*a,h==t.MixDirection.mixOut?(u.bendDirection=u.data.bendDirection,u.compress=u.data.compress,u.stretch=u.data.stretch):(u.bendDirection=l[l.length+r.PREV_BEND_DIRECTION],u.compress=0!=l[l.length+r.PREV_COMPRESS],u.stretch=0!=l[l.length+r.PREV_STRETCH])):(u.mix+=(l[l.length+r.PREV_MIX]-u.mix)*a,h==t.MixDirection.mixIn&&(u.bendDirection=l[l.length+r.PREV_BEND_DIRECTION],u.compress=0!=l[l.length+r.PREV_COMPRESS],u.stretch=0!=l[l.length+r.PREV_STRETCH]));else{var c=xe.binarySearch(l,n,r.ENTRIES),p=l[c+r.PREV_MIX],d=l[c],f=this.getCurvePercent(c/r.ENTRIES-1,1-(n-d)/(l[c+r.PREV_TIME]-d));s==t.MixBlend.setup?(u.mix=u.data.mix+(p+(l[c+r.MIX]-p)*f-u.data.mix)*a,h==t.MixDirection.mixOut?(u.bendDirection=u.data.bendDirection,u.compress=u.data.compress,u.stretch=u.data.stretch):(u.bendDirection=l[c+r.PREV_BEND_DIRECTION],u.compress=0!=l[c+r.PREV_COMPRESS],u.stretch=0!=l[c+r.PREV_STRETCH])):(u.mix+=(p+(l[c+r.MIX]-p)*f-u.mix)*a,h==t.MixDirection.mixIn&&(u.bendDirection=l[c+r.PREV_BEND_DIRECTION],u.compress=0!=l[c+r.PREV_COMPRESS],u.stretch=0!=l[c+r.PREV_STRETCH]))}},r.ENTRIES=5,r.PREV_TIME=-5,r.PREV_MIX=-4,r.PREV_BEND_DIRECTION=-3,r.PREV_COMPRESS=-2,r.PREV_STRETCH=-1,r.MIX=1,r.BEND_DIRECTION=2,r.COMPRESS=3,r.STRETCH=4,r}(we),Ne=function(e){function r(t){var i=e.call(this,t)||this;return i.frames=L.newFloatArray(t*r.ENTRIES),i}return he(r,e),r.prototype.getPropertyId=function(){return(le.transformConstraint<<24)+this.transformConstraintIndex},r.prototype.setFrame=function(t,e,i,n,o,a){t*=r.ENTRIES,this.frames[t]=e,this.frames[t+r.ROTATE]=i,this.frames[t+r.TRANSLATE]=n,this.frames[t+r.SCALE]=o,this.frames[t+r.SHEAR]=a},r.prototype.apply=function(e,i,n,o,a,s,h){var l=this.frames,u=e.transformConstraints[this.transformConstraintIndex];if(n<l[0]){var c=u.data;switch(s){case t.MixBlend.setup:return u.rotateMix=c.rotateMix,u.translateMix=c.translateMix,u.scaleMix=c.scaleMix,void(u.shearMix=c.shearMix);case t.MixBlend.first:u.rotateMix+=(c.rotateMix-u.rotateMix)*a,u.translateMix+=(c.translateMix-u.translateMix)*a,u.scaleMix+=(c.scaleMix-u.scaleMix)*a,u.shearMix+=(c.shearMix-u.shearMix)*a}}else{var p=0,d=0,f=0,m=0;if(n>=l[l.length-r.ENTRIES]){var v=l.length;p=l[v+r.PREV_ROTATE],d=l[v+r.PREV_TRANSLATE],f=l[v+r.PREV_SCALE],m=l[v+r.PREV_SHEAR]}else{var y=xe.binarySearch(l,n,r.ENTRIES);p=l[y+r.PREV_ROTATE],d=l[y+r.PREV_TRANSLATE],f=l[y+r.PREV_SCALE],m=l[y+r.PREV_SHEAR];var g=l[y],_=this.getCurvePercent(y/r.ENTRIES-1,1-(n-g)/(l[y+r.PREV_TIME]-g));p+=(l[y+r.ROTATE]-p)*_,d+=(l[y+r.TRANSLATE]-d)*_,f+=(l[y+r.SCALE]-f)*_,m+=(l[y+r.SHEAR]-m)*_}if(s==t.MixBlend.setup){c=u.data;u.rotateMix=c.rotateMix+(p-c.rotateMix)*a,u.translateMix=c.translateMix+(d-c.translateMix)*a,u.scaleMix=c.scaleMix+(f-c.scaleMix)*a,u.shearMix=c.shearMix+(m-c.shearMix)*a}else u.rotateMix+=(p-u.rotateMix)*a,u.translateMix+=(d-u.translateMix)*a,u.scaleMix+=(f-u.scaleMix)*a,u.shearMix+=(m-u.shearMix)*a}},r.ENTRIES=5,r.PREV_TIME=-5,r.PREV_ROTATE=-4,r.PREV_TRANSLATE=-3,r.PREV_SCALE=-2,r.PREV_SHEAR=-1,r.ROTATE=1,r.TRANSLATE=2,r.SCALE=3,r.SHEAR=4,r}(we),ke=function(e){function r(t){var i=e.call(this,t)||this;return i.frames=L.newFloatArray(t*r.ENTRIES),i}return he(r,e),r.prototype.getPropertyId=function(){return(le.pathConstraintPosition<<24)+this.pathConstraintIndex},r.prototype.setFrame=function(t,e,i){t*=r.ENTRIES,this.frames[t]=e,this.frames[t+r.VALUE]=i},r.prototype.apply=function(e,i,n,o,a,s,h){var l=this.frames,u=e.pathConstraints[this.pathConstraintIndex];if(n<l[0])switch(s){case t.MixBlend.setup:return void(u.position=u.data.position);case t.MixBlend.first:u.position+=(u.data.position-u.position)*a}else{var c=0;if(n>=l[l.length-r.ENTRIES])c=l[l.length+r.PREV_VALUE];else{var p=xe.binarySearch(l,n,r.ENTRIES);c=l[p+r.PREV_VALUE];var d=l[p],f=this.getCurvePercent(p/r.ENTRIES-1,1-(n-d)/(l[p+r.PREV_TIME]-d));c+=(l[p+r.VALUE]-c)*f}s==t.MixBlend.setup?u.position=u.data.position+(c-u.data.position)*a:u.position+=(c-u.position)*a}},r.ENTRIES=2,r.PREV_TIME=-2,r.PREV_VALUE=-1,r.VALUE=1,r}(we),Fe=function(e){function r(t){return e.call(this,t)||this}return he(r,e),r.prototype.getPropertyId=function(){return(le.pathConstraintSpacing<<24)+this.pathConstraintIndex},r.prototype.apply=function(e,i,n,o,a,s,h){var l=this.frames,u=e.pathConstraints[this.pathConstraintIndex];if(n<l[0])switch(s){case t.MixBlend.setup:return void(u.spacing=u.data.spacing);case t.MixBlend.first:u.spacing+=(u.data.spacing-u.spacing)*a}else{var c=0;if(n>=l[l.length-r.ENTRIES])c=l[l.length+r.PREV_VALUE];else{var p=xe.binarySearch(l,n,r.ENTRIES);c=l[p+r.PREV_VALUE];var d=l[p],f=this.getCurvePercent(p/r.ENTRIES-1,1-(n-d)/(l[p+r.PREV_TIME]-d));c+=(l[p+r.VALUE]-c)*f}s==t.MixBlend.setup?u.spacing=u.data.spacing+(c-u.data.spacing)*a:u.spacing+=(c-u.spacing)*a}},r}(ke),Le=function(e){function r(t){var i=e.call(this,t)||this;return i.frames=L.newFloatArray(t*r.ENTRIES),i}return he(r,e),r.prototype.getPropertyId=function(){return(le.pathConstraintMix<<24)+this.pathConstraintIndex},r.prototype.setFrame=function(t,e,i,n){t*=r.ENTRIES,this.frames[t]=e,this.frames[t+r.ROTATE]=i,this.frames[t+r.TRANSLATE]=n},r.prototype.apply=function(e,i,n,o,a,s,h){var l=this.frames,u=e.pathConstraints[this.pathConstraintIndex];if(n<l[0])switch(s){case t.MixBlend.setup:return u.rotateMix=u.data.rotateMix,void(u.translateMix=u.data.translateMix);case t.MixBlend.first:u.rotateMix+=(u.data.rotateMix-u.rotateMix)*a,u.translateMix+=(u.data.translateMix-u.translateMix)*a}else{var c=0,p=0;if(n>=l[l.length-r.ENTRIES])c=l[l.length+r.PREV_ROTATE],p=l[l.length+r.PREV_TRANSLATE];else{var d=xe.binarySearch(l,n,r.ENTRIES);c=l[d+r.PREV_ROTATE],p=l[d+r.PREV_TRANSLATE];var f=l[d],m=this.getCurvePercent(d/r.ENTRIES-1,1-(n-f)/(l[d+r.PREV_TIME]-f));c+=(l[d+r.ROTATE]-c)*m,p+=(l[d+r.TRANSLATE]-p)*m}s==t.MixBlend.setup?(u.rotateMix=u.data.rotateMix+(c-u.data.rotateMix)*a,u.translateMix=u.data.translateMix+(p-u.data.translateMix)*a):(u.rotateMix+=(c-u.rotateMix)*a,u.translateMix+=(p-u.translateMix)*a)}},r.ENTRIES=3,r.PREV_TIME=-3,r.PREV_ROTATE=-2,r.PREV_TRANSLATE=-1,r.ROTATE=1,r.TRANSLATE=2,r}(we),Ve=function(){function e(t){this.tracks=new Array,this.events=new Array,this.listeners=new Array,this.queue=new je(this),this.propertyIDs=new R,this.animationsChanged=!1,this.timeScale=1,this.trackEntryPool=new X((function(){return new Xe})),this.data=t}return e.prototype.update=function(t){t*=this.timeScale;for(var e=this.tracks,r=0,i=e.length;r<i;r++){var n=e[r];if(null!=n){n.animationLast=n.nextAnimationLast,n.trackLast=n.nextTrackLast;var o=t*n.timeScale;if(n.delay>0){if(n.delay-=o,n.delay>0)continue;o=-n.delay,n.delay=0}var a=n.next;if(null!=a){var s=n.trackLast-a.delay;if(s>=0){for(a.delay=0,a.trackTime=0==n.timeScale?0:(s/n.timeScale+t)*a.timeScale,n.trackTime+=o,this.setCurrent(r,a,!0);null!=a.mixingFrom;)a.mixTime+=t,a=a.mixingFrom;continue}}else if(n.trackLast>=n.trackEnd&&null==n.mixingFrom){e[r]=null,this.queue.end(n),this.disposeNext(n);continue}if(null!=n.mixingFrom&&this.updateMixingFrom(n,t)){var h=n.mixingFrom;for(n.mixingFrom=null,null!=h&&(h.mixingTo=null);null!=h;)this.queue.end(h),h=h.mixingFrom}n.trackTime+=o}}this.queue.drain()},e.prototype.updateMixingFrom=function(t,e){var r=t.mixingFrom;if(null==r)return!0;var i=this.updateMixingFrom(r,e);return r.animationLast=r.nextAnimationLast,r.trackLast=r.nextTrackLast,t.mixTime>0&&t.mixTime>=t.mixDuration?(0!=r.totalAlpha&&0!=t.mixDuration||(t.mixingFrom=r.mixingFrom,null!=r.mixingFrom&&(r.mixingFrom.mixingTo=t),t.interruptAlpha=r.interruptAlpha,this.queue.end(r)),i):(r.trackTime+=e*r.timeScale,t.mixTime+=e,!1)},e.prototype.apply=function(r){if(null==r)throw new Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();for(var i=this.events,n=this.tracks,o=!1,a=0,s=n.length;a<s;a++){var h=n[a];if(!(null==h||h.delay>0)){o=!0;var l=0==a?t.MixBlend.first:h.mixBlend,u=h.alpha;null!=h.mixingFrom?u*=this.applyMixingFrom(h,r,l):h.trackTime>=h.trackEnd&&null==h.next&&(u=0);var c=h.animationLast,p=h.getAnimationTime(),d=h.animation.timelines.length,f=h.animation.timelines;if(0==a&&1==u||l==t.MixBlend.add)for(var m=0;m<d;m++)L.webkit602BugfixHelper(u,l),f[m].apply(r,c,p,i,u,l,t.MixDirection.mixIn);else{var v=h.timelineMode,y=0==h.timelinesRotation.length;y&&L.setArraySize(h.timelinesRotation,d<<1,null);var g=h.timelinesRotation;for(m=0;m<d;m++){var _=f[m],x=v[m]==e.SUBSEQUENT?l:t.MixBlend.setup;_ instanceof Te?this.applyRotateTimeline(_,r,p,u,x,g,m<<1,y):(L.webkit602BugfixHelper(u,l),_.apply(r,c,p,i,u,x,t.MixDirection.mixIn))}}this.queueEvents(h,p),i.length=0,h.nextAnimationLast=p,h.nextTrackLast=h.trackTime}}return this.queue.drain(),o},e.prototype.applyMixingFrom=function(r,i,n){var o=r.mixingFrom;null!=o.mixingFrom&&this.applyMixingFrom(o,i,n);var a=0;0==r.mixDuration?(a=1,n==t.MixBlend.first&&(n=t.MixBlend.setup)):((a=r.mixTime/r.mixDuration)>1&&(a=1),n!=t.MixBlend.first&&(n=o.mixBlend));var s=a<o.eventThreshold?this.events:null,h=a<o.attachmentThreshold,l=a<o.drawOrderThreshold,u=o.animationLast,c=o.getAnimationTime(),p=o.animation.timelines.length,d=o.animation.timelines,f=o.alpha*r.interruptAlpha,m=f*(1-a);if(n==t.MixBlend.add)for(var v=0;v<p;v++)d[v].apply(i,u,c,s,m,n,t.MixDirection.mixOut);else{var y=o.timelineMode,g=o.timelineHoldMix,_=0==o.timelinesRotation.length;_&&L.setArraySize(o.timelinesRotation,p<<1,null);var x=o.timelinesRotation;o.totalAlpha=0;for(v=0;v<p;v++){var b=d[v],w=t.MixDirection.mixOut,T=void 0,E=0;switch(y[v]){case e.SUBSEQUENT:if(!h&&b instanceof Me)continue;if(!l&&b instanceof De)continue;T=n,E=m;break;case e.FIRST:T=t.MixBlend.setup,E=m;break;case e.HOLD:T=t.MixBlend.setup,E=f;break;default:T=t.MixBlend.setup;var S=g[v];E=f*Math.max(0,1-S.mixTime/S.mixDuration)}o.totalAlpha+=E,b instanceof Te?this.applyRotateTimeline(b,i,c,E,T,x,v<<1,_):(L.webkit602BugfixHelper(E,n),T==t.MixBlend.setup&&(b instanceof Me?h&&(w=t.MixDirection.mixOut):b instanceof De&&l&&(w=t.MixDirection.mixOut)),b.apply(i,u,c,s,E,T,w))}}return r.mixDuration>0&&this.queueEvents(o,c),this.events.length=0,o.nextAnimationLast=c,o.nextTrackLast=o.trackTime,a},e.prototype.applyRotateTimeline=function(e,r,i,n,o,a,s,h){if(h&&(a[s]=0),1!=n){var l=e,u=l.frames,c=r.bones[l.boneIndex],p=0,d=0;if(i<u[0])switch(o){case t.MixBlend.setup:c.rotation=c.data.rotation;default:return;case t.MixBlend.first:p=c.rotation,d=c.data.rotation}else if(p=o==t.MixBlend.setup?c.data.rotation:c.rotation,i>=u[u.length-Te.ENTRIES])d=c.data.rotation+u[u.length+Te.PREV_ROTATION];else{var f=xe.binarySearch(u,i,Te.ENTRIES),m=u[f+Te.PREV_ROTATION],v=u[f],y=l.getCurvePercent((f>>1)-1,1-(i-v)/(u[f+Te.PREV_TIME]-v));d=u[f+Te.ROTATION]-m,d=m+(d-=360*(16384-(16384.499999999996-d/360|0)))*y+c.data.rotation,d-=360*(16384-(16384.499999999996-d/360|0))}var g=0,_=d-p;if(0==(_-=360*(16384-(16384.499999999996-_/360|0))))g=a[s];else{var x=0,b=0;h?(x=0,b=_):(x=a[s],b=a[s+1]);var w=_>0,T=x>=0;B.signum(b)!=B.signum(_)&&Math.abs(b)<=90&&(Math.abs(x)>180&&(x+=360*B.signum(x)),T=w),g=_+x-x%360,T!=w&&(g+=360*B.signum(x)),a[s]=g}a[s+1]=_,p+=g*n,c.rotation=p-360*(16384-(16384.499999999996-p/360|0))}else e.apply(r,0,i,null,1,o,t.MixDirection.mixIn)},e.prototype.queueEvents=function(t,e){for(var r=t.animationStart,i=t.animationEnd,n=i-r,o=t.trackLast%n,a=this.events,s=0,h=a.length;s<h;s++){var l=a[s];if(l.time<o)break;l.time>i||this.queue.event(t,l)}for((t.loop?0==n||o>t.trackTime%n:e>=i&&t.animationLast<i)&&this.queue.complete(t);s<h;s++){a[s].time<r||this.queue.event(t,a[s])}},e.prototype.clearTracks=function(){var t=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(var e=0,r=this.tracks.length;e<r;e++)this.clearTrack(e);this.tracks.length=0,this.queue.drainDisabled=t,this.queue.drain()},e.prototype.clearTrack=function(t){if(!(t>=this.tracks.length)){var e=this.tracks[t];if(null!=e){this.queue.end(e),this.disposeNext(e);for(var r=e;;){var i=r.mixingFrom;if(null==i)break;this.queue.end(i),r.mixingFrom=null,r.mixingTo=null,r=i}this.tracks[e.trackIndex]=null,this.queue.drain()}}},e.prototype.setCurrent=function(t,e,r){var i=this.expandToIndex(t);this.tracks[t]=e,null!=i&&(r&&this.queue.interrupt(i),e.mixingFrom=i,i.mixingTo=e,e.mixTime=0,null!=i.mixingFrom&&i.mixDuration>0&&(e.interruptAlpha*=Math.min(1,i.mixTime/i.mixDuration)),i.timelinesRotation.length=0),this.queue.start(e)},e.prototype.setAnimation=function(t,e,r){var i=this.data.skeletonData.findAnimation(e);if(null==i)throw new Error("Animation not found: "+e);return this.setAnimationWith(t,i,r)},e.prototype.setAnimationWith=function(t,e,r){if(null==e)throw new Error("animation cannot be null.");var i=!0,n=this.expandToIndex(t);null!=n&&(-1==n.nextTrackLast?(this.tracks[t]=n.mixingFrom,this.queue.interrupt(n),this.queue.end(n),this.disposeNext(n),n=n.mixingFrom,i=!1):this.disposeNext(n));var o=this.trackEntry(t,e,r,n);return this.setCurrent(t,o,i),this.queue.drain(),o},e.prototype.addAnimation=function(t,e,r,i){var n=this.data.skeletonData.findAnimation(e);if(null==n)throw new Error("Animation not found: "+e);return this.addAnimationWith(t,n,r,i)},e.prototype.addAnimationWith=function(t,e,r,i){if(null==e)throw new Error("animation cannot be null.");var n=this.expandToIndex(t);if(null!=n)for(;null!=n.next;)n=n.next;var o=this.trackEntry(t,e,r,n);if(null==n)this.setCurrent(t,o,!0),this.queue.drain();else if(n.next=o,i<=0){var a=n.animationEnd-n.animationStart;0!=a?(n.loop?i+=a*(1+(n.trackTime/a|0)):i+=Math.max(a,n.trackTime),i-=this.data.getMix(n.animation,e)):i=n.trackTime}return o.delay=i,o},e.prototype.setEmptyAnimation=function(t,r){var i=this.setAnimationWith(t,e.emptyAnimation,!1);return i.mixDuration=r,i.trackEnd=r,i},e.prototype.addEmptyAnimation=function(t,r,i){i<=0&&(i-=r);var n=this.addAnimationWith(t,e.emptyAnimation,!1,i);return n.mixDuration=r,n.trackEnd=r,n},e.prototype.setEmptyAnimations=function(t){var e=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(var r=0,i=this.tracks.length;r<i;r++){var n=this.tracks[r];null!=n&&this.setEmptyAnimation(n.trackIndex,t)}this.queue.drainDisabled=e,this.queue.drain()},e.prototype.expandToIndex=function(t){return t<this.tracks.length?this.tracks[t]:(L.ensureArrayCapacity(this.tracks,t-this.tracks.length+1,null),this.tracks.length=t+1,null)},e.prototype.trackEntry=function(t,e,r,i){var n=this.trackEntryPool.obtain();return n.trackIndex=t,n.animation=e,n.loop=r,n.holdPrevious=!1,n.eventThreshold=0,n.attachmentThreshold=0,n.drawOrderThreshold=0,n.animationStart=0,n.animationEnd=e.duration,n.animationLast=-1,n.nextAnimationLast=-1,n.delay=0,n.trackTime=0,n.trackLast=-1,n.nextTrackLast=-1,n.trackEnd=Number.MAX_VALUE,n.timeScale=1,n.alpha=1,n.interruptAlpha=1,n.mixTime=0,n.mixDuration=null==i?0:this.data.getMix(i.animation,e),n},e.prototype.disposeNext=function(t){for(var e=t.next;null!=e;)this.queue.dispose(e),e=e.next;t.next=null},e.prototype._animationsChanged=function(){this.animationsChanged=!1,this.propertyIDs.clear();for(var e=0,r=this.tracks.length;e<r;e++){var i=this.tracks[e];if(null!=i){for(;null!=i.mixingFrom;)i=i.mixingFrom;do{null!=i.mixingFrom&&i.mixBlend==t.MixBlend.add||this.setTimelineModes(i),i=i.mixingTo}while(null!=i)}}},e.prototype.setTimelineModes=function(t){var r=t.mixingTo,i=t.animation.timelines,n=t.animation.timelines.length,o=L.setArraySize(t.timelineMode,n);t.timelineHoldMix.length=0;var a=L.setArraySize(t.timelineHoldMix,n),s=this.propertyIDs;if(null!=r&&r.holdPrevious)for(var h=0;h<n;h++)s.add(i[h].getPropertyId()),o[h]=e.HOLD;else t:for(h=0;h<n;h++){var l=i[h].getPropertyId();if(s.add(l))if(null!=r&&this.hasTimeline(r,l)){for(var u=r.mixingTo;null!=u;u=u.mixingTo)if(!this.hasTimeline(u,l)){if(t.mixDuration>0){o[h]=e.HOLD_MIX,a[h]=u;continue t}break}o[h]=e.HOLD}else o[h]=e.FIRST;else o[h]=e.SUBSEQUENT}},e.prototype.hasTimeline=function(t,e){for(var r=t.animation.timelines,i=0,n=r.length;i<n;i++)if(r[i].getPropertyId()==e)return!0;return!1},e.prototype.getCurrent=function(t){return t>=this.tracks.length?null:this.tracks[t]},e.prototype.addListener=function(t){if(null==t)throw new Error("listener cannot be null.");this.listeners.push(t)},e.prototype.removeListener=function(t){var e=this.listeners.indexOf(t);e>=0&&this.listeners.splice(e,1)},e.prototype.clearListeners=function(){this.listeners.length=0},e.prototype.clearListenerNotifications=function(){this.queue.clear()},e.prototype.setAnimationByName=function(t,r,i){e.deprecatedWarning1||(e.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: AnimationState.setAnimationByName is deprecated, please use setAnimation from now on.")),this.setAnimation(t,r,i)},e.prototype.addAnimationByName=function(t,r,i,n){e.deprecatedWarning2||(e.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: AnimationState.addAnimationByName is deprecated, please use addAnimation from now on.")),this.addAnimation(t,r,i,n)},e.prototype.hasAnimation=function(t){return null!==this.data.skeletonData.findAnimation(t)},e.prototype.hasAnimationByName=function(t){return e.deprecatedWarning3||(e.deprecatedWarning3=!0,console.warn("Spine Deprecation Warning: AnimationState.hasAnimationByName is deprecated, please use hasAnimation from now on.")),this.hasAnimation(t)},e.emptyAnimation=new xe("<empty>",[],0),e.SUBSEQUENT=0,e.FIRST=1,e.HOLD=2,e.HOLD_MIX=3,e.deprecatedWarning1=!1,e.deprecatedWarning2=!1,e.deprecatedWarning3=!1,e}(),Xe=function(){function e(){this.mixBlend=t.MixBlend.replace,this.timelineMode=new Array,this.timelineHoldMix=new Array,this.timelinesRotation=new Array}return e.prototype.reset=function(){this.next=null,this.mixingFrom=null,this.mixingTo=null,this.animation=null,this.listener=null,this.timelineMode.length=0,this.timelineHoldMix.length=0,this.timelinesRotation.length=0},e.prototype.getAnimationTime=function(){if(this.loop){var t=this.animationEnd-this.animationStart;return 0==t?this.animationStart:this.trackTime%t+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)},e.prototype.setAnimationLast=function(t){this.animationLast=t,this.nextAnimationLast=t},e.prototype.isComplete=function(){return this.trackTime>=this.animationEnd-this.animationStart},e.prototype.resetRotationDirections=function(){this.timelinesRotation.length=0},Object.defineProperty(e.prototype,"time",{get:function(){return e.deprecatedWarning1||(e.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime},set:function(t){e.deprecatedWarning1||(e.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"endTime",{get:function(){return e.deprecatedWarning2||(e.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime},set:function(t){e.deprecatedWarning2||(e.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime=t},enumerable:!1,configurable:!0}),e.prototype.loopsCount=function(){return Math.floor(this.trackTime/this.trackEnd)},e.deprecatedWarning1=!1,e.deprecatedWarning2=!1,e}(),je=function(){function t(t){this.objects=[],this.drainDisabled=!1,this.animState=t}return t.prototype.start=function(t){this.objects.push(be.start),this.objects.push(t),this.animState.animationsChanged=!0},t.prototype.interrupt=function(t){this.objects.push(be.interrupt),this.objects.push(t)},t.prototype.end=function(t){this.objects.push(be.end),this.objects.push(t),this.animState.animationsChanged=!0},t.prototype.dispose=function(t){this.objects.push(be.dispose),this.objects.push(t)},t.prototype.complete=function(t){this.objects.push(be.complete),this.objects.push(t)},t.prototype.event=function(t,e){this.objects.push(be.event),this.objects.push(t),this.objects.push(e)},t.prototype.deprecateStuff=function(){return t.deprecatedWarning1||(t.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: onComplete, onStart, onEnd, onEvent art deprecated, please use listeners from now on. 'state.addListener({ complete: function(track, event) { } })'")),!0},t.prototype.drain=function(){if(!this.drainDisabled){this.drainDisabled=!0;for(var t=this.objects,e=this.animState.listeners,r=0;r<t.length;r+=2){var i=t[r],n=t[r+1];switch(i){case be.start:null!=n.listener&&n.listener.start&&n.listener.start(n);for(var o=0;o<e.length;o++)e[o].start&&e[o].start(n);n.onStart&&this.deprecateStuff()&&n.onStart(n.trackIndex),this.animState.onStart&&this.deprecateStuff()&&this.deprecateStuff&&this.animState.onStart(n.trackIndex);break;case be.interrupt:null!=n.listener&&n.listener.interrupt&&n.listener.interrupt(n);for(o=0;o<e.length;o++)e[o].interrupt&&e[o].interrupt(n);break;case be.end:null!=n.listener&&n.listener.end&&n.listener.end(n);for(o=0;o<e.length;o++)e[o].end&&e[o].end(n);n.onEnd&&this.deprecateStuff()&&n.onEnd(n.trackIndex),this.animState.onEnd&&this.deprecateStuff()&&this.animState.onEnd(n.trackIndex);case be.dispose:null!=n.listener&&n.listener.dispose&&n.listener.dispose(n);for(o=0;o<e.length;o++)e[o].dispose&&e[o].dispose(n);this.animState.trackEntryPool.free(n);break;case be.complete:null!=n.listener&&n.listener.complete&&n.listener.complete(n);for(o=0;o<e.length;o++)e[o].complete&&e[o].complete(n);var a=B.toInt(n.loopsCount());n.onComplete&&this.deprecateStuff()&&n.onComplete(n.trackIndex,a),this.animState.onComplete&&this.deprecateStuff()&&this.animState.onComplete(n.trackIndex,a);break;case be.event:var s=t[2+r++];null!=n.listener&&n.listener.event&&n.listener.event(n,s);for(o=0;o<e.length;o++)e[o].event&&e[o].event(n,s);n.onEvent&&this.deprecateStuff()&&n.onEvent(n.trackIndex,s),this.animState.onEvent&&this.deprecateStuff()&&this.animState.onEvent(n.trackIndex,s)}}this.clear(),this.drainDisabled=!1}},t.prototype.clear=function(){this.objects.length=0},t.deprecatedWarning1=!1,t}();!function(t){t[t.start=0]="start",t[t.interrupt=1]="interrupt",t[t.end=2]="end",t[t.dispose=3]="dispose",t[t.complete=4]="complete",t[t.event=5]="event"}(be||(be={}));var Ue,Ye=function(){function t(){}return t.prototype.start=function(t){},t.prototype.interrupt=function(t){},t.prototype.end=function(t){},t.prototype.dispose=function(t){},t.prototype.complete=function(t){},t.prototype.event=function(t,e){},t}(),ze=function(){function t(t){if(this.animationToMixTime={},this.defaultMix=0,null==t)throw new Error("skeletonData cannot be null.");this.skeletonData=t}return t.prototype.setMix=function(t,e,r){var i=this.skeletonData.findAnimation(t);if(null==i)throw new Error("Animation not found: "+t);var n=this.skeletonData.findAnimation(e);if(null==n)throw new Error("Animation not found: "+e);this.setMixWith(i,n,r)},t.prototype.setMixByName=function(e,r,i){t.deprecatedWarning1||(t.deprecatedWarning1=!0,console.warn("Deprecation Warning: AnimationStateData.setMixByName is deprecated, please use setMix from now on.")),this.setMix(e,r,i)},t.prototype.setMixWith=function(t,e,r){if(null==t)throw new Error("from cannot be null.");if(null==e)throw new Error("to cannot be null.");var i=t.name+"."+e.name;this.animationToMixTime[i]=r},t.prototype.getMix=function(t,e){var r=t.name+"."+e.name,i=this.animationToMixTime[r];return void 0===i?this.defaultMix:i},t.deprecatedWarning1=!1,t}(),We=function(){function t(t){this.atlas=t}return t.prototype.newRegionAttachment=function(t,e,r){var i=this.atlas.findRegion(r);if(null==i)throw new Error("Region not found in atlas: "+r+" (region attachment: "+e+")");var n=new ye(e);return n.region=i,n},t.prototype.newMeshAttachment=function(t,e,r){var i=this.atlas.findRegion(r);if(null==i)throw new Error("Region not found in atlas: "+r+" (mesh attachment: "+e+")");var n=new fe(e);return n.region=i,n},t.prototype.newBoundingBoxAttachment=function(t,e){return new pe(e)},t.prototype.newPathAttachment=function(t,e){return new me(e)},t.prototype.newPointAttachment=function(t,e){return new ve(e)},t.prototype.newClippingAttachment=function(t,e){return new de(e)},t}(),qe=function(){function e(t,e,r){if(this.matrix=new n.Matrix,this.children=new Array,this.x=0,this.y=0,this.rotation=0,this.scaleX=0,this.scaleY=0,this.shearX=0,this.shearY=0,this.ax=0,this.ay=0,this.arotation=0,this.ascaleX=0,this.ascaleY=0,this.ashearX=0,this.ashearY=0,this.appliedValid=!1,this.sorted=!1,null==t)throw new Error("data cannot be null.");if(null==e)throw new Error("skeleton cannot be null.");this.data=t,this.skeleton=e,this.parent=r,this.setToSetupPose()}return Object.defineProperty(e.prototype,"worldX",{get:function(){return this.matrix.tx},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"worldY",{get:function(){return this.matrix.ty},enumerable:!1,configurable:!0}),e.prototype.update=function(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)},e.prototype.updateWorldTransform=function(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)},e.prototype.updateWorldTransformWith=function(e,r,i,n,o,a,s){this.ax=e,this.ay=r,this.arotation=i,this.ascaleX=n,this.ascaleY=o,this.ashearX=a,this.ashearY=s,this.appliedValid=!0;var h=this.parent,l=this.matrix,u=this.skeleton.scaleX,c=z.yDown?-this.skeleton.scaleY:this.skeleton.scaleY;if(null==h){var p=this.skeleton,d=i+90+s;return l.a=B.cosDeg(i+a)*n*u,l.c=B.cosDeg(d)*o*u,l.b=B.sinDeg(i+a)*n*c,l.d=B.sinDeg(d)*o*c,l.tx=e*u+p.x,void(l.ty=r*c+p.y)}var f=h.matrix.a,m=h.matrix.c,v=h.matrix.b,y=h.matrix.d;switch(l.tx=f*e+m*r+h.matrix.tx,l.ty=v*e+y*r+h.matrix.ty,this.data.transformMode){case t.TransformMode.Normal:d=i+90+s;var g=B.cosDeg(i+a)*n,_=B.cosDeg(d)*o,x=B.sinDeg(i+a)*n,b=B.sinDeg(d)*o;return l.a=f*g+m*x,l.c=f*_+m*b,l.b=v*g+y*x,void(l.d=v*_+y*b);case t.TransformMode.OnlyTranslation:d=i+90+s;l.a=B.cosDeg(i+a)*n,l.c=B.cosDeg(d)*o,l.b=B.sinDeg(i+a)*n,l.d=B.sinDeg(d)*o;break;case t.TransformMode.NoRotationOrReflection:var w=0;(S=f*f+v*v)>1e-4?(m=v*(S=Math.abs(f*y-m*v)/S),y=f*S,w=Math.atan2(v,f)*B.radDeg):(f=0,v=0,w=90-Math.atan2(y,m)*B.radDeg);var T=i+a-w,E=i+s-w+90;g=B.cosDeg(T)*n,_=B.cosDeg(E)*o,x=B.sinDeg(T)*n,b=B.sinDeg(E)*o;l.a=f*g-m*x,l.c=f*_-m*b,l.b=v*g+y*x,l.d=v*_+y*b;break;case t.TransformMode.NoScale:case t.TransformMode.NoScaleOrReflection:var S,A=B.cosDeg(i),I=B.sinDeg(i),P=(f*A+m*I)/u,M=(v*A+y*I)/c;(S=Math.sqrt(P*P+M*M))>1e-5&&(S=1/S),P*=S,M*=S,S=Math.sqrt(P*P+M*M),this.data.transformMode==t.TransformMode.NoScale&&f*y-m*v<0!=(z.yDown?this.skeleton.scaleX<0!=this.skeleton.scaleY>0:this.skeleton.scaleX<0!=this.skeleton.scaleY<0)&&(S=-S);var C=Math.PI/2+Math.atan2(M,P),R=Math.cos(C)*S,O=Math.sin(C)*S;g=B.cosDeg(a)*n,_=B.cosDeg(90+s)*o,x=B.sinDeg(a)*n,b=B.sinDeg(90+s)*o;l.a=P*g+R*x,l.c=P*_+R*b,l.b=M*g+O*x,l.d=M*_+O*b}l.a*=u,l.c*=u,l.b*=c,l.d*=c},e.prototype.setToSetupPose=function(){var t=this.data;this.x=t.x,this.y=t.y,this.rotation=t.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this.shearX=t.shearX,this.shearY=t.shearY},e.prototype.getWorldRotationX=function(){return Math.atan2(this.matrix.b,this.matrix.a)*B.radDeg},e.prototype.getWorldRotationY=function(){return Math.atan2(this.matrix.d,this.matrix.c)*B.radDeg},e.prototype.getWorldScaleX=function(){var t=this.matrix;return Math.sqrt(t.a*t.a+t.c*t.c)},e.prototype.getWorldScaleY=function(){var t=this.matrix;return Math.sqrt(t.b*t.b+t.d*t.d)},e.prototype.updateAppliedTransform=function(){this.appliedValid=!0;var t=this.parent,e=this.matrix;if(null==t)return this.ax=e.tx,this.ay=e.ty,this.arotation=Math.atan2(e.b,e.a)*B.radDeg,this.ascaleX=Math.sqrt(e.a*e.a+e.b*e.b),this.ascaleY=Math.sqrt(e.c*e.c+e.d*e.d),this.ashearX=0,void(this.ashearY=Math.atan2(e.a*e.c+e.b*e.d,e.a*e.d-e.b*e.c)*B.radDeg);var r=t.matrix,i=1/(r.a*r.d-r.b*r.c),n=e.tx-r.tx,o=e.ty-r.ty;this.ax=n*r.d*i-o*r.c*i,this.ay=o*r.a*i-n*r.b*i;var a=i*r.d,s=i*r.a,h=i*r.c,l=i*r.b,u=a*e.a-h*e.b,c=a*e.c-h*e.d,p=s*e.b-l*e.a,d=s*e.d-l*e.c;if(this.ashearX=0,this.ascaleX=Math.sqrt(u*u+p*p),this.ascaleX>1e-4){var f=u*d-c*p;this.ascaleY=f/this.ascaleX,this.ashearY=Math.atan2(u*c+p*d,f)*B.radDeg,this.arotation=Math.atan2(p,u)*B.radDeg}else this.ascaleX=0,this.ascaleY=Math.sqrt(c*c+d*d),this.ashearY=0,this.arotation=90-Math.atan2(d,c)*B.radDeg},e.prototype.worldToLocal=function(t){var e=this.matrix,r=e.a,i=e.c,n=e.b,o=e.d,a=1/(r*o-i*n),s=t.x-e.tx,h=t.y-e.ty;return t.x=s*o*a-h*i*a,t.y=h*r*a-s*n*a,t},e.prototype.localToWorld=function(t){var e=this.matrix,r=t.x,i=t.y;return t.x=r*e.a+i*e.c+e.tx,t.y=r*e.b+i*e.d+e.ty,t},e.prototype.worldToLocalRotation=function(t){var e=B.sinDeg(t),r=B.cosDeg(t),i=this.matrix;return Math.atan2(i.a*e-i.b*r,i.d*r-i.c*e)*B.radDeg},e.prototype.localToWorldRotation=function(t){var e=B.sinDeg(t),r=B.cosDeg(t),i=this.matrix;return Math.atan2(r*i.b+e*i.d,r*i.a+e*i.c)*B.radDeg},e.prototype.rotateWorld=function(t){var e=this.matrix,r=e.a,i=e.c,n=e.b,o=e.d,a=B.cosDeg(t),s=B.sinDeg(t);e.a=a*r-s*n,e.c=a*i-s*o,e.b=s*r+a*n,e.d=s*i+a*o,this.appliedValid=!1},e}(),Ge=function(e,r,i){if(this.x=0,this.y=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.shearX=0,this.shearY=0,this.transformMode=t.TransformMode.Normal,e<0)throw new Error("index must be >= 0.");if(null==r)throw new Error("name cannot be null.");this.index=e,this.name=r,this.parent=i},He=function(t,e){if(null==e)throw new Error("data cannot be null.");this.time=t,this.data=e},$e=function(t){this.name=t},Je=function(){function t(t,e){if(this.bendDirection=0,this.compress=!1,this.stretch=!1,this.mix=1,null==t)throw new Error("data cannot be null.");if(null==e)throw new Error("skeleton cannot be null.");this.data=t,this.mix=t.mix,this.bendDirection=t.bendDirection,this.compress=t.compress,this.stretch=t.stretch,this.bones=new Array;for(var r=0;r<t.bones.length;r++)this.bones.push(e.findBone(t.bones[r].name));this.target=e.findBone(t.target.name)}return t.prototype.getOrder=function(){return this.data.order},t.prototype.apply=function(){this.update()},t.prototype.update=function(){var t=this.target,e=this.bones;switch(e.length){case 1:this.apply1(e[0],t.worldX,t.worldY,this.compress,this.stretch,this.data.uniform,this.mix);break;case 2:this.apply2(e[0],e[1],t.worldX,t.worldY,this.bendDirection,this.stretch,this.mix)}},t.prototype.apply1=function(t,e,r,i,n,o,a){t.appliedValid||t.updateAppliedTransform();var s=t.parent.matrix,h=1/(s.a*s.d-s.b*s.c),l=e-s.tx,u=r-s.ty,c=(l*s.d-u*s.c)*h-t.ax,p=(u*s.a-l*s.b)*h-t.ay,d=Math.atan2(p,c)*B.radDeg-t.ashearX-t.arotation;t.ascaleX<0&&(d+=180),d>180?d-=360:d<-180&&(d+=360);var f=t.ascaleX,m=t.ascaleY;if(i||n){var v=t.data.length*f,y=Math.sqrt(c*c+p*p);if(i&&y<v||n&&y>v&&v>1e-4){var g=(y/v-1)*a+1;f*=g,o&&(m*=g)}}t.updateWorldTransformWith(t.ax,t.ay,t.arotation+d*a,f,m,t.ashearX,t.ashearY)},t.prototype.apply2=function(t,e,r,i,n,o,a){if(0!=a){t.appliedValid||t.updateAppliedTransform(),e.appliedValid||e.updateAppliedTransform();var s=t.ax,h=t.ay,l=t.ascaleX,u=l,c=t.ascaleY,p=e.ascaleX,d=t.matrix,f=0,m=0,v=0;l<0?(l=-l,f=180,v=-1):(f=0,v=1),c<0&&(c=-c,v=-v),p<0?(p=-p,m=180):m=0;var y=e.ax,g=0,_=0,x=0,b=d.a,w=d.c,T=d.b,E=d.d,S=Math.abs(l-c)<=1e-4;S?(_=b*y+w*(g=e.ay)+d.tx,x=T*y+E*g+d.ty):(g=0,_=b*y+d.tx,x=T*y+d.ty);var A=t.parent.matrix;b=A.a,w=A.c,T=A.b;var I=1/(b*(E=A.d)-w*T),P=r-A.tx,M=i-A.ty,C=(P*E-M*w)*I-s,R=(M*b-P*T)*I-h,O=C*C+R*R,D=((P=_-A.tx)*E-(M=x-A.ty)*w)*I-s,N=(M*b-P*T)*I-h,k=Math.sqrt(D*D+N*N),F=e.data.length*p,L=0,V=0;t:if(S){var X=(O-k*k-(F*=l)*F)/(2*k*F);X<-1?X=-1:X>1&&(X=1,o&&k+F>1e-4&&(u*=(Math.sqrt(O)/(k+F)-1)*a+1)),V=Math.acos(X)*n,b=k+F*X,w=F*Math.sin(V),L=Math.atan2(R*b-C*w,C*b+R*w)}else{var j=(b=l*F)*b,U=(w=c*F)*w,Y=Math.atan2(R,C),z=-2*U*k,W=U-j;if((E=z*z-4*W*(T=U*k*k+j*O-j*U))>=0){var q=Math.sqrt(E);z<0&&(q=-q);var G=(q=-(z+q)/2)/W,H=T/q,$=Math.abs(G)<Math.abs(H)?G:H;if($*$<=O){M=Math.sqrt(O-$*$)*n,L=Y-Math.atan2(M,$),V=Math.atan2(M/c,($-k)/l);break t}}var J=B.PI,Z=k-b,Q=Z*Z,K=0,tt=0,et=k+b,rt=et*et,it=0;(T=-b*k/(j-U))>=-1&&T<=1&&(T=Math.acos(T),(E=(P=b*Math.cos(T)+k)*P+(M=w*Math.sin(T))*M)<Q&&(J=T,Q=E,Z=P,K=M),E>rt&&(tt=T,rt=E,et=P,it=M)),O<=(Q+rt)/2?(L=Y-Math.atan2(K*n,Z),V=J*n):(L=Y-Math.atan2(it*n,et),V=tt*n)}var nt=Math.atan2(g,y)*v,ot=t.arotation;(L=(L-nt)*B.radDeg+f-ot)>180?L-=360:L<-180&&(L+=360),t.updateWorldTransformWith(s,h,ot+L*a,u,t.ascaleY,0,0),ot=e.arotation,(V=((V+nt)*B.radDeg-e.ashearX)*v+m-ot)>180?V-=360:V<-180&&(V+=360),e.updateWorldTransformWith(y,g,ot+V*a,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY)}else e.updateWorldTransform()},t}(),Ze=function(t){this.order=0,this.bones=new Array,this.bendDirection=1,this.compress=!1,this.stretch=!1,this.uniform=!1,this.mix=1,this.name=t},Qe=function(t){this.order=0,this.bones=new Array,this.name=t};!function(t){t[t.Length=0]="Length",t[t.Fixed=1]="Fixed",t[t.Percent=2]="Percent"}(Ue||(Ue={}));var Ke=function(){function e(t,e){if(this.position=0,this.spacing=0,this.rotateMix=0,this.translateMix=0,this.spaces=new Array,this.positions=new Array,this.world=new Array,this.curves=new Array,this.lengths=new Array,this.segments=new Array,null==t)throw new Error("data cannot be null.");if(null==e)throw new Error("skeleton cannot be null.");this.data=t,this.bones=new Array;for(var r=0,i=t.bones.length;r<i;r++)this.bones.push(e.findBone(t.bones[r].name));this.target=e.findSlot(t.target.name),this.position=t.position,this.spacing=t.spacing,this.rotateMix=t.rotateMix,this.translateMix=t.translateMix}return e.prototype.apply=function(){this.update()},e.prototype.update=function(){var r=this.target.getAttachment();if(r instanceof me){var i=this.rotateMix,n=this.translateMix,o=i>0;if(n>0||o){var a=this.data,s=a.spacingMode,h=s==Ue.Length,l=a.rotateMode,u=l==t.RotateMode.Tangent,c=l==t.RotateMode.ChainScale,p=this.bones.length,d=u?p:p+1,f=this.bones,m=L.setArraySize(this.spaces,d),v=null,y=this.spacing;if(c||h){c&&(v=L.setArraySize(this.lengths,p));for(var g=0,_=d-1;g<_;){var x=(C=f[g]).data.length;if(x<e.epsilon)c&&(v[g]=0),m[++g]=0;else{var b=x*C.matrix.a,w=x*C.matrix.b,T=Math.sqrt(b*b+w*w);c&&(v[g]=T),m[++g]=(h?x+y:y)*T/x}}}else for(g=1;g<d;g++)m[g]=y;var E=this.computeWorldPositions(r,d,u,a.positionMode==t.PositionMode.Percent,s==Ue.Percent),S=E[0],A=E[1],I=a.offsetRotation,P=!1;if(0==I)P=l==t.RotateMode.Chain;else P=!1,I*=(M=this.target.bone.matrix).a*M.d-M.b*M.c>0?B.degRad:-B.degRad;g=0;for(var M=3;g<p;g++,M+=3){var C,R=(C=f[g]).matrix;R.tx+=(S-R.tx)*n,R.ty+=(A-R.ty)*n;var O=(b=E[M])-S,D=(w=E[M+1])-A;if(c){var N=v[g];if(0!=N){var k=(Math.sqrt(O*O+D*D)/N-1)*i+1;R.a*=k,R.b*=k}}if(S=b,A=w,o){var F=R.a,V=R.c,X=R.b,j=R.d,U=0,Y=0,z=0;if(U=u?E[M-1]:0==m[g+1]?E[M+2]:Math.atan2(D,O),U-=Math.atan2(X,F),P){Y=Math.cos(U),z=Math.sin(U);var W=C.data.length;S+=(W*(Y*F-z*X)-O)*i,A+=(W*(z*F+Y*X)-D)*i}else U+=I;U>B.PI?U-=B.PI2:U<-B.PI&&(U+=B.PI2),U*=i,Y=Math.cos(U),z=Math.sin(U),R.a=Y*F-z*X,R.c=Y*V-z*j,R.b=z*F+Y*X,R.d=z*V+Y*j}C.appliedValid=!1}}}},e.prototype.computeWorldPositions=function(t,r,i,n,o){var a=this.target,s=this.position,h=this.spaces,l=L.setArraySize(this.positions,3*r+2),u=null,c=t.closed,p=t.worldVerticesLength,d=p/6,f=e.NONE;if(!t.constantSpeed){var m=t.lengths,v=m[d-=c?1:2];if(n&&(s*=v),o)for(var y=0;y<r;y++)h[y]*=v;u=L.setArraySize(this.world,8);y=0;for(var g=0,_=0;y<r;y++,g+=3){var x=s+=W=h[y];if(c)(x%=v)<0&&(x+=v),_=0;else{if(x<0){f!=e.BEFORE&&(f=e.BEFORE,t.computeWorldVertices(a,2,4,u,0,2)),this.addBeforePosition(x,u,0,l,g);continue}if(x>v){f!=e.AFTER&&(f=e.AFTER,t.computeWorldVertices(a,p-6,4,u,0,2)),this.addAfterPosition(x-v,u,0,l,g);continue}}for(;;_++){var b=m[_];if(!(x>b)){if(0==_)x/=b;else x=(x-($=m[_-1]))/(b-$);break}}_!=f&&(f=_,c&&_==d?(t.computeWorldVertices(a,p-4,4,u,0,2),t.computeWorldVertices(a,0,4,u,4,2)):t.computeWorldVertices(a,6*_+2,8,u,0,2)),this.addCurvePosition(x,u[0],u[1],u[2],u[3],u[4],u[5],u[6],u[7],l,g,i||y>0&&0==W)}return l}c?(p+=2,u=L.setArraySize(this.world,p),t.computeWorldVertices(a,2,p-4,u,0,2),t.computeWorldVertices(a,0,2,u,p-4,2),u[p-2]=u[0],u[p-1]=u[1]):(d--,p-=4,u=L.setArraySize(this.world,p),t.computeWorldVertices(a,2,p,u,0,2));for(var w=L.setArraySize(this.curves,d),T=0,E=u[0],S=u[1],A=0,I=0,P=0,M=0,C=0,R=0,O=0,D=0,B=0,N=0,k=0,F=0,V=0,X=0,j=(y=0,2);y<d;y++,j+=6)A=u[j],I=u[j+1],P=u[j+2],M=u[j+3],k=2*(O=.1875*(E-2*A+P))+(B=.09375*(3*(A-P)-E+(C=u[j+4]))),F=2*(D=.1875*(S-2*I+M))+(N=.09375*(3*(I-M)-S+(R=u[j+5]))),V=.75*(A-E)+O+.16666667*B,X=.75*(I-S)+D+.16666667*N,T+=Math.sqrt(V*V+X*X),V+=k,X+=F,k+=B,F+=N,T+=Math.sqrt(V*V+X*X),V+=k,X+=F,T+=Math.sqrt(V*V+X*X),V+=k+B,X+=F+N,T+=Math.sqrt(V*V+X*X),w[y]=T,E=C,S=R;if(n&&(s*=T),o)for(y=0;y<r;y++)h[y]*=T;for(var U=this.segments,Y=0,z=(y=0,g=0,_=0,0);y<r;y++,g+=3){var W;x=s+=W=h[y];if(c)(x%=T)<0&&(x+=T),_=0;else{if(x<0){this.addBeforePosition(x,u,0,l,g);continue}if(x>T){this.addAfterPosition(x-T,u,p-4,l,g);continue}}for(;;_++){var q=w[_];if(!(x>q)){if(0==_)x/=q;else x=(x-($=w[_-1]))/(q-$);break}}if(_!=f){f=_;var G=6*_;for(E=u[G],S=u[G+1],A=u[G+2],I=u[G+3],P=u[G+4],M=u[G+5],k=2*(O=.03*(E-2*A+P))+(B=.006*(3*(A-P)-E+(C=u[G+6]))),F=2*(D=.03*(S-2*I+M))+(N=.006*(3*(I-M)-S+(R=u[G+7]))),V=.3*(A-E)+O+.16666667*B,X=.3*(I-S)+D+.16666667*N,Y=Math.sqrt(V*V+X*X),U[0]=Y,G=1;G<8;G++)V+=k,X+=F,k+=B,F+=N,Y+=Math.sqrt(V*V+X*X),U[G]=Y;V+=k,X+=F,Y+=Math.sqrt(V*V+X*X),U[8]=Y,V+=k+B,X+=F+N,Y+=Math.sqrt(V*V+X*X),U[9]=Y,z=0}for(x*=Y;;z++){var H=U[z];if(!(x>H)){var $;if(0==z)x/=H;else x=z+(x-($=U[z-1]))/(H-$);break}}this.addCurvePosition(.1*x,E,S,A,I,P,M,C,R,l,g,i||y>0&&0==W)}return l},e.prototype.addBeforePosition=function(t,e,r,i,n){var o=e[r],a=e[r+1],s=e[r+2]-o,h=e[r+3]-a,l=Math.atan2(h,s);i[n]=o+t*Math.cos(l),i[n+1]=a+t*Math.sin(l),i[n+2]=l},e.prototype.addAfterPosition=function(t,e,r,i,n){var o=e[r+2],a=e[r+3],s=o-e[r],h=a-e[r+1],l=Math.atan2(h,s);i[n]=o+t*Math.cos(l),i[n+1]=a+t*Math.sin(l),i[n+2]=l},e.prototype.addCurvePosition=function(t,e,r,i,n,o,a,s,h,l,u,c){(0==t||isNaN(t))&&(t=1e-4);var p=t*t,d=p*t,f=1-t,m=f*f,v=m*f,y=f*t,g=3*y,_=f*g,x=g*t,b=e*v+i*_+o*x+s*d,w=r*v+n*_+a*x+h*d;l[u]=b,l[u+1]=w,c&&(l[u+2]=Math.atan2(w-(r*m+n*y*2+a*p),b-(e*m+i*y*2+o*p)))},e.prototype.getOrder=function(){return this.data.order},e.NONE=-1,e.BEFORE=-2,e.AFTER=-3,e.epsilon=1e-5,e}(),tr=function(){function t(t,e){if(this.attachmentVertices=new Array,null==t)throw new Error("data cannot be null.");if(null==e)throw new Error("bone cannot be null.");this.data=t,this.bone=e,this.color=new D,this.darkColor=null==t.darkColor?null:new D,this.setToSetupPose(),this.blendMode=this.data.blendMode}return t.prototype.getAttachment=function(){return this.attachment},t.prototype.setAttachment=function(t){this.attachment!=t&&(this.attachment=t,this.attachmentTime=this.bone.skeleton.time,this.attachmentVertices.length=0)},t.prototype.setAttachmentTime=function(t){this.attachmentTime=this.bone.skeleton.time-t},t.prototype.getAttachmentTime=function(){return this.bone.skeleton.time-this.attachmentTime},t.prototype.setToSetupPose=function(){this.color.setFromColor(this.data.color),null!=this.darkColor&&this.darkColor.setFromColor(this.data.darkColor),null==this.data.attachmentName?this.attachment=null:(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName)))},t}(),er=function(){function t(t,e){if(this.rotateMix=0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.temp=new j,null==t)throw new Error("data cannot be null.");if(null==e)throw new Error("skeleton cannot be null.");this.data=t,this.rotateMix=t.rotateMix,this.translateMix=t.translateMix,this.scaleMix=t.scaleMix,this.shearMix=t.shearMix,this.bones=new Array;for(var r=0;r<t.bones.length;r++)this.bones.push(e.findBone(t.bones[r].name));this.target=e.findBone(t.target.name)}return t.prototype.apply=function(){this.update()},t.prototype.update=function(){this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld()},t.prototype.applyAbsoluteWorld=function(){for(var t=this.rotateMix,e=this.translateMix,r=this.scaleMix,i=this.shearMix,n=this.target,o=n.matrix,a=o.a,s=o.c,h=o.b,l=o.d,u=a*l-s*h>0?B.degRad:-B.degRad,c=this.data.offsetRotation*u,p=this.data.offsetShearY*u,d=this.bones,f=0,m=d.length;f<m;f++){var v=d[f],y=!1,g=v.matrix;if(0!=t){var _=g.a,x=g.c,b=g.b,w=g.d;(P=Math.atan2(h,a)-Math.atan2(b,_)+c)>B.PI?P-=B.PI2:P<-B.PI&&(P+=B.PI2),P*=t;var T=Math.cos(P),E=Math.sin(P);g.a=T*_-E*b,g.c=T*x-E*w,g.b=E*_+T*b,g.d=E*x+T*w,y=!0}if(0!=e){var S=this.temp;n.localToWorld(S.set(this.data.offsetX,this.data.offsetY)),g.tx+=(S.x-g.tx)*e,g.ty+=(S.y-g.ty)*e,y=!0}if(r>0){var A=Math.sqrt(g.a*g.a+g.b*g.b),I=Math.sqrt(a*a+h*h);A>1e-5&&(A=(A+(I-A+this.data.offsetScaleX)*r)/A),g.a*=A,g.b*=A,A=Math.sqrt(g.c*g.c+g.d*g.d),I=Math.sqrt(s*s+l*l),A>1e-5&&(A=(A+(I-A+this.data.offsetScaleY)*r)/A),g.c*=A,g.d*=A,y=!0}if(i>0){x=g.c,w=g.d;var P,M=Math.atan2(w,x);(P=Math.atan2(l,s)-Math.atan2(h,a)-(M-Math.atan2(g.b,g.a)))>B.PI?P-=B.PI2:P<-B.PI&&(P+=B.PI2),P=M+(P+p)*i;A=Math.sqrt(x*x+w*w);g.c=Math.cos(P)*A,g.d=Math.sin(P)*A,y=!0}y&&(v.appliedValid=!1)}},t.prototype.applyRelativeWorld=function(){for(var t=this.rotateMix,e=this.translateMix,r=this.scaleMix,i=this.shearMix,n=this.target,o=n.matrix,a=o.a,s=o.c,h=o.b,l=o.d,u=a*l-s*h>0?B.degRad:-B.degRad,c=this.data.offsetRotation*u,p=this.data.offsetShearY*u,d=this.bones,f=0,m=d.length;f<m;f++){var v=d[f],y=!1,g=v.matrix;if(0!=t){var _=g.a,x=g.c,b=g.b,w=g.d;(I=Math.atan2(h,a)+c)>B.PI?I-=B.PI2:I<-B.PI&&(I+=B.PI2),I*=t;var T=Math.cos(I),E=Math.sin(I);g.a=T*_-E*b,g.c=T*x-E*w,g.b=E*_+T*b,g.d=E*x+T*w,y=!0}if(0!=e){var S=this.temp;n.localToWorld(S.set(this.data.offsetX,this.data.offsetY)),g.tx+=S.x*e,g.ty+=S.y*e,y=!0}if(r>0){var A=(Math.sqrt(a*a+h*h)-1+this.data.offsetScaleX)*r+1;g.a*=A,g.b*=A,A=(Math.sqrt(s*s+l*l)-1+this.data.offsetScaleY)*r+1,g.c*=A,g.d*=A,y=!0}if(i>0){var I;(I=Math.atan2(l,s)-Math.atan2(h,a))>B.PI?I-=B.PI2:I<-B.PI&&(I+=B.PI2);x=g.c,w=g.d;I=Math.atan2(w,x)+(I-B.PI/2+p)*i;A=Math.sqrt(x*x+w*w);g.c=Math.cos(I)*A,g.d=Math.sin(I)*A,y=!0}y&&(v.appliedValid=!1)}},t.prototype.applyAbsoluteLocal=function(){var t=this.rotateMix,e=this.translateMix,r=this.scaleMix,i=this.shearMix,n=this.target;n.appliedValid||n.updateAppliedTransform();for(var o=this.bones,a=0,s=o.length;a<s;a++){var h=o[a];h.appliedValid||h.updateAppliedTransform();var l=h.arotation;if(0!=t){var u=n.arotation-l+this.data.offsetRotation;l+=(u-=360*(16384-(16384.499999999996-u/360|0)))*t}var c=h.ax,p=h.ay;0!=e&&(c+=(n.ax-c+this.data.offsetX)*e,p+=(n.ay-p+this.data.offsetY)*e);var d=h.ascaleX,f=h.ascaleY;r>0&&(d>1e-5&&(d=(d+(n.ascaleX-d+this.data.offsetScaleX)*r)/d),f>1e-5&&(f=(f+(n.ascaleY-f+this.data.offsetScaleY)*r)/f));var m=h.ashearY;if(i>0){u=n.ashearY-m+this.data.offsetShearY;u-=360*(16384-(16384.499999999996-u/360|0)),h.shearY+=u*i}h.updateWorldTransformWith(c,p,l,d,f,h.ashearX,m)}},t.prototype.applyRelativeLocal=function(){var t=this.rotateMix,e=this.translateMix,r=this.scaleMix,i=this.shearMix,n=this.target;n.appliedValid||n.updateAppliedTransform();for(var o=this.bones,a=0,s=o.length;a<s;a++){var h=o[a];h.appliedValid||h.updateAppliedTransform();var l=h.arotation;0!=t&&(l+=(n.arotation+this.data.offsetRotation)*t);var u=h.ax,c=h.ay;0!=e&&(u+=(n.ax+this.data.offsetX)*e,c+=(n.ay+this.data.offsetY)*e);var p=h.ascaleX,d=h.ascaleY;r>0&&(p>1e-5&&(p*=(n.ascaleX-1+this.data.offsetScaleX)*r+1),d>1e-5&&(d*=(n.ascaleY-1+this.data.offsetScaleY)*r+1));var f=h.ashearY;i>0&&(f+=(n.ashearY+this.data.offsetShearY)*i),h.updateWorldTransformWith(u,c,l,p,d,h.ashearX,f)}},t.prototype.getOrder=function(){return this.data.order},t}(),rr=function(){function t(t){if(this._updateCache=new Array,this.updateCacheReset=new Array,this.time=0,this.scaleX=1,this.scaleY=1,this.x=0,this.y=0,null==t)throw new Error("data cannot be null.");this.data=t,this.bones=new Array;for(var e=0;e<t.bones.length;e++){var r=t.bones[e],i=void 0;if(null==r.parent)i=new qe(r,this,null);else{var n=this.bones[r.parent.index];i=new qe(r,this,n),n.children.push(i)}this.bones.push(i)}this.slots=new Array,this.drawOrder=new Array;for(e=0;e<t.slots.length;e++){var o=t.slots[e],a=(i=this.bones[o.boneData.index],new tr(o,i));this.slots.push(a),this.drawOrder.push(a)}this.ikConstraints=new Array;for(e=0;e<t.ikConstraints.length;e++){var s=t.ikConstraints[e];this.ikConstraints.push(new Je(s,this))}this.transformConstraints=new Array;for(e=0;e<t.transformConstraints.length;e++){var h=t.transformConstraints[e];this.transformConstraints.push(new er(h,this))}this.pathConstraints=new Array;for(e=0;e<t.pathConstraints.length;e++){var l=t.pathConstraints[e];this.pathConstraints.push(new Ke(l,this))}this.color=new D(1,1,1,1),this.updateCache()}return t.prototype.updateCache=function(){this._updateCache.length=0,this.updateCacheReset.length=0;for(var t=this.bones,e=0,r=t.length;e<r;e++)t[e].sorted=!1;var i=this.ikConstraints,n=this.transformConstraints,o=this.pathConstraints,a=i.length,s=n.length,h=o.length,l=a+s+h;t:for(e=0;e<l;e++){for(var u=0;u<a;u++){if((c=i[u]).data.order==e){this.sortIkConstraint(c);continue t}}for(u=0;u<s;u++){if((c=n[u]).data.order==e){this.sortTransformConstraint(c);continue t}}for(u=0;u<h;u++){var c;if((c=o[u]).data.order==e){this.sortPathConstraint(c);continue t}}}for(e=0,r=t.length;e<r;e++)this.sortBone(t[e])},t.prototype.sortIkConstraint=function(t){var e=t.target;this.sortBone(e);var r=t.bones,i=r[0];if(this.sortBone(i),r.length>1){var n=r[r.length-1];this._updateCache.indexOf(n)>-1||this.updateCacheReset.push(n)}this._updateCache.push(t),this.sortReset(i.children),r[r.length-1].sorted=!0},t.prototype.sortPathConstraint=function(t){var e=t.target,r=e.data.index,i=e.bone;null!=this.skin&&this.sortPathConstraintAttachment(this.skin,r,i),null!=this.data.defaultSkin&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,r,i);for(var n=0,o=this.data.skins.length;n<o;n++)this.sortPathConstraintAttachment(this.data.skins[n],r,i);var a=e.getAttachment();a instanceof me&&this.sortPathConstraintAttachmentWith(a,i);var s=t.bones,h=s.length;for(n=0;n<h;n++)this.sortBone(s[n]);this._updateCache.push(t);for(n=0;n<h;n++)this.sortReset(s[n].children);for(n=0;n<h;n++)s[n].sorted=!0},t.prototype.sortTransformConstraint=function(t){this.sortBone(t.target);var e=t.bones,r=e.length;if(t.data.local)for(var i=0;i<r;i++){var n=e[i];this.sortBone(n.parent),this._updateCache.indexOf(n)>-1||this.updateCacheReset.push(n)}else for(i=0;i<r;i++)this.sortBone(e[i]);this._updateCache.push(t);for(var o=0;o<r;o++)this.sortReset(e[o].children);for(o=0;o<r;o++)e[o].sorted=!0},t.prototype.sortPathConstraintAttachment=function(t,e,r){var i=t.attachments[e];if(i)for(var n in i)this.sortPathConstraintAttachmentWith(i[n],r)},t.prototype.sortPathConstraintAttachmentWith=function(t,e){if(t instanceof me){var r=t.bones;if(null==r)this.sortBone(e);else for(var i=this.bones,n=0;n<r.length;)for(var o=r[n++],a=n+o;n<a;n++){var s=r[n];this.sortBone(i[s])}}},t.prototype.sortBone=function(t){if(!t.sorted){var e=t.parent;null!=e&&this.sortBone(e),t.sorted=!0,this._updateCache.push(t)}},t.prototype.sortReset=function(t){for(var e=0,r=t.length;e<r;e++){var i=t[e];i.sorted&&this.sortReset(i.children),i.sorted=!1}},t.prototype.updateWorldTransform=function(){for(var t=this.updateCacheReset,e=0,r=t.length;e<r;e++){var i=t[e];i.ax=i.x,i.ay=i.y,i.arotation=i.rotation,i.ascaleX=i.scaleX,i.ascaleY=i.scaleY,i.ashearX=i.shearX,i.ashearY=i.shearY,i.appliedValid=!0}var n=this._updateCache;for(e=0,r=n.length;e<r;e++)n[e].update()},t.prototype.setToSetupPose=function(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()},t.prototype.setBonesToSetupPose=function(){for(var t=this.bones,e=0,r=t.length;e<r;e++)t[e].setToSetupPose();var i=this.ikConstraints;for(e=0,r=i.length;e<r;e++){(s=i[e]).bendDirection=s.data.bendDirection,s.mix=s.data.mix}var n=this.transformConstraints;for(e=0,r=n.length;e<r;e++){var o=(s=n[e]).data;s.rotateMix=o.rotateMix,s.translateMix=o.translateMix,s.scaleMix=o.scaleMix,s.shearMix=o.shearMix}var a=this.pathConstraints;for(e=0,r=a.length;e<r;e++){var s;o=(s=a[e]).data;s.position=o.position,s.spacing=o.spacing,s.rotateMix=o.rotateMix,s.translateMix=o.translateMix}},t.prototype.setSlotsToSetupPose=function(){var t=this.slots;L.arrayCopy(t,0,this.drawOrder,0,t.length);for(var e=0,r=t.length;e<r;e++)t[e].setToSetupPose()},t.prototype.getRootBone=function(){return 0==this.bones.length?null:this.bones[0]},t.prototype.findBone=function(t){if(null==t)throw new Error("boneName cannot be null.");for(var e=this.bones,r=0,i=e.length;r<i;r++){var n=e[r];if(n.data.name==t)return n}return null},t.prototype.findBoneIndex=function(t){if(null==t)throw new Error("boneName cannot be null.");for(var e=this.bones,r=0,i=e.length;r<i;r++)if(e[r].data.name==t)return r;return-1},t.prototype.findSlot=function(t){if(null==t)throw new Error("slotName cannot be null.");for(var e=this.slots,r=0,i=e.length;r<i;r++){var n=e[r];if(n.data.name==t)return n}return null},t.prototype.findSlotIndex=function(t){if(null==t)throw new Error("slotName cannot be null.");for(var e=this.slots,r=0,i=e.length;r<i;r++)if(e[r].data.name==t)return r;return-1},t.prototype.setSkinByName=function(t){var e=this.data.findSkin(t);if(null==e)throw new Error("Skin not found: "+t);this.setSkin(e)},t.prototype.setSkin=function(t){if(null!=t)if(null!=this.skin)t.attachAll(this,this.skin);else for(var e=this.slots,r=0,i=e.length;r<i;r++){var n=e[r],o=n.data.attachmentName;if(null!=o){var a=t.getAttachment(r,o);null!=a&&n.setAttachment(a)}}this.skin=t},t.prototype.getAttachmentByName=function(t,e){return this.getAttachment(this.data.findSlotIndex(t),e)},t.prototype.getAttachment=function(t,e){if(null==e)throw new Error("attachmentName cannot be null.");if(null!=this.skin){var r=this.skin.getAttachment(t,e);if(null!=r)return r}return null!=this.data.defaultSkin?this.data.defaultSkin.getAttachment(t,e):null},t.prototype.setAttachment=function(t,e){if(null==t)throw new Error("slotName cannot be null.");for(var r=this.slots,i=0,n=r.length;i<n;i++){var o=r[i];if(o.data.name==t){var a=null;if(null!=e&&null==(a=this.getAttachment(i,e)))throw new Error("Attachment not found: "+e+", for slot: "+t);return void o.setAttachment(a)}}throw new Error("Slot not found: "+t)},t.prototype.findIkConstraint=function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.ikConstraints,r=0,i=e.length;r<i;r++){var n=e[r];if(n.data.name==t)return n}return null},t.prototype.findTransformConstraint=function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.transformConstraints,r=0,i=e.length;r<i;r++){var n=e[r];if(n.data.name==t)return n}return null},t.prototype.findPathConstraint=function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.pathConstraints,r=0,i=e.length;r<i;r++){var n=e[r];if(n.data.name==t)return n}return null},t.prototype.getBounds=function(t,e,r){if(null==t)throw new Error("offset cannot be null.");if(null==e)throw new Error("size cannot be null.");for(var i=this.drawOrder,n=Number.POSITIVE_INFINITY,o=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY,s=Number.NEGATIVE_INFINITY,h=0,l=i.length;h<l;h++){var u=i[h],c=0,p=null,d=u.getAttachment();if(d instanceof ye)c=8,p=L.setArraySize(r,c,0),d.computeWorldVertices(u.bone,p,0,2);else if(d instanceof fe){var f=d;c=f.worldVerticesLength,p=L.setArraySize(r,c,0),f.computeWorldVertices(u,0,c,p,0,2)}if(null!=p)for(var m=0,v=p.length;m<v;m+=2){var y=p[m],g=p[m+1];n=Math.min(n,y),o=Math.min(o,g),a=Math.max(a,y),s=Math.max(s,g)}}t.set(n,o),e.set(a-n,s-o)},t.prototype.update=function(t){this.time+=t},Object.defineProperty(t.prototype,"flipX",{get:function(){return-1==this.scaleX},set:function(e){t.deprecatedWarning1||(t.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleX=e?1:-1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"flipY",{get:function(){return-1==this.scaleY},set:function(e){t.deprecatedWarning1||(t.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleY=e?1:-1},enumerable:!1,configurable:!0}),t.deprecatedWarning1=!1,t}(),ir=function(){function t(){this.minX=0,this.minY=0,this.maxX=0,this.maxY=0,this.boundingBoxes=new Array,this.polygons=new Array,this.polygonPool=new X((function(){return L.newFloatArray(16)}))}return t.prototype.update=function(t,e){if(null==t)throw new Error("skeleton cannot be null.");var r=this.boundingBoxes,i=this.polygons,n=this.polygonPool,o=t.slots,a=o.length;r.length=0,n.freeAll(i),i.length=0;for(var s=0;s<a;s++){var h=o[s],l=h.getAttachment();if(l instanceof pe){var u=l;r.push(u);var c=n.obtain();c.length!=u.worldVerticesLength&&(c=L.newFloatArray(u.worldVerticesLength)),i.push(c),u.computeWorldVertices(h,0,u.worldVerticesLength,c,0,2)}}e?this.aabbCompute():(this.minX=Number.POSITIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY)},t.prototype.aabbCompute=function(){for(var t=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY,i=Number.NEGATIVE_INFINITY,n=this.polygons,o=0,a=n.length;o<a;o++)for(var s=n[o],h=s,l=0,u=s.length;l<u;l+=2){var c=h[l],p=h[l+1];t=Math.min(t,c),e=Math.min(e,p),r=Math.max(r,c),i=Math.max(i,p)}this.minX=t,this.minY=e,this.maxX=r,this.maxY=i},t.prototype.aabbContainsPoint=function(t,e){return t>=this.minX&&t<=this.maxX&&e>=this.minY&&e<=this.maxY},t.prototype.aabbIntersectsSegment=function(t,e,r,i){var n=this.minX,o=this.minY,a=this.maxX,s=this.maxY;if(t<=n&&r<=n||e<=o&&i<=o||t>=a&&r>=a||e>=s&&i>=s)return!1;var h=(i-e)/(r-t),l=h*(n-t)+e;if(l>o&&l<s)return!0;if((l=h*(a-t)+e)>o&&l<s)return!0;var u=(o-e)/h+t;return u>n&&u<a||(u=(s-e)/h+t)>n&&u<a},t.prototype.aabbIntersectsSkeleton=function(t){return this.minX<t.maxX&&this.maxX>t.minX&&this.minY<t.maxY&&this.maxY>t.minY},t.prototype.containsPoint=function(t,e){for(var r=this.polygons,i=0,n=r.length;i<n;i++)if(this.containsPointPolygon(r[i],t,e))return this.boundingBoxes[i];return null},t.prototype.containsPointPolygon=function(t,e,r){for(var i=t,n=t.length,o=n-2,a=!1,s=0;s<n;s+=2){var h=i[s+1],l=i[o+1];if(h<r&&l>=r||l<r&&h>=r){var u=i[s];u+(r-h)/(l-h)*(i[o]-u)<e&&(a=!a)}o=s}return a},t.prototype.intersectsSegment=function(t,e,r,i){for(var n=this.polygons,o=0,a=n.length;o<a;o++)if(this.intersectsSegmentPolygon(n[o],t,e,r,i))return this.boundingBoxes[o];return null},t.prototype.intersectsSegmentPolygon=function(t,e,r,i,n){for(var o=t,a=t.length,s=e-i,h=r-n,l=e*n-r*i,u=o[a-2],c=o[a-1],p=0;p<a;p+=2){var d=o[p],f=o[p+1],m=u*f-c*d,v=u-d,y=c-f,g=s*y-h*v,_=(l*v-s*m)/g;if((_>=u&&_<=d||_>=d&&_<=u)&&(_>=e&&_<=i||_>=i&&_<=e)){var x=(l*y-h*m)/g;if((x>=c&&x<=f||x>=f&&x<=c)&&(x>=r&&x<=n||x>=n&&x<=r))return!0}u=d,c=f}return!1},t.prototype.getPolygon=function(t){if(null==t)throw new Error("boundingBox cannot be null.");var e=this.boundingBoxes.indexOf(t);return-1==e?null:this.polygons[e]},t.prototype.getWidth=function(){return this.maxX-this.minX},t.prototype.getHeight=function(){return this.maxY-this.minY},t}(),nr=function(){function t(){this.bones=new Array,this.slots=new Array,this.skins=new Array,this.events=new Array,this.animations=new Array,this.ikConstraints=new Array,this.transformConstraints=new Array,this.pathConstraints=new Array,this.fps=0}return t.prototype.findBone=function(t){if(null==t)throw new Error("boneName cannot be null.");for(var e=this.bones,r=0,i=e.length;r<i;r++){var n=e[r];if(n.name==t)return n}return null},t.prototype.findBoneIndex=function(t){if(null==t)throw new Error("boneName cannot be null.");for(var e=this.bones,r=0,i=e.length;r<i;r++)if(e[r].name==t)return r;return-1},t.prototype.findSlot=function(t){if(null==t)throw new Error("slotName cannot be null.");for(var e=this.slots,r=0,i=e.length;r<i;r++){var n=e[r];if(n.name==t)return n}return null},t.prototype.findSlotIndex=function(t){if(null==t)throw new Error("slotName cannot be null.");for(var e=this.slots,r=0,i=e.length;r<i;r++)if(e[r].name==t)return r;return-1},t.prototype.findSkin=function(t){if(null==t)throw new Error("skinName cannot be null.");for(var e=this.skins,r=0,i=e.length;r<i;r++){var n=e[r];if(n.name==t)return n}return null},t.prototype.findEvent=function(t){if(null==t)throw new Error("eventDataName cannot be null.");for(var e=this.events,r=0,i=e.length;r<i;r++){var n=e[r];if(n.name==t)return n}return null},t.prototype.findAnimation=function(t){if(null==t)throw new Error("animationName cannot be null.");for(var e=this.animations,r=0,i=e.length;r<i;r++){var n=e[r];if(n.name==t)return n}return null},t.prototype.findIkConstraint=function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.ikConstraints,r=0,i=e.length;r<i;r++){var n=e[r];if(n.name==t)return n}return null},t.prototype.findTransformConstraint=function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.transformConstraints,r=0,i=e.length;r<i;r++){var n=e[r];if(n.name==t)return n}return null},t.prototype.findPathConstraint=function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.pathConstraints,r=0,i=e.length;r<i;r++){var n=e[r];if(n.name==t)return n}return null},t.prototype.findPathConstraintIndex=function(t){if(null==t)throw new Error("pathConstraintName cannot be null.");for(var e=this.pathConstraints,r=0,i=e.length;r<i;r++)if(e[r].name==t)return r;return-1},t}(),or=function(t,e,r){if(this.color=new D(1,1,1,1),t<0)throw new Error("index must be >= 0.");if(null==e)throw new Error("name cannot be null.");if(null==r)throw new Error("boneData cannot be null.");this.index=t,this.name=e,this.boneData=r},ar=function(t){if(this.order=0,this.bones=new Array,this.rotateMix=0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.offsetRotation=0,this.offsetX=0,this.offsetY=0,this.offsetScaleX=0,this.offsetScaleY=0,this.offsetShearY=0,this.relative=!1,this.local=!1,null==t)throw new Error("name cannot be null.");this.name=t},sr=function(){function t(t){if(this.attachments=new Array,null==t)throw new Error("name cannot be null.");this.name=t}return t.prototype.addAttachment=function(t,e,r){if(null==r)throw new Error("attachment cannot be null.");var i=this.attachments;t>=i.length&&(i.length=t+1),i[t]||(i[t]={}),i[t][e]=r},t.prototype.getAttachment=function(t,e){var r=this.attachments[t];return r?r[e]:null},t.prototype.attachAll=function(t,e){for(var r=0,i=0;i<t.slots.length;i++){var n=t.slots[i],o=n.getAttachment();if(o&&r<e.attachments.length){var a=e.attachments[r];for(var s in a){if(o==a[s]){var h=this.getAttachment(r,s);null!=h&&n.setAttachment(h);break}}}r++}},t}(),hr=function(){function e(t){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=t}return e.prototype.readSkeletonData=function(r){var i=this.scale,n=new nr,o="string"==typeof r?JSON.parse(r):r,a=o.skeleton;if(null!=a&&(n.hash=a.hash,n.version=a.spine,n.width=a.width,n.height=a.height,n.fps=a.fps,n.imagesPath=a.images),o.bones)for(var s=0;s<o.bones.length;s++){var h=o.bones[s],l=null,u=this.getValue(h,"parent",null);if(null!=u&&null==(l=n.findBone(u)))throw new Error("Parent bone not found: "+u);(f=new Ge(n.bones.length,h.name,l)).length=this.getValue(h,"length",0)*i,f.x=this.getValue(h,"x",0)*i,f.y=this.getValue(h,"y",0)*i,f.rotation=this.getValue(h,"rotation",0),f.scaleX=this.getValue(h,"scaleX",1),f.scaleY=this.getValue(h,"scaleY",1),f.shearX=this.getValue(h,"shearX",0),f.shearY=this.getValue(h,"shearY",0),f.transformMode=e.transformModeFromString(this.getValue(h,"transform","normal")),n.bones.push(f)}if(o.slots)for(s=0;s<o.slots.length;s++){var c=(S=o.slots[s]).name,p=S.bone,d=n.findBone(p);if(null==d)throw new Error("Slot bone not found: "+p);var f=new or(n.slots.length,c,d),m=this.getValue(S,"color",null);null!=m&&f.color.setFromString(m);var v=this.getValue(S,"dark",null);null!=v&&(f.darkColor=new D(1,1,1,1),f.darkColor.setFromString(v)),f.attachmentName=this.getValue(S,"attachment",null),f.blendMode=e.blendModeFromString(this.getValue(S,"blend","normal")),n.slots.push(f)}if(o.ik)for(s=0;s<o.ik.length;s++){var y=o.ik[s];(f=new Ze(y.name)).order=this.getValue(y,"order",0);for(var g=0;g<y.bones.length;g++){p=y.bones[g];if(null==(x=n.findBone(p)))throw new Error("IK bone not found: "+p);f.bones.push(x)}var _=y.target;if(f.target=n.findBone(_),null==f.target)throw new Error("IK target bone not found: "+_);f.bendDirection=this.getValue(y,"bendPositive",!0)?1:-1,f.mix=this.getValue(y,"mix",1),n.ikConstraints.push(f)}if(o.transform)for(s=0;s<o.transform.length;s++){y=o.transform[s];(f=new ar(y.name)).order=this.getValue(y,"order",0);for(g=0;g<y.bones.length;g++){p=y.bones[g];if(null==(x=n.findBone(p)))throw new Error("Transform constraint bone not found: "+p);f.bones.push(x)}_=y.target;if(f.target=n.findBone(_),null==f.target)throw new Error("Transform constraint target bone not found: "+_);f.local=this.getValue(y,"local",!1),f.relative=this.getValue(y,"relative",!1),f.offsetRotation=this.getValue(y,"rotation",0),f.offsetX=this.getValue(y,"x",0)*i,f.offsetY=this.getValue(y,"y",0)*i,f.offsetScaleX=this.getValue(y,"scaleX",0),f.offsetScaleY=this.getValue(y,"scaleY",0),f.offsetShearY=this.getValue(y,"shearY",0),f.rotateMix=this.getValue(y,"rotateMix",1),f.translateMix=this.getValue(y,"translateMix",1),f.scaleMix=this.getValue(y,"scaleMix",1),f.shearMix=this.getValue(y,"shearMix",1),n.transformConstraints.push(f)}if(o.path)for(s=0;s<o.path.length;s++){y=o.path[s];(f=new Qe(y.name)).order=this.getValue(y,"order",0);for(g=0;g<y.bones.length;g++){var x;p=y.bones[g];if(null==(x=n.findBone(p)))throw new Error("Transform constraint bone not found: "+p);f.bones.push(x)}_=y.target;if(f.target=n.findSlot(_),null==f.target)throw new Error("Path target slot not found: "+_);f.positionMode=e.positionModeFromString(this.getValue(y,"positionMode","percent")),f.spacingMode=e.spacingModeFromString(this.getValue(y,"spacingMode","length")),f.rotateMode=e.rotateModeFromString(this.getValue(y,"rotateMode","tangent")),f.offsetRotation=this.getValue(y,"rotation",0),f.position=this.getValue(y,"position",0),f.positionMode==t.PositionMode.Fixed&&(f.position*=i),f.spacing=this.getValue(y,"spacing",0),f.spacingMode!=Ue.Length&&f.spacingMode!=Ue.Fixed||(f.spacing*=i),f.rotateMix=this.getValue(y,"rotateMix",1),f.translateMix=this.getValue(y,"translateMix",1),n.pathConstraints.push(f)}if(o.skins)for(var b in o.skins){var w=o.skins[b],T=new sr(b);for(var c in w){var E=n.findSlotIndex(c);if(-1==E)throw new Error("Slot not found: "+c);var S=w[c];for(var A in S){var I=this.readAttachment(S[A],T,E,A,n);null!=I&&T.addAttachment(E,A,I)}}n.skins.push(T),"default"==T.name&&(n.defaultSkin=T)}s=0;for(var P=this.linkedMeshes.length;s<P;s++){var M=this.linkedMeshes[s];if(null==(T=null==M.skin?n.defaultSkin:n.findSkin(M.skin)))throw new Error("Skin not found: "+M.skin);var C=T.getAttachment(M.slotIndex,M.parent);if(null==C)throw new Error("Parent mesh not found: "+M.parent);M.mesh.setParentMesh(C)}if(this.linkedMeshes.length=0,o.events)for(var R in o.events){var O=o.events[R];(f=new $e(R)).intValue=this.getValue(O,"int",0),f.floatValue=this.getValue(O,"float",0),f.stringValue=this.getValue(O,"string",""),f.audioPath=this.getValue(O,"audio",null),null!=f.audioPath&&(f.volume=this.getValue(O,"volume",1),f.balance=this.getValue(O,"balance",0)),n.events.push(f)}if(o.animations)for(var B in o.animations){var N=o.animations[B];this.readAnimation(N,B,n)}return n},e.prototype.readAttachment=function(t,e,r,i,n){var o=this.scale;switch(i=this.getValue(t,"name",i),this.getValue(t,"type","region")){case"region":var a=this.getValue(t,"path",i),s=this.attachmentLoader.newRegionAttachment(e,i,a);return null==s?null:(s.path=a,s.x=this.getValue(t,"x",0)*o,s.y=this.getValue(t,"y",0)*o,s.scaleX=this.getValue(t,"scaleX",1),s.scaleY=this.getValue(t,"scaleY",1),s.rotation=this.getValue(t,"rotation",0),s.width=t.width*o,s.height=t.height*o,null!=(_=this.getValue(t,"color",null))&&s.color.setFromString(_),s);case"boundingbox":var h=this.attachmentLoader.newBoundingBoxAttachment(e,i);return null==h?null:(this.readVertices(t,h,t.vertexCount<<1),null!=(_=this.getValue(t,"color",null))&&h.color.setFromString(_),h);case"mesh":case"linkedmesh":a=this.getValue(t,"path",i);var l=this.attachmentLoader.newMeshAttachment(e,i,a);if(null==l)return null;l.path=a,null!=(_=this.getValue(t,"color",null))&&l.color.setFromString(_);var u=this.getValue(t,"parent",null);if(null!=u)return l.inheritDeform=this.getValue(t,"deform",!0),this.linkedMeshes.push(new lr(l,this.getValue(t,"skin",null),r,u)),l;var c=t.uvs;return this.readVertices(t,l,c.length),l.triangles=t.triangles,l.regionUVs=new Float32Array(c),l.hullLength=2*this.getValue(t,"hull",0),l;case"path":if(null==(a=this.attachmentLoader.newPathAttachment(e,i)))return null;a.closed=this.getValue(t,"closed",!1),a.constantSpeed=this.getValue(t,"constantSpeed",!0);var p=t.vertexCount;this.readVertices(t,a,p<<1);for(var d=L.newArray(p/3,0),f=0;f<t.lengths.length;f++)d[f]=t.lengths[f]*o;return a.lengths=d,null!=(_=this.getValue(t,"color",null))&&a.color.setFromString(_),a;case"point":var m=this.attachmentLoader.newPointAttachment(e,i);return null==m?null:(m.x=this.getValue(t,"x",0)*o,m.y=this.getValue(t,"y",0)*o,m.rotation=this.getValue(t,"rotation",0),null!=(_=this.getValue(t,"color",null))&&m.color.setFromString(_),m);case"clipping":var v=this.attachmentLoader.newClippingAttachment(e,i);if(null==v)return null;var y=this.getValue(t,"end",null);if(null!=y){var g=n.findSlot(y);if(null==g)throw new Error("Clipping end slot not found: "+y);v.endSlot=g}var _;p=t.vertexCount;return this.readVertices(t,v,p<<1),null!=(_=this.getValue(t,"color",null))&&v.color.setFromString(_),v}return null},e.prototype.readVertices=function(t,e,r){var i=this.scale;e.worldVerticesLength=r;var n=t.vertices;if(r!=n.length){var o=new Array,a=new Array;for(u=0,c=n.length;u<c;){var s=n[u++];a.push(s);for(var h=u+4*s;u<h;u+=4)a.push(n[u]),o.push(n[u+1]*i),o.push(n[u+2]*i),o.push(n[u+3])}e.bones=a,e.vertices=L.toFloatArray(o)}else{var l=L.toFloatArray(n);if(1!=i)for(var u=0,c=n.length;u<c;u++)l[u]*=i;e.vertices=l}},e.prototype.readAnimation=function(e,r,i){var n=this.scale,o=new Array,a=0;if(e.slots)for(var s in e.slots){var h=e.slots[s];if(-1==(Q=i.findSlotIndex(s)))throw new Error("Slot not found: "+s);for(var l in h){var u=h[l];if("attachment"==l){(x=new Me(u.length)).slotIndex=Q;for(var c=0,p=0;p<u.length;p++){var d=u[p];x.setFrame(c++,d.time,d.name)}o.push(x),a=Math.max(a,x.frames[x.getFrameCount()-1])}else if("color"==l){(x=new Ie(u.length)).slotIndex=Q;for(c=0,p=0;p<u.length;p++){d=u[p];var f=new D;f.setFromString(d.color||"ffffffff"),x.setFrame(c,d.time,f.r,f.g,f.b,f.a),this.readCurve(d,x,c),c++}o.push(x),a=Math.max(a,x.frames[(x.getFrameCount()-1)*Ie.ENTRIES])}else{if("twoColor"!=l)throw new Error("Invalid timeline type for a slot: "+l+" ("+s+")");(x=new Pe(u.length)).slotIndex=Q;for(c=0,p=0;p<u.length;p++){d=u[p];var m=new D,v=new D;m.setFromString(d.light),v.setFromString(d.dark),x.setFrame(c,d.time,m.r,m.g,m.b,m.a,v.r,v.g,v.b),this.readCurve(d,x,c),c++}o.push(x),a=Math.max(a,x.frames[(x.getFrameCount()-1)*Pe.ENTRIES])}}}if(e.bones)for(var y in e.bones){var g=e.bones[y],_=i.findBoneIndex(y);if(-1==_)throw new Error("Bone not found: "+y);for(var l in g){u=g[l];if("rotate"===l){(x=new Te(u.length)).boneIndex=_;for(c=0,p=0;p<u.length;p++){d=u[p];x.setFrame(c,d.time,d.angle),this.readCurve(d,x,c),c++}o.push(x),a=Math.max(a,x.frames[(x.getFrameCount()-1)*Te.ENTRIES])}else{if("translate"!==l&&"scale"!==l&&"shear"!==l)throw new Error("Invalid timeline type for a bone: "+l+" ("+y+")");var x=null,b=1;"scale"===l?x=new Se(u.length):"shear"===l?x=new Ae(u.length):(x=new Ee(u.length),b=n),x.boneIndex=_;for(c=0,p=0;p<u.length;p++){d=u[p];var w=this.getValue(d,"x",0),T=this.getValue(d,"y",0);x.setFrame(c,d.time,w*b,T*b),this.readCurve(d,x,c),c++}o.push(x),a=Math.max(a,x.frames[(x.getFrameCount()-1)*Ee.ENTRIES])}}}if(e.ik)for(var E in e.ik){var S=e.ik[E],A=i.findIkConstraint(E);(x=new Be(S.length)).ikConstraintIndex=i.ikConstraints.indexOf(A);for(c=0,p=0;p<S.length;p++){d=S[p];x.setFrame(c,d.time,this.getValue(d,"mix",1),this.getValue(d,"bendPositive",!0)?1:-1,this.getValue(d,"compress",!1),this.getValue(d,"stretch",!1)),this.readCurve(d,x,c),c++}o.push(x),a=Math.max(a,x.frames[(x.getFrameCount()-1)*Be.ENTRIES])}if(e.transform)for(var E in e.transform){S=e.transform[E],A=i.findTransformConstraint(E);(x=new Ne(S.length)).transformConstraintIndex=i.transformConstraints.indexOf(A);for(c=0,p=0;p<S.length;p++){d=S[p];x.setFrame(c,d.time,this.getValue(d,"rotateMix",1),this.getValue(d,"translateMix",1),this.getValue(d,"scaleMix",1),this.getValue(d,"shearMix",1)),this.readCurve(d,x,c),c++}o.push(x),a=Math.max(a,x.frames[(x.getFrameCount()-1)*Ne.ENTRIES])}if(e.paths)for(var E in e.paths){S=e.paths[E];var I=i.findPathConstraintIndex(E);if(-1==I)throw new Error("Path constraint not found: "+E);var P=i.pathConstraints[I];for(var l in S){u=S[l];if("position"===l||"spacing"===l){x=null,b=1;"spacing"===l?(x=new Fe(u.length),P.spacingMode!=Ue.Length&&P.spacingMode!=Ue.Fixed||(b=n)):(x=new ke(u.length),P.positionMode==t.PositionMode.Fixed&&(b=n)),x.pathConstraintIndex=I;for(c=0,p=0;p<u.length;p++){d=u[p];x.setFrame(c,d.time,this.getValue(d,l,0)*b),this.readCurve(d,x,c),c++}o.push(x),a=Math.max(a,x.frames[(x.getFrameCount()-1)*ke.ENTRIES])}else if("mix"===l){(x=new Le(u.length)).pathConstraintIndex=I;for(c=0,p=0;p<u.length;p++){d=u[p];x.setFrame(c,d.time,this.getValue(d,"rotateMix",1),this.getValue(d,"translateMix",1)),this.readCurve(d,x,c),c++}o.push(x),a=Math.max(a,x.frames[(x.getFrameCount()-1)*Le.ENTRIES])}}}if(e.deform)for(var M in e.deform){var C=e.deform[M],R=i.findSkin(M);if(null!=R)for(var s in C){h=C[s];if(-1==(Q=i.findSlotIndex(s)))throw new Error("Slot not found: "+h.name);for(var l in h){u=h[l];var O=R.getAttachment(Q,l);if(null==O)throw new Error("Deform attachment not found: "+u.name);var B=null!=O.bones,N=O.vertices,k=B?N.length/3*2:N.length;(x=new Re(u.length)).slotIndex=Q,x.attachment=O;c=0;for(var F=0;F<u.length;F++){d=u[F];var V=void 0,X=this.getValue(d,"vertices",null);if(null==X)V=B?L.newFloatArray(k):N;else{V=L.newFloatArray(k);var j=this.getValue(d,"offset",0);if(L.arrayCopy(X,0,V,j,X.length),1!=n)for(var U=(p=j)+X.length;p<U;p++)V[p]*=n;if(!B)for(p=0;p<k;p++)V[p]+=N[p]}x.setFrame(c,d.time,V),this.readCurve(d,x,c),c++}o.push(x),a=Math.max(a,x.frames[x.getFrameCount()-1])}}else if(z.FAIL_ON_NON_EXISTING_SKIN)throw new Error("Skin not found: "+M)}var Y=e.drawOrder;if(null==Y&&(Y=e.draworder),null!=Y){x=new De(Y.length);var W=i.slots.length;for(c=0,F=0;F<Y.length;F++){var q=Y[F],G=null,H=this.getValue(q,"offsets",null);if(null!=H){G=L.newArray(W,-1);var $=L.newArray(W-H.length,0),J=0,Z=0;for(p=0;p<H.length;p++){var Q,K=H[p];if(-1==(Q=i.findSlotIndex(K.slot)))throw new Error("Slot not found: "+K.slot);for(;J!=Q;)$[Z++]=J++;G[J+K.offset]=J++}for(;J<W;)$[Z++]=J++;for(p=W-1;p>=0;p--)-1==G[p]&&(G[p]=$[--Z])}x.setFrame(c++,q.time,G)}o.push(x),a=Math.max(a,x.frames[x.getFrameCount()-1])}if(e.events){for(x=new Oe(e.events.length),c=0,p=0;p<e.events.length;p++){var tt=e.events[p],et=i.findEvent(tt.name);if(null==et)throw new Error("Event not found: "+tt.name);var rt=new He(L.toSinglePrecision(tt.time),et);rt.intValue=this.getValue(tt,"int",et.intValue),rt.floatValue=this.getValue(tt,"float",et.floatValue),rt.stringValue=this.getValue(tt,"string",et.stringValue),null!=rt.data.audioPath&&(rt.volume=this.getValue(tt,"volume",1),rt.balance=this.getValue(tt,"balance",0)),x.setFrame(c++,rt)}o.push(x),a=Math.max(a,x.frames[x.getFrameCount()-1])}if(isNaN(a))throw new Error("Error while parsing animation, duration is NaN");i.animations.push(new xe(r,o,a))},e.prototype.readCurve=function(t,e,r){if(t.curve)if("stepped"===t.curve)e.setStepped(r);else if("[object Array]"===Object.prototype.toString.call(t.curve)){var i=t.curve;e.setCurve(r,i[0],i[1],i[2],i[3])}},e.prototype.getValue=function(t,e,r){return void 0!==t[e]?t[e]:r},e.blendModeFromString=function(t){if("normal"==(t=t.toLowerCase()))return i.BLEND_MODES.NORMAL;if("additive"==t)return i.BLEND_MODES.ADD;if("multiply"==t)return i.BLEND_MODES.MULTIPLY;if("screen"==t)return i.BLEND_MODES.SCREEN;throw new Error("Unknown blend mode: "+t)},e.positionModeFromString=function(e){if("fixed"==(e=e.toLowerCase()))return t.PositionMode.Fixed;if("percent"==e)return t.PositionMode.Percent;throw new Error("Unknown position mode: "+e)},e.spacingModeFromString=function(t){if("length"==(t=t.toLowerCase()))return Ue.Length;if("fixed"==t)return Ue.Fixed;if("percent"==t)return Ue.Percent;throw new Error("Unknown position mode: "+t)},e.rotateModeFromString=function(e){if("tangent"==(e=e.toLowerCase()))return t.RotateMode.Tangent;if("chain"==e)return t.RotateMode.Chain;if("chainscale"==e)return t.RotateMode.ChainScale;throw new Error("Unknown rotate mode: "+e)},e.transformModeFromString=function(e){if("normal"==(e=e.toLowerCase()))return t.TransformMode.Normal;if("onlytranslation"==e)return t.TransformMode.OnlyTranslation;if("norotationorreflection"==e)return t.TransformMode.NoRotationOrReflection;if("noscale"==e)return t.TransformMode.NoScale;if("noscaleorreflection"==e)return t.TransformMode.NoScaleOrReflection;throw new Error("Unknown transform mode: "+e)},e}(),lr=function(t,e,r,i){this.mesh=t,this.skin=e,this.slotIndex=r,this.parent=i},ur=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return he(e,t),e.prototype.createSkeleton=function(t){this.skeleton=new rr(t),this.skeleton.updateWorldTransform(),this.stateData=new ze(t),this.state=new Ve(this.stateData)},e}(H),cr=Object.freeze({__proto__:null,Animation:xe,AnimationState:Ve,AnimationStateAdapter2:Ye,AnimationStateData:ze,AtlasAttachmentLoader:We,Attachment:ue,AttachmentTimeline:Me,Bone:qe,BoneData:Ge,BoundingBoxAttachment:pe,ClippingAttachment:de,ColorTimeline:Ie,CurveTimeline:we,DeformTimeline:Re,DrawOrderTimeline:De,Event:He,EventData:$e,EventQueue:je,EventTimeline:Oe,get EventType(){return be},IkConstraint:Je,IkConstraintData:Ze,IkConstraintTimeline:Be,JitterEffect:ge,MeshAttachment:fe,PathAttachment:me,PathConstraint:Ke,PathConstraintData:Qe,PathConstraintMixTimeline:Le,PathConstraintPositionTimeline:ke,PathConstraintSpacingTimeline:Fe,PointAttachment:ve,RegionAttachment:ye,RotateTimeline:Te,ScaleTimeline:Se,ShearTimeline:Ae,Skeleton:rr,SkeletonBounds:ir,SkeletonData:nr,SkeletonJson:hr,Skin:sr,Slot:tr,SlotData:or,get SpacingMode(){return Ue},Spine:ur,SwirlEffect:_e,get TimelineType(){return le},TrackEntry:Xe,TransformConstraint:er,TransformConstraintData:ar,TransformConstraintTimeline:Ne,TranslateTimeline:Ee,TwoColorTimeline:Pe,VertexAttachment:ce}),pr=function(t,e){return(pr=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)};function dr(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}pr(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var fr,mr=function(t){if(!t)throw new Error("name cannot be null.");this.name=t},vr=function(t){function e(r){var i=t.call(this,r)||this;return i.id=e.nextID++,i.bones=null,i.vertices=[],i.worldVerticesLength=0,i.timelineAttachment=i,i}return dr(e,t),e.prototype.computeWorldVerticesOld=function(t,e){this.computeWorldVertices(t,0,this.worldVerticesLength,e,0,2)},e.prototype.computeWorldVertices=function(t,e,r,i,n,o){r=n+(r>>1)*o;var a=t.bone.skeleton,s=t.deform,h=this.vertices,l=this.bones;if(l){for(var u=0,c=0,p=0;p<e;p+=2){u+=(v=l[u])+1,c+=v}var d=a.bones;if(0==s.length)for(P=n,E=3*c;P<r;P+=o){var f=0,m=0,v=l[u++];for(v+=u;u<v;u++,E+=3){x=d[l[u]].matrix,M=h[E],C=h[E+1];var y=h[E+2];f+=(M*x.a+C*x.c+x.tx)*y,m+=(M*x.b+C*x.d+x.ty)*y}i[P]=f,i[P+1]=m}else for(var g=s,_=(P=n,E=3*c,c<<1);P<r;P+=o){f=0,m=0,v=l[u++];for(v+=u;u<v;u++,E+=3,_+=2){x=d[l[u]].matrix,M=h[E]+g[_],C=h[E+1]+g[_+1],y=h[E+2];f+=(M*x.a+C*x.c+x.tx)*y,m+=(M*x.b+C*x.d+x.ty)*y}i[P]=f,i[P+1]=m}}else{s.length>0&&(h=s);for(var x,b=(x=t.bone.matrix).tx,w=x.ty,T=x.a,E=x.c,S=x.b,A=x.d,I=e,P=n;P<r;I+=2,P+=o){var M=h[I],C=h[I+1];i[P]=M*T+C*E+b,i[P+1]=M*S+C*A+w}}},e.prototype.copyTo=function(t){this.bones?(t.bones=new Array(this.bones.length),L.arrayCopy(this.bones,0,t.bones,0,this.bones.length)):t.bones=null,this.vertices&&(t.vertices=L.newFloatArray(this.vertices.length),L.arrayCopy(this.vertices,0,t.vertices,0,this.vertices.length)),t.worldVerticesLength=this.worldVerticesLength,t.timelineAttachment=this.timelineAttachment},e.nextID=0,e}(mr),yr=function(e){function r(r){var i=e.call(this,r)||this;return i.type=t.AttachmentType.BoundingBox,i.color=new D(1,1,1,1),i}return dr(r,e),r.prototype.copy=function(){var t=new r(this.name);return this.copyTo(t),t.color.setFromColor(this.color),t},r}(vr),gr=function(e){function r(r){var i=e.call(this,r)||this;return i.type=t.AttachmentType.Clipping,i.endSlot=null,i.color=new D(.2275,.2275,.8078,1),i}return dr(r,e),r.prototype.copy=function(){var t=new r(this.name);return this.copyTo(t),t.endSlot=this.endSlot,t.color.setFromColor(this.color),t},r}(vr),_r=function(e){function r(r,i){var n=e.call(this,r)||this;return n.type=t.AttachmentType.Mesh,n.region=null,n.triangles=[],n.color=new D(1,1,1,1),n.width=0,n.height=0,n.hullLength=0,n.edges=[],n.parentMesh=null,n.sequence=null,n.tempColor=new D(0,0,0,0),n.path=i,n}return dr(r,e),r.prototype.getParentMesh=function(){return this.parentMesh},r.prototype.setParentMesh=function(t){this.parentMesh=t,t&&(this.bones=t.bones,this.vertices=t.vertices,this.worldVerticesLength=t.worldVerticesLength,this.regionUVs=t.regionUVs,this.triangles=t.triangles,this.hullLength=t.hullLength,this.worldVerticesLength=t.worldVerticesLength)},r.prototype.copy=function(){if(this.parentMesh)return this.newLinkedMesh();var t=new r(this.name,this.path);return t.region=this.region,t.color.setFromColor(this.color),this.copyTo(t),t.regionUVs=new Float32Array(this.regionUVs.length),L.arrayCopy(this.regionUVs,0,t.regionUVs,0,this.regionUVs.length),t.triangles=new Array(this.triangles.length),L.arrayCopy(this.triangles,0,t.triangles,0,this.triangles.length),t.hullLength=this.hullLength,t.sequence=null!=this.sequence?this.sequence.copy():null,this.edges&&(t.edges=new Array(this.edges.length),L.arrayCopy(this.edges,0,t.edges,0,this.edges.length)),t.width=this.width,t.height=this.height,t},r.prototype.computeWorldVertices=function(t,r,i,n,o,a){null!=this.sequence&&this.sequence.apply(t,this),e.prototype.computeWorldVertices.call(this,t,r,i,n,o,a)},r.prototype.newLinkedMesh=function(){var t=new r(this.name,this.path);return t.region=this.region,t.color.setFromColor(this.color),t.timelineAttachment=this.timelineAttachment,t.setParentMesh(this.parentMesh?this.parentMesh:this),t},r}(vr),xr=function(e){function r(r){var i=e.call(this,r)||this;return i.type=t.AttachmentType.Path,i.lengths=[],i.closed=!1,i.constantSpeed=!1,i.color=new D(1,1,1,1),i}return dr(r,e),r.prototype.copy=function(){var t=new r(this.name);return this.copyTo(t),t.lengths=new Array(this.lengths.length),L.arrayCopy(this.lengths,0,t.lengths,0,this.lengths.length),t.closed=closed,t.constantSpeed=this.constantSpeed,t.color.setFromColor(this.color),t},r}(vr),br=function(e){function r(r){var i=e.call(this,r)||this;return i.type=t.AttachmentType.Point,i.x=0,i.y=0,i.rotation=0,i.color=new D(.38,.94,0,1),i}return dr(r,e),r.prototype.computeWorldPosition=function(t,e){var r=t.matrix;return e.x=this.x*r.a+this.y*r.c+t.worldX,e.y=this.x*r.b+this.y*r.d+t.worldY,e},r.prototype.computeWorldRotation=function(t){var e=t.matrix,r=B.cosDeg(this.rotation),i=B.sinDeg(this.rotation),n=r*e.a+i*e.c,o=r*e.b+i*e.d;return Math.atan2(o,n)*B.radDeg},r.prototype.copy=function(){var t=new r(this.name);return t.x=this.x,t.y=this.y,t.rotation=this.rotation,t.color.setFromColor(this.color),t},r}(vr),wr=function(e){function r(r,i){var n=e.call(this,r)||this;return n.type=t.AttachmentType.Region,n.x=0,n.y=0,n.scaleX=1,n.scaleY=1,n.rotation=0,n.width=0,n.height=0,n.color=new D(1,1,1,1),n.rendererObject=null,n.region=null,n.sequence=null,n.offset=L.newFloatArray(8),n.uvs=L.newFloatArray(8),n.tempColor=new D(1,1,1,1),n.path=i,n}return dr(r,e),r.prototype.updateRegion=function(){if(!this.region)throw new Error("Region not set.");var t=this.region,e=this.width/this.region.originalWidth*this.scaleX,r=this.height/this.region.originalHeight*this.scaleY,i=-this.width/2*this.scaleX+this.region.offsetX*e,n=-this.height/2*this.scaleY+this.region.offsetY*r,o=i+this.region.width*e,a=n+this.region.height*r,s=this.rotation*Math.PI/180,h=Math.cos(s),l=Math.sin(s),u=this.x,c=this.y,p=i*h+u,d=i*l,f=n*h+c,m=n*l,v=o*h+u,y=o*l,g=a*h+c,_=a*l,x=this.offset;x[0]=p-m,x[1]=f+d,x[2]=p-_,x[3]=g+d,x[4]=v-_,x[5]=g+y,x[6]=v-m,x[7]=f+y;var b=this.uvs;90==t.degrees?(b[2]=t.u,b[3]=t.v2,b[4]=t.u,b[5]=t.v,b[6]=t.u2,b[7]=t.v,b[0]=t.u2,b[1]=t.v2):(b[0]=t.u,b[1]=t.v2,b[2]=t.u,b[3]=t.v,b[4]=t.u2,b[5]=t.v,b[6]=t.u2,b[7]=t.v2)},r.prototype.computeWorldVertices=function(t,e,r,i){null!=this.sequence&&this.sequence.apply(t,this);var n=t.bone,o=this.offset,a=n.matrix,s=a.tx,h=a.ty,l=a.a,u=a.c,c=a.b,p=a.d,d=0,f=0;d=o[0],f=o[1],e[r]=d*l+f*u+s,e[r+1]=d*c+f*p+h,r+=i,d=o[2],f=o[3],e[r]=d*l+f*u+s,e[r+1]=d*c+f*p+h,r+=i,d=o[4],f=o[5],e[r]=d*l+f*u+s,e[r+1]=d*c+f*p+h,r+=i,d=o[6],f=o[7],e[r]=d*l+f*u+s,e[r+1]=d*c+f*p+h},r.prototype.copy=function(){var t=new r(this.name,this.path);return t.region=this.region,t.rendererObject=this.rendererObject,t.x=this.x,t.y=this.y,t.scaleX=this.scaleX,t.scaleY=this.scaleY,t.rotation=this.rotation,t.width=this.width,t.height=this.height,L.arrayCopy(this.uvs,0,t.uvs,0,8),L.arrayCopy(this.offset,0,t.offset,0,8),t.color.setFromColor(this.color),t.sequence=null!=this.sequence?this.sequence.copy():null,t},r.X1=0,r.Y1=1,r.C1R=2,r.C1G=3,r.C1B=4,r.C1A=5,r.U1=6,r.V1=7,r.X2=8,r.Y2=9,r.C2R=10,r.C2G=11,r.C2B=12,r.C2A=13,r.U2=14,r.V2=15,r.X3=16,r.Y3=17,r.C3R=18,r.C3G=19,r.C3B=20,r.C3A=21,r.U3=22,r.V3=23,r.X4=24,r.Y4=25,r.C4R=26,r.C4G=27,r.C4B=28,r.C4A=29,r.U4=30,r.V4=31,r}(mr),Tr=function(){function t(e){this.id=t.nextID(),this.start=0,this.digits=0,this.setupIndex=0,this.regions=new Array(e)}return t.prototype.copy=function(){var e=new t(this.regions.length);return L.arrayCopy(this.regions,0,e.regions,0,this.regions.length),e.start=this.start,e.digits=this.digits,e.setupIndex=this.setupIndex,e},t.prototype.apply=function(t,e){var r=t.sequenceIndex;-1==r&&(r=this.setupIndex),r>=this.regions.length&&(r=this.regions.length-1);var i=this.regions[r];e.region!=i&&(e.region=i)},t.prototype.getPath=function(t,e){for(var r=t,i=(this.start+e).toString(),n=this.digits-i.length;n>0;n--)r+="0";return r+=i},t.nextID=function(){return t._nextID++},t._nextID=0,t}();!function(t){t[t.hold=0]="hold",t[t.once=1]="once",t[t.loop=2]="loop",t[t.pingpong=3]="pingpong",t[t.onceReverse=4]="onceReverse",t[t.loopReverse=5]="loopReverse",t[t.pingpongReverse=6]="pingpongReverse"}(fr||(fr={}));var Er,Sr=[fr.hold,fr.once,fr.loop,fr.pingpong,fr.onceReverse,fr.loopReverse,fr.pingpongReverse],Ar=function(){function t(t,e,r){if(this.timelines=[],this.timelineIds=new O,!t)throw new Error("name cannot be null.");this.name=t,this.setTimelines(e),this.duration=r}return t.prototype.setTimelines=function(t){if(!t)throw new Error("timelines cannot be null.");this.timelines=t,this.timelineIds.clear();for(var e=0;e<t.length;e++)this.timelineIds.addAll(t[e].getPropertyIds())},t.prototype.hasTimeline=function(t){for(var e=0;e<t.length;e++)if(this.timelineIds.contains(t[e]))return!0;return!1},t.prototype.apply=function(t,e,r,i,n,o,a,s){if(!t)throw new Error("skeleton cannot be null.");i&&0!=this.duration&&(r%=this.duration,e>0&&(e%=this.duration));for(var h=this.timelines,l=0,u=h.length;l<u;l++)h[l].apply(t,e,r,n,o,a,s)},t}(),Ir=0,Pr=1,Mr=2,Cr=3,Rr=4,Or=5,Dr=6,Br=7,Nr=8,kr=9,Fr=10,Lr=11,Vr=12,Xr=13,jr=14,Ur=15,Yr=16,zr=17,Wr=18,qr=19,Gr=function(){function t(t,e){this.propertyIds=e,this.frames=L.newFloatArray(t*this.getFrameEntries())}return t.prototype.getPropertyIds=function(){return this.propertyIds},t.prototype.getFrameEntries=function(){return 1},t.prototype.getFrameCount=function(){return this.frames.length/this.getFrameEntries()},t.prototype.getDuration=function(){return this.frames[this.frames.length-this.getFrameEntries()]},t.search1=function(t,e){for(var r=t.length,i=1;i<r;i++)if(t[i]>e)return i-1;return r-1},t.search=function(t,e,r){for(var i=t.length,n=r;n<i;n+=r)if(t[n]>e)return n-r;return i-r},t}(),Hr=function(t){function e(e,r,i){var n=t.call(this,e,i)||this;return n.curves=L.newFloatArray(e+18*r),n.curves[e-1]=1,n}return dr(e,t),e.prototype.setLinear=function(t){this.curves[t]=0},e.prototype.setStepped=function(t){this.curves[t]=1},e.prototype.shrink=function(t){var e=this.getFrameCount()+18*t;if(this.curves.length>e){var r=L.newFloatArray(e);L.arrayCopy(this.curves,0,r,0,e),this.curves=r}},e.prototype.setBezier=function(t,e,r,i,n,o,a,s,h,l,u){var c=this.curves,p=this.getFrameCount()+18*t;0==r&&(c[e]=2+p);for(var d=.03*(i-2*o+s),f=.03*(n-2*a+h),m=.006*(3*(o-s)-i+l),v=.006*(3*(a-h)-n+u),y=2*d+m,g=2*f+v,_=.3*(o-i)+d+.16666667*m,x=.3*(a-n)+f+.16666667*v,b=i+_,w=n+x,T=p+18;p<T;p+=2)c[p]=b,c[p+1]=w,_+=y,x+=g,y+=m,g+=v,b+=_,w+=x},e.prototype.getBezierValue=function(t,e,r,i){var n=this.curves;if(n[i]>t){var o=this.frames[e],a=this.frames[e+r];return a+(t-o)/(n[i]-o)*(n[i+1]-a)}var s=i+18;for(i+=2;i<s;i+=2)if(n[i]>=t){var h=n[i-2],l=n[i-1];return l+(t-h)/(n[i]-h)*(n[i+1]-l)}e+=this.getFrameEntries();var u=n[s-2],c=n[s-1];return c+(t-u)/(this.frames[e]-u)*(this.frames[e+r]-c)},e}(Gr),$r=function(t){function e(e,r,i){return t.call(this,e,r,[i])||this}return dr(e,t),e.prototype.getFrameEntries=function(){return 2},e.prototype.setFrame=function(t,e,r){t<<=1,this.frames[t]=e,this.frames[t+1]=r},e.prototype.getCurveValue=function(t){for(var e=this.frames,r=e.length-2,i=2;i<=r;i+=2)if(e[i]>t){r=i-2;break}var n=this.curves[r>>1];switch(n){case 0:var o=e[r],a=e[r+1];return a+(t-o)/(e[r+2]-o)*(e[r+2+1]-a);case 1:return e[r+1]}return this.getBezierValue(t,r,1,n-2)},e}(Hr),Jr=function(t){function e(e,r,i,n){return t.call(this,e,r,[i,n])||this}return dr(e,t),e.prototype.getFrameEntries=function(){return 3},e.prototype.setFrame=function(t,e,r,i){t*=3,this.frames[t]=e,this.frames[t+1]=r,this.frames[t+2]=i},e}(Hr),Zr=function(e){function r(t,r,i){var n=e.call(this,t,r,Ir+"|"+i)||this;return n.boneIndex=0,n.boneIndex=i,n}return dr(r,e),r.prototype.apply=function(e,r,i,n,o,a,s){var h=e.bones[this.boneIndex];if(h.active)if(i<this.frames[0])switch(a){case t.MixBlend.setup:return void(h.rotation=h.data.rotation);case t.MixBlend.first:h.rotation+=(h.data.rotation-h.rotation)*o}else{var l=this.getCurveValue(i);switch(a){case t.MixBlend.setup:h.rotation=h.data.rotation+l*o;break;case t.MixBlend.first:case t.MixBlend.replace:l+=h.data.rotation-h.rotation;case t.MixBlend.add:h.rotation+=l*o}}},r}($r),Qr=function(e){function r(t,r,i){var n=e.call(this,t,r,Pr+"|"+i,Mr+"|"+i)||this;return n.boneIndex=0,n.boneIndex=i,n}return dr(r,e),r.prototype.apply=function(e,r,i,n,o,a,s){var h=e.bones[this.boneIndex];if(h.active){var l=this.frames;if(i<l[0])switch(a){case t.MixBlend.setup:return h.x=h.data.x,void(h.y=h.data.y);case t.MixBlend.first:h.x+=(h.data.x-h.x)*o,h.y+=(h.data.y-h.y)*o}else{var u=0,c=0,p=Gr.search(l,i,3),d=this.curves[p/3];switch(d){case 0:var f=l[p];u=l[p+1],c=l[p+2];var m=(i-f)/(l[p+3]-f);u+=(l[p+3+1]-u)*m,c+=(l[p+3+2]-c)*m;break;case 1:u=l[p+1],c=l[p+2];break;default:u=this.getBezierValue(i,p,1,d-2),c=this.getBezierValue(i,p,2,d+18-2)}switch(a){case t.MixBlend.setup:h.x=h.data.x+u*o,h.y=h.data.y+c*o;break;case t.MixBlend.first:case t.MixBlend.replace:h.x+=(h.data.x+u-h.x)*o,h.y+=(h.data.y+c-h.y)*o;break;case t.MixBlend.add:h.x+=u*o,h.y+=c*o}}}},r}(Jr),Kr=function(e){function r(t,r,i){var n=e.call(this,t,r,Pr+"|"+i)||this;return n.boneIndex=0,n.boneIndex=i,n}return dr(r,e),r.prototype.apply=function(e,r,i,n,o,a,s){var h=e.bones[this.boneIndex];if(h.active)if(i<this.frames[0])switch(a){case t.MixBlend.setup:return void(h.x=h.data.x);case t.MixBlend.first:h.x+=(h.data.x-h.x)*o}else{var l=this.getCurveValue(i);switch(a){case t.MixBlend.setup:h.x=h.data.x+l*o;break;case t.MixBlend.first:case t.MixBlend.replace:h.x+=(h.data.x+l-h.x)*o;break;case t.MixBlend.add:h.x+=l*o}}},r}($r),ti=function(e){function r(t,r,i){var n=e.call(this,t,r,Mr+"|"+i)||this;return n.boneIndex=0,n.boneIndex=i,n}return dr(r,e),r.prototype.apply=function(e,r,i,n,o,a,s){var h=e.bones[this.boneIndex];if(h.active)if(i<this.frames[0])switch(a){case t.MixBlend.setup:return void(h.y=h.data.y);case t.MixBlend.first:h.y+=(h.data.y-h.y)*o}else{var l=this.getCurveValue(i);switch(a){case t.MixBlend.setup:h.y=h.data.y+l*o;break;case t.MixBlend.first:case t.MixBlend.replace:h.y+=(h.data.y+l-h.y)*o;break;case t.MixBlend.add:h.y+=l*o}}},r}($r),ei=function(e){function r(t,r,i){var n=e.call(this,t,r,Cr+"|"+i,Rr+"|"+i)||this;return n.boneIndex=0,n.boneIndex=i,n}return dr(r,e),r.prototype.apply=function(e,r,i,n,o,a,s){var h=e.bones[this.boneIndex];if(h.active){var l=this.frames;if(i<l[0])switch(a){case t.MixBlend.setup:return h.scaleX=h.data.scaleX,void(h.scaleY=h.data.scaleY);case t.MixBlend.first:h.scaleX+=(h.data.scaleX-h.scaleX)*o,h.scaleY+=(h.data.scaleY-h.scaleY)*o}else{var u,c,p=Gr.search(l,i,3),d=this.curves[p/3];switch(d){case 0:var f=l[p];u=l[p+1],c=l[p+2];var m=(i-f)/(l[p+3]-f);u+=(l[p+3+1]-u)*m,c+=(l[p+3+2]-c)*m;break;case 1:u=l[p+1],c=l[p+2];break;default:u=this.getBezierValue(i,p,1,d-2),c=this.getBezierValue(i,p,2,d+18-2)}if(u*=h.data.scaleX,c*=h.data.scaleY,1==o)a==t.MixBlend.add?(h.scaleX+=u-h.data.scaleX,h.scaleY+=c-h.data.scaleY):(h.scaleX=u,h.scaleY=c);else{var v=0,y=0;if(s==t.MixDirection.mixOut)switch(a){case t.MixBlend.setup:v=h.data.scaleX,y=h.data.scaleY,h.scaleX=v+(Math.abs(u)*B.signum(v)-v)*o,h.scaleY=y+(Math.abs(c)*B.signum(y)-y)*o;break;case t.MixBlend.first:case t.MixBlend.replace:v=h.scaleX,y=h.scaleY,h.scaleX=v+(Math.abs(u)*B.signum(v)-v)*o,h.scaleY=y+(Math.abs(c)*B.signum(y)-y)*o;break;case t.MixBlend.add:h.scaleX+=(u-h.data.scaleX)*o,h.scaleY+=(c-h.data.scaleY)*o}else switch(a){case t.MixBlend.setup:v=Math.abs(h.data.scaleX)*B.signum(u),y=Math.abs(h.data.scaleY)*B.signum(c),h.scaleX=v+(u-v)*o,h.scaleY=y+(c-y)*o;break;case t.MixBlend.first:case t.MixBlend.replace:v=Math.abs(h.scaleX)*B.signum(u),y=Math.abs(h.scaleY)*B.signum(c),h.scaleX=v+(u-v)*o,h.scaleY=y+(c-y)*o;break;case t.MixBlend.add:h.scaleX+=(u-h.data.scaleX)*o,h.scaleY+=(c-h.data.scaleY)*o}}}}},r}(Jr),ri=function(e){function r(t,r,i){var n=e.call(this,t,r,Cr+"|"+i)||this;return n.boneIndex=0,n.boneIndex=i,n}return dr(r,e),r.prototype.apply=function(e,r,i,n,o,a,s){var h=e.bones[this.boneIndex];if(h.active)if(i<this.frames[0])switch(a){case t.MixBlend.setup:return void(h.scaleX=h.data.scaleX);case t.MixBlend.first:h.scaleX+=(h.data.scaleX-h.scaleX)*o}else{var l=this.getCurveValue(i)*h.data.scaleX;if(1==o)a==t.MixBlend.add?h.scaleX+=l-h.data.scaleX:h.scaleX=l;else{var u=0;if(s==t.MixDirection.mixOut)switch(a){case t.MixBlend.setup:u=h.data.scaleX,h.scaleX=u+(Math.abs(l)*B.signum(u)-u)*o;break;case t.MixBlend.first:case t.MixBlend.replace:u=h.scaleX,h.scaleX=u+(Math.abs(l)*B.signum(u)-u)*o;break;case t.MixBlend.add:h.scaleX+=(l-h.data.scaleX)*o}else switch(a){case t.MixBlend.setup:u=Math.abs(h.data.scaleX)*B.signum(l),h.scaleX=u+(l-u)*o;break;case t.MixBlend.first:case t.MixBlend.replace:u=Math.abs(h.scaleX)*B.signum(l),h.scaleX=u+(l-u)*o;break;case t.MixBlend.add:h.scaleX+=(l-h.data.scaleX)*o}}}},r}($r),ii=function(e){function r(t,r,i){var n=e.call(this,t,r,Rr+"|"+i)||this;return n.boneIndex=0,n.boneIndex=i,n}return dr(r,e),r.prototype.apply=function(e,r,i,n,o,a,s){var h=e.bones[this.boneIndex];if(h.active)if(i<this.frames[0])switch(a){case t.MixBlend.setup:return void(h.scaleY=h.data.scaleY);case t.MixBlend.first:h.scaleY+=(h.data.scaleY-h.scaleY)*o}else{var l=this.getCurveValue(i)*h.data.scaleY;if(1==o)a==t.MixBlend.add?h.scaleY+=l-h.data.scaleY:h.scaleY=l;else{var u=0;if(s==t.MixDirection.mixOut)switch(a){case t.MixBlend.setup:u=h.data.scaleY,h.scaleY=u+(Math.abs(l)*B.signum(u)-u)*o;break;case t.MixBlend.first:case t.MixBlend.replace:u=h.scaleY,h.scaleY=u+(Math.abs(l)*B.signum(u)-u)*o;break;case t.MixBlend.add:h.scaleY+=(l-h.data.scaleY)*o}else switch(a){case t.MixBlend.setup:u=Math.abs(h.data.scaleY)*B.signum(l),h.scaleY=u+(l-u)*o;break;case t.MixBlend.first:case t.MixBlend.replace:u=Math.abs(h.scaleY)*B.signum(l),h.scaleY=u+(l-u)*o;break;case t.MixBlend.add:h.scaleY+=(l-h.data.scaleY)*o}}}},r}($r),ni=function(e){function r(t,r,i){var n=e.call(this,t,r,Or+"|"+i,Dr+"|"+i)||this;return n.boneIndex=0,n.boneIndex=i,n}return dr(r,e),r.prototype.apply=function(e,r,i,n,o,a,s){var h=e.bones[this.boneIndex];if(h.active){var l=this.frames;if(i<l[0])switch(a){case t.MixBlend.setup:return h.shearX=h.data.shearX,void(h.shearY=h.data.shearY);case t.MixBlend.first:h.shearX+=(h.data.shearX-h.shearX)*o,h.shearY+=(h.data.shearY-h.shearY)*o}else{var u=0,c=0,p=Gr.search(l,i,3),d=this.curves[p/3];switch(d){case 0:var f=l[p];u=l[p+1],c=l[p+2];var m=(i-f)/(l[p+3]-f);u+=(l[p+3+1]-u)*m,c+=(l[p+3+2]-c)*m;break;case 1:u=l[p+1],c=l[p+2];break;default:u=this.getBezierValue(i,p,1,d-2),c=this.getBezierValue(i,p,2,d+18-2)}switch(a){case t.MixBlend.setup:h.shearX=h.data.shearX+u*o,h.shearY=h.data.shearY+c*o;break;case t.MixBlend.first:case t.MixBlend.replace:h.shearX+=(h.data.shearX+u-h.shearX)*o,h.shearY+=(h.data.shearY+c-h.shearY)*o;break;case t.MixBlend.add:h.shearX+=u*o,h.shearY+=c*o}}}},r}(Jr),oi=function(e){function r(t,r,i){var n=e.call(this,t,r,Or+"|"+i)||this;return n.boneIndex=0,n.boneIndex=i,n}return dr(r,e),r.prototype.apply=function(e,r,i,n,o,a,s){var h=e.bones[this.boneIndex];if(h.active)if(i<this.frames[0])switch(a){case t.MixBlend.setup:return void(h.shearX=h.data.shearX);case t.MixBlend.first:h.shearX+=(h.data.shearX-h.shearX)*o}else{var l=this.getCurveValue(i);switch(a){case t.MixBlend.setup:h.shearX=h.data.shearX+l*o;break;case t.MixBlend.first:case t.MixBlend.replace:h.shearX+=(h.data.shearX+l-h.shearX)*o;break;case t.MixBlend.add:h.shearX+=l*o}}},r}($r),ai=function(e){function r(t,r,i){var n=e.call(this,t,r,Dr+"|"+i)||this;return n.boneIndex=0,n.boneIndex=i,n}return dr(r,e),r.prototype.apply=function(e,r,i,n,o,a,s){var h=e.bones[this.boneIndex];if(h.active)if(i<this.frames[0])switch(a){case t.MixBlend.setup:return void(h.shearY=h.data.shearY);case t.MixBlend.first:h.shearY+=(h.data.shearY-h.shearY)*o}else{var l=this.getCurveValue(i);switch(a){case t.MixBlend.setup:h.shearY=h.data.shearY+l*o;break;case t.MixBlend.first:case t.MixBlend.replace:h.shearY+=(h.data.shearY+l-h.shearY)*o;break;case t.MixBlend.add:h.shearY+=l*o}}},r}($r),si=function(e){function r(t,r,i){var n=e.call(this,t,r,[Br+"|"+i,Nr+"|"+i])||this;return n.slotIndex=0,n.slotIndex=i,n}return dr(r,e),r.prototype.getFrameEntries=function(){return 5},r.prototype.setFrame=function(t,e,r,i,n,o){t*=5,this.frames[t]=e,this.frames[t+1]=r,this.frames[t+2]=i,this.frames[t+3]=n,this.frames[t+4]=o},r.prototype.apply=function(e,r,i,n,o,a,s){var h=e.slots[this.slotIndex];if(h.bone.active){var l=this.frames,u=h.color;if(i<l[0]){var c=h.data.color;switch(a){case t.MixBlend.setup:return void u.setFromColor(c);case t.MixBlend.first:u.add((c.r-u.r)*o,(c.g-u.g)*o,(c.b-u.b)*o,(c.a-u.a)*o)}}else{var p=0,d=0,f=0,m=0,v=Gr.search(l,i,5),y=this.curves[v/5];switch(y){case 0:var g=l[v];p=l[v+1],d=l[v+2],f=l[v+3],m=l[v+4];var _=(i-g)/(l[v+5]-g);p+=(l[v+5+1]-p)*_,d+=(l[v+5+2]-d)*_,f+=(l[v+5+3]-f)*_,m+=(l[v+5+4]-m)*_;break;case 1:p=l[v+1],d=l[v+2],f=l[v+3],m=l[v+4];break;default:p=this.getBezierValue(i,v,1,y-2),d=this.getBezierValue(i,v,2,y+18-2),f=this.getBezierValue(i,v,3,y+36-2),m=this.getBezierValue(i,v,4,y+54-2)}1==o?u.set(p,d,f,m):(a==t.MixBlend.setup&&u.setFromColor(h.data.color),u.add((p-u.r)*o,(d-u.g)*o,(f-u.b)*o,(m-u.a)*o))}}},r}(Hr),hi=function(e){function r(t,r,i){var n=e.call(this,t,r,[Br+"|"+i])||this;return n.slotIndex=0,n.slotIndex=i,n}return dr(r,e),r.prototype.getFrameEntries=function(){return 4},r.prototype.setFrame=function(t,e,r,i,n){t<<=2,this.frames[t]=e,this.frames[t+1]=r,this.frames[t+2]=i,this.frames[t+3]=n},r.prototype.apply=function(e,r,i,n,o,a,s){var h=e.slots[this.slotIndex];if(h.bone.active){var l=this.frames,u=h.color;if(i<l[0]){var c=h.data.color;switch(a){case t.MixBlend.setup:return u.r=c.r,u.g=c.g,void(u.b=c.b);case t.MixBlend.first:u.r+=(c.r-u.r)*o,u.g+=(c.g-u.g)*o,u.b+=(c.b-u.b)*o}}else{var p=0,d=0,f=0,m=Gr.search(l,i,4),v=this.curves[m>>2];switch(v){case 0:var y=l[m];p=l[m+1],d=l[m+2],f=l[m+3];var g=(i-y)/(l[m+4]-y);p+=(l[m+4+1]-p)*g,d+=(l[m+4+2]-d)*g,f+=(l[m+4+3]-f)*g;break;case 1:p=l[m+1],d=l[m+2],f=l[m+3];break;default:p=this.getBezierValue(i,m,1,v-2),d=this.getBezierValue(i,m,2,v+18-2),f=this.getBezierValue(i,m,3,v+36-2)}if(1==o)u.r=p,u.g=d,u.b=f;else{if(a==t.MixBlend.setup){c=h.data.color;u.r=c.r,u.g=c.g,u.b=c.b}u.r+=(p-u.r)*o,u.g+=(d-u.g)*o,u.b+=(f-u.b)*o}}}},r}(Hr),li=function(e){function r(t,r,i){var n=e.call(this,t,r,Nr+"|"+i)||this;return n.slotIndex=0,n.slotIndex=i,n}return dr(r,e),r.prototype.apply=function(e,r,i,n,o,a,s){var h=e.slots[this.slotIndex];if(h.bone.active){var l=h.color;if(i<this.frames[0]){var u=h.data.color;switch(a){case t.MixBlend.setup:return void(l.a=u.a);case t.MixBlend.first:l.a+=(u.a-l.a)*o}}else{var c=this.getCurveValue(i);1==o?l.a=c:(a==t.MixBlend.setup&&(l.a=h.data.color.a),l.a+=(c-l.a)*o)}}},r}($r),ui=function(e){function r(t,r,i){var n=e.call(this,t,r,[Br+"|"+i,Nr+"|"+i,kr+"|"+i])||this;return n.slotIndex=0,n.slotIndex=i,n}return dr(r,e),r.prototype.getFrameEntries=function(){return 8},r.prototype.setFrame=function(t,e,r,i,n,o,a,s,h){t<<=3,this.frames[t]=e,this.frames[t+1]=r,this.frames[t+2]=i,this.frames[t+3]=n,this.frames[t+4]=o,this.frames[t+5]=a,this.frames[t+6]=s,this.frames[t+7]=h},r.prototype.apply=function(e,r,i,n,o,a,s){var h=e.slots[this.slotIndex];if(h.bone.active){var l=this.frames,u=h.color,c=h.darkColor;if(i<l[0]){var p=h.data.color,d=h.data.darkColor;switch(a){case t.MixBlend.setup:return u.setFromColor(p),c.r=d.r,c.g=d.g,void(c.b=d.b);case t.MixBlend.first:u.add((p.r-u.r)*o,(p.g-u.g)*o,(p.b-u.b)*o,(p.a-u.a)*o),c.r+=(d.r-c.r)*o,c.g+=(d.g-c.g)*o,c.b+=(d.b-c.b)*o}}else{var f=0,m=0,v=0,y=0,g=0,_=0,x=0,b=Gr.search(l,i,8),w=this.curves[b>>3];switch(w){case 0:var T=l[b];f=l[b+1],m=l[b+2],v=l[b+3],y=l[b+4],g=l[b+5],_=l[b+6],x=l[b+7];var E=(i-T)/(l[b+8]-T);f+=(l[b+8+1]-f)*E,m+=(l[b+8+2]-m)*E,v+=(l[b+8+3]-v)*E,y+=(l[b+8+4]-y)*E,g+=(l[b+8+5]-g)*E,_+=(l[b+8+6]-_)*E,x+=(l[b+8+7]-x)*E;break;case 1:f=l[b+1],m=l[b+2],v=l[b+3],y=l[b+4],g=l[b+5],_=l[b+6],x=l[b+7];break;default:f=this.getBezierValue(i,b,1,w-2),m=this.getBezierValue(i,b,2,w+18-2),v=this.getBezierValue(i,b,3,w+36-2),y=this.getBezierValue(i,b,4,w+54-2),g=this.getBezierValue(i,b,5,w+72-2),_=this.getBezierValue(i,b,6,w+90-2),x=this.getBezierValue(i,b,7,w+108-2)}if(1==o)u.set(f,m,v,y),c.r=g,c.g=_,c.b=x;else{if(a==t.MixBlend.setup){u.setFromColor(h.data.color);d=h.data.darkColor;c.r=d.r,c.g=d.g,c.b=d.b}u.add((f-u.r)*o,(m-u.g)*o,(v-u.b)*o,(y-u.a)*o),c.r+=(g-c.r)*o,c.g+=(_-c.g)*o,c.b+=(x-c.b)*o}}}},r}(Hr),ci=function(e){function r(t,r,i){var n=e.call(this,t,r,[Br+"|"+i,kr+"|"+i])||this;return n.slotIndex=0,n.slotIndex=i,n}return dr(r,e),r.prototype.getFrameEntries=function(){return 7},r.prototype.setFrame=function(t,e,r,i,n,o,a,s){t*=7,this.frames[t]=e,this.frames[t+1]=r,this.frames[t+2]=i,this.frames[t+3]=n,this.frames[t+4]=o,this.frames[t+5]=a,this.frames[t+6]=s},r.prototype.apply=function(e,r,i,n,o,a,s){var h=e.slots[this.slotIndex];if(h.bone.active){var l=this.frames,u=h.color,c=h.darkColor;if(i<l[0]){var p=h.data.color,d=h.data.darkColor;switch(a){case t.MixBlend.setup:return u.r=p.r,u.g=p.g,u.b=p.b,c.r=d.r,c.g=d.g,void(c.b=d.b);case t.MixBlend.first:u.r+=(p.r-u.r)*o,u.g+=(p.g-u.g)*o,u.b+=(p.b-u.b)*o,c.r+=(d.r-c.r)*o,c.g+=(d.g-c.g)*o,c.b+=(d.b-c.b)*o}}else{var f=0,m=0,v=0,y=0,g=0,_=0,x=Gr.search(l,i,7),b=this.curves[x/7];switch(b){case 0:var w=l[x];f=l[x+1],m=l[x+2],v=l[x+3],y=l[x+4],g=l[x+5],_=l[x+6];var T=(i-w)/(l[x+7]-w);f+=(l[x+7+1]-f)*T,m+=(l[x+7+2]-m)*T,v+=(l[x+7+3]-v)*T,y+=(l[x+7+4]-y)*T,g+=(l[x+7+5]-g)*T,_+=(l[x+7+6]-_)*T;break;case 1:f=l[x+1],m=l[x+2],v=l[x+3],y=l[x+4],g=l[x+5],_=l[x+6];break;default:f=this.getBezierValue(i,x,1,b-2),m=this.getBezierValue(i,x,2,b+18-2),v=this.getBezierValue(i,x,3,b+36-2),y=this.getBezierValue(i,x,4,b+54-2),g=this.getBezierValue(i,x,5,b+72-2),_=this.getBezierValue(i,x,6,b+90-2)}if(1==o)u.r=f,u.g=m,u.b=v,c.r=y,c.g=g,c.b=_;else{if(a==t.MixBlend.setup){p=h.data.color,d=h.data.darkColor;u.r=p.r,u.g=p.g,u.b=p.b,c.r=d.r,c.g=d.g,c.b=d.b}u.r+=(f-u.r)*o,u.g+=(m-u.g)*o,u.b+=(v-u.b)*o,c.r+=(y-c.r)*o,c.g+=(g-c.g)*o,c.b+=(_-c.b)*o}}}},r}(Hr),pi=function(e){function r(t,r){var i=e.call(this,t,[Fr+"|"+r])||this;return i.slotIndex=0,i.slotIndex=r,i.attachmentNames=new Array(t),i}return dr(r,e),r.prototype.getFrameCount=function(){return this.frames.length},r.prototype.setFrame=function(t,e,r){this.frames[t]=e,this.attachmentNames[t]=r},r.prototype.apply=function(e,r,i,n,o,a,s){var h=e.slots[this.slotIndex];h.bone.active&&(s!=t.MixDirection.mixOut?i<this.frames[0]?a!=t.MixBlend.setup&&a!=t.MixBlend.first||this.setAttachment(e,h,h.data.attachmentName):this.setAttachment(e,h,this.attachmentNames[Gr.search1(this.frames,i)]):a==t.MixBlend.setup&&this.setAttachment(e,h,h.data.attachmentName))},r.prototype.setAttachment=function(t,e,r){e.setAttachment(r?t.getAttachment(this.slotIndex,r):null)},r}(Gr),di=function(e){function r(t,r,i,n){var o=e.call(this,t,r,[Lr+"|"+i+"|"+n.id])||this;return o.slotIndex=0,o.slotIndex=i,o.attachment=n,o.vertices=new Array(t),o}return dr(r,e),r.prototype.getFrameCount=function(){return this.frames.length},r.prototype.setFrame=function(t,e,r){this.frames[t]=e,this.vertices[t]=r},r.prototype.setBezier=function(t,e,r,i,n,o,a,s,h,l,u){var c=this.curves,p=this.getFrameCount()+18*t;0==r&&(c[e]=2+p);for(var d=.03*(i-2*o+s),f=.03*h-.06*a,m=.006*(3*(o-s)-i+l),v=.018*(a-h+.33333333),y=2*d+m,g=2*f+v,_=.3*(o-i)+d+.16666667*m,x=.3*a+f+.16666667*v,b=i+_,w=x,T=p+18;p<T;p+=2)c[p]=b,c[p+1]=w,_+=y,x+=g,y+=m,g+=v,b+=_,w+=x},r.prototype.getCurvePercent=function(t,e){var r=this.curves,i=r[e];switch(i){case 0:var n=this.frames[e];return(t-n)/(this.frames[e+this.getFrameEntries()]-n);case 1:return 0}if(r[i-=2]>t){var o=this.frames[e];return r[i+1]*(t-o)/(r[i]-o)}var a=i+18;for(i+=2;i<a;i+=2)if(r[i]>=t){var s=r[i-2],h=r[i-1];return h+(t-s)/(r[i]-s)*(r[i+1]-h)}var l=r[a-2],u=r[a-1];return u+(1-u)*(t-l)/(this.frames[e+this.getFrameEntries()]-l)},r.prototype.apply=function(e,r,i,n,o,a,s){var h=e.slots[this.slotIndex];if(h.bone.active){var l=h.getAttachment();if(l&&l instanceof vr&&l.timelineAttachment==this.attachment){var u=h.deform;0==u.length&&(a=t.MixBlend.setup);var c=this.vertices,p=c[0].length,d=this.frames;if(i<d[0])switch(a){case t.MixBlend.setup:return void(u.length=0);case t.MixBlend.first:if(1==o)return void(u.length=0);if(u.length=p,(V=l).bones){o=1-o;for(m=0;m<p;m++)u[m]*=o}else for(var f=V.vertices,m=0;m<p;m++)u[m]+=(f[m]-u[m])*o}else if(u.length=p,i>=d[d.length-1]){var v=c[d.length-1];if(1==o)if(a==t.MixBlend.add)if((V=l).bones)for(var y=0;y<p;y++)u[y]+=v[y];else{f=V.vertices;for(var g=0;g<p;g++)u[g]+=v[g]-f[g]}else L.arrayCopy(v,0,u,0,p);else switch(a){case t.MixBlend.setup:var _=l;if(_.bones)for(var x=0;x<p;x++)u[x]=v[x]*o;else{f=_.vertices;for(var b=0;b<p;b++){var w=f[b];u[b]=w+(v[b]-w)*o}}break;case t.MixBlend.first:case t.MixBlend.replace:for(var T=0;T<p;T++)u[T]+=(v[T]-u[T])*o;break;case t.MixBlend.add:if((V=l).bones)for(var E=0;E<p;E++)u[E]+=v[E]*o;else{f=V.vertices;for(var S=0;S<p;S++)u[S]+=(v[S]-f[S])*o}}}else{var A=Gr.search1(d,i),I=this.getCurvePercent(i,A),P=c[A],M=c[A+1];if(1==o)if(a==t.MixBlend.add)if((V=l).bones)for(var C=0;C<p;C++){O=P[C];u[C]+=O+(M[C]-O)*I}else{f=V.vertices;for(var R=0;R<p;R++){var O=P[R];u[R]+=O+(M[R]-O)*I-f[R]}}else for(var D=0;D<p;D++){O=P[D];u[D]=O+(M[D]-O)*I}else switch(a){case t.MixBlend.setup:var B=l;if(B.bones)for(var N=0;N<p;N++){O=P[N];u[N]=(O+(M[N]-O)*I)*o}else{f=B.vertices;for(var k=0;k<p;k++){var O=P[k];w=f[k];u[k]=w+(O+(M[k]-O)*I-w)*o}}break;case t.MixBlend.first:case t.MixBlend.replace:for(var F=0;F<p;F++){O=P[F];u[F]+=(O+(M[F]-O)*I-u[F])*o}break;case t.MixBlend.add:var V;if((V=l).bones)for(var X=0;X<p;X++){O=P[X];u[X]+=(O+(M[X]-O)*I)*o}else{f=V.vertices;for(var j=0;j<p;j++){O=P[j];u[j]+=(O+(M[j]-O)*I-f[j])*o}}}}}}},r}(Hr),fi=function(t){function e(r){var i=t.call(this,r,e.propertyIds)||this;return i.events=new Array(r),i}return dr(e,t),e.prototype.getFrameCount=function(){return this.frames.length},e.prototype.setFrame=function(t,e){this.frames[t]=e.time,this.events[t]=e},e.prototype.apply=function(t,e,r,i,n,o,a){if(i){var s=this.frames,h=this.frames.length;if(e>r)this.apply(t,e,Number.MAX_VALUE,i,n,o,a),e=-1;else if(e>=s[h-1])return;if(!(r<s[0])){var l=0;if(e<s[0])l=0;else for(var u=s[l=Gr.search1(s,e)+1];l>0&&s[l-1]==u;)l--;for(;l<h&&r>=s[l];l++)i.push(this.events[l])}}},e.propertyIds=[""+Vr],e}(Gr),mi=function(e){function r(t){var i=e.call(this,t,r.propertyIds)||this;return i.drawOrders=new Array(t),i}return dr(r,e),r.prototype.getFrameCount=function(){return this.frames.length},r.prototype.setFrame=function(t,e,r){this.frames[t]=e,this.drawOrders[t]=r},r.prototype.apply=function(e,r,i,n,o,a,s){if(s!=t.MixDirection.mixOut)if(i<this.frames[0])a!=t.MixBlend.setup&&a!=t.MixBlend.first||L.arrayCopy(e.slots,0,e.drawOrder,0,e.slots.length);else{var h=Gr.search1(this.frames,i),l=this.drawOrders[h];if(l)for(var u=e.drawOrder,c=e.slots,p=0,d=l.length;p<d;p++)u[p]=c[l[p]];else L.arrayCopy(e.slots,0,e.drawOrder,0,e.slots.length)}else a==t.MixBlend.setup&&L.arrayCopy(e.slots,0,e.drawOrder,0,e.slots.length)},r.propertyIds=[""+Xr],r}(Gr),vi=function(e){function r(t,r,i){var n=e.call(this,t,r,[jr+"|"+i])||this;return n.ikConstraintIndex=0,n.ikConstraintIndex=i,n}return dr(r,e),r.prototype.getFrameEntries=function(){return 6},r.prototype.setFrame=function(t,e,r,i,n,o,a){t*=6,this.frames[t]=e,this.frames[t+1]=r,this.frames[t+2]=i,this.frames[t+3]=n,this.frames[t+4]=o?1:0,this.frames[t+5]=a?1:0},r.prototype.apply=function(e,r,i,n,o,a,s){var h=e.ikConstraints[this.ikConstraintIndex];if(h.active){var l=this.frames;if(i<l[0])switch(a){case t.MixBlend.setup:return h.mix=h.data.mix,h.softness=h.data.softness,h.bendDirection=h.data.bendDirection,h.compress=h.data.compress,void(h.stretch=h.data.stretch);case t.MixBlend.first:h.mix+=(h.data.mix-h.mix)*o,h.softness+=(h.data.softness-h.softness)*o,h.bendDirection=h.data.bendDirection,h.compress=h.data.compress,h.stretch=h.data.stretch}else{var u=0,c=0,p=Gr.search(l,i,6),d=this.curves[p/6];switch(d){case 0:var f=l[p];u=l[p+1],c=l[p+2];var m=(i-f)/(l[p+6]-f);u+=(l[p+6+1]-u)*m,c+=(l[p+6+2]-c)*m;break;case 1:u=l[p+1],c=l[p+2];break;default:u=this.getBezierValue(i,p,1,d-2),c=this.getBezierValue(i,p,2,d+18-2)}a==t.MixBlend.setup?(h.mix=h.data.mix+(u-h.data.mix)*o,h.softness=h.data.softness+(c-h.data.softness)*o,s==t.MixDirection.mixOut?(h.bendDirection=h.data.bendDirection,h.compress=h.data.compress,h.stretch=h.data.stretch):(h.bendDirection=l[p+3],h.compress=0!=l[p+4],h.stretch=0!=l[p+5])):(h.mix+=(u-h.mix)*o,h.softness+=(c-h.softness)*o,s==t.MixDirection.mixIn&&(h.bendDirection=l[p+3],h.compress=0!=l[p+4],h.stretch=0!=l[p+5]))}}},r}(Hr),yi=function(e){function r(t,r,i){var n=e.call(this,t,r,[Ur+"|"+i])||this;return n.transformConstraintIndex=0,n.transformConstraintIndex=i,n}return dr(r,e),r.prototype.getFrameEntries=function(){return 7},r.prototype.setFrame=function(t,e,r,i,n,o,a,s){var h=this.frames;h[t*=7]=e,h[t+1]=r,h[t+2]=i,h[t+3]=n,h[t+4]=o,h[t+5]=a,h[t+6]=s},r.prototype.apply=function(e,r,i,n,o,a,s){var h=e.transformConstraints[this.transformConstraintIndex];if(h.active){var l=this.frames;if(i<l[0]){var u=h.data;switch(a){case t.MixBlend.setup:return h.mixRotate=u.mixRotate,h.mixX=u.mixX,h.mixY=u.mixY,h.mixScaleX=u.mixScaleX,h.mixScaleY=u.mixScaleY,void(h.mixShearY=u.mixShearY);case t.MixBlend.first:h.mixRotate+=(u.mixRotate-h.mixRotate)*o,h.mixX+=(u.mixX-h.mixX)*o,h.mixY+=(u.mixY-h.mixY)*o,h.mixScaleX+=(u.mixScaleX-h.mixScaleX)*o,h.mixScaleY+=(u.mixScaleY-h.mixScaleY)*o,h.mixShearY+=(u.mixShearY-h.mixShearY)*o}}else{var c,p,d,f,m,v,y=Gr.search(l,i,7),g=this.curves[y/7];switch(g){case 0:var _=l[y];c=l[y+1],p=l[y+2],d=l[y+3],f=l[y+4],m=l[y+5],v=l[y+6];var x=(i-_)/(l[y+7]-_);c+=(l[y+7+1]-c)*x,p+=(l[y+7+2]-p)*x,d+=(l[y+7+3]-d)*x,f+=(l[y+7+4]-f)*x,m+=(l[y+7+5]-m)*x,v+=(l[y+7+6]-v)*x;break;case 1:c=l[y+1],p=l[y+2],d=l[y+3],f=l[y+4],m=l[y+5],v=l[y+6];break;default:c=this.getBezierValue(i,y,1,g-2),p=this.getBezierValue(i,y,2,g+18-2),d=this.getBezierValue(i,y,3,g+36-2),f=this.getBezierValue(i,y,4,g+54-2),m=this.getBezierValue(i,y,5,g+72-2),v=this.getBezierValue(i,y,6,g+90-2)}if(a==t.MixBlend.setup){u=h.data;h.mixRotate=u.mixRotate+(c-u.mixRotate)*o,h.mixX=u.mixX+(p-u.mixX)*o,h.mixY=u.mixY+(d-u.mixY)*o,h.mixScaleX=u.mixScaleX+(f-u.mixScaleX)*o,h.mixScaleY=u.mixScaleY+(m-u.mixScaleY)*o,h.mixShearY=u.mixShearY+(v-u.mixShearY)*o}else h.mixRotate+=(c-h.mixRotate)*o,h.mixX+=(p-h.mixX)*o,h.mixY+=(d-h.mixY)*o,h.mixScaleX+=(f-h.mixScaleX)*o,h.mixScaleY+=(m-h.mixScaleY)*o,h.mixShearY+=(v-h.mixShearY)*o}}},r}(Hr),gi=function(e){function r(t,r,i){var n=e.call(this,t,r,Yr+"|"+i)||this;return n.pathConstraintIndex=0,n.pathConstraintIndex=i,n}return dr(r,e),r.prototype.apply=function(e,r,i,n,o,a,s){var h=e.pathConstraints[this.pathConstraintIndex];if(h.active)if(i<this.frames[0])switch(a){case t.MixBlend.setup:return void(h.position=h.data.position);case t.MixBlend.first:h.position+=(h.data.position-h.position)*o}else{var l=this.getCurveValue(i);a==t.MixBlend.setup?h.position=h.data.position+(l-h.data.position)*o:h.position+=(l-h.position)*o}},r}($r),_i=function(e){function r(t,r,i){var n=e.call(this,t,r,zr+"|"+i)||this;return n.pathConstraintIndex=0,n.pathConstraintIndex=i,n}return dr(r,e),r.prototype.apply=function(e,r,i,n,o,a,s){var h=e.pathConstraints[this.pathConstraintIndex];if(h.active)if(i<this.frames[0])switch(a){case t.MixBlend.setup:return void(h.spacing=h.data.spacing);case t.MixBlend.first:h.spacing+=(h.data.spacing-h.spacing)*o}else{var l=this.getCurveValue(i);a==t.MixBlend.setup?h.spacing=h.data.spacing+(l-h.data.spacing)*o:h.spacing+=(l-h.spacing)*o}},r}($r),xi=function(e){function r(t,r,i){var n=e.call(this,t,r,[Wr+"|"+i])||this;return n.pathConstraintIndex=0,n.pathConstraintIndex=i,n}return dr(r,e),r.prototype.getFrameEntries=function(){return 4},r.prototype.setFrame=function(t,e,r,i,n){var o=this.frames;o[t<<=2]=e,o[t+1]=r,o[t+2]=i,o[t+3]=n},r.prototype.apply=function(e,r,i,n,o,a,s){var h=e.pathConstraints[this.pathConstraintIndex];if(h.active){var l=this.frames;if(i<l[0])switch(a){case t.MixBlend.setup:return h.mixRotate=h.data.mixRotate,h.mixX=h.data.mixX,void(h.mixY=h.data.mixY);case t.MixBlend.first:h.mixRotate+=(h.data.mixRotate-h.mixRotate)*o,h.mixX+=(h.data.mixX-h.mixX)*o,h.mixY+=(h.data.mixY-h.mixY)*o}else{var u,c,p,d=Gr.search(l,i,4),f=this.curves[d>>2];switch(f){case 0:var m=l[d];u=l[d+1],c=l[d+2],p=l[d+3];var v=(i-m)/(l[d+4]-m);u+=(l[d+4+1]-u)*v,c+=(l[d+4+2]-c)*v,p+=(l[d+4+3]-p)*v;break;case 1:u=l[d+1],c=l[d+2],p=l[d+3];break;default:u=this.getBezierValue(i,d,1,f-2),c=this.getBezierValue(i,d,2,f+18-2),p=this.getBezierValue(i,d,3,f+36-2)}if(a==t.MixBlend.setup){var y=h.data;h.mixRotate=y.mixRotate+(u-y.mixRotate)*o,h.mixX=y.mixX+(c-y.mixX)*o,h.mixY=y.mixY+(p-y.mixY)*o}else h.mixRotate+=(u-h.mixRotate)*o,h.mixX+=(c-h.mixX)*o,h.mixY+=(p-h.mixY)*o}}},r}(Hr),bi=function(e){function r(t,r,i){var n=e.call(this,t,[qr+"|"+r+"|"+i.sequence.id])||this;return n.slotIndex=r,n.attachment=i,n}return dr(r,e),r.prototype.getFrameEntries=function(){return r.ENTRIES},r.prototype.getSlotIndex=function(){return this.slotIndex},r.prototype.getAttachment=function(){return this.attachment},r.prototype.setFrame=function(t,e,i,n,o){var a=this.frames;a[t*=r.ENTRIES]=e,a[t+r.MODE]=i|n<<4,a[t+r.DELAY]=o},r.prototype.apply=function(e,i,n,o,a,s,h){var l=e.slots[this.slotIndex];if(l.bone.active){var u=l.attachment,c=this.attachment;if(u==c||u instanceof vr&&u.timelineAttachment==c){var p=this.frames;if(n<p[0])s!=t.MixBlend.setup&&s!=t.MixBlend.first||(l.sequenceIndex=-1);else{var d=Gr.search(p,n,r.ENTRIES),f=p[d],m=p[d+r.MODE],v=p[d+r.DELAY];if(this.attachment.sequence){var y=m>>4,g=this.attachment.sequence.regions.length,_=Sr[15&m];if(_!=fr.hold)switch(y+=(n-f)/v+1e-5|0,_){case fr.once:y=Math.min(g-1,y);break;case fr.loop:y%=g;break;case fr.pingpong:(y=0==(x=(g<<1)-2)?0:y%x)>=g&&(y=x-y);break;case fr.onceReverse:y=Math.max(g-1-y,0);break;case fr.loopReverse:y=g-1-y%g;break;case fr.pingpongReverse:var x;(y=0==(x=(g<<1)-2)?0:(y+g-1)%x)>=g&&(y=x-y)}l.sequenceIndex=y}}}}},r.ENTRIES=3,r.MODE=1,r.DELAY=2,r}(Gr),wi=function(){function e(t){this.tracks=new Array,this.timeScale=1,this.unkeyedState=0,this.events=new Array,this.listeners=new Array,this.queue=new Ei(this),this.propertyIDs=new O,this.animationsChanged=!1,this.trackEntryPool=new X((function(){return new Ti})),this.data=t}return e.emptyAnimation=function(){return e._emptyAnimation},e.prototype.update=function(t){t*=this.timeScale;for(var e=this.tracks,r=0,i=e.length;r<i;r++){var n=e[r];if(n){n.animationLast=n.nextAnimationLast,n.trackLast=n.nextTrackLast;var o=t*n.timeScale;if(n.delay>0){if(n.delay-=o,n.delay>0)continue;o=-n.delay,n.delay=0}var a=n.next;if(a){var s=n.trackLast-a.delay;if(s>=0){for(a.delay=0,a.trackTime+=0==n.timeScale?0:(s/n.timeScale+t)*a.timeScale,n.trackTime+=o,this.setCurrent(r,a,!0);a.mixingFrom;)a.mixTime+=t,a=a.mixingFrom;continue}}else if(n.trackLast>=n.trackEnd&&!n.mixingFrom){e[r]=null,this.queue.end(n),this.clearNext(n);continue}if(n.mixingFrom&&this.updateMixingFrom(n,t)){var h=n.mixingFrom;for(n.mixingFrom=null,h&&(h.mixingTo=null);h;)this.queue.end(h),h=h.mixingFrom}n.trackTime+=o}}this.queue.drain()},e.prototype.updateMixingFrom=function(t,e){var r=t.mixingFrom;if(!r)return!0;var i=this.updateMixingFrom(r,e);return r.animationLast=r.nextAnimationLast,r.trackLast=r.nextTrackLast,t.mixTime>0&&t.mixTime>=t.mixDuration?(0!=r.totalAlpha&&0!=t.mixDuration||(t.mixingFrom=r.mixingFrom,r.mixingFrom&&(r.mixingFrom.mixingTo=t),t.interruptAlpha=r.interruptAlpha,this.queue.end(r)),i):(r.trackTime+=e*r.timeScale,t.mixTime+=e,!1)},e.prototype.apply=function(e){if(!e)throw new Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();for(var r=this.events,i=this.tracks,n=!1,o=0,a=i.length;o<a;o++){var s=i[o];if(s&&!(s.delay>0)){n=!0;var h=0==o?t.MixBlend.first:s.mixBlend,l=s.alpha;s.mixingFrom?l*=this.applyMixingFrom(s,e,h):s.trackTime>=s.trackEnd&&!s.next&&(l=0);var u=s.animationLast,c=s.getAnimationTime(),p=c,d=r;s.reverse&&(p=s.animation.duration-p,d=null);var f=s.animation.timelines,m=f.length;if(0==o&&1==l||h==t.MixBlend.add)for(var v=0;v<m;v++){L.webkit602BugfixHelper(l,h);var y=f[v];y instanceof pi?this.applyAttachmentTimeline(y,e,p,h,!0):y.apply(e,u,p,d,l,h,t.MixDirection.mixIn)}else{var g=s.timelineMode,_=s.shortestRotation,x=!_&&s.timelinesRotation.length!=m<<1;x&&(s.timelinesRotation.length=m<<1);for(v=0;v<m;v++){var b=f[v],w=g[v]==Ii?h:t.MixBlend.setup;!_&&b instanceof Zr?this.applyRotateTimeline(b,e,p,l,w,s.timelinesRotation,v<<1,x):b instanceof pi?this.applyAttachmentTimeline(b,e,p,h,!0):(L.webkit602BugfixHelper(l,h),b.apply(e,u,p,d,l,w,t.MixDirection.mixIn))}}this.queueEvents(s,c),r.length=0,s.nextAnimationLast=c,s.nextTrackLast=s.trackTime}}for(var T=this.unkeyedState+Oi,E=e.slots,S=0,A=e.slots.length;S<A;S++){var I=E[S];if(I.attachmentState==T){var P=I.data.attachmentName;I.setAttachment(P?e.getAttachment(I.data.index,P):null)}}return this.unkeyedState+=2,this.queue.drain(),n},e.prototype.applyMixingFrom=function(e,r,i){var n=e.mixingFrom;n.mixingFrom&&this.applyMixingFrom(n,r,i);var o=0;0==e.mixDuration?(o=1,i==t.MixBlend.first&&(i=t.MixBlend.setup)):((o=e.mixTime/e.mixDuration)>1&&(o=1),i!=t.MixBlend.first&&(i=n.mixBlend));var a=o<n.attachmentThreshold,s=o<n.drawOrderThreshold,h=n.animation.timelines,l=h.length,u=n.alpha*e.interruptAlpha,c=u*(1-o),p=n.animationLast,d=n.getAnimationTime(),f=d,m=null;if(n.reverse?f=n.animation.duration-f:o<n.eventThreshold&&(m=this.events),i==t.MixBlend.add)for(var v=0;v<l;v++)h[v].apply(r,p,f,m,c,i,t.MixDirection.mixOut);else{var y=n.timelineMode,g=n.timelineHoldMix,_=n.shortestRotation,x=!_&&n.timelinesRotation.length!=l<<1;x&&(n.timelinesRotation.length=l<<1),n.totalAlpha=0;for(v=0;v<l;v++){var b=h[v],w=t.MixDirection.mixOut,T=void 0,E=0;switch(y[v]){case Ii:if(!s&&b instanceof mi)continue;T=i,E=c;break;case Pi:T=t.MixBlend.setup,E=c;break;case Mi:T=i,E=u;break;case Ci:T=t.MixBlend.setup,E=u;break;default:T=t.MixBlend.setup;var S=g[v];E=u*Math.max(0,1-S.mixTime/S.mixDuration)}n.totalAlpha+=E,!_&&b instanceof Zr?this.applyRotateTimeline(b,r,f,E,T,n.timelinesRotation,v<<1,x):b instanceof pi?this.applyAttachmentTimeline(b,r,f,T,a):(L.webkit602BugfixHelper(E,i),s&&b instanceof mi&&T==t.MixBlend.setup&&(w=t.MixDirection.mixIn),b.apply(r,p,f,m,E,T,w))}}return e.mixDuration>0&&this.queueEvents(n,d),this.events.length=0,n.nextAnimationLast=d,n.nextTrackLast=n.trackTime,o},e.prototype.applyAttachmentTimeline=function(e,r,i,n,o){var a=r.slots[e.slotIndex];a.bone.active&&(i<e.frames[0]?n!=t.MixBlend.setup&&n!=t.MixBlend.first||this.setAttachment(r,a,a.data.attachmentName,o):this.setAttachment(r,a,e.attachmentNames[Gr.search1(e.frames,i)],o),a.attachmentState<=this.unkeyedState&&(a.attachmentState=this.unkeyedState+Oi))},e.prototype.setAttachment=function(t,e,r,i){e.setAttachment(r?t.getAttachment(e.data.index,r):null),i&&(e.attachmentState=this.unkeyedState+Di)},e.prototype.applyRotateTimeline=function(e,r,i,n,o,a,s,h){if(h&&(a[s]=0),1!=n){var l=r.bones[e.boneIndex];if(l.active){var u=0,c=0;if(i<e.frames[0])switch(o){case t.MixBlend.setup:l.rotation=l.data.rotation;default:return;case t.MixBlend.first:u=l.rotation,c=l.data.rotation}else u=o==t.MixBlend.setup?l.data.rotation:l.rotation,c=l.data.rotation+e.getCurveValue(i);var p=0,d=c-u;if(0==(d-=360*(16384-(16384.499999999996-d/360|0))))p=a[s];else{var f=0,m=0;h?(f=0,m=d):(f=a[s],m=a[s+1]);var v=d>0,y=f>=0;B.signum(m)!=B.signum(d)&&Math.abs(m)<=90&&(Math.abs(f)>180&&(f+=360*B.signum(f)),y=v),p=d+f-f%360,y!=v&&(p+=360*B.signum(f)),a[s]=p}a[s+1]=d,l.rotation=u+p*n}}else e.apply(r,0,i,null,1,o,t.MixDirection.mixIn)},e.prototype.queueEvents=function(t,e){for(var r=t.animationStart,i=t.animationEnd,n=i-r,o=t.trackLast%n,a=this.events,s=0,h=a.length;s<h;s++){var l=a[s];if(l.time<o)break;l.time>i||this.queue.event(t,l)}for((t.loop?0==n||o>t.trackTime%n:e>=i&&t.animationLast<i)&&this.queue.complete(t);s<h;s++){var u=a[s];u.time<r||this.queue.event(t,u)}},e.prototype.clearTracks=function(){var t=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(var e=0,r=this.tracks.length;e<r;e++)this.clearTrack(e);this.tracks.length=0,this.queue.drainDisabled=t,this.queue.drain()},e.prototype.clearTrack=function(t){if(!(t>=this.tracks.length)){var e=this.tracks[t];if(e){this.queue.end(e),this.clearNext(e);for(var r=e;;){var i=r.mixingFrom;if(!i)break;this.queue.end(i),r.mixingFrom=null,r.mixingTo=null,r=i}this.tracks[e.trackIndex]=null,this.queue.drain()}}},e.prototype.setCurrent=function(t,e,r){var i=this.expandToIndex(t);this.tracks[t]=e,e.previous=null,i&&(r&&this.queue.interrupt(i),e.mixingFrom=i,i.mixingTo=e,e.mixTime=0,i.mixingFrom&&i.mixDuration>0&&(e.interruptAlpha*=Math.min(1,i.mixTime/i.mixDuration)),i.timelinesRotation.length=0),this.queue.start(e)},e.prototype.setAnimation=function(t,e,r){void 0===r&&(r=!1);var i=this.data.skeletonData.findAnimation(e);if(!i)throw new Error("Animation not found: "+e);return this.setAnimationWith(t,i,r)},e.prototype.setAnimationWith=function(t,e,r){if(void 0===r&&(r=!1),!e)throw new Error("animation cannot be null.");var i=!0,n=this.expandToIndex(t);n&&(-1==n.nextTrackLast?(this.tracks[t]=n.mixingFrom,this.queue.interrupt(n),this.queue.end(n),this.clearNext(n),n=n.mixingFrom,i=!1):this.clearNext(n));var o=this.trackEntry(t,e,r,n);return this.setCurrent(t,o,i),this.queue.drain(),o},e.prototype.addAnimation=function(t,e,r,i){void 0===r&&(r=!1),void 0===i&&(i=0);var n=this.data.skeletonData.findAnimation(e);if(!n)throw new Error("Animation not found: "+e);return this.addAnimationWith(t,n,r,i)},e.prototype.addAnimationWith=function(t,e,r,i){if(void 0===r&&(r=!1),void 0===i&&(i=0),!e)throw new Error("animation cannot be null.");var n=this.expandToIndex(t);if(n)for(;n.next;)n=n.next;var o=this.trackEntry(t,e,r,n);return n?(n.next=o,o.previous=n,i<=0&&(i+=n.getTrackComplete()-o.mixDuration)):(this.setCurrent(t,o,!0),this.queue.drain()),o.delay=i,o},e.prototype.setEmptyAnimation=function(t,r){void 0===r&&(r=0);var i=this.setAnimationWith(t,e.emptyAnimation(),!1);return i.mixDuration=r,i.trackEnd=r,i},e.prototype.addEmptyAnimation=function(t,r,i){void 0===r&&(r=0),void 0===i&&(i=0);var n=this.addAnimationWith(t,e.emptyAnimation(),!1,i);return i<=0&&(n.delay+=n.mixDuration-r),n.mixDuration=r,n.trackEnd=r,n},e.prototype.setEmptyAnimations=function(t){void 0===t&&(t=0);var e=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(var r=0,i=this.tracks.length;r<i;r++){var n=this.tracks[r];n&&this.setEmptyAnimation(n.trackIndex,t)}this.queue.drainDisabled=e,this.queue.drain()},e.prototype.expandToIndex=function(t){return t<this.tracks.length?this.tracks[t]:(L.ensureArrayCapacity(this.tracks,t+1,null),this.tracks.length=t+1,null)},e.prototype.trackEntry=function(e,r,i,n){var o=this.trackEntryPool.obtain();return o.reset(),o.trackIndex=e,o.animation=r,o.loop=i,o.holdPrevious=!1,o.reverse=!1,o.shortestRotation=!1,o.eventThreshold=0,o.attachmentThreshold=0,o.drawOrderThreshold=0,o.animationStart=0,o.animationEnd=r.duration,o.animationLast=-1,o.nextAnimationLast=-1,o.delay=0,o.trackTime=0,o.trackLast=-1,o.nextTrackLast=-1,o.trackEnd=Number.MAX_VALUE,o.timeScale=1,o.alpha=1,o.mixTime=0,o.mixDuration=n?this.data.getMix(n.animation,r):0,o.interruptAlpha=1,o.totalAlpha=0,o.mixBlend=t.MixBlend.replace,o},e.prototype.clearNext=function(t){for(var e=t.next;e;)this.queue.dispose(e),e=e.next;t.next=null},e.prototype._animationsChanged=function(){this.animationsChanged=!1,this.propertyIDs.clear();for(var e=this.tracks,r=0,i=e.length;r<i;r++){var n=e[r];if(n){for(;n.mixingFrom;)n=n.mixingFrom;do{n.mixingTo&&n.mixBlend==t.MixBlend.add||this.computeHold(n),n=n.mixingTo}while(n)}}},e.prototype.computeHold=function(t){var e=t.mixingTo,r=t.animation.timelines,i=t.animation.timelines.length,n=t.timelineMode;n.length=i;var o=t.timelineHoldMix;o.length=0;var a=this.propertyIDs;if(e&&e.holdPrevious)for(var s=0;s<i;s++)n[s]=a.addAll(r[s].getPropertyIds())?Ci:Mi;else t:for(s=0;s<i;s++){var h=r[s],l=h.getPropertyIds();if(a.addAll(l))if(!e||h instanceof pi||h instanceof mi||h instanceof fi||!e.animation.hasTimeline(l))n[s]=Pi;else{for(var u=e.mixingTo;u;u=u.mixingTo)if(!u.animation.hasTimeline(l)){if(t.mixDuration>0){n[s]=Ri,o[s]=u;continue t}break}n[s]=Ci}else n[s]=Ii}},e.prototype.getCurrent=function(t){return t>=this.tracks.length?null:this.tracks[t]},e.prototype.addListener=function(t){if(!t)throw new Error("listener cannot be null.");this.listeners.push(t)},e.prototype.removeListener=function(t){var e=this.listeners.indexOf(t);e>=0&&this.listeners.splice(e,1)},e.prototype.clearListeners=function(){this.listeners.length=0},e.prototype.clearListenerNotifications=function(){this.queue.clear()},e.prototype.setAnimationByName=function(t,r,i){e.deprecatedWarning1||(e.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: AnimationState.setAnimationByName is deprecated, please use setAnimation from now on.")),this.setAnimation(t,r,i)},e.prototype.addAnimationByName=function(t,r,i,n){e.deprecatedWarning2||(e.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: AnimationState.addAnimationByName is deprecated, please use addAnimation from now on.")),this.addAnimation(t,r,i,n)},e.prototype.hasAnimation=function(t){return null!==this.data.skeletonData.findAnimation(t)},e.prototype.hasAnimationByName=function(t){return e.deprecatedWarning3||(e.deprecatedWarning3=!0,console.warn("Spine Deprecation Warning: AnimationState.hasAnimationByName is deprecated, please use hasAnimation from now on.")),this.hasAnimation(t)},e._emptyAnimation=new Ar("<empty>",[],0),e.deprecatedWarning1=!1,e.deprecatedWarning2=!1,e.deprecatedWarning3=!1,e}(),Ti=function(){function e(){this.animation=null,this.previous=null,this.next=null,this.mixingFrom=null,this.mixingTo=null,this.listener=null,this.trackIndex=0,this.loop=!1,this.holdPrevious=!1,this.reverse=!1,this.shortestRotation=!1,this.eventThreshold=0,this.attachmentThreshold=0,this.drawOrderThreshold=0,this.animationStart=0,this.animationEnd=0,this.animationLast=0,this.nextAnimationLast=0,this.delay=0,this.trackTime=0,this.trackLast=0,this.nextTrackLast=0,this.trackEnd=0,this.timeScale=0,this.alpha=0,this.mixTime=0,this.mixDuration=0,this.interruptAlpha=0,this.totalAlpha=0,this.mixBlend=t.MixBlend.replace,this.timelineMode=new Array,this.timelineHoldMix=new Array,this.timelinesRotation=new Array}return e.prototype.reset=function(){this.next=null,this.previous=null,this.mixingFrom=null,this.mixingTo=null,this.animation=null,this.listener=null,this.timelineMode.length=0,this.timelineHoldMix.length=0,this.timelinesRotation.length=0},e.prototype.getAnimationTime=function(){if(this.loop){var t=this.animationEnd-this.animationStart;return 0==t?this.animationStart:this.trackTime%t+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)},e.prototype.setAnimationLast=function(t){this.animationLast=t,this.nextAnimationLast=t},e.prototype.isComplete=function(){return this.trackTime>=this.animationEnd-this.animationStart},e.prototype.resetRotationDirections=function(){this.timelinesRotation.length=0},e.prototype.getTrackComplete=function(){var t=this.animationEnd-this.animationStart;if(0!=t){if(this.loop)return t*(1+(this.trackTime/t|0));if(this.trackTime<t)return t}return this.trackTime},Object.defineProperty(e.prototype,"time",{get:function(){return e.deprecatedWarning1||(e.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime},set:function(t){e.deprecatedWarning1||(e.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"endTime",{get:function(){return e.deprecatedWarning2||(e.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime},set:function(t){e.deprecatedWarning2||(e.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime=t},enumerable:!1,configurable:!0}),e.prototype.loopsCount=function(){return Math.floor(this.trackTime/this.trackEnd)},e.deprecatedWarning1=!1,e.deprecatedWarning2=!1,e}(),Ei=function(){function t(t){this.objects=[],this.drainDisabled=!1,this.animState=t}return t.prototype.start=function(t){this.objects.push(Er.start),this.objects.push(t),this.animState.animationsChanged=!0},t.prototype.interrupt=function(t){this.objects.push(Er.interrupt),this.objects.push(t)},t.prototype.end=function(t){this.objects.push(Er.end),this.objects.push(t),this.animState.animationsChanged=!0},t.prototype.dispose=function(t){this.objects.push(Er.dispose),this.objects.push(t)},t.prototype.complete=function(t){this.objects.push(Er.complete),this.objects.push(t)},t.prototype.event=function(t,e){this.objects.push(Er.event),this.objects.push(t),this.objects.push(e)},t.prototype.drain=function(){if(!this.drainDisabled){this.drainDisabled=!0;for(var t=this.objects,e=this.animState.listeners,r=0;r<t.length;r+=2){var i=t[r],n=t[r+1];switch(i){case Er.start:n.listener&&n.listener.start&&n.listener.start(n);for(var o=0;o<e.length;o++){(s=e[o]).start&&s.start(n)}break;case Er.interrupt:n.listener&&n.listener.interrupt&&n.listener.interrupt(n);for(o=0;o<e.length;o++){(s=e[o]).interrupt&&s.interrupt(n)}break;case Er.end:n.listener&&n.listener.end&&n.listener.end(n);for(o=0;o<e.length;o++){(s=e[o]).end&&s.end(n)}case Er.dispose:n.listener&&n.listener.dispose&&n.listener.dispose(n);for(o=0;o<e.length;o++){(s=e[o]).dispose&&s.dispose(n)}this.animState.trackEntryPool.free(n);break;case Er.complete:n.listener&&n.listener.complete&&n.listener.complete(n);for(o=0;o<e.length;o++){(s=e[o]).complete&&s.complete(n)}break;case Er.event:var a=t[2+r++];n.listener&&n.listener.event&&n.listener.event(n,a);for(o=0;o<e.length;o++){var s;(s=e[o]).event&&s.event(n,a)}}}this.clear(),this.drainDisabled=!1}},t.prototype.clear=function(){this.objects.length=0},t}();!function(t){t[t.start=0]="start",t[t.interrupt=1]="interrupt",t[t.end=2]="end",t[t.dispose=3]="dispose",t[t.complete=4]="complete",t[t.event=5]="event"}(Er||(Er={}));var Si,Ai=function(){function t(){}return t.prototype.start=function(t){},t.prototype.interrupt=function(t){},t.prototype.end=function(t){},t.prototype.dispose=function(t){},t.prototype.complete=function(t){},t.prototype.event=function(t,e){},t}(),Ii=0,Pi=1,Mi=2,Ci=3,Ri=4,Oi=1,Di=2,Bi=function(){function t(t){if(this.animationToMixTime={},this.defaultMix=0,!t)throw new Error("skeletonData cannot be null.");this.skeletonData=t}return t.prototype.setMix=function(t,e,r){var i=this.skeletonData.findAnimation(t);if(!i)throw new Error("Animation not found: "+t);var n=this.skeletonData.findAnimation(e);if(!n)throw new Error("Animation not found: "+e);this.setMixWith(i,n,r)},t.prototype.setMixWith=function(t,e,r){if(!t)throw new Error("from cannot be null.");if(!e)throw new Error("to cannot be null.");var i=t.name+"."+e.name;this.animationToMixTime[i]=r},t.prototype.getMix=function(t,e){var r=t.name+"."+e.name,i=this.animationToMixTime[r];return void 0===i?this.defaultMix:i},t}(),Ni=function(){function t(t){this.atlas=t}return t.prototype.loadSequence=function(t,e,r){for(var i=r.regions,n=0,o=i.length;n<o;n++){var a=r.getPath(e,n),s=this.atlas.findRegion(a);if(null==s)throw new Error("Region not found in atlas: "+a+" (sequence: "+t+")");i[n]=s,i[n].renderObject=i[n]}},t.prototype.newRegionAttachment=function(t,e,r,i){var n=new wr(e,r);if(null!=i)this.loadSequence(e,r,i);else{var o=this.atlas.findRegion(r);if(!o)throw new Error("Region not found in atlas: "+r+" (region attachment: "+e+")");o.renderObject=o,n.region=o}return n},t.prototype.newMeshAttachment=function(t,e,r,i){var n=new _r(e,r);if(null!=i)this.loadSequence(e,r,i);else{var o=this.atlas.findRegion(r);if(!o)throw new Error("Region not found in atlas: "+r+" (mesh attachment: "+e+")");o.renderObject=o,n.region=o}return n},t.prototype.newBoundingBoxAttachment=function(t,e){return new yr(e)},t.prototype.newPathAttachment=function(t,e){return new xr(e)},t.prototype.newPointAttachment=function(t,e){return new br(e)},t.prototype.newClippingAttachment=function(t,e){return new gr(e)},t}(),ki=function(){function e(t,e,r){if(this.matrix=new n.Matrix,this.parent=null,this.children=new Array,this.x=0,this.y=0,this.rotation=0,this.scaleX=0,this.scaleY=0,this.shearX=0,this.shearY=0,this.ax=0,this.ay=0,this.arotation=0,this.ascaleX=0,this.ascaleY=0,this.ashearX=0,this.ashearY=0,this.sorted=!1,this.active=!1,!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.skeleton=e,this.parent=r,this.setToSetupPose()}return Object.defineProperty(e.prototype,"worldX",{get:function(){return this.matrix.tx},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"worldY",{get:function(){return this.matrix.ty},enumerable:!1,configurable:!0}),e.prototype.isActive=function(){return this.active},e.prototype.update=function(){this.updateWorldTransformWith(this.ax,this.ay,this.arotation,this.ascaleX,this.ascaleY,this.ashearX,this.ashearY)},e.prototype.updateWorldTransform=function(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)},e.prototype.updateWorldTransformWith=function(e,r,i,n,o,a,s){this.ax=e,this.ay=r,this.arotation=i,this.ascaleX=n,this.ascaleY=o,this.ashearX=a,this.ashearY=s;var h=this.parent,l=this.matrix,u=this.skeleton.scaleX,c=z.yDown?-this.skeleton.scaleY:this.skeleton.scaleY;if(!h){var p=this.skeleton,d=i+90+s;return l.a=B.cosDeg(i+a)*n*u,l.c=B.cosDeg(d)*o*u,l.b=B.sinDeg(i+a)*n*c,l.d=B.sinDeg(d)*o*c,l.tx=e*u+p.x,void(l.ty=r*c+p.y)}var f=h.matrix.a,m=h.matrix.c,v=h.matrix.b,y=h.matrix.d;switch(l.tx=f*e+m*r+h.matrix.tx,l.ty=v*e+y*r+h.matrix.ty,this.data.transformMode){case t.TransformMode.Normal:d=i+90+s;var g=B.cosDeg(i+a)*n,_=B.cosDeg(d)*o,x=B.sinDeg(i+a)*n,b=B.sinDeg(d)*o;return l.a=f*g+m*x,l.c=f*_+m*b,l.b=v*g+y*x,void(l.d=v*_+y*b);case t.TransformMode.OnlyTranslation:d=i+90+s;l.a=B.cosDeg(i+a)*n,l.c=B.cosDeg(d)*o,l.b=B.sinDeg(i+a)*n,l.d=B.sinDeg(d)*o;break;case t.TransformMode.NoRotationOrReflection:var w=0;(S=f*f+v*v)>1e-4?(S=Math.abs(f*y-m*v)/S,m=(v/=c)*S,y=(f/=u)*S,w=Math.atan2(v,f)*B.radDeg):(f=0,v=0,w=90-Math.atan2(y,m)*B.radDeg);var T=i+a-w,E=i+s-w+90;g=B.cosDeg(T)*n,_=B.cosDeg(E)*o,x=B.sinDeg(T)*n,b=B.sinDeg(E)*o;l.a=f*g-m*x,l.c=f*_-m*b,l.b=v*g+y*x,l.d=v*_+y*b;break;case t.TransformMode.NoScale:case t.TransformMode.NoScaleOrReflection:var S,A=B.cosDeg(i),I=B.sinDeg(i),P=(f*A+m*I)/u,M=(v*A+y*I)/c;(S=Math.sqrt(P*P+M*M))>1e-5&&(S=1/S),P*=S,M*=S,S=Math.sqrt(P*P+M*M),this.data.transformMode==t.TransformMode.NoScale&&f*y-m*v<0!=(u<0!=c<0)&&(S=-S);var C=Math.PI/2+Math.atan2(M,P),R=Math.cos(C)*S,O=Math.sin(C)*S;g=B.cosDeg(a)*n,_=B.cosDeg(90+s)*o,x=B.sinDeg(a)*n,b=B.sinDeg(90+s)*o;l.a=P*g+R*x,l.c=P*_+R*b,l.b=M*g+O*x,l.d=M*_+O*b}l.a*=u,l.c*=u,l.b*=c,l.d*=c},e.prototype.setToSetupPose=function(){var t=this.data;this.x=t.x,this.y=t.y,this.rotation=t.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this.shearX=t.shearX,this.shearY=t.shearY},e.prototype.getWorldRotationX=function(){return Math.atan2(this.matrix.b,this.matrix.a)*B.radDeg},e.prototype.getWorldRotationY=function(){return Math.atan2(this.matrix.d,this.matrix.c)*B.radDeg},e.prototype.getWorldScaleX=function(){var t=this.matrix;return Math.sqrt(t.a*t.a+t.b*t.b)},e.prototype.getWorldScaleY=function(){var t=this.matrix;return Math.sqrt(t.c*t.c+t.d*t.d)},e.prototype.updateAppliedTransform=function(){var t=this.parent,e=this.matrix;if(!t)return this.ax=e.tx-this.skeleton.x,this.ay=e.ty-this.skeleton.y,this.arotation=Math.atan2(e.b,e.a)*B.radDeg,this.ascaleX=Math.sqrt(e.a*e.a+e.b*e.b),this.ascaleY=Math.sqrt(e.c*e.c+e.d*e.d),this.ashearX=0,void(this.ashearY=Math.atan2(e.a*e.c+e.b*e.d,e.a*e.d-e.b*e.c)*B.radDeg);var r=t.matrix,i=1/(r.a*r.d-r.b*r.c),n=e.tx-r.tx,o=e.ty-r.ty;this.ax=n*r.d*i-o*r.c*i,this.ay=o*r.a*i-n*r.b*i;var a=i*r.d,s=i*r.a,h=i*r.c,l=i*r.b,u=a*e.a-h*e.b,c=a*e.c-h*e.d,p=s*e.b-l*e.a,d=s*e.d-l*e.c;if(this.ashearX=0,this.ascaleX=Math.sqrt(u*u+p*p),this.ascaleX>1e-4){var f=u*d-c*p;this.ascaleY=f/this.ascaleX,this.ashearY=Math.atan2(u*c+p*d,f)*B.radDeg,this.arotation=Math.atan2(p,u)*B.radDeg}else this.ascaleX=0,this.ascaleY=Math.sqrt(c*c+d*d),this.ashearY=0,this.arotation=90-Math.atan2(d,c)*B.radDeg},e.prototype.worldToLocal=function(t){var e=this.matrix,r=e.a,i=e.c,n=e.b,o=e.d,a=1/(r*o-i*n),s=t.x-e.tx,h=t.y-e.ty;return t.x=s*o*a-h*i*a,t.y=h*r*a-s*n*a,t},e.prototype.localToWorld=function(t){var e=this.matrix,r=t.x,i=t.y;return t.x=r*e.a+i*e.c+e.tx,t.y=r*e.b+i*e.d+e.ty,t},e.prototype.worldToLocalRotation=function(t){var e=B.sinDeg(t),r=B.cosDeg(t),i=this.matrix;return Math.atan2(i.a*e-i.b*r,i.d*r-i.c*e)*B.radDeg},e.prototype.localToWorldRotation=function(t){t-=this.rotation-this.shearX;var e=B.sinDeg(t),r=B.cosDeg(t),i=this.matrix;return Math.atan2(r*i.b+e*i.d,r*i.a+e*i.c)*B.radDeg},e.prototype.rotateWorld=function(t){var e=this.matrix,r=e.a,i=e.c,n=e.b,o=e.d,a=B.cosDeg(t),s=B.sinDeg(t);e.a=a*r-s*n,e.c=a*i-s*o,e.b=s*r+a*n,e.d=s*i+a*o},e}(),Fi=function(e,r,i){if(this.index=0,this.parent=null,this.length=0,this.x=0,this.y=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.shearX=0,this.shearY=0,this.transformMode=t.TransformMode.Normal,this.skinRequired=!1,this.color=new D,e<0)throw new Error("index must be >= 0.");if(!r)throw new Error("name cannot be null.");this.index=e,this.name=r,this.parent=i},Li=function(t,e,r){this.name=t,this.order=e,this.skinRequired=r},Vi=function(t,e){if(this.intValue=0,this.floatValue=0,this.stringValue=null,this.time=0,this.volume=0,this.balance=0,!e)throw new Error("data cannot be null.");this.time=t,this.data=e},Xi=function(t){this.intValue=0,this.floatValue=0,this.stringValue=null,this.audioPath=null,this.volume=0,this.balance=0,this.name=t},ji=function(){function e(t,e){if(this.bendDirection=0,this.compress=!1,this.stretch=!1,this.mix=1,this.softness=0,this.active=!1,!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.mix=t.mix,this.softness=t.softness,this.bendDirection=t.bendDirection,this.compress=t.compress,this.stretch=t.stretch,this.bones=new Array;for(var r=0;r<t.bones.length;r++){var i=e.findBone(t.bones[r].name);if(!i)throw new Error("Couldn't find bone "+t.bones[r].name);this.bones.push(i)}var n=e.findBone(t.target.name);if(!n)throw new Error("Couldn't find bone "+t.target.name);this.target=n}return e.prototype.isActive=function(){return this.active},e.prototype.update=function(){if(0!=this.mix){var t=this.target,e=this.bones;switch(e.length){case 1:this.apply1(e[0],t.worldX,t.worldY,this.compress,this.stretch,this.data.uniform,this.mix);break;case 2:this.apply2(e[0],e[1],t.worldX,t.worldY,this.bendDirection,this.stretch,this.data.uniform,this.softness,this.mix)}}},e.prototype.apply1=function(e,r,i,n,o,a,s){var h=e.parent.matrix;if(!h)throw new Error("IK bone must have parent.");var l=h.a,u=h.c,c=h.b,p=h.d,d=-e.ashearX-e.arotation,f=0,m=0,v=e.skeleton.scaleX,y=z.yDown?-e.skeleton.scaleY:e.skeleton.scaleY;switch(e.data.transformMode){case t.TransformMode.OnlyTranslation:f=r-e.worldX,m=i-e.worldY,z.yDown&&(m=-m);break;case t.TransformMode.NoRotationOrReflection:var g=l/v,_=c/y;u=-_*(S=Math.abs(l*p-u*c)/(l*l+c*c))*v,p=g*S*y,d+=Math.atan2(_,g)*B.radDeg;default:var x=r-h.tx,b=i-h.ty,w=l*p-u*c;f=(x*p-b*u)/w-e.ax,m=(b*l-x*c)/w-e.ay}d+=Math.atan2(m,f)*B.radDeg,e.ascaleX<0&&(d+=180),d>180?d-=360:d<-180&&(d+=360);var T=e.ascaleX,E=e.ascaleY;if(n||o){switch(e.data.transformMode){case t.TransformMode.NoScale:case t.TransformMode.NoScaleOrReflection:f=r-e.worldX,m=i-e.worldY}var S,A=e.data.length*T,I=Math.sqrt(f*f+m*m);if(n&&I<A||o&&I>A&&A>1e-4)T*=S=(I/A-1)*s+1,a&&(E*=S)}e.updateWorldTransformWith(e.ax,e.ay,e.arotation+d*s,T,E,e.ashearX,e.ashearY)},e.prototype.apply2=function(t,e,r,i,n,o,a,s,h){var l=t.ax,u=t.ay,c=t.ascaleX,p=t.ascaleY,d=c,f=p,m=e.ascaleX,v=t.matrix,y=0,g=0,_=0;c<0?(c=-c,y=180,_=-1):(y=0,_=1),p<0&&(p=-p,_=-_),m<0?(m=-m,g=180):g=0;var x=e.ax,b=0,w=0,T=0,E=v.a,S=v.c,A=v.b,I=v.d,P=Math.abs(c-p)<=1e-4;!P||o?(b=0,w=E*x+v.tx,T=A*x+v.ty):(w=E*x+S*(b=e.ay)+v.tx,T=A*x+I*b+v.ty);var M=t.parent.matrix;if(!M)throw new Error("IK parent must itself have a parent.");E=M.a,S=M.c,A=M.b;var C,R,O=1/(E*(I=M.d)-S*A),D=w-M.tx,N=T-M.ty,k=(D*I-N*S)*O-l,F=(N*E-D*A)*O-u,L=Math.sqrt(k*k+F*F),V=e.data.length*m;if(L<1e-4)return this.apply1(t,r,i,!1,o,!1,h),void e.updateWorldTransformWith(x,b,0,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY);var X=((D=r-M.tx)*I-(N=i-M.ty)*S)*O-l,j=(N*E-D*A)*O-u,U=X*X+j*j;if(0!=s){s*=c*(m+1)*.5;var Y=Math.sqrt(U),z=Y-L-V*c+s;if(z>0){var W=Math.min(1,z/(2*s))-1;U=(X-=(W=(z-s*(1-W*W))/Y)*X)*X+(j-=W*j)*j}}t:if(P){var q=(U-L*L-(V*=c)*V)/(2*L*V);q<-1?(q=-1,R=Math.PI*n):q>1?(q=1,R=0,o&&(d*=E=(Math.sqrt(U)/(L+V)-1)*h+1,a&&(f*=E))):R=Math.acos(q)*n,E=L+V*q,S=V*Math.sin(R),C=Math.atan2(j*E-X*S,X*E+j*S)}else{var G=(E=c*V)*E,H=(S=p*V)*S,$=Math.atan2(j,X),J=-2*H*L,Z=H-G;if((I=J*J-4*Z*(A=H*L*L+G*U-G*H))>=0){var Q=Math.sqrt(I);J<0&&(Q=-Q);var K=(Q=.5*-(J+Q))/Z,tt=A/Q,et=Math.abs(K)<Math.abs(tt)?K:tt;if(et*et<=U){N=Math.sqrt(U-et*et)*n,C=$-Math.atan2(N,et),R=Math.atan2(N/p,(et-L)/c);break t}}var rt=B.PI,it=L-E,nt=it*it,ot=0,at=0,st=L+E,ht=st*st,lt=0;(A=-E*L/(G-H))>=-1&&A<=1&&(A=Math.acos(A),(I=(D=E*Math.cos(A)+L)*D+(N=S*Math.sin(A))*N)<nt&&(rt=A,nt=I,it=D,ot=N),I>ht&&(at=A,ht=I,st=D,lt=N)),U<=.5*(nt+ht)?(C=$-Math.atan2(ot*n,it),R=rt*n):(C=$-Math.atan2(lt*n,st),R=at*n)}var ut=Math.atan2(b,x)*_,ct=t.arotation;(C=(C-ut)*B.radDeg+y-ct)>180?C-=360:C<-180&&(C+=360),t.updateWorldTransformWith(l,u,ct+C*h,d,f,0,0),ct=e.arotation,(R=((R+ut)*B.radDeg-e.ashearX)*_+g-ct)>180?R-=360:R<-180&&(R+=360),e.updateWorldTransformWith(x,b,ct+R*h,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY)},e}(),Ui=function(t){function e(e){var r=t.call(this,e,0,!1)||this;return r.bones=new Array,r._target=null,r.bendDirection=1,r.compress=!1,r.stretch=!1,r.uniform=!1,r.mix=1,r.softness=0,r}return dr(e,t),Object.defineProperty(e.prototype,"target",{get:function(){if(this._target)return this._target;throw new Error("BoneData not set.")},set:function(t){this._target=t},enumerable:!1,configurable:!0}),e}(Li),Yi=function(e){function r(r){var i=e.call(this,r,0,!1)||this;return i.bones=new Array,i._target=null,i.positionMode=t.PositionMode.Fixed,i.spacingMode=Si.Fixed,i.rotateMode=t.RotateMode.Chain,i.offsetRotation=0,i.position=0,i.spacing=0,i.mixRotate=0,i.mixX=0,i.mixY=0,i}return dr(r,e),Object.defineProperty(r.prototype,"target",{get:function(){if(this._target)return this._target;throw new Error("SlotData not set.")},set:function(t){this._target=t},enumerable:!1,configurable:!0}),r}(Li);!function(t){t[t.Length=0]="Length",t[t.Fixed=1]="Fixed",t[t.Percent=2]="Percent",t[t.Proportional=3]="Proportional"}(Si||(Si={}));var zi=function(){function e(t,e){if(this.position=0,this.spacing=0,this.mixRotate=0,this.mixX=0,this.mixY=0,this.spaces=new Array,this.positions=new Array,this.world=new Array,this.curves=new Array,this.lengths=new Array,this.segments=new Array,this.active=!1,!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.bones=new Array;for(var r=0,i=t.bones.length;r<i;r++){var n=e.findBone(t.bones[r].name);if(!n)throw new Error("Couldn't find bone "+t.bones[r].name+".");this.bones.push(n)}var o=e.findSlot(t.target.name);if(!o)throw new Error("Couldn't find target bone "+t.target.name);this.target=o,this.position=t.position,this.spacing=t.spacing,this.mixRotate=t.mixRotate,this.mixX=t.mixX,this.mixY=t.mixY}return e.prototype.isActive=function(){return this.active},e.prototype.update=function(){var r=this.target.getAttachment();if(r instanceof xr){var i=this.mixRotate,n=this.mixX,o=this.mixY;if(0!=i||0!=n||0!=o){var a=this.data,s=a.rotateMode==t.RotateMode.Tangent,h=a.rotateMode==t.RotateMode.ChainScale,l=this.bones,u=l.length,c=s?u:u+1,p=L.setArraySize(this.spaces,c),d=h?this.lengths=L.setArraySize(this.lengths,u):[],f=this.spacing;switch(a.spacingMode){case Si.Percent:if(h)for(var m=0,v=c-1;m<v;m++){if((w=(C=l[m]).data.length)<e.epsilon)d[m]=0;else{var y=w*C.matrix.a,g=w*C.matrix.b;d[m]=Math.sqrt(y*y+g*g)}}L.arrayFill(p,1,c,f);break;case Si.Proportional:var _=0;for(m=0,v=c-1;m<v;){if((w=(C=l[m]).data.length)<e.epsilon)h&&(d[m]=0),p[++m]=f;else{y=w*C.matrix.a,g=w*C.matrix.b;var x=Math.sqrt(y*y+g*g);h&&(d[m]=x),p[++m]=x,_+=x}}if(_>0){_=c/_*f;for(m=1;m<c;m++)p[m]*=_}break;default:var b=a.spacingMode==Si.Length;for(m=0,v=c-1;m<v;){var w;if((w=(C=l[m]).data.length)<e.epsilon)h&&(d[m]=0),p[++m]=f;else{y=w*C.matrix.a,g=w*C.matrix.b;var T=Math.sqrt(y*y+g*g);h&&(d[m]=T),p[++m]=(b?w+f:f)*T/w}}}var E=this.computeWorldPositions(r,c,s),S=E[0],A=E[1],I=a.offsetRotation,P=!1;if(0==I)P=a.rotateMode==t.RotateMode.Chain;else P=!1,I*=(M=this.target.bone.matrix).a*M.d-M.b*M.c>0?B.degRad:-B.degRad;m=0;for(var M=3;m<u;m++,M+=3){var C,R=(C=l[m]).matrix;R.tx+=(S-R.tx)*n,R.ty+=(A-R.ty)*o;var O=(y=E[M])-S,D=(g=E[M+1])-A;if(h){var N=d[m];if(0!=N){var k=(Math.sqrt(O*O+D*D)/N-1)*i+1;R.a*=k,R.b*=k}}if(S=y,A=g,i>0){var F=R.a,V=R.c,X=R.b,j=R.d,U=0,Y=0,z=0;if(U=s?E[M-1]:0==p[m+1]?E[M+2]:Math.atan2(D,O),U-=Math.atan2(X,F),P){Y=Math.cos(U),z=Math.sin(U);var W=C.data.length;S+=(W*(Y*F-z*X)-O)*i,A+=(W*(z*F+Y*X)-D)*i}else U+=I;U>B.PI?U-=B.PI2:U<-B.PI&&(U+=B.PI2),U*=i,Y=Math.cos(U),z=Math.sin(U),R.a=Y*F-z*X,R.c=Y*V-z*j,R.b=z*F+Y*X,R.d=z*V+Y*j}C.updateAppliedTransform()}}}},e.prototype.computeWorldPositions=function(r,i,n){var o=this.target,a=this.position,s=this.spaces,h=L.setArraySize(this.positions,3*i+2),l=this.world,u=r.closed,c=r.worldVerticesLength,p=c/6,d=e.NONE;if(!r.constantSpeed){var f,m=r.lengths,v=m[p-=u?1:2];switch(this.data.positionMode==t.PositionMode.Percent&&(a*=v),this.data.spacingMode){case Si.Percent:f=v;break;case Si.Proportional:f=v/i;break;default:f=1}l=L.setArraySize(this.world,8);for(var y=0,g=0,_=0;y<i;y++,g+=3){var x=a+=q=s[y]*f;if(u)(x%=v)<0&&(x+=v),_=0;else{if(x<0){d!=e.BEFORE&&(d=e.BEFORE,r.computeWorldVertices(o,2,4,l,0,2)),this.addBeforePosition(x,l,0,h,g);continue}if(x>v){d!=e.AFTER&&(d=e.AFTER,r.computeWorldVertices(o,c-6,4,l,0,2)),this.addAfterPosition(x-v,l,0,h,g);continue}}for(;;_++){var b=m[_];if(!(x>b)){if(0==_)x/=b;else x=(x-(J=m[_-1]))/(b-J);break}}_!=d&&(d=_,u&&_==p?(r.computeWorldVertices(o,c-4,4,l,0,2),r.computeWorldVertices(o,0,4,l,4,2)):r.computeWorldVertices(o,6*_+2,8,l,0,2)),this.addCurvePosition(x,l[0],l[1],l[2],l[3],l[4],l[5],l[6],l[7],h,g,n||y>0&&0==q)}return h}u?(c+=2,l=L.setArraySize(this.world,c),r.computeWorldVertices(o,2,c-4,l,0,2),r.computeWorldVertices(o,0,2,l,c-4,2),l[c-2]=l[0],l[c-1]=l[1]):(p--,c-=4,l=L.setArraySize(this.world,c),r.computeWorldVertices(o,2,c,l,0,2));for(var w,T=L.setArraySize(this.curves,p),E=0,S=l[0],A=l[1],I=0,P=0,M=0,C=0,R=0,O=0,D=0,B=0,N=0,k=0,F=0,V=0,X=0,j=0,U=(y=0,2);y<p;y++,U+=6)I=l[U],P=l[U+1],M=l[U+2],C=l[U+3],F=2*(D=.1875*(S-2*I+M))+(N=.09375*(3*(I-M)-S+(R=l[U+4]))),V=2*(B=.1875*(A-2*P+C))+(k=.09375*(3*(P-C)-A+(O=l[U+5]))),X=.75*(I-S)+D+.16666667*N,j=.75*(P-A)+B+.16666667*k,E+=Math.sqrt(X*X+j*j),X+=F,j+=V,F+=N,V+=k,E+=Math.sqrt(X*X+j*j),X+=F,j+=V,E+=Math.sqrt(X*X+j*j),X+=F+N,j+=V+k,E+=Math.sqrt(X*X+j*j),T[y]=E,S=R,A=O;switch(this.data.positionMode==t.PositionMode.Percent&&(a*=E),this.data.spacingMode){case Si.Percent:w=E;break;case Si.Proportional:w=E/i;break;default:w=1}for(var Y=this.segments,z=0,W=(y=0,g=0,_=0,0);y<i;y++,g+=3){var q;x=a+=q=s[y]*w;if(u)(x%=E)<0&&(x+=E),_=0;else{if(x<0){this.addBeforePosition(x,l,0,h,g);continue}if(x>E){this.addAfterPosition(x-E,l,c-4,h,g);continue}}for(;;_++){var G=T[_];if(!(x>G)){if(0==_)x/=G;else x=(x-(J=T[_-1]))/(G-J);break}}if(_!=d){d=_;var H=6*_;for(S=l[H],A=l[H+1],I=l[H+2],P=l[H+3],M=l[H+4],C=l[H+5],F=2*(D=.03*(S-2*I+M))+(N=.006*(3*(I-M)-S+(R=l[H+6]))),V=2*(B=.03*(A-2*P+C))+(k=.006*(3*(P-C)-A+(O=l[H+7]))),X=.3*(I-S)+D+.16666667*N,j=.3*(P-A)+B+.16666667*k,z=Math.sqrt(X*X+j*j),Y[0]=z,H=1;H<8;H++)X+=F,j+=V,F+=N,V+=k,z+=Math.sqrt(X*X+j*j),Y[H]=z;X+=F,j+=V,z+=Math.sqrt(X*X+j*j),Y[8]=z,X+=F+N,j+=V+k,z+=Math.sqrt(X*X+j*j),Y[9]=z,W=0}for(x*=z;;W++){var $=Y[W];if(!(x>$)){var J;if(0==W)x/=$;else x=W+(x-(J=Y[W-1]))/($-J);break}}this.addCurvePosition(.1*x,S,A,I,P,M,C,R,O,h,g,n||y>0&&0==q)}return h},e.prototype.addBeforePosition=function(t,e,r,i,n){var o=e[r],a=e[r+1],s=e[r+2]-o,h=e[r+3]-a,l=Math.atan2(h,s);i[n]=o+t*Math.cos(l),i[n+1]=a+t*Math.sin(l),i[n+2]=l},e.prototype.addAfterPosition=function(t,e,r,i,n){var o=e[r+2],a=e[r+3],s=o-e[r],h=a-e[r+1],l=Math.atan2(h,s);i[n]=o+t*Math.cos(l),i[n+1]=a+t*Math.sin(l),i[n+2]=l},e.prototype.addCurvePosition=function(t,e,r,i,n,o,a,s,h,l,u,c){if(0==t||isNaN(t))return l[u]=e,l[u+1]=r,void(l[u+2]=Math.atan2(n-r,i-e));var p=t*t,d=p*t,f=1-t,m=f*f,v=m*f,y=f*t,g=3*y,_=f*g,x=g*t,b=e*v+i*_+o*x+s*d,w=r*v+n*_+a*x+h*d;l[u]=b,l[u+1]=w,c&&(l[u+2]=t<.001?Math.atan2(n-r,i-e):Math.atan2(w-(r*m+n*y*2+a*p),b-(e*m+i*y*2+o*p)))},e.NONE=-1,e.BEFORE=-2,e.AFTER=-3,e.epsilon=1e-5,e}(),Wi=function(){function t(t,e){if(this.darkColor=null,this.attachment=null,this.attachmentState=0,this.sequenceIndex=-1,this.deform=new Array,!t)throw new Error("data cannot be null.");if(!e)throw new Error("bone cannot be null.");this.data=t,this.bone=e,this.color=new D,this.darkColor=t.darkColor?new D:null,this.setToSetupPose(),this.blendMode=this.data.blendMode}return t.prototype.getSkeleton=function(){return this.bone.skeleton},t.prototype.getAttachment=function(){return this.attachment},t.prototype.setAttachment=function(t){this.attachment!=t&&(t instanceof vr&&this.attachment instanceof vr&&t.timelineAttachment==this.attachment.timelineAttachment||(this.deform.length=0),this.attachment=t,this.sequenceIndex=-1)},t.prototype.setToSetupPose=function(){this.color.setFromColor(this.data.color),this.darkColor&&this.darkColor.setFromColor(this.data.darkColor),this.data.attachmentName?(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName))):this.attachment=null},t}(),qi=function(){function t(t,e){if(this.mixRotate=0,this.mixX=0,this.mixY=0,this.mixScaleX=0,this.mixScaleY=0,this.mixShearY=0,this.temp=new j,this.active=!1,!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.mixRotate=t.mixRotate,this.mixX=t.mixX,this.mixY=t.mixY,this.mixScaleX=t.mixScaleX,this.mixScaleY=t.mixScaleY,this.mixShearY=t.mixShearY,this.bones=new Array;for(var r=0;r<t.bones.length;r++){var i=e.findBone(t.bones[r].name);if(!i)throw new Error("Couldn't find bone "+t.bones[r].name+".");this.bones.push(i)}var n=e.findBone(t.target.name);if(!n)throw new Error("Couldn't find target bone "+t.target.name+".");this.target=n}return t.prototype.isActive=function(){return this.active},t.prototype.update=function(){0==this.mixRotate&&0==this.mixX&&0==this.mixY&&0==this.mixScaleX&&0==this.mixScaleX&&0==this.mixShearY||(this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld())},t.prototype.applyAbsoluteWorld=function(){for(var t=this.mixRotate,e=this.mixX,r=this.mixY,i=this.mixScaleX,n=this.mixScaleY,o=this.mixShearY,a=0!=e||0!=r,s=this.target,h=s.matrix,l=h.a,u=h.c,c=h.b,p=h.d,d=l*p-u*c>0?B.degRad:-B.degRad,f=this.data.offsetRotation*d,m=this.data.offsetShearY*d,v=this.bones,y=0,g=v.length;y<g;y++){var _=v[y],x=_.matrix;if(0!=t){var b=x.a,w=x.c,T=x.b,E=x.d;(P=Math.atan2(c,l)-Math.atan2(T,b)+f)>B.PI?P-=B.PI2:P<-B.PI&&(P+=B.PI2),P*=t;var S=Math.cos(P),A=Math.sin(P);x.a=S*b-A*T,x.c=S*w-A*E,x.b=A*b+S*T,x.d=A*w+S*E}if(a){var I=this.temp;s.localToWorld(I.set(this.data.offsetX,this.data.offsetY)),x.tx+=(I.x-x.tx)*e,x.ty+=(I.y-x.ty)*r}if(0!=i)0!=(C=Math.sqrt(x.a*x.a+x.b*x.b))&&(C=(C+(Math.sqrt(l*l+c*c)-C+this.data.offsetScaleX)*i)/C),x.a*=C,x.b*=C;if(0!=n)0!=(C=Math.sqrt(x.c*x.c+x.d*x.d))&&(C=(C+(Math.sqrt(u*u+p*p)-C+this.data.offsetScaleY)*n)/C),x.c*=C,x.d*=C;if(o>0){w=x.c,E=x.d;var P,M=Math.atan2(E,w);(P=Math.atan2(p,u)-Math.atan2(c,l)-(M-Math.atan2(x.b,x.a)))>B.PI?P-=B.PI2:P<-B.PI&&(P+=B.PI2),P=M+(P+m)*o;var C=Math.sqrt(w*w+E*E);x.c=Math.cos(P)*C,x.d=Math.sin(P)*C}_.updateAppliedTransform()}},t.prototype.applyRelativeWorld=function(){for(var t=this.mixRotate,e=this.mixX,r=this.mixY,i=this.mixScaleX,n=this.mixScaleY,o=this.mixShearY,a=0!=e||0!=r,s=this.target,h=s.matrix,l=h.a,u=h.c,c=h.b,p=h.d,d=l*p-u*c>0?B.degRad:-B.degRad,f=this.data.offsetRotation*d,m=this.data.offsetShearY*d,v=this.bones,y=0,g=v.length;y<g;y++){var _=v[y],x=_.matrix;if(0!=t){var b=x.a,w=x.c,T=x.b,E=x.d;(M=Math.atan2(c,l)+f)>B.PI?M-=B.PI2:M<-B.PI&&(M+=B.PI2),M*=t;var S=Math.cos(M),A=Math.sin(M);x.a=S*b-A*T,x.c=S*w-A*E,x.b=A*b+S*T,x.d=A*w+S*E}if(a){var I=this.temp;s.localToWorld(I.set(this.data.offsetX,this.data.offsetY)),x.tx+=I.x*e,x.ty+=I.y*r}if(0!=i){var P=(Math.sqrt(l*l+c*c)-1+this.data.offsetScaleX)*i+1;x.a*=P,x.b*=P}if(0!=n){P=(Math.sqrt(u*u+p*p)-1+this.data.offsetScaleY)*n+1;x.c*=P,x.d*=P}if(o>0){var M;(M=Math.atan2(p,u)-Math.atan2(c,l))>B.PI?M-=B.PI2:M<-B.PI&&(M+=B.PI2);w=x.c,E=x.d;M=Math.atan2(E,w)+(M-B.PI/2+m)*o;P=Math.sqrt(w*w+E*E);x.c=Math.cos(M)*P,x.d=Math.sin(M)*P}_.updateAppliedTransform()}},t.prototype.applyAbsoluteLocal=function(){for(var t=this.mixRotate,e=this.mixX,r=this.mixY,i=this.mixScaleX,n=this.mixScaleY,o=this.mixShearY,a=this.target,s=this.bones,h=0,l=s.length;h<l;h++){var u=s[h],c=u.arotation;if(0!=t){var p=a.arotation-c+this.data.offsetRotation;c+=(p-=360*(16384-(16384.499999999996-p/360|0)))*t}var d=u.ax,f=u.ay;d+=(a.ax-d+this.data.offsetX)*e,f+=(a.ay-f+this.data.offsetY)*r;var m=u.ascaleX,v=u.ascaleY;0!=i&&0!=m&&(m=(m+(a.ascaleX-m+this.data.offsetScaleX)*i)/m),0!=n&&0!=v&&(v=(v+(a.ascaleY-v+this.data.offsetScaleY)*n)/v);var y=u.ashearY;if(0!=o){p=a.ashearY-y+this.data.offsetShearY;y+=(p-=360*(16384-(16384.499999999996-p/360|0)))*o}u.updateWorldTransformWith(d,f,c,m,v,u.ashearX,y)}},t.prototype.applyRelativeLocal=function(){for(var t=this.mixRotate,e=this.mixX,r=this.mixY,i=this.mixScaleX,n=this.mixScaleY,o=this.mixShearY,a=this.target,s=this.bones,h=0,l=s.length;h<l;h++){var u=s[h],c=u.arotation+(a.arotation+this.data.offsetRotation)*t,p=u.ax+(a.ax+this.data.offsetX)*e,d=u.ay+(a.ay+this.data.offsetY)*r,f=u.ascaleX*((a.ascaleX-1+this.data.offsetScaleX)*i+1),m=u.ascaleY*((a.ascaleY-1+this.data.offsetScaleY)*n+1),v=u.ashearY+(a.ashearY+this.data.offsetShearY)*o;u.updateWorldTransformWith(p,d,c,f,m,u.ashearX,v)}},t}(),Gi=function(){function t(t){if(this._updateCache=new Array,this.skin=null,this.scaleX=1,this.scaleY=1,this.x=0,this.y=0,!t)throw new Error("data cannot be null.");this.data=t,this.bones=new Array;for(var e=0;e<t.bones.length;e++){var r=t.bones[e],i=void 0;if(r.parent){var n=this.bones[r.parent.index];i=new ki(r,this,n),n.children.push(i)}else i=new ki(r,this,null);this.bones.push(i)}this.slots=new Array,this.drawOrder=new Array;for(e=0;e<t.slots.length;e++){var o=t.slots[e],a=(i=this.bones[o.boneData.index],new Wi(o,i));this.slots.push(a),this.drawOrder.push(a)}this.ikConstraints=new Array;for(e=0;e<t.ikConstraints.length;e++){var s=t.ikConstraints[e];this.ikConstraints.push(new ji(s,this))}this.transformConstraints=new Array;for(e=0;e<t.transformConstraints.length;e++){var h=t.transformConstraints[e];this.transformConstraints.push(new qi(h,this))}this.pathConstraints=new Array;for(e=0;e<t.pathConstraints.length;e++){var l=t.pathConstraints[e];this.pathConstraints.push(new zi(l,this))}this.color=new D(1,1,1,1),this.updateCache()}return t.prototype.updateCache=function(){this._updateCache.length=0;for(var t=this.bones,e=0,r=t.length;e<r;e++){(n=t[e]).sorted=n.data.skinRequired,n.active=!n.sorted}if(this.skin){var i=this.skin.bones;for(e=0,r=this.skin.bones.length;e<r;e++){var n=this.bones[i[e].index];do{n.sorted=!1,n.active=!0,n=n.parent}while(n)}}var o=this.ikConstraints,a=this.transformConstraints,s=this.pathConstraints,h=o.length,l=a.length,u=s.length,c=h+l+u;t:for(e=0;e<c;e++){for(var p=0;p<h;p++){if((d=o[p]).data.order==e){this.sortIkConstraint(d);continue t}}for(p=0;p<l;p++){if((d=a[p]).data.order==e){this.sortTransformConstraint(d);continue t}}for(p=0;p<u;p++){var d;if((d=s[p]).data.order==e){this.sortPathConstraint(d);continue t}}}for(e=0,r=t.length;e<r;e++)this.sortBone(t[e])},t.prototype.sortIkConstraint=function(t){if(t.active=t.target.isActive()&&(!t.data.skinRequired||this.skin&&L.contains(this.skin.constraints,t.data,!0)),t.active){var e=t.target;this.sortBone(e);var r=t.bones,i=r[0];if(this.sortBone(i),1==r.length)this._updateCache.push(t),this.sortReset(i.children);else{var n=r[r.length-1];this.sortBone(n),this._updateCache.push(t),this.sortReset(i.children),n.sorted=!0}}},t.prototype.sortPathConstraint=function(t){if(t.active=t.target.bone.isActive()&&(!t.data.skinRequired||this.skin&&L.contains(this.skin.constraints,t.data,!0)),t.active){var e=t.target,r=e.data.index,i=e.bone;this.skin&&this.sortPathConstraintAttachment(this.skin,r,i),this.data.defaultSkin&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,r,i);for(var n=0,o=this.data.skins.length;n<o;n++)this.sortPathConstraintAttachment(this.data.skins[n],r,i);var a=e.getAttachment();a instanceof xr&&this.sortPathConstraintAttachmentWith(a,i);var s=t.bones,h=s.length;for(n=0;n<h;n++)this.sortBone(s[n]);this._updateCache.push(t);for(n=0;n<h;n++)this.sortReset(s[n].children);for(n=0;n<h;n++)s[n].sorted=!0}},t.prototype.sortTransformConstraint=function(t){if(t.active=t.target.isActive()&&(!t.data.skinRequired||this.skin&&L.contains(this.skin.constraints,t.data,!0)),t.active){this.sortBone(t.target);var e=t.bones,r=e.length;if(t.data.local)for(var i=0;i<r;i++){var n=e[i];this.sortBone(n.parent),this.sortBone(n)}else for(i=0;i<r;i++)this.sortBone(e[i]);this._updateCache.push(t);for(i=0;i<r;i++)this.sortReset(e[i].children);for(i=0;i<r;i++)e[i].sorted=!0}},t.prototype.sortPathConstraintAttachment=function(t,e,r){var i=t.attachments[e];if(i)for(var n in i)this.sortPathConstraintAttachmentWith(i[n],r)},t.prototype.sortPathConstraintAttachmentWith=function(t,e){if(t instanceof xr){var r=t.bones;if(r)for(var i=this.bones,n=0,o=r.length;n<o;){var a=r[n++];for(a+=n;n<a;)this.sortBone(i[r[n++]])}else this.sortBone(e)}},t.prototype.sortBone=function(t){if(t&&!t.sorted){var e=t.parent;e&&this.sortBone(e),t.sorted=!0,this._updateCache.push(t)}},t.prototype.sortReset=function(t){for(var e=0,r=t.length;e<r;e++){var i=t[e];i.active&&(i.sorted&&this.sortReset(i.children),i.sorted=!1)}},t.prototype.updateWorldTransform=function(){for(var t=this.bones,e=0,r=t.length;e<r;e++){var i=t[e];i.ax=i.x,i.ay=i.y,i.arotation=i.rotation,i.ascaleX=i.scaleX,i.ascaleY=i.scaleY,i.ashearX=i.shearX,i.ashearY=i.shearY}var n=this._updateCache;for(e=0,r=n.length;e<r;e++)n[e].update()},t.prototype.updateWorldTransformWith=function(t){var e=this.getRootBone(),r=t.matrix.a,i=t.matrix.c,n=t.matrix.b,o=t.matrix.d;e.matrix.tx=r*this.x+i*this.y+t.worldX,e.matrix.ty=n*this.x+o*this.y+t.worldY;var a=e.rotation+90+e.shearY,s=B.cosDeg(e.rotation+e.shearX)*e.scaleX,h=B.cosDeg(a)*e.scaleY,l=B.sinDeg(e.rotation+e.shearX)*e.scaleX,u=B.sinDeg(a)*e.scaleY,c=this.scaleX,p=z.yDown?-this.scaleY:this.scaleY;e.matrix.a=(r*s+i*l)*c,e.matrix.c=(r*h+i*u)*c,e.matrix.b=(n*s+o*l)*p,e.matrix.d=(n*h+o*u)*p;for(var d=this._updateCache,f=0,m=d.length;f<m;f++){var v=d[f];v!=e&&v.update()}},t.prototype.setToSetupPose=function(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()},t.prototype.setBonesToSetupPose=function(){for(var t=this.bones,e=0,r=t.length;e<r;e++)t[e].setToSetupPose();var i=this.ikConstraints;for(e=0,r=i.length;e<r;e++){(s=i[e]).mix=s.data.mix,s.softness=s.data.softness,s.bendDirection=s.data.bendDirection,s.compress=s.data.compress,s.stretch=s.data.stretch}var n=this.transformConstraints;for(e=0,r=n.length;e<r;e++){var o=(s=n[e]).data;s.mixRotate=o.mixRotate,s.mixX=o.mixX,s.mixY=o.mixY,s.mixScaleX=o.mixScaleX,s.mixScaleY=o.mixScaleY,s.mixShearY=o.mixShearY}var a=this.pathConstraints;for(e=0,r=a.length;e<r;e++){var s;o=(s=a[e]).data;s.position=o.position,s.spacing=o.spacing,s.mixRotate=o.mixRotate,s.mixX=o.mixX,s.mixY=o.mixY}},t.prototype.setSlotsToSetupPose=function(){var t=this.slots;L.arrayCopy(t,0,this.drawOrder,0,t.length);for(var e=0,r=t.length;e<r;e++)t[e].setToSetupPose()},t.prototype.getRootBone=function(){return 0==this.bones.length?null:this.bones[0]},t.prototype.findBone=function(t){if(!t)throw new Error("boneName cannot be null.");for(var e=this.bones,r=0,i=e.length;r<i;r++){var n=e[r];if(n.data.name==t)return n}return null},t.prototype.findBoneIndex=function(t){if(!t)throw new Error("boneName cannot be null.");for(var e=this.bones,r=0,i=e.length;r<i;r++)if(e[r].data.name==t)return r;return-1},t.prototype.findSlot=function(t){if(!t)throw new Error("slotName cannot be null.");for(var e=this.slots,r=0,i=e.length;r<i;r++){var n=e[r];if(n.data.name==t)return n}return null},t.prototype.findSlotIndex=function(t){if(!t)throw new Error("slotName cannot be null.");for(var e=this.slots,r=0,i=e.length;r<i;r++)if(e[r].data.name==t)return r;return-1},t.prototype.setSkinByName=function(t){var e=this.data.findSkin(t);if(!e)throw new Error("Skin not found: "+t);this.setSkin(e)},t.prototype.setSkin=function(t){if(t!=this.skin){if(t)if(this.skin)t.attachAll(this,this.skin);else for(var e=this.slots,r=0,i=e.length;r<i;r++){var n=e[r],o=n.data.attachmentName;if(o){var a=t.getAttachment(r,o);a&&n.setAttachment(a)}}this.skin=t,this.updateCache()}},t.prototype.getAttachmentByName=function(t,e){var r=this.data.findSlot(t);if(!r)throw new Error("Can't find slot with name "+t);return this.getAttachment(r.index,e)},t.prototype.getAttachment=function(t,e){if(!e)throw new Error("attachmentName cannot be null.");if(this.skin){var r=this.skin.getAttachment(t,e);if(r)return r}return this.data.defaultSkin?this.data.defaultSkin.getAttachment(t,e):null},t.prototype.setAttachment=function(t,e){if(!t)throw new Error("slotName cannot be null.");for(var r=this.slots,i=0,n=r.length;i<n;i++){var o=r[i];if(o.data.name==t){var a=null;if(e&&!(a=this.getAttachment(i,e)))throw new Error("Attachment not found: "+e+", for slot: "+t);return void o.setAttachment(a)}}throw new Error("Slot not found: "+t)},t.prototype.findIkConstraint=function(t){if(!t)throw new Error("constraintName cannot be null.");for(var e=this.ikConstraints,r=0,i=e.length;r<i;r++){var n=e[r];if(n.data.name==t)return n}return null},t.prototype.findTransformConstraint=function(t){if(!t)throw new Error("constraintName cannot be null.");for(var e=this.transformConstraints,r=0,i=e.length;r<i;r++){var n=e[r];if(n.data.name==t)return n}return null},t.prototype.findPathConstraint=function(t){if(!t)throw new Error("constraintName cannot be null.");for(var e=this.pathConstraints,r=0,i=e.length;r<i;r++){var n=e[r];if(n.data.name==t)return n}return null},t.prototype.getBoundsRect=function(){var t=new j,e=new j;return this.getBounds(t,e),{x:t.x,y:t.y,width:e.x,height:e.y}},t.prototype.getBounds=function(t,e,r){if(void 0===r&&(r=new Array(2)),!t)throw new Error("offset cannot be null.");if(!e)throw new Error("size cannot be null.");for(var i=this.drawOrder,n=Number.POSITIVE_INFINITY,o=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY,s=Number.NEGATIVE_INFINITY,h=0,l=i.length;h<l;h++){var u=i[h];if(u.bone.active){var c=0,p=null,d=u.getAttachment();if(d instanceof wr)c=8,p=L.setArraySize(r,c,0),d.computeWorldVertices(u,p,0,2);else if(d instanceof _r){var f=d;c=f.worldVerticesLength,p=L.setArraySize(r,c,0),f.computeWorldVertices(u,0,c,p,0,2)}if(p)for(var m=0,v=p.length;m<v;m+=2){var y=p[m],g=p[m+1];n=Math.min(n,y),o=Math.min(o,g),a=Math.max(a,y),s=Math.max(s,g)}}}t.set(n,o),e.set(a-n,s-o)},Object.defineProperty(t.prototype,"flipX",{get:function(){return-1==this.scaleX},set:function(e){t.deprecatedWarning1||(t.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleX=e?1:-1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"flipY",{get:function(){return-1==this.scaleY},set:function(e){t.deprecatedWarning1||(t.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleY=e?1:-1},enumerable:!1,configurable:!0}),t.deprecatedWarning1=!1,t}(),Hi=function(){function t(){this.name=null,this.bones=new Array,this.slots=new Array,this.skins=new Array,this.defaultSkin=null,this.events=new Array,this.animations=new Array,this.ikConstraints=new Array,this.transformConstraints=new Array,this.pathConstraints=new Array,this.x=0,this.y=0,this.width=0,this.height=0,this.version=null,this.hash=null,this.fps=0,this.imagesPath=null,this.audioPath=null}return t.prototype.findBone=function(t){if(!t)throw new Error("boneName cannot be null.");for(var e=this.bones,r=0,i=e.length;r<i;r++){var n=e[r];if(n.name==t)return n}return null},t.prototype.findBoneIndex=function(t){if(!t)throw new Error("boneName cannot be null.");for(var e=this.bones,r=0,i=e.length;r<i;r++)if(e[r].name==t)return r;return-1},t.prototype.findSlot=function(t){if(!t)throw new Error("slotName cannot be null.");for(var e=this.slots,r=0,i=e.length;r<i;r++){var n=e[r];if(n.name==t)return n}return null},t.prototype.findSlotIndex=function(t){if(!t)throw new Error("slotName cannot be null.");for(var e=this.slots,r=0,i=e.length;r<i;r++)if(e[r].name==t)return r;return-1},t.prototype.findSkin=function(t){if(!t)throw new Error("skinName cannot be null.");for(var e=this.skins,r=0,i=e.length;r<i;r++){var n=e[r];if(n.name==t)return n}return null},t.prototype.findEvent=function(t){if(!t)throw new Error("eventDataName cannot be null.");for(var e=this.events,r=0,i=e.length;r<i;r++){var n=e[r];if(n.name==t)return n}return null},t.prototype.findAnimation=function(t){if(!t)throw new Error("animationName cannot be null.");for(var e=this.animations,r=0,i=e.length;r<i;r++){var n=e[r];if(n.name==t)return n}return null},t.prototype.findIkConstraint=function(t){if(!t)throw new Error("constraintName cannot be null.");for(var e=this.ikConstraints,r=0,i=e.length;r<i;r++){var n=e[r];if(n.name==t)return n}return null},t.prototype.findTransformConstraint=function(t){if(!t)throw new Error("constraintName cannot be null.");for(var e=this.transformConstraints,r=0,i=e.length;r<i;r++){var n=e[r];if(n.name==t)return n}return null},t.prototype.findPathConstraint=function(t){if(!t)throw new Error("constraintName cannot be null.");for(var e=this.pathConstraints,r=0,i=e.length;r<i;r++){var n=e[r];if(n.name==t)return n}return null},t.prototype.findPathConstraintIndex=function(t){if(null==t)throw new Error("pathConstraintName cannot be null.");for(var e=this.pathConstraints,r=0,i=e.length;r<i;r++)if(e[r].name==t)return r;return-1},t}(),$i=function(t,e,r){if(this.index=0,this.color=new D(1,1,1,1),this.darkColor=null,this.attachmentName=null,this.blendMode=i.BLEND_MODES.NORMAL,t<0)throw new Error("index must be >= 0.");if(!e)throw new Error("name cannot be null.");if(!r)throw new Error("boneData cannot be null.");this.index=t,this.name=e,this.boneData=r},Ji=function(t){function e(e){var r=t.call(this,e,0,!1)||this;return r.bones=new Array,r._target=null,r.mixRotate=0,r.mixX=0,r.mixY=0,r.mixScaleX=0,r.mixScaleY=0,r.mixShearY=0,r.offsetRotation=0,r.offsetX=0,r.offsetY=0,r.offsetScaleX=0,r.offsetScaleY=0,r.offsetShearY=0,r.relative=!1,r.local=!1,r}return dr(e,t),Object.defineProperty(e.prototype,"target",{get:function(){if(this._target)return this._target;throw new Error("BoneData not set.")},set:function(t){this._target=t},enumerable:!1,configurable:!0}),e}(Li),Zi=function(t,e,r){this.slotIndex=t,this.name=e,this.attachment=r},Qi=function(){function t(t){if(this.attachments=new Array,this.bones=Array(),this.constraints=new Array,!t)throw new Error("name cannot be null.");this.name=t}return t.prototype.setAttachment=function(t,e,r){if(!r)throw new Error("attachment cannot be null.");var i=this.attachments;t>=i.length&&(i.length=t+1),i[t]||(i[t]={}),i[t][e]=r},t.prototype.addSkin=function(t){for(var e=0;e<t.bones.length;e++){for(var r=t.bones[e],i=!1,n=0;n<this.bones.length;n++)if(this.bones[n]==r){i=!0;break}i||this.bones.push(r)}for(e=0;e<t.constraints.length;e++){var o=t.constraints[e];for(i=!1,n=0;n<this.constraints.length;n++)if(this.constraints[n]==o){i=!0;break}i||this.constraints.push(o)}var a=t.getAttachments();for(e=0;e<a.length;e++){var s=a[e];this.setAttachment(s.slotIndex,s.name,s.attachment)}},t.prototype.copySkin=function(t){for(var e=0;e<t.bones.length;e++){for(var r=t.bones[e],i=!1,n=0;n<this.bones.length;n++)if(this.bones[n]==r){i=!0;break}i||this.bones.push(r)}for(e=0;e<t.constraints.length;e++){var o=t.constraints[e];for(i=!1,n=0;n<this.constraints.length;n++)if(this.constraints[n]==o){i=!0;break}i||this.constraints.push(o)}var a=t.getAttachments();for(e=0;e<a.length;e++){var s=a[e];s.attachment&&(s.attachment instanceof _r?(s.attachment=s.attachment.newLinkedMesh(),this.setAttachment(s.slotIndex,s.name,s.attachment)):(s.attachment=s.attachment.copy(),this.setAttachment(s.slotIndex,s.name,s.attachment)))}},t.prototype.getAttachment=function(t,e){var r=this.attachments[t];return r?r[e]:null},t.prototype.removeAttachment=function(t,e){var r=this.attachments[t];r&&delete r[e]},t.prototype.getAttachments=function(){for(var t=new Array,e=0;e<this.attachments.length;e++){var r=this.attachments[e];if(r)for(var i in r){var n=r[i];n&&t.push(new Zi(e,i,n))}}return t},t.prototype.getAttachmentsForSlot=function(t,e){var r=this.attachments[t];if(r)for(var i in r){var n=r[i];n&&e.push(new Zi(t,i,n))}},t.prototype.clear=function(){this.attachments.length=0,this.bones.length=0,this.constraints.length=0},t.prototype.attachAll=function(t,e){for(var r=0,i=0;i<t.slots.length;i++){var n=t.slots[i],o=n.getAttachment();if(o&&r<e.attachments.length){var a=e.attachments[r];for(var s in a){if(o==a[s]){var h=this.getAttachment(r,s);h&&n.setAttachment(h);break}}}r++}},t}(),Ki=function(){function e(t){this.ver40=!1,this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=t}return e.prototype.readSkeletonData=function(e){var r=this.scale,i=new Hi;i.name="";var n=new v(e),o=n.readInt32(),a=n.readInt32();i.hash=0==a&&0==o?null:a.toString(16)+o.toString(16),i.version=n.readString();var s=i.version.substr(0,3);if("4.0"!==s&&"4.1"!==s){var h="Spine 4.1 loader cant load version "+i.version+". Please configure your pixi-spine bundle";console.error(h)}this.ver40="4.0"===s,i.x=n.readFloat(),i.y=n.readFloat(),i.width=n.readFloat(),i.height=n.readFloat();var l=n.readBoolean();l&&(i.fps=n.readFloat(),i.imagesPath=n.readString(),i.audioPath=n.readString());var u=0;u=n.readInt(!0);for(var c=0;c<u;c++){var p=n.readString();if(!p)throw new Error("String in string table must not be null.");n.strings.push(p)}u=n.readInt(!0);for(c=0;c<u;c++){var d=n.readString();if(!d)throw new Error("Bone name must not be null.");var f=0==c?null:i.bones[n.readInt(!0)];(g=new Fi(c,d,f)).rotation=n.readFloat(),g.x=n.readFloat()*r,g.y=n.readFloat()*r,g.scaleX=n.readFloat(),g.scaleY=n.readFloat(),g.shearX=n.readFloat(),g.shearY=n.readFloat(),g.length=n.readFloat()*r,g.transformMode=n.readInt(!0),g.skinRequired=n.readBoolean(),l&&D.rgba8888ToColor(g.color,n.readInt32()),i.bones.push(g)}u=n.readInt(!0);for(c=0;c<u;c++){var m=n.readString();if(!m)throw new Error("Slot name must not be null.");var y=i.bones[n.readInt(!0)],g=new $i(c,m,y);D.rgba8888ToColor(g.color,n.readInt32());var _=n.readInt32();-1!=_&&D.rgb888ToColor(g.darkColor=new D,_),g.attachmentName=n.readStringRef(),g.blendMode=n.readInt(!0),i.slots.push(g)}u=n.readInt(!0);c=0;for(var x=void 0;c<u;c++){var b=n.readString();if(!b)throw new Error("IK constraint data name must not be null.");(g=new Ui(b)).order=n.readInt(!0),g.skinRequired=n.readBoolean(),x=n.readInt(!0);for(var w=0;w<x;w++)g.bones.push(i.bones[n.readInt(!0)]);g.target=i.bones[n.readInt(!0)],g.mix=n.readFloat(),g.softness=n.readFloat()*r,g.bendDirection=n.readByte(),g.compress=n.readBoolean(),g.stretch=n.readBoolean(),g.uniform=n.readBoolean(),i.ikConstraints.push(g)}u=n.readInt(!0);for(c=0,x=void 0;c<u;c++){var T=n.readString();if(!T)throw new Error("Transform constraint data name must not be null.");(g=new Ji(T)).order=n.readInt(!0),g.skinRequired=n.readBoolean(),x=n.readInt(!0);for(w=0;w<x;w++)g.bones.push(i.bones[n.readInt(!0)]);g.target=i.bones[n.readInt(!0)],g.local=n.readBoolean(),g.relative=n.readBoolean(),g.offsetRotation=n.readFloat(),g.offsetX=n.readFloat()*r,g.offsetY=n.readFloat()*r,g.offsetScaleX=n.readFloat(),g.offsetScaleY=n.readFloat(),g.offsetShearY=n.readFloat(),g.mixRotate=n.readFloat(),g.mixX=n.readFloat(),g.mixY=n.readFloat(),g.mixScaleX=n.readFloat(),g.mixScaleY=n.readFloat(),g.mixShearY=n.readFloat(),i.transformConstraints.push(g)}u=n.readInt(!0);for(c=0,x=void 0;c<u;c++){var E=n.readString();if(!E)throw new Error("Path constraint data name must not be null.");(g=new Yi(E)).order=n.readInt(!0),g.skinRequired=n.readBoolean(),x=n.readInt(!0);for(w=0;w<x;w++)g.bones.push(i.bones[n.readInt(!0)]);g.target=i.slots[n.readInt(!0)],g.positionMode=n.readInt(!0),g.spacingMode=n.readInt(!0),g.rotateMode=n.readInt(!0),g.offsetRotation=n.readFloat(),g.position=n.readFloat(),g.positionMode==t.PositionMode.Fixed&&(g.position*=r),g.spacing=n.readFloat(),g.spacingMode!=Si.Length&&g.spacingMode!=Si.Fixed||(g.spacing*=r),g.mixRotate=n.readFloat(),g.mixX=n.readFloat(),g.mixY=n.readFloat(),i.pathConstraints.push(g)}var S=this.readSkin(n,i,!0,l);S&&(i.defaultSkin=S,i.skins.push(S));c=i.skins.length;for(L.setArraySize(i.skins,u=c+n.readInt(!0));c<u;c++){if(!(A=this.readSkin(n,i,!1,l)))throw new Error("readSkin() should not have returned null.");i.skins[c]=A}u=this.linkedMeshes.length;for(c=0;c<u;c++){var A,I=this.linkedMeshes[c];if(!(A=I.skin?i.findSkin(I.skin):i.defaultSkin))throw new Error("Not skin found for linked mesh.");if(!I.parent)throw new Error("Linked mesh parent must not be null");var P=A.getAttachment(I.slotIndex,I.parent);if(!P)throw new Error("Parent mesh not found: "+I.parent);I.mesh.timelineAttachment=I.inheritTimeline?P:I.mesh,I.mesh.setParentMesh(P)}this.linkedMeshes.length=0,u=n.readInt(!0);for(c=0;c<u;c++){var M=n.readStringRef();if(!M)throw new Error;(g=new Xi(M)).intValue=n.readInt(!1),g.floatValue=n.readFloat(),g.stringValue=n.readString(),g.audioPath=n.readString(),g.audioPath&&(g.volume=n.readFloat(),g.balance=n.readFloat()),i.events.push(g)}u=n.readInt(!0);for(c=0;c<u;c++){var C=n.readString();if(!C)throw new Error("Animatio name must not be null.");i.animations.push(this.readAnimation(n,C,i))}return i},e.prototype.readSkin=function(t,e,r,i){var n=null,o=0;if(r){if(0==(o=t.readInt(!0)))return null;n=new Qi("default")}else{var a=t.readStringRef();if(!a)throw new Error("Skin name must not be null.");(n=new Qi(a)).bones.length=t.readInt(!0);for(var s=0,h=n.bones.length;s<h;s++)n.bones[s]=e.bones[t.readInt(!0)];for(s=0,h=t.readInt(!0);s<h;s++)n.constraints.push(e.ikConstraints[t.readInt(!0)]);for(s=0,h=t.readInt(!0);s<h;s++)n.constraints.push(e.transformConstraints[t.readInt(!0)]);for(s=0,h=t.readInt(!0);s<h;s++)n.constraints.push(e.pathConstraints[t.readInt(!0)]);o=t.readInt(!0)}for(s=0;s<o;s++)for(var l=t.readInt(!0),u=0,c=t.readInt(!0);u<c;u++){var p=t.readStringRef();if(!p)throw new Error("Attachment name must not be null");var d=this.readAttachment(t,e,n,l,p,i);d&&n.setAttachment(l,p,d)}return n},e.prototype.readAttachment=function(e,r,i,n,o,a){var s=this.scale,h=e.readStringRef();switch(h||(h=o),e.readByte()){case t.AttachmentType.Region:var l=e.readStringRef(),u=e.readFloat(),c=e.readFloat(),p=e.readFloat(),d=e.readFloat(),f=e.readFloat(),m=e.readFloat(),v=e.readFloat(),y=e.readInt32(),g=this.readSequence(e);l||(l=h);var _=this.attachmentLoader.newRegionAttachment(i,h,l,g);return _?(_.path=l,_.x=c*s,_.y=p*s,_.scaleX=d,_.scaleY=f,_.rotation=u,_.width=m*s,_.height=v*s,D.rgba8888ToColor(_.color,y),_.sequence=g,null==g&&_.updateRegion(),_):null;case t.AttachmentType.BoundingBox:var x=e.readInt(!0),b=this.readVertices(e,x),w=(y=a?e.readInt32():0,this.attachmentLoader.newBoundingBoxAttachment(i,h));return w?(w.worldVerticesLength=x<<1,w.vertices=b.vertices,w.bones=b.bones,a&&D.rgba8888ToColor(w.color,y),w):null;case t.AttachmentType.Mesh:l=e.readStringRef(),y=e.readInt32(),x=e.readInt(!0);var T=this.readFloatArray(e,x<<1,1),E=this.readShortArray(e),S=(b=this.readVertices(e,x),e.readInt(!0)),A=(g=this.readSequence(e),[]);m=0,v=0;return a&&(A=this.readShortArray(e),m=e.readFloat(),v=e.readFloat()),l||(l=h),(I=this.attachmentLoader.newMeshAttachment(i,h,l,g))?(I.path=l,D.rgba8888ToColor(I.color,y),I.bones=b.bones,I.vertices=b.vertices,I.worldVerticesLength=x<<1,I.triangles=E,I.regionUVs=new Float32Array(T),I.hullLength=S<<1,I.sequence=g,a&&(I.edges=A,I.width=m*s,I.height=v*s),I):null;case t.AttachmentType.LinkedMesh:l=e.readStringRef(),y=e.readInt32();var I,P=e.readStringRef(),M=e.readStringRef(),C=e.readBoolean();g=this.readSequence(e),m=0,v=0;return a&&(m=e.readFloat(),v=e.readFloat()),l||(l=h),(I=this.attachmentLoader.newMeshAttachment(i,h,l,g))?(I.path=l,D.rgba8888ToColor(I.color,y),I.sequence=g,a&&(I.width=m*s,I.height=v*s),this.linkedMeshes.push(new tn(I,P,n,M,C)),I):null;case t.AttachmentType.Path:for(var R=e.readBoolean(),O=e.readBoolean(),B=(x=e.readInt(!0),b=this.readVertices(e,x),L.newArray(x/3,0)),N=0,k=B.length;N<k;N++)B[N]=e.readFloat()*s;y=a?e.readInt32():0;return(l=this.attachmentLoader.newPathAttachment(i,h))?(l.closed=R,l.constantSpeed=O,l.worldVerticesLength=x<<1,l.vertices=b.vertices,l.bones=b.bones,l.lengths=B,a&&D.rgba8888ToColor(l.color,y),l):null;case t.AttachmentType.Point:u=e.readFloat(),c=e.readFloat(),p=e.readFloat(),y=a?e.readInt32():0;var F=this.attachmentLoader.newPointAttachment(i,h);return F?(F.x=c*s,F.y=p*s,F.rotation=u,a&&D.rgba8888ToColor(F.color,y),F):null;case t.AttachmentType.Clipping:var V=e.readInt(!0),X=(x=e.readInt(!0),b=this.readVertices(e,x),y=a?e.readInt32():0,this.attachmentLoader.newClippingAttachment(i,h));return X?(X.endSlot=r.slots[V],X.worldVerticesLength=x<<1,X.vertices=b.vertices,X.bones=b.bones,a&&D.rgba8888ToColor(X.color,y),X):null}return null},e.prototype.readSequence=function(t){if(this.ver40||!t.readBoolean())return null;var e=new Tr(t.readInt(!0));return e.start=t.readInt(!0),e.digits=t.readInt(!0),e.setupIndex=t.readInt(!0),e},e.prototype.readDeformTimelineType=function(t){return this.ver40?wn:t.readByte()},e.prototype.readVertices=function(t,e){var r=this.scale,i=e<<1,n=new en;if(!t.readBoolean())return n.vertices=this.readFloatArray(t,i,r),n;for(var o=new Array,a=new Array,s=0;s<e;s++){var h=t.readInt(!0);a.push(h);for(var l=0;l<h;l++)a.push(t.readInt(!0)),o.push(t.readFloat()*r),o.push(t.readFloat()*r),o.push(t.readFloat())}return n.vertices=L.toFloatArray(o),n.bones=a,n},e.prototype.readFloatArray=function(t,e,r){var i=new Array(e);if(1==r)for(var n=0;n<e;n++)i[n]=t.readFloat();else for(n=0;n<e;n++)i[n]=t.readFloat()*r;return i},e.prototype.readShortArray=function(t){for(var e=t.readInt(!0),r=new Array(e),i=0;i<e;i++)r[i]=t.readShort();return r},e.prototype.readAnimation=function(e,r,i){e.readInt(!0);for(var n=new Array,o=this.scale,a=0,s=e.readInt(!0);a<s;a++)for(var h=e.readInt(!0),l=0,u=e.readInt(!0);l<u;l++){var c=e.readByte(),p=(k=e.readInt(!0))-1;switch(c){case vn:for(var d=new pi(k,h),f=0;f<k;f++)d.setFrame(f,e.readFloat(),e.readStringRef());n.push(d);break;case yn:for(var m=e.readInt(!0),v=(d=new si(k,m,h),e.readFloat()),y=e.readUnsignedByte()/255,g=e.readUnsignedByte()/255,_=e.readUnsignedByte()/255,x=e.readUnsignedByte()/255,b=(f=0,0);d.setFrame(f,v,y,g,_,x),f!=p;f++){var w=e.readFloat(),T=e.readUnsignedByte()/255,E=e.readUnsignedByte()/255,S=e.readUnsignedByte()/255,A=e.readUnsignedByte()/255;switch(e.readByte()){case In:d.setStepped(f);break;case Pn:on(e,d,b++,f,0,v,w,y,T,1),on(e,d,b++,f,1,v,w,g,E,1),on(e,d,b++,f,2,v,w,_,S,1),on(e,d,b++,f,3,v,w,x,A,1)}v=w,y=T,g=E,_=S,x=A}n.push(d);break;case gn:for(m=e.readInt(!0),d=new hi(k,m,h),v=e.readFloat(),y=e.readUnsignedByte()/255,g=e.readUnsignedByte()/255,_=e.readUnsignedByte()/255,f=0,b=0;d.setFrame(f,v,y,g,_),f!=p;f++){w=e.readFloat(),T=e.readUnsignedByte()/255,E=e.readUnsignedByte()/255,S=e.readUnsignedByte()/255;switch(e.readByte()){case In:d.setStepped(f);break;case Pn:on(e,d,b++,f,0,v,w,y,T,1),on(e,d,b++,f,1,v,w,g,E,1),on(e,d,b++,f,2,v,w,_,S,1)}v=w,y=T,g=E,_=S}n.push(d);break;case _n:for(m=e.readInt(!0),d=new ui(k,m,h),v=e.readFloat(),y=e.readUnsignedByte()/255,g=e.readUnsignedByte()/255,_=e.readUnsignedByte()/255,x=e.readUnsignedByte()/255,T=e.readUnsignedByte()/255,E=e.readUnsignedByte()/255,S=e.readUnsignedByte()/255,f=0,b=0;d.setFrame(f,v,y,g,_,x,T,E,S),f!=p;f++){w=e.readFloat();var I=e.readUnsignedByte()/255,P=e.readUnsignedByte()/255,M=e.readUnsignedByte()/255,C=e.readUnsignedByte()/255,R=e.readUnsignedByte()/255,O=e.readUnsignedByte()/255,D=e.readUnsignedByte()/255;switch(e.readByte()){case In:d.setStepped(f);break;case Pn:on(e,d,b++,f,0,v,w,y,I,1),on(e,d,b++,f,1,v,w,g,P,1),on(e,d,b++,f,2,v,w,_,M,1),on(e,d,b++,f,3,v,w,x,C,1),on(e,d,b++,f,4,v,w,T,R,1),on(e,d,b++,f,5,v,w,E,O,1),on(e,d,b++,f,6,v,w,S,D,1)}v=w,y=I,g=P,_=M,x=C,T=R,E=O,S=D}n.push(d);break;case xn:for(m=e.readInt(!0),d=new ci(k,m,h),v=e.readFloat(),y=e.readUnsignedByte()/255,g=e.readUnsignedByte()/255,_=e.readUnsignedByte()/255,T=e.readUnsignedByte()/255,E=e.readUnsignedByte()/255,S=e.readUnsignedByte()/255,f=0,b=0;d.setFrame(f,v,y,g,_,T,E,S),f!=p;f++){w=e.readFloat(),I=e.readUnsignedByte()/255,P=e.readUnsignedByte()/255,M=e.readUnsignedByte()/255,R=e.readUnsignedByte()/255,O=e.readUnsignedByte()/255,D=e.readUnsignedByte()/255;switch(e.readByte()){case In:d.setStepped(f);break;case Pn:on(e,d,b++,f,0,v,w,y,I,1),on(e,d,b++,f,1,v,w,g,P,1),on(e,d,b++,f,2,v,w,_,M,1),on(e,d,b++,f,3,v,w,T,R,1),on(e,d,b++,f,4,v,w,E,O,1),on(e,d,b++,f,5,v,w,S,D,1)}v=w,y=I,g=P,_=M,T=R,E=O,S=D}n.push(d);break;case bn:for(d=new li(k,e.readInt(!0),h),v=e.readFloat(),x=e.readUnsignedByte()/255,f=0,b=0;d.setFrame(f,v,x),f!=p;f++){w=e.readFloat(),A=e.readUnsignedByte()/255;switch(e.readByte()){case In:d.setStepped(f);break;case Pn:on(e,d,b++,f,0,v,w,x,A,1)}v=w,x=A}n.push(d)}}for(a=0,s=e.readInt(!0);a<s;a++){var B=e.readInt(!0);for(l=0,u=e.readInt(!0);l<u;l++){var N=e.readByte(),k=e.readInt(!0);m=e.readInt(!0);switch(N){case an:n.push(rn(e,new Zr(k,m,B),1));break;case sn:n.push(nn(e,new Qr(k,m,B),o));break;case hn:n.push(rn(e,new Kr(k,m,B),o));break;case ln:n.push(rn(e,new ti(k,m,B),o));break;case un:n.push(nn(e,new ei(k,m,B),1));break;case cn:n.push(rn(e,new ri(k,m,B),1));break;case pn:n.push(rn(e,new ii(k,m,B),1));break;case dn:n.push(nn(e,new ni(k,m,B),1));break;case fn:n.push(rn(e,new oi(k,m,B),1));break;case mn:n.push(rn(e,new ai(k,m,B),1))}}}for(a=0,s=e.readInt(!0);a<s;a++){var F=e.readInt(!0),V=(p=(k=e.readInt(!0))-1,d=new vi(k,e.readInt(!0),F),v=e.readFloat(),e.readFloat()),X=e.readFloat()*o;for(f=0,b=0;d.setFrame(f,v,V,X,e.readByte(),e.readBoolean(),e.readBoolean()),f!=p;f++){w=e.readFloat();var j=e.readFloat(),U=e.readFloat()*o;switch(e.readByte()){case In:d.setStepped(f);break;case Pn:on(e,d,b++,f,0,v,w,V,j,1),on(e,d,b++,f,1,v,w,X,U,o)}v=w,V=j,X=U}n.push(d)}for(a=0,s=e.readInt(!0);a<s;a++){F=e.readInt(!0),p=(k=e.readInt(!0))-1,d=new yi(k,e.readInt(!0),F),v=e.readFloat();var Y=e.readFloat(),z=e.readFloat(),W=e.readFloat(),q=e.readFloat(),G=e.readFloat(),H=e.readFloat();for(f=0,b=0;d.setFrame(f,v,Y,z,W,q,G,H),f!=p;f++){w=e.readFloat();var $=e.readFloat(),J=e.readFloat(),Z=e.readFloat(),Q=e.readFloat(),K=e.readFloat(),tt=e.readFloat();switch(e.readByte()){case In:d.setStepped(f);break;case Pn:on(e,d,b++,f,0,v,w,Y,$,1),on(e,d,b++,f,1,v,w,z,J,1),on(e,d,b++,f,2,v,w,W,Z,1),on(e,d,b++,f,3,v,w,q,Q,1),on(e,d,b++,f,4,v,w,G,K,1),on(e,d,b++,f,5,v,w,H,tt,1)}v=w,Y=$,z=J,W=Z,q=Q,G=K,H=tt}n.push(d)}for(a=0,s=e.readInt(!0);a<s;a++){F=e.readInt(!0);var et=i.pathConstraints[F];for(l=0,u=e.readInt(!0);l<u;l++)switch(e.readByte()){case En:n.push(rn(e,new gi(e.readInt(!0),e.readInt(!0),F),et.positionMode==t.PositionMode.Fixed?o:1));break;case Sn:n.push(rn(e,new _i(e.readInt(!0),e.readInt(!0),F),et.spacingMode==Si.Length||et.spacingMode==Si.Fixed?o:1));break;case An:for(d=new xi(e.readInt(!0),e.readInt(!0),F),v=e.readFloat(),Y=e.readFloat(),z=e.readFloat(),W=e.readFloat(),f=0,b=0,p=d.getFrameCount()-1;d.setFrame(f,v,Y,z,W),f!=p;f++){w=e.readFloat(),$=e.readFloat(),J=e.readFloat(),Z=e.readFloat();switch(e.readByte()){case In:d.setStepped(f);break;case Pn:on(e,d,b++,f,0,v,w,Y,$,1),on(e,d,b++,f,1,v,w,z,J,1),on(e,d,b++,f,2,v,w,W,Z,1)}v=w,Y=$,z=J,W=Z}n.push(d)}}for(a=0,s=e.readInt(!0);a<s;a++){var rt=i.skins[e.readInt(!0)];for(l=0,u=e.readInt(!0);l<u;l++){h=e.readInt(!0);for(var it=0,nt=e.readInt(!0);it<nt;it++){var ot=e.readStringRef();if(!ot)throw new Error("attachmentName must not be null.");var at=rt.getAttachment(h,ot);c=this.readDeformTimelineType(e),p=(k=e.readInt(!0))-1;switch(c){case wn:var st=at,ht=st.bones,lt=st.vertices,ut=ht?lt.length/3*2:lt.length;for(m=e.readInt(!0),d=new di(k,m,h,st),v=e.readFloat(),f=0,b=0;;f++){var ct=void 0,pt=e.readInt(!0);if(0==pt)ct=ht?L.newFloatArray(ut):lt;else{ct=L.newFloatArray(ut);var dt=e.readInt(!0);if(pt+=dt,1==o)for(var ft=dt;ft<pt;ft++)ct[ft]=e.readFloat();else for(ft=dt;ft<pt;ft++)ct[ft]=e.readFloat()*o;if(!ht){ft=0;for(var mt=ct.length;ft<mt;ft++)ct[ft]+=lt[ft]}}if(d.setFrame(f,v,ct),f==p)break;w=e.readFloat();switch(e.readByte()){case In:d.setStepped(f);break;case Pn:on(e,d,b++,f,0,v,w,0,1,1)}v=w}n.push(d);break;case Tn:for(d=new bi(k,h,at),f=0;f<k;f++){v=e.readFloat();var vt=e.readInt32();d.setFrame(f,v,Sr[15&vt],vt>>4,e.readFloat())}n.push(d)}}}}var yt=e.readInt(!0);if(yt>0){d=new mi(yt);var gt=i.slots.length;for(a=0;a<yt;a++){v=e.readFloat();var _t=e.readInt(!0),xt=L.newArray(gt,0);for(l=gt-1;l>=0;l--)xt[l]=-1;var bt=L.newArray(gt-_t,0),wt=0,Tt=0;for(l=0;l<_t;l++){for(h=e.readInt(!0);wt!=h;)bt[Tt++]=wt++;xt[wt+e.readInt(!0)]=wt++}for(;wt<gt;)bt[Tt++]=wt++;for(l=gt-1;l>=0;l--)-1==xt[l]&&(xt[l]=bt[--Tt]);d.setFrame(a,v,xt)}n.push(d)}var Et=e.readInt(!0);if(Et>0){for(d=new fi(Et),a=0;a<Et;a++){v=e.readFloat();var St=i.events[e.readInt(!0)],At=new Vi(v,St);At.intValue=e.readInt(!1),At.floatValue=e.readFloat(),At.stringValue=e.readBoolean()?e.readString():St.stringValue,At.data.audioPath&&(At.volume=e.readFloat(),At.balance=e.readFloat()),d.setFrame(a,At)}n.push(d)}var It=0;for(a=0,s=n.length;a<s;a++)It=Math.max(It,n[a].getDuration());return new Ar(r,n,It)},e.BlendModeValues=[i.BLEND_MODES.NORMAL,i.BLEND_MODES.ADD,i.BLEND_MODES.MULTIPLY,i.BLEND_MODES.SCREEN],e}(),tn=function(t,e,r,i,n){this.mesh=t,this.skin=e,this.slotIndex=r,this.parent=i,this.inheritTimeline=n},en=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),this.bones=t,this.vertices=e};function rn(t,e,r){for(var i=t.readFloat(),n=t.readFloat()*r,o=0,a=0,s=e.getFrameCount()-1;e.setFrame(o,i,n),o!=s;o++){var h=t.readFloat(),l=t.readFloat()*r;switch(t.readByte()){case In:e.setStepped(o);break;case Pn:on(t,e,a++,o,0,i,h,n,l,r)}i=h,n=l}return e}function nn(t,e,r){for(var i=t.readFloat(),n=t.readFloat()*r,o=t.readFloat()*r,a=0,s=0,h=e.getFrameCount()-1;e.setFrame(a,i,n,o),a!=h;a++){var l=t.readFloat(),u=t.readFloat()*r,c=t.readFloat()*r;switch(t.readByte()){case In:e.setStepped(a);break;case Pn:on(t,e,s++,a,0,i,l,n,u,r),on(t,e,s++,a,1,i,l,o,c,r)}i=l,n=u,o=c}return e}function on(t,e,r,i,n,o,a,s,h,l){e.setBezier(r,i,n,o,s,t.readFloat(),t.readFloat()*l,t.readFloat(),t.readFloat()*l,a,h)}var an=0,sn=1,hn=2,ln=3,un=4,cn=5,pn=6,dn=7,fn=8,mn=9,vn=0,yn=1,gn=2,_n=3,xn=4,bn=5,wn=0,Tn=1,En=0,Sn=1,An=2,In=1,Pn=2,Mn=function(){function t(){this.minX=0,this.minY=0,this.maxX=0,this.maxY=0,this.boundingBoxes=new Array,this.polygons=new Array,this.polygonPool=new X((function(){return L.newFloatArray(16)}))}return t.prototype.update=function(t,e){if(!t)throw new Error("skeleton cannot be null.");var r=this.boundingBoxes,i=this.polygons,n=this.polygonPool,o=t.slots,a=o.length;r.length=0,n.freeAll(i),i.length=0;for(var s=0;s<a;s++){var h=o[s];if(h.bone.active){var l=h.getAttachment();if(l instanceof yr){var u=l;r.push(u);var c=n.obtain();c.length!=u.worldVerticesLength&&(c=L.newFloatArray(u.worldVerticesLength)),i.push(c),u.computeWorldVertices(h,0,u.worldVerticesLength,c,0,2)}}}e?this.aabbCompute():(this.minX=Number.POSITIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY)},t.prototype.aabbCompute=function(){for(var t=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY,i=Number.NEGATIVE_INFINITY,n=this.polygons,o=0,a=n.length;o<a;o++)for(var s=n[o],h=s,l=0,u=s.length;l<u;l+=2){var c=h[l],p=h[l+1];t=Math.min(t,c),e=Math.min(e,p),r=Math.max(r,c),i=Math.max(i,p)}this.minX=t,this.minY=e,this.maxX=r,this.maxY=i},t.prototype.aabbContainsPoint=function(t,e){return t>=this.minX&&t<=this.maxX&&e>=this.minY&&e<=this.maxY},t.prototype.aabbIntersectsSegment=function(t,e,r,i){var n=this.minX,o=this.minY,a=this.maxX,s=this.maxY;if(t<=n&&r<=n||e<=o&&i<=o||t>=a&&r>=a||e>=s&&i>=s)return!1;var h=(i-e)/(r-t),l=h*(n-t)+e;if(l>o&&l<s)return!0;if((l=h*(a-t)+e)>o&&l<s)return!0;var u=(o-e)/h+t;return u>n&&u<a||(u=(s-e)/h+t)>n&&u<a},t.prototype.aabbIntersectsSkeleton=function(t){return this.minX<t.maxX&&this.maxX>t.minX&&this.minY<t.maxY&&this.maxY>t.minY},t.prototype.containsPoint=function(t,e){for(var r=this.polygons,i=0,n=r.length;i<n;i++)if(this.containsPointPolygon(r[i],t,e))return this.boundingBoxes[i];return null},t.prototype.containsPointPolygon=function(t,e,r){for(var i=t,n=t.length,o=n-2,a=!1,s=0;s<n;s+=2){var h=i[s+1],l=i[o+1];if(h<r&&l>=r||l<r&&h>=r){var u=i[s];u+(r-h)/(l-h)*(i[o]-u)<e&&(a=!a)}o=s}return a},t.prototype.intersectsSegment=function(t,e,r,i){for(var n=this.polygons,o=0,a=n.length;o<a;o++)if(this.intersectsSegmentPolygon(n[o],t,e,r,i))return this.boundingBoxes[o];return null},t.prototype.intersectsSegmentPolygon=function(t,e,r,i,n){for(var o=t,a=t.length,s=e-i,h=r-n,l=e*n-r*i,u=o[a-2],c=o[a-1],p=0;p<a;p+=2){var d=o[p],f=o[p+1],m=u*f-c*d,v=u-d,y=c-f,g=s*y-h*v,_=(l*v-s*m)/g;if((_>=u&&_<=d||_>=d&&_<=u)&&(_>=e&&_<=i||_>=i&&_<=e)){var x=(l*y-h*m)/g;if((x>=c&&x<=f||x>=f&&x<=c)&&(x>=r&&x<=n||x>=n&&x<=r))return!0}u=d,c=f}return!1},t.prototype.getPolygon=function(t){if(!t)throw new Error("boundingBox cannot be null.");var e=this.boundingBoxes.indexOf(t);return-1==e?null:this.polygons[e]},t.prototype.getWidth=function(){return this.maxX-this.minX},t.prototype.getHeight=function(){return this.maxY-this.minY},t}(),Cn=function(){function e(t){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=t}return e.prototype.readSkeletonData=function(r){var i=this.scale,n=new Hi,o="string"==typeof r?JSON.parse(r):r,a=o.skeleton;if(a){n.hash=a.hash,n.version=a.spine;var s=n.version.substr(0,3);if("4.0"!==s&&"4.1"!==s){var h="Spine 4.1 loader cant load version "+a.spine+". Please configure your pixi-spine bundle";console.error(h)}n.x=a.x,n.y=a.y,n.width=a.width,n.height=a.height,n.fps=a.fps,n.imagesPath=a.images}if(o.bones)for(var l=0;l<o.bones.length;l++){var u=o.bones[l],c=null,p=Nn(u,"parent",null);if(null!=p&&null==(c=n.findBone(p)))throw new Error("Parent bone not found: "+p);(v=new Fi(n.bones.length,u.name,c)).length=Nn(u,"length",0)*i,v.x=Nn(u,"x",0)*i,v.y=Nn(u,"y",0)*i,v.rotation=Nn(u,"rotation",0),v.scaleX=Nn(u,"scaleX",1),v.scaleY=Nn(u,"scaleY",1),v.shearX=Nn(u,"shearX",0),v.shearY=Nn(u,"shearY",0),v.transformMode=L.enumValue(t.TransformMode,Nn(u,"transform","Normal")),v.skinRequired=Nn(u,"skin",!1),(m=Nn(u,"color",null))&&v.color.setFromString(m),n.bones.push(v)}if(o.slots)for(l=0;l<o.slots.length;l++){var d=o.slots[l],f=n.findBone(d.bone);if(!f)throw new Error("Couldn't find bone "+d.bone+" for slot "+d.name);var m,v=new $i(n.slots.length,d.name,f);(m=Nn(d,"color",null))&&v.color.setFromString(m);var y=Nn(d,"dark",null);y&&(v.darkColor=D.fromString(y)),v.attachmentName=Nn(d,"attachment",null),v.blendMode=e.blendModeFromString(Nn(d,"blend","normal")),n.slots.push(v)}if(o.ik)for(l=0;l<o.ik.length;l++){var g=o.ik[l];(v=new Ui(g.name)).order=Nn(g,"order",0),v.skinRequired=Nn(g,"skin",!1);for(var _=0;_<g.bones.length;_++){var x=g.bones[_];if(null==(S=n.findBone(x)))throw new Error("IK bone not found: "+x);v.bones.push(S)}v.target=n.findBone(g.target),v.mix=Nn(g,"mix",1),v.softness=Nn(g,"softness",0)*i,v.bendDirection=Nn(g,"bendPositive",!0)?1:-1,v.compress=Nn(g,"compress",!1),v.stretch=Nn(g,"stretch",!1),v.uniform=Nn(g,"uniform",!1),n.ikConstraints.push(v)}if(o.transform)for(l=0;l<o.transform.length;l++){g=o.transform[l];(v=new Ji(g.name)).order=Nn(g,"order",0),v.skinRequired=Nn(g,"skin",!1);for(_=0;_<g.bones.length;_++){x=g.bones[_];if(!(S=n.findBone(x)))throw new Error("Couldn't find bone "+x+" for transform constraint "+g.name+".");v.bones.push(S)}var b=g.target;if(!(w=n.findBone(b)))throw new Error("Couldn't find target bone "+b+" for transform constraint "+g.name+".");v.target=w,v.local=Nn(g,"local",!1),v.relative=Nn(g,"relative",!1),v.offsetRotation=Nn(g,"rotation",0),v.offsetX=Nn(g,"x",0)*i,v.offsetY=Nn(g,"y",0)*i,v.offsetScaleX=Nn(g,"scaleX",0),v.offsetScaleY=Nn(g,"scaleY",0),v.offsetShearY=Nn(g,"shearY",0),v.mixRotate=Nn(g,"mixRotate",1),v.mixX=Nn(g,"mixX",1),v.mixY=Nn(g,"mixY",v.mixX),v.mixScaleX=Nn(g,"mixScaleX",1),v.mixScaleY=Nn(g,"mixScaleY",v.mixScaleX),v.mixShearY=Nn(g,"mixShearY",1),n.transformConstraints.push(v)}if(o.path)for(l=0;l<o.path.length;l++){g=o.path[l];(v=new Yi(g.name)).order=Nn(g,"order",0),v.skinRequired=Nn(g,"skin",!1);for(_=0;_<g.bones.length;_++){x=g.bones[_];if(!(S=n.findBone(x)))throw new Error("Couldn't find bone "+x+" for path constraint "+g.name+".");v.bones.push(S)}var w;b=g.target;if(!(w=n.findSlot(b)))throw new Error("Couldn't find target slot "+b+" for path constraint "+g.name+".");v.target=w,v.positionMode=L.enumValue(t.PositionMode,Nn(g,"positionMode","Percent")),v.spacingMode=L.enumValue(Si,Nn(g,"spacingMode","Length")),v.rotateMode=L.enumValue(t.RotateMode,Nn(g,"rotateMode","Tangent")),v.offsetRotation=Nn(g,"rotation",0),v.position=Nn(g,"position",0),v.positionMode==t.PositionMode.Fixed&&(v.position*=i),v.spacing=Nn(g,"spacing",0),v.spacingMode!=Si.Length&&v.spacingMode!=Si.Fixed||(v.spacing*=i),v.mixRotate=Nn(g,"mixRotate",1),v.mixX=Nn(g,"mixX",1),v.mixY=Nn(g,"mixY",v.mixX),n.pathConstraints.push(v)}if(o.skins)for(l=0;l<o.skins.length;l++){var T=o.skins[l],E=new Qi(T.name);if(T.bones)for(_=0;_<T.bones.length;_++){var S;x=T.bones[_];if(!(S=n.findBone(x)))throw new Error("Couldn't find bone "+x+" for skin "+T.name+".");E.bones.push(S)}if(T.ik)for(_=0;_<T.ik.length;_++){var A=T.ik[_];if(!(I=n.findIkConstraint(A)))throw new Error("Couldn't find IK constraint "+A+" for skin "+T.name+".");E.constraints.push(I)}if(T.transform)for(_=0;_<T.transform.length;_++){A=T.transform[_];if(!(I=n.findTransformConstraint(A)))throw new Error("Couldn't find transform constraint "+A+" for skin "+T.name+".");E.constraints.push(I)}if(T.path)for(_=0;_<T.path.length;_++){var I;A=T.path[_];if(!(I=n.findPathConstraint(A)))throw new Error("Couldn't find path constraint "+A+" for skin "+T.name+".");E.constraints.push(I)}for(var P in T.attachments){var M=n.findSlot(P);if(!M)throw new Error("Couldn't find slot "+P+" for skin "+T.name+".");d=T.attachments[P];for(var C in d){var R=this.readAttachment(d[C],E,M.index,C,n);R&&E.setAttachment(M.index,C,R)}}n.skins.push(E),"default"==E.name&&(n.defaultSkin=E)}l=0;for(var O=this.linkedMeshes.length;l<O;l++){var B=this.linkedMeshes[l];if(!(E=B.skin?n.findSkin(B.skin):n.defaultSkin))throw new Error("Skin not found: "+B.skin);var N=E.getAttachment(B.slotIndex,B.parent);if(!N)throw new Error("Parent mesh not found: "+B.parent);B.mesh.timelineAttachment=B.inheritTimeline?N:B.mesh,B.mesh.setParentMesh(N)}if(this.linkedMeshes.length=0,o.events)for(var k in o.events){var F=o.events[k];(v=new Xi(k)).intValue=Nn(F,"int",0),v.floatValue=Nn(F,"float",0),v.stringValue=Nn(F,"string",""),v.audioPath=Nn(F,"audio",null),v.audioPath&&(v.volume=Nn(F,"volume",1),v.balance=Nn(F,"balance",0)),n.events.push(v)}if(o.animations)for(var V in o.animations){var X=o.animations[V];this.readAnimation(X,V,n)}return n},e.prototype.readAttachment=function(t,e,r,i,n){var o=this.scale;switch(i=Nn(t,"name",i),Nn(t,"type","region")){case"region":var a=Nn(t,"path",i),s=this.readSequence(Nn(t,"sequence",null)),h=this.attachmentLoader.newRegionAttachment(e,i,a,s);return h?(h.path=a,h.x=Nn(t,"x",0)*o,h.y=Nn(t,"y",0)*o,h.scaleX=Nn(t,"scaleX",1),h.scaleY=Nn(t,"scaleY",1),h.rotation=Nn(t,"rotation",0),h.width=t.width*o,h.height=t.height*o,h.sequence=s,(x=Nn(t,"color",null))&&h.color.setFromString(x),h):null;case"boundingbox":var l=this.attachmentLoader.newBoundingBoxAttachment(e,i);return l?(this.readVertices(t,l,t.vertexCount<<1),(x=Nn(t,"color",null))&&l.color.setFromString(x),l):null;case"mesh":case"linkedmesh":a=Nn(t,"path",i),s=this.readSequence(Nn(t,"sequence",null));var u=this.attachmentLoader.newMeshAttachment(e,i,a,s);if(!u)return null;u.path=a,(x=Nn(t,"color",null))&&u.color.setFromString(x),u.width=Nn(t,"width",0)*o,u.height=Nn(t,"height",0)*o,u.sequence=s;var c=Nn(t,"parent",null);if(c)return this.linkedMeshes.push(new Rn(u,Nn(t,"skin",null),r,c,Nn(t,"timelines",!0))),u;var p=t.uvs;return this.readVertices(t,u,p.length),u.triangles=t.triangles,u.regionUVs=new Float32Array(p),u.edges=Nn(t,"edges",null),u.hullLength=2*Nn(t,"hull",0),u;case"path":if(!(a=this.attachmentLoader.newPathAttachment(e,i)))return null;a.closed=Nn(t,"closed",!1),a.constantSpeed=Nn(t,"constantSpeed",!0);var d=t.vertexCount;this.readVertices(t,a,d<<1);for(var f=L.newArray(d/3,0),m=0;m<t.lengths.length;m++)f[m]=t.lengths[m]*o;return a.lengths=f,(x=Nn(t,"color",null))&&a.color.setFromString(x),a;case"point":var v=this.attachmentLoader.newPointAttachment(e,i);return v?(v.x=Nn(t,"x",0)*o,v.y=Nn(t,"y",0)*o,v.rotation=Nn(t,"rotation",0),(x=Nn(t,"color",null))&&v.color.setFromString(x),v):null;case"clipping":var y=this.attachmentLoader.newClippingAttachment(e,i);if(!y)return null;var g=Nn(t,"end",null);if(null!=g){var _=n.findSlot(g);if(null==_)throw new Error("Clipping end slot not found: "+g);y.endSlot=_}var x;d=t.vertexCount;return this.readVertices(t,y,d<<1),(x=Nn(t,"color",null))&&y.color.setFromString(x),y}return null},e.prototype.readSequence=function(t){if(null==t)return null;var e=new Tr(Nn(t,"count",0));return e.start=Nn(t,"start",1),e.digits=Nn(t,"digits",0),e.setupIndex=Nn(t,"setup",0),e},e.prototype.readVertices=function(t,e,r){var i=this.scale;e.worldVerticesLength=r;var n=t.vertices;if(r!=n.length){var o=new Array,a=new Array;for(u=0,c=n.length;u<c;){var s=n[u++];a.push(s);for(var h=u+4*s;u<h;u+=4)a.push(n[u]),o.push(n[u+1]*i),o.push(n[u+2]*i),o.push(n[u+3])}e.bones=a,e.vertices=L.toFloatArray(o)}else{var l=L.toFloatArray(n);if(1!=i)for(var u=0,c=n.length;u<c;u++)l[u]*=i;e.vertices=l}},e.prototype.readAnimation=function(e,r,i){var n=this.scale,o=new Array;if(e.slots)for(var a in e.slots){var s=e.slots[a];if(!(Ot=i.findSlot(a)))throw new Error("Slot not found: "+a);var h=Ot.index;for(var l in s){if(lt=s[l]){var u=lt.length;if("attachment"==l){for(var c=new pi(u,h),p=0;p<u;p++){var d=lt[p];c.setFrame(p,Nn(d,"time",0),Nn(d,"name",null))}o.push(c)}else if("rgba"==l){c=new si(u,u<<2,h);for(var f=Nn(d=lt[0],"time",0),m=D.fromString(d.color),v=(p=0,0);;p++){if(c.setFrame(p,f,m.r,m.g,m.b,m.a),!(dt=lt[p+1])){c.shrink(v);break}var y=Nn(dt,"time",0),g=D.fromString(dt.color);(_t=d.curve)&&(v=Bn(_t,c,v,p,0,f,y,m.r,g.r,1),v=Bn(_t,c,v,p,1,f,y,m.g,g.g,1),v=Bn(_t,c,v,p,2,f,y,m.b,g.b,1),v=Bn(_t,c,v,p,3,f,y,m.a,g.a,1)),f=y,m=g,d=dt}o.push(c)}else if("rgb"==l){for(c=new hi(u,3*u,h),f=Nn(d=lt[0],"time",0),m=D.fromString(d.color),p=0,v=0;;p++){if(c.setFrame(p,f,m.r,m.g,m.b),!(dt=lt[p+1])){c.shrink(v);break}y=Nn(dt,"time",0),g=D.fromString(dt.color);(_t=d.curve)&&(v=Bn(_t,c,v,p,0,f,y,m.r,g.r,1),v=Bn(_t,c,v,p,1,f,y,m.g,g.g,1),v=Bn(_t,c,v,p,2,f,y,m.b,g.b,1)),f=y,m=g,d=dt}o.push(c)}else if("alpha"==l)o.push(On(lt,new li(u,u,h),0,1));else if("rgba2"==l){c=new ui(u,7*u,h),f=Nn(d=lt[0],"time",0),m=D.fromString(d.light);var _=D.fromString(d.dark);for(p=0,v=0;;p++){if(c.setFrame(p,f,m.r,m.g,m.b,m.a,_.r,_.g,_.b),!(dt=lt[p+1])){c.shrink(v);break}y=Nn(dt,"time",0),g=D.fromString(dt.light);var x=D.fromString(dt.dark);(_t=d.curve)&&(v=Bn(_t,c,v,p,0,f,y,m.r,g.r,1),v=Bn(_t,c,v,p,1,f,y,m.g,g.g,1),v=Bn(_t,c,v,p,2,f,y,m.b,g.b,1),v=Bn(_t,c,v,p,3,f,y,m.a,g.a,1),v=Bn(_t,c,v,p,4,f,y,_.r,x.r,1),v=Bn(_t,c,v,p,5,f,y,_.g,x.g,1),v=Bn(_t,c,v,p,6,f,y,_.b,x.b,1)),f=y,m=g,_=x,d=dt}o.push(c)}else if("rgb2"==l){for(c=new ci(u,6*u,h),f=Nn(d=lt[0],"time",0),m=D.fromString(d.light),_=D.fromString(d.dark),p=0,v=0;;p++){if(c.setFrame(p,f,m.r,m.g,m.b,_.r,_.g,_.b),!(dt=lt[p+1])){c.shrink(v);break}y=Nn(dt,"time",0),g=D.fromString(dt.light),x=D.fromString(dt.dark);(_t=d.curve)&&(v=Bn(_t,c,v,p,0,f,y,m.r,g.r,1),v=Bn(_t,c,v,p,1,f,y,m.g,g.g,1),v=Bn(_t,c,v,p,2,f,y,m.b,g.b,1),v=Bn(_t,c,v,p,3,f,y,_.r,x.r,1),v=Bn(_t,c,v,p,4,f,y,_.g,x.g,1),v=Bn(_t,c,v,p,5,f,y,_.b,x.b,1)),f=y,m=g,_=x,d=dt}o.push(c)}}}}if(e.bones)for(var b in e.bones){var w=e.bones[b],T=i.findBone(b);if(!T)throw new Error("Bone not found: "+b);var E=T.index;for(var l in w){var S=(lt=w[l]).length;if(0!=S)if("rotate"===l)o.push(On(lt,new Zr(S,S,E),0,1));else if("translate"===l){c=new Qr(S,S<<1,E);o.push(Dn(lt,c,"x","y",0,n))}else if("translatex"===l){c=new Kr(S,S,E);o.push(On(lt,c,0,n))}else if("translatey"===l){c=new ti(S,S,E);o.push(On(lt,c,0,n))}else if("scale"===l){c=new ei(S,S<<1,E);o.push(Dn(lt,c,"x","y",1,1))}else if("scalex"===l){c=new ri(S,S,E);o.push(On(lt,c,1,1))}else if("scaley"===l){c=new ii(S,S,E);o.push(On(lt,c,1,1))}else if("shear"===l){c=new ni(S,S<<1,E);o.push(Dn(lt,c,"x","y",0,1))}else if("shearx"===l){c=new oi(S,S,E);o.push(On(lt,c,0,1))}else if("sheary"===l){c=new ai(S,S,E);o.push(On(lt,c,0,1))}}}if(e.ik)for(var A in e.ik){if(d=(H=e.ik[A])[0]){if(!(G=i.findIkConstraint(A)))throw new Error("IK Constraint not found: "+A);var I=i.ikConstraints.indexOf(G),P=(c=new vi(H.length,H.length<<1,I),f=Nn(d,"time",0),Nn(d,"mix",1)),M=Nn(d,"softness",0)*n;for(p=0,v=0;;p++){if(c.setFrame(p,f,P,M,Nn(d,"bendPositive",!0)?1:-1,Nn(d,"compress",!1),Nn(d,"stretch",!1)),!(dt=H[p+1])){c.shrink(v);break}y=Nn(dt,"time",0);var C=Nn(dt,"mix",1),R=Nn(dt,"softness",0)*n;(_t=d.curve)&&(v=Bn(_t,c,v,p,0,f,y,P,C,1),v=Bn(_t,c,v,p,1,f,y,M,R,n)),f=y,P=C,M=R,d=dt}o.push(c)}}if(e.transform)for(var A in e.transform){if(d=(lt=e.transform[A])[0]){if(!(G=i.findTransformConstraint(A)))throw new Error("Transform constraint not found: "+A);I=i.transformConstraints.indexOf(G),c=new yi(lt.length,6*lt.length,I),f=Nn(d,"time",0);var O=Nn(d,"mixRotate",1),B=Nn(d,"mixX",1),N=Nn(d,"mixY",B),k=Nn(d,"mixScaleX",1),F=Nn(d,"mixScaleY",k),V=Nn(d,"mixShearY",1);for(p=0,v=0;;p++){if(c.setFrame(p,f,O,B,N,k,F,V),!(dt=lt[p+1])){c.shrink(v);break}y=Nn(dt,"time",0);var X=Nn(dt,"mixRotate",1),j=Nn(dt,"mixX",1),U=Nn(dt,"mixY",j),Y=Nn(dt,"mixScaleX",1),W=Nn(dt,"mixScaleY",Y),q=Nn(dt,"mixShearY",1);(_t=d.curve)&&(v=Bn(_t,c,v,p,0,f,y,O,X,1),v=Bn(_t,c,v,p,1,f,y,B,j,1),v=Bn(_t,c,v,p,2,f,y,N,U,1),v=Bn(_t,c,v,p,3,f,y,k,Y,1),v=Bn(_t,c,v,p,4,f,y,F,W,1),v=Bn(_t,c,v,p,5,f,y,V,q,1)),f=y,O=X,B=j,N=U,k=Y,F=W,k=Y,d=dt}o.push(c)}}if(e.path)for(var A in e.path){var G,H=e.path[A];if(!(G=i.findPathConstraint(A)))throw new Error("Path constraint not found: "+A);I=i.pathConstraints.indexOf(G);for(var l in H){if(d=(lt=H[l])[0]){var $=lt.length;if("position"===l){c=new gi($,$,I);o.push(On(lt,c,0,G.positionMode==t.PositionMode.Fixed?n:1))}else if("spacing"===l){c=new _i($,$,I);o.push(On(lt,c,0,G.spacingMode==Si.Length||G.spacingMode==Si.Fixed?n:1))}else if("mix"===l){for(c=new xi($,3*$,I),f=Nn(d,"time",0),O=Nn(d,"mixRotate",1),B=Nn(d,"mixX",1),N=Nn(d,"mixY",B),p=0,v=0;;p++){if(c.setFrame(p,f,O,B,N),!(dt=lt[p+1])){c.shrink(v);break}y=Nn(dt,"time",0),X=Nn(dt,"mixRotate",1),j=Nn(dt,"mixX",1),U=Nn(dt,"mixY",j);(_t=d.curve)&&(v=Bn(_t,c,v,p,0,f,y,O,X,1),v=Bn(_t,c,v,p,1,f,y,B,j,1),v=Bn(_t,c,v,p,2,f,y,N,U,1)),f=y,O=X,B=j,N=U,d=dt}o.push(c)}}}}if(e.deform)for(var J in e.attachments={},e.deform){var Z=e.deform[J],Q=e.attachments[J]={};for(var a in Z){s=Z[a];var K=Q[a]={};for(var tt in s)K[tt]={deform:s[tt]}}}if(e.attachments)for(var et in e.attachments){var rt=e.attachments[et],it=i.findSkin(et);if(null!=it)for(var nt in rt){s=rt[nt];if(!(Ot=i.findSlot(nt)))throw new Error("Slot not found: "+nt);h=Ot.index;for(var ot in s){var at=s[ot],st=it.getAttachment(h,ot);for(var ht in at){var lt;if(d=(lt=at[ht])[0])if("deform"==ht){var ut=st.bones,ct=st.vertices,pt=ut?ct.length/3*2:ct.length;for(c=new di(lt.length,lt.length,h,st),f=Nn(d,"time",0),p=0,v=0;;p++){var dt,ft=void 0,mt=Nn(d,"vertices",null);if(mt){ft=L.newFloatArray(pt);var vt=Nn(d,"offset",0);if(L.arrayCopy(mt,0,ft,vt,mt.length),1!=n)for(var yt=(gt=vt)+mt.length;gt<yt;gt++)ft[gt]*=n;if(!ut)for(var gt=0;gt<pt;gt++)ft[gt]+=ct[gt]}else ft=ut?L.newFloatArray(pt):ct;if(c.setFrame(p,f,ft),!(dt=lt[p+1])){c.shrink(v);break}var _t;y=Nn(dt,"time",0);(_t=d.curve)&&(v=Bn(_t,c,v,p,0,f,y,0,1,1)),f=y,d=dt}o.push(c)}else if("sequence"==ht){c=new bi(lt.length,h,st);var xt=0;for(p=0;p<lt.length;p++){var bt=Nn(d,"delay",xt),wt=(f=Nn(d,"time",0),fr[Nn(d,"mode","hold")]),Tt=Nn(d,"index",0);c.setFrame(p,f,wt,Tt,bt),xt=bt,d=lt[p+1]}o.push(c)}}}}else if(z.FAIL_ON_NON_EXISTING_SKIN)throw new Error("Skin not found: "+et)}if(e.drawOrder){c=new mi(e.drawOrder.length);var Et=i.slots.length;for(p=0,gt=0;gt<e.drawOrder.length;gt++,p++){var St=e.drawOrder[gt],At=null,It=Nn(St,"offsets",null);if(It){At=L.newArray(Et,-1);for(var Pt=L.newArray(Et-It.length,0),Mt=0,Ct=0,Rt=0;Rt<It.length;Rt++){var Ot,Dt=It[Rt];if(!(Ot=i.findSlot(Dt.slot)))throw new Error("Slot not found: "+Ot);for(h=Ot.index;Mt!=h;)Pt[Ct++]=Mt++;At[Mt+Dt.offset]=Mt++}for(;Mt<Et;)Pt[Ct++]=Mt++;for(Rt=Et-1;Rt>=0;Rt--)-1==At[Rt]&&(At[Rt]=Pt[--Ct])}c.setFrame(p,Nn(St,"time",0),At)}o.push(c)}if(e.events){for(c=new fi(e.events.length),p=0,gt=0;gt<e.events.length;gt++,p++){var Bt=e.events[gt],Nt=i.findEvent(Bt.name);if(!Nt)throw new Error("Event not found: "+Bt.name);var kt=new Vi(L.toSinglePrecision(Nn(Bt,"time",0)),Nt);kt.intValue=Nn(Bt,"int",Nt.intValue),kt.floatValue=Nn(Bt,"float",Nt.floatValue),kt.stringValue=Nn(Bt,"string",Nt.stringValue),kt.data.audioPath&&(kt.volume=Nn(Bt,"volume",1),kt.balance=Nn(Bt,"balance",0)),c.setFrame(p,kt)}o.push(c)}var Ft=0;for(gt=0,yt=o.length;gt<yt;gt++)Ft=Math.max(Ft,o[gt].getDuration());if(isNaN(Ft))throw new Error("Error while parsing animation, duration is NaN");i.animations.push(new Ar(r,o,Ft))},e.blendModeFromString=function(t){if("normal"==(t=t.toLowerCase()))return i.BLEND_MODES.NORMAL;if("additive"==t)return i.BLEND_MODES.ADD;if("multiply"==t)return i.BLEND_MODES.MULTIPLY;if("screen"==t)return i.BLEND_MODES.SCREEN;throw new Error("Unknown blend mode: "+t)},e}(),Rn=function(t,e,r,i,n){this.mesh=t,this.skin=e,this.slotIndex=r,this.parent=i,this.inheritTimeline=n};function On(t,e,r,i){for(var n=t[0],o=Nn(n,"time",0),a=Nn(n,"value",r)*i,s=0,h=0;;h++){e.setFrame(h,o,a);var l=t[h+1];if(!l)return e.shrink(s),e;var u=Nn(l,"time",0),c=Nn(l,"value",r)*i;n.curve&&(s=Bn(n.curve,e,s,h,0,o,u,a,c,i)),o=u,a=c,n=l}}function Dn(t,e,r,i,n,o){for(var a=t[0],s=Nn(a,"time",0),h=Nn(a,r,n)*o,l=Nn(a,i,n)*o,u=0,c=0;;c++){e.setFrame(c,s,h,l);var p=t[c+1];if(!p)return e.shrink(u),e;var d=Nn(p,"time",0),f=Nn(p,r,n)*o,m=Nn(p,i,n)*o,v=a.curve;v&&(u=Bn(v,e,u,c,0,s,d,h,f,o),u=Bn(v,e,u,c,1,s,d,l,m,o)),s=d,h=f,l=m,a=p}}function Bn(t,e,r,i,n,o,a,s,h,l){if("stepped"==t)return e.setStepped(i),r;var u=n<<2,c=t[u],p=t[u+1]*l,d=t[u+2],f=t[u+3]*l;return e.setBezier(r,i,n,o,s,c,p,d,f,a,h),r+1}function Nn(t,e,r){return void 0!==t[e]?t[e]:r}var kn,Fn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return dr(e,t),e.prototype.createSkeleton=function(t){this.skeleton=new Gi(t),this.skeleton.updateWorldTransform(),this.stateData=new Bi(t),this.state=new wi(this.stateData)},e}(H),Ln=Object.freeze({__proto__:null,AlphaTimeline:li,Animation:Ar,AnimationState:wi,AnimationStateAdapter:Ai,AnimationStateData:Bi,AtlasAttachmentLoader:Ni,Attachment:mr,AttachmentTimeline:pi,Bone:ki,BoneData:Fi,BoundingBoxAttachment:yr,ClippingAttachment:gr,ConstraintData:Li,CurveTimeline:Hr,CurveTimeline1:$r,CurveTimeline2:Jr,DeformTimeline:di,DrawOrderTimeline:mi,Event:Vi,EventData:Xi,EventQueue:Ei,EventTimeline:fi,get EventType(){return Er},IkConstraint:ji,IkConstraintData:Ui,IkConstraintTimeline:vi,MeshAttachment:_r,PathAttachment:xr,PathConstraint:zi,PathConstraintData:Yi,PathConstraintMixTimeline:xi,PathConstraintPositionTimeline:gi,PathConstraintSpacingTimeline:_i,PointAttachment:br,RGB2Timeline:ci,RGBA2Timeline:ui,RGBATimeline:si,RGBTimeline:hi,RegionAttachment:wr,RotateTimeline:Zr,ScaleTimeline:ei,ScaleXTimeline:ri,ScaleYTimeline:ii,Sequence:Tr,get SequenceMode(){return fr},SequenceModeValues:Sr,SequenceTimeline:bi,ShearTimeline:ni,ShearXTimeline:oi,ShearYTimeline:ai,Skeleton:Gi,SkeletonBinary:Ki,SkeletonBounds:Mn,SkeletonData:Hi,SkeletonJson:Cn,Skin:Qi,SkinEntry:Zi,Slot:Wi,SlotData:$i,get SpacingMode(){return Si},Spine:Fn,Timeline:Gr,TrackEntry:Ti,TransformConstraint:qi,TransformConstraintData:Ji,TransformConstraintTimeline:yi,TranslateTimeline:Qr,TranslateXTimeline:Kr,TranslateYTimeline:ti,VertexAttachment:vr}),Vn=function(t,e){return(Vn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)};function Xn(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}Vn(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}function jn(t){var e=t.substr(0,3),r=Math.floor(10*+e+.001);return"3.7"===e?kn.VER37:"3.8"===e?kn.VER38:"4.0"===e?kn.VER40:"4.1"===e?kn.VER41:r<kn.VER37?kn.VER37:kn.UNKNOWN}!function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.VER37=37]="VER37",t[t.VER38=38]="VER38",t[t.VER40=40]="VER40",t[t.VER41=41]="VER41"}(kn||(kn={}));var Un=function(){function t(){this.scale=1}return t.prototype.readSkeletonData=function(t,e){var r=new v(e);r.readString();var i=r.readString(),n=jn(i),o=null;if(n===kn.VER38&&(o=new Kt(new Nt(t))),(r=new v(e)).readInt32(),r.readInt32(),(n=jn(i=r.readString()))!==kn.VER40&&n!==kn.VER41||(o=new Ki(new Ni(t))),!o){var a="Unsupported version of spine model "+i+", please update pixi-spine";console.error(a)}return o.scale=this.scale,o.readSkeletonData(e)},t}(),Yn=function(){function t(){this.scale=1}return t.prototype.readSkeletonData=function(t,e){var r=e.skeleton.spine,i=jn(r),n=null;if(i===kn.VER37&&(n=new hr(new We(t))),i===kn.VER38&&(n=new ie(new Nt(t))),i!==kn.VER40&&i!==kn.VER41||(n=new Cn(new Ni(t))),!n){var o="Unsupported version of spine model "+r+", please update pixi-spine";console.error(o)}return n.scale=this.scale,n.readSkeletonData(e)},t}(),zn=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return Xn(r,t),r.prototype.createBinaryParser=function(){return new Un},r.prototype.createJsonParser=function(){return new Yn},r.prototype.parseData=function(t,e,r,i){var n=e;t.spineData=n.readSkeletonData(r,i),t.spineAtlas=r},r.registerLoaderPlugin=function(){e.Loader.registerPlugin(r)},r.use=(new r).genMiddleware().use,r}($),Wn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Xn(e,t),e.prototype.createSkeleton=function(t){var e=jn(t.version),r=null;if(e===kn.VER37&&(r=cr),e===kn.VER38&&(r=ae),e!==kn.VER40&&e!==kn.VER41||(r=Ln),!r){var i="Cant detect version of spine model "+t.version;console.error(i)}this.skeleton=new r.Skeleton(t),this.skeleton.updateWorldTransform(),this.stateData=new r.AnimationStateData(t),this.state=new r.AnimationState(this.stateData)},e}(H);zn.registerLoaderPlugin(),t.BinaryInput=v,t.Color=D,t.DebugUtils=V,t.IntSet=R,t.Interpolation=N,t.MathUtils=B,t.Pool=X,t.Pow=k,t.PowOut=F,t.SkeletonBounds=Mn,t.Spine=Wn,t.SpineBase=H,t.SpineMesh=G,t.SpineParser=zn,t.SpineSprite=q,t.StringSet=O,t.TextureAtlas=S,t.TextureAtlasPage=I,t.TextureAtlasRegion=P,t.TextureRegion=T,t.TimeKeeper=U,t.Utils=L,t.Vector2=j,t.WindowedMean=Y,t.filterFromString=b,t.settings=z,t.wrapFromString=function(e){switch(e.toLowerCase()){case"mirroredtepeat":return t.TextureWrap.MirroredRepeat;case"clamptoedge":return t.TextureWrap.ClampToEdge;case"repeat":return t.TextureWrap.Repeat;default:throw new Error("Unknown texture wrap "+e)}},Object.defineProperty(t,"__esModule",{value:!0})})),"undefined"!=typeof pixi_spine&&Object.assign(this.PIXI.spine,pixi_spine);var pixi_compressed_textures,__extends=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();function fourCCToInt32(t){return t.charCodeAt(0)+(t.charCodeAt(1)<<8)+(t.charCodeAt(2)<<16)+(t.charCodeAt(3)<<24)}function int32ToFourCC(t){return String.fromCharCode(255&t,t>>8&255,t>>16&255,t>>24&255)}!function(t){t.loadFromArrayBuffer=function(t,r,i){return new e(r).loadFromArrayBuffer(t,i)};var e=function(e){function r(t,r,i,n,o,a,s){var h=e.call(this)||this;return h.complete=!1,h.isCompressedImage=!0,h.preserveSource=!0,h.onload=null,h.baseTexture=null,h.init(t,r,i,n,o,a,s),h}return __extends(r,e),r.prototype.init=function(t,e,r,i,n,o,a){void 0===i&&(i=-1),void 0===n&&(n=-1),this.src=t,this.resize(i,n),this._width=i,this._height=n,this.data=e,this.type=r,this.levels=o,this.internalFormat=a;var s=this.complete;return this.complete=!!e,!s&&this.complete&&this.onload&&this.onload({target:this}),this.update(),this},r.prototype.dispose=function(){this.data=null},r.prototype.bind=function(t){void 0!==t.alphaMode?t.alphaMode=PIXI.ALPHA_MODES.NO_PREMULTIPLIED_ALPHA:t.premultiplyAlpha=!1,e.prototype.bind.call(this,t)},r.prototype.upload=function(t,e,r){var i=t.state.gl;if(r.compressed=!1,t.texture.initCompressed(),null===this.data)throw"Trying to create a second (or more) webgl texture from the same CompressedImage : "+this.src;for(var n=this.levels,o=this.width,a=this.height,s=0,h=0;h<n;++h){var l=this._internalLoader.levelBufferSize(o,a,h),u=new Uint8Array(this.data.buffer,this.data.byteOffset+s,l);i.compressedTexImage2D(i.TEXTURE_2D,h,this.internalFormat,o,a,0,u),(o>>=1)<1&&(o=1),(a>>=1)<1&&(a=1),s+=l}return this._internalLoader.free(),this.preserveSource||(this.data=null),!0},r.prototype.style=function(t,e,r){var i=t.state.gl,n=this.levels;return e.scaleMode===PIXI.SCALE_MODES.LINEAR?n>1&&r.mipmap?(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR_MIPMAP_NEAREST)):(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR)):n>1&&r.mipmap?i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.NEAREST_MIPMAP_NEAREST):(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.NEAREST)),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,r.wrapMode),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,r.wrapMode),!0},r.prototype.loadFromArrayBuffer=function(e,r){var i=t.Loaders;if(!i||!i.length)throw"Registered compressed loaders is missing. Call `TextureSystem.initCompressed` before loading!";for(var n=void 0,o=0,a=i;o<a.length;o++){var s=a[o];if(r){if("CRN"===s.type){n=s;break}}else if(s.test(e)){n=s;break}}if(n)return this._internalLoader=new n(this),this._internalLoader.load(e);throw new Error("Compressed texture format is not recognized: "+this.src)},r}(PIXI.resources.Resource);t.CompressedImage=e}(pixi_compressed_textures||(pixi_compressed_textures={})),function(t){var e=function(){function e(e){void 0===e&&(e=new t.CompressedImage("unknown")),this._image=e,this._format=0,e._internalLoader=this}return e.prototype.free=function(){},e.test=function(t){return!1},e.type="ABSTRACT",e}();t.AbstractInternalLoader=e}(pixi_compressed_textures||(pixi_compressed_textures={})),function(t){var e,r=((e={})[16]=0,e[20]=1,e[25]=2,e[30]=3,e[36]=4,e[40]=5,e[48]=6,e[64]=7,e[50]=8,e[60]=9,e[80]=10,e[100]=11,e[120]=12,e[144]=13,e),i=function(t){function e(e,r){void 0===r&&(r=!1);var i=t.call(this,e)||this;return i.useSRGB=r,i._blockSize={x:0,y:0},i}return __extends(e,t),e.prototype.load=function(t){if(!e.test(t))throw"Invalid magic number in ASTC header";var i=new Uint8Array(t,0,16),n=i[4],o=i[5],a=i[7]+(i[8]<<8)+(i[9]<<16),s=i[10]+(i[11]<<8)+(i[12]<<16),h=r[n*o]+(this.useSRGB?37840:37808),l=new Uint8Array(t,16);this._format=h,this._blockSize.x=n,this._blockSize.y=o;var u=this._image;return u.init(u.src,l,"ASTC",a,s,1,h),u},e.test=function(t){return 1554098963===new Int32Array(t,0,1)[0]},e.prototype.levelBufferSize=function(t,e,r){void 0===r&&(r=0);var i=Math.floor,n=this._blockSize.x,o=this._blockSize.y;return i((t+n-1)/n)*i((e+o-1)/o)<<4},e.type="ASTC",e}(t.AbstractInternalLoader);t.ASTCLoader=i}(pixi_compressed_textures||(pixi_compressed_textures={})),function(t){var e,r=fourCCToInt32("DXT1"),i=fourCCToInt32("DXT3"),n=fourCCToInt32("DXT5"),o=fourCCToInt32("ATC "),a=fourCCToInt32("ATCA"),s=fourCCToInt32("ATCI"),h=((e={})[r]=33776,e[i]=33778,e[n]=33779,e[o]=35986,e[a]=35987,e[s]=34798,e),l=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e.prototype.load=function(t){if(!e.test(t))throw"Invalid magic number in DDS header";var r=new Int32Array(t,0,31);if(!(4&r[20]))throw"Unsupported format, must contain a FourCC code";var i=r[21],n=h[i]||-1;if(n<0)throw"Unsupported FourCC code: "+int32ToFourCC(i);var o=1;131072&r[2]&&(o=Math.max(1,r[7]));var a=r[4],s=r[3],l=r[1]+4,u=new Uint8Array(t,l),c=this._image;return this._format=n,c.init(c.src,u,"DDS",a,s,o,n),c},e.test=function(t){return 542327876===new Int32Array(t,0,1)[0]},e.prototype.levelBufferSize=function(t,e,r){switch(void 0===r&&(r=0),this._format){case 33776:case 35986:return(t+3>>2)*(e+3>>2)*8;case 33778:case 33779:case 35987:case 34798:return(t+3>>2)*(e+3>>2)*16;default:return 0}},e.type="DDS",e}(t.AbstractInternalLoader);t.DDSLoader=l}(pixi_compressed_textures||(pixi_compressed_textures={})),function(t){var e,r=((e={})[0]=35841,e[1]=35843,e[2]=35840,e[3]=35842,e[6]=36196,e[7]=33776,e[9]=33778,e[5]=33779,e),i=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e.prototype.load=function(t){if(!e.test(t))throw"Invalid magic number in PVR header";var i=new Int32Array(t,0,13),n=i[2],o=r[n]||-1,a=i[7],s=i[6],h=i[11],l=i[12]+52,u=new Uint8Array(t,l),c=this._image;return this._format=o,c.init(c.src,u,"PVR",a,s,h,o),c},e.test=function(t){return 55727696===new Int32Array(t,0,1)[0]},e.prototype.levelBufferSize=function(t,e,r){switch(void 0===r&&(r=0),this._format){case 33776:case 36196:return(t+3>>2)*(e+3>>2)*8;case 33778:case 33779:return(t+3>>2)*(e+3>>2)*16;case 35840:case 35842:return Math.floor((Math.max(t,8)*Math.max(e,8)*4+7)/8);case 35841:case 35843:return Math.floor((Math.max(t,16)*Math.max(e,8)*2+7)/8);default:return 0}},e.type="PVR",e}(t.AbstractInternalLoader);t.PVRTCLoader=i}(pixi_compressed_textures||(pixi_compressed_textures={})),function(t){var e,r,i=0,n=2,o=3,a=8,s=9,h=10,l=11,u=((e={})[3]=!0,e[9]=!0,e[10]=!0,e[11]=!0,e),c=((r={})[l]=-1,r[i]=36196,r[n]=33776,r[o]=33779,r[a]=35840,r[s]=35842,r[h]=37808,r),p=Object.keys(c).reduce((function(t,e){return t[c[+e]]=+e,t}),{}),d=function(e){function r(t){var r=e.call(this,t)||this;return r.type="BASIS",r._file=void 0,r}return __extends(r,e),r.test=function(t){var e=new Uint32Array(t,0,1)[0],i=!!r.BASIS_BINDING,n=1262195===e&&i,o=r.RGB_FORMAT&&r.RGBA_FORMAT;return!n&&o&&console.warn("[BASIS LOADER] Is Supported, but transcoder not binded or file is not BASIS file!"),o&&n},r.bindTranscoder=function(e,i){if(!e||!i)throw"Invalid state! undef fileCtr or ext invalid!";var n=Object.keys(i).reduce((function(t,e){var r=i[e];return r?Object.assign(t,r.__proto__):t}),{}),o=void 0,a=void 0;for(var s in n){var h=n[s];if(void 0!==p[h]){var l=p[h];u[l]?a={native:h,name:s,basis:l}:o={native:h,name:s,basis:l}}}r.RGB_FORMAT=o||a,r.RGBA_FORMAT=a||o,r.BASIS_BINDING=e,console.log("[BASISLoader] Supported formats:","\nRGB:"+r.RGB_FORMAT.name+"\nRGBA:"+r.RGBA_FORMAT.name),t.RegisterCompressedLoader(r),t.RegisterCompressedExtensions("basis")},r.prototype.load=function(t){if(!r.test(t))throw"BASIS Transcoder not binded or transcoding not supported =(!";return this._loadAsync(t),this._image},r.prototype._loadAsync=function(t){var e=performance.now(),i=new(0,r.BASIS_BINDING)(new Uint8Array(t)),n=i.getImageWidth(0,0),o=i.getImageHeight(0,0),a=i.getHasAlpha(),s=this._image;if(!i.startTranscoding())throw"Transcoding error!";var h=a?r.RGBA_FORMAT:r.RGB_FORMAT;console.log("Grats! BASIS will be transcoded to:",h);var l=new Uint8Array(i.getImageTranscodedSizeInBytes(0,0,h.basis));if(!i.transcodeImage(l,0,0,h.basis,!1,!1))throw"Transcoding error!";console.log("[BASISLoader] Totla transcoding time:",performance.now()-e),this._format=h.native,this._file=i;var u=h.name.replace("COMPRESSED_","");return Promise.resolve(s.init(s.src,l,"BASIS|"+u,n,o,1,h.native))},r.prototype.levelBufferSize=function(t,e,r){return this._file?this._file.getImageTranscodedSizeInBytes(0,r,p[this._format]):void 0},r.BASIS_BINDING=void 0,r}(t.AbstractInternalLoader);t.BASISLoader=d}(pixi_compressed_textures||(pixi_compressed_textures={})),function(t){var e=window.CRN_Module;var r=[33776,33778,33779],i=function(i){function n(t){return i.call(this,t)||this}return __extends(n,i),n.prototype.load=function(t){var i=t.byteLength,n=new Uint8Array(t),o=e._malloc(i);!function(t,e,r,i){for(var n=r/4,o=i%4,a=new Uint32Array(t.buffer,0,(i-o)/4),s=new Uint32Array(e.buffer),h=0;h<a.length;h++)s[n+h]=a[h];for(var l=i-o;l<i;l++)e[r+l]=t[l]}(n,e.HEAPU8,o,i);var a=e._crn_get_width(o,i),s=e._crn_get_height(o,i),h=e._crn_get_levels(o,i),l=e._crn_get_dxt_format(o,i),u=e._crn_get_uncompressed_size(o,i,0),c=e._malloc(u);e._crn_decompress(o,i,c,u,0);var p=new Uint8Array(e.HEAPU8.buffer,c,u),d=r[l],f=this._image;return this._format=d,this._caches=[o,c],f.init(f.src,p,"CRN",a,s,h,d)},n.prototype.levelBufferSize=function(e,r,i){return void 0===i&&(i=0),t.DDSLoader.prototype.levelBufferSize.call(this,e,r,i)},n.prototype.free=function(){e._free(this._caches[0]),e._free(this._caches[1])},n.test=function(t){return!!e},n.type="CRN",n}(t.AbstractInternalLoader);t.CRNLoader=i}(pixi_compressed_textures||(pixi_compressed_textures={})),function(t){t.Loaders=[t.DDSLoader,t.PVRTCLoader,t.ASTCLoader,t.CRNLoader],PIXI.systems.TextureSystem.prototype.initCompressed=function(){var t=this.gl;this.compressedExtensions||(this.compressedExtensions={dxt:t.getExtension("WEBGL_compressed_texture_s3tc"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),astc:t.getExtension("WEBGL_compressed_texture_astc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1")},this.compressedExtensions.crn=this.compressedExtensions.dxt)},t.RegisterCompressedLoader=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];for(var i in t.Loaders=t.Loaders||[],e)t.Loaders.indexOf(e[i])<0&&t.Loaders.push(e[i])},t.defaultDetectedExtensions=[".png",".jpg",".json",".atlas"],t.detectExtensions=function(e,r,i){void 0===i&&(i=1);var n=[];if(e instanceof PIXI.Renderer){e.texture.initCompressed();var o=e.texture.compressedExtensions;o.dxt&&n.push(".dds"),o.pvrtc&&n.push(".pvr"),o.atc&&n.push(".atc"),o.astc&&n.push(".astc"),o.etc1&&n.push(".etc1")}var a=n.slice(0),s=[r||e.resolution];i&&s.push(i);for(var h=0;h<s.length;h++){for(var l="@"+s[h]+"x",u=0;u<a.length;u++)n.push(l+a[u]);for(u=0;u<t.defaultDetectedExtensions.length;u++)n.push(l+t.defaultDetectedExtensions[u])}return n}}(pixi_compressed_textures||(pixi_compressed_textures={})),function(t){var e=PIXI.LoaderResource;function r(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];for(var n in r)t.TEXTURE_EXTENSIONS.indexOf(r[n])<0&&(t.TEXTURE_EXTENSIONS.push(r[n]),e.setExtensionXhrType(r[n],e.XHR_RESPONSE_TYPE.BUFFER))}t.TEXTURE_EXTENSIONS=[],t.RegisterCompressedExtensions=r;var i=function(){function e(){}return e.use=function(e,r){var i=e.url,n=i.lastIndexOf("."),o=i.lastIndexOf("?"),a=i.substring(n+1,o>0?o:i.length);if(t.TEXTURE_EXTENSIONS.indexOf(a)<0)r();else{if(!e.data)throw new Error("compressedImageParser middleware for PixiJS v5 must be specified in loader.use() and must have resource.data when completed");e.compressedImage||(e.compressedImage=new t.CompressedImage(e.url),e.compressedImage.loadFromArrayBuffer(e.data,"crn"===a),e.isCompressedImage=!0,e.texture=function(t,e,r){var i=new PIXI.BaseTexture(t,{scaleMode:PIXI.settings.SCALE_MODE,resolution:PIXI.utils.getResolutionOfUrl(e)}),n=new PIXI.Texture(i);r||(r=e);PIXI.BaseTexture.addToCache(n.baseTexture,r),PIXI.Texture.addToCache(n,r),r!==e&&(PIXI.BaseTexture.addToCache(n.baseTexture,e),PIXI.Texture.addToCache(n,e));return n}(e.compressedImage,e.url,e.name)),r()}},e}();t.ImageParser=i,r("dds","crn","pvr","etc1","astc"),PIXI.Loader.registerPlugin(i)}(pixi_compressed_textures||(pixi_compressed_textures={})),function(t){t.extensionChooser=function(t){return void 0===t&&(t=[]),function(e,r){var i=e.metadata.choice;if(!i)return r();var n=e.url,o=0;if(!e._defaultUrlChoice){if(e._defaultUrlChoice=n,!((o=n.lastIndexOf("."))>=0))return r();e._baseUrl=n.substring(0,o)}for(var a=i.length-1;a>=0;a--){n=e._baseUrl+i[a];for(var s=0;s<t.length;s++)if(i[a]===t[s]){e.url=n;var h=i[a];return h.indexOf("@")>-1&&(h=h.replace(/@[0-9.]*x/,"")),(o=h.indexOf("."))>=0&&(h=h.substring(o+1)),e.extension=h,e.loadType=e._determineLoadType(),void r()}}r()}}}(pixi_compressed_textures||(pixi_compressed_textures={})),function(t){var e=function(){function t(){}return t.use=function(t,e){if(t.texture&&t._defaultUrlChoice&&t._defaultUrl!==t.url){var r=t.texture,i=r.baseTexture,n=t.url,o=t._defaultUrlChoice,a=i.textureCacheIds.indexOf(n);a>=0&&(i.textureCacheIds[a]=o,delete PIXI.utils.BaseTextureCache[t.url],PIXI.utils.BaseTextureCache[o]=i),(a=r.textureCacheIds.indexOf(n))>=0&&(r.textureCacheIds[a]=o,delete PIXI.utils.TextureCache[t.url],PIXI.utils.TextureCache[o]=i)}e()},t}();t.ExtensionFixer=e}(pixi_compressed_textures||(pixi_compressed_textures={})),function(t){PIXI.compressedTextures=t}(pixi_compressed_textures||(pixi_compressed_textures={})),function(t){var e=function(e){function r(t){var r=e.call(this,t)||this;return r._mips=[],r}return __extends(r,e),r.prototype._loadAsync=function(e){var r=this,i=performance.now(),n=t.BASISLoader.BASIS_BINDING,o={genMip:!0,rgbaFormat:t.BASISLoader.RGBA_FORMAT.basis,rgbFormat:t.BASISLoader.RGB_FORMAT.basis,transfer:!0};return n.transcode(e,o).then((function(e){var n=e.width,o=e.height,a=new Uint8Array(e.buffer),s=e.hasAlpha?t.BASISLoader.RGBA_FORMAT:t.BASISLoader.RGB_FORMAT,h=s.name.replace("COMPRESSED_",""),l=r._image;return r._mips=e.mipmaps,console.log("[WorkedBASISLoader] Total transcoding time:",performance.now()-i),l.init(l.src,a,"BASIS|"+h,n,o,1,s.native)}))},r.loadAndRunTranscoder=function(t){return Promise.all([fetch(t.path+"/basis_transcoder.js").then((function(t){return t.text()})),fetch(t.path+"/basis_transcoder.wasm").then((function(t){return t.arrayBuffer()}))]).then((function(e){var i=e[0],n=e[1];r.runTranscoder(Object.assign(t,{jsSource:i,wasmSource:n}))}))},r.runTranscoder=function(i){var n=new t.WorkedBASIS.TranscoderWorkerPool(i.threads||2);e.bindTranscoder.call(this,n,i.ext);var o=t.Loaders.indexOf(t.BASISLoader);return t.Loaders[o]=r,n.init(i.jsSource,i.wasmSource)},r.prototype.levelBufferSize=function(t,e,r){return this._mips[r].size},r}(t.BASISLoader);t.WorkedBASISLoader=e}(pixi_compressed_textures||(pixi_compressed_textures={})),function(t){!function(t){var e=function(){function e(){this.worker=void 0,this.id=e.ID++,this.free=!1,this.initDone=!1,this.binary=void 0,this._rej=void 0,this._res=void 0}return e.prototype.init=function(e,r){var i=this;if(void 0===e&&(e=void 0),void 0===r&&(r=void 0),this.worker||(this.worker=t.generateWorker(e)),!this.worker)throw"Can't create worker";if(this.initDone)return Promise.resolve(!0);console.log("[BASIS Worker "+this.id+"] init start!"),this.worker.addEventListener("message",this._onMessage.bind(this)),this.worker.addEventListener("error",this._onError.bind(this)),this.binary=r;var n=performance.now();return new Promise((function(t,e){i._rej=e,i._res=t,i._init(r)})).then((function(t){return console.log("[BASIS Worker "+i.id+"] init done!",performance.now()-n),i.initDone=!0,i.free=!0,i.binary=t.buffer,!0}))},e.prototype.transcode=function(t,e){var r=this;if(!this.free)throw"[BASIS Worker "+this.id+"] Is busy! Check '.free' status!";if(!t||void 0===e.rgbaFormat||void 0===e.rgbFormat)throw"Buffer and formats requred!";var i={rgbaFormat:e.rgbaFormat,rgbFormat:e.rgbFormat,genMip:e.genMip||!1};return this.free=!1,new Promise((function(n,o){r._rej=o,r._res=n,e.transfer?r.worker.postMessage({type:"transcode",buffer:t,config:i},[t]):r.worker.postMessage({type:"transcode",buffer:t,config:i})})).then((function(t){return r.free=!0,t}))},e.prototype._init=function(t){this.worker.postMessage({type:"init",id:0,wasmBinary:t},[t])},e.prototype._onMessage=function(t){"error"===t.data.type&&this._onError(t.data.error),this._res&&this._res(t.data)},e.prototype._onError=function(t){this._rej&&this._rej(t)},e.prototype.destroy=function(){this.worker.terminate()},e.ID=0,e}();t.BasisWorker=e;var r=function(){function t(t){void 0===t&&(t=0),this.workers=[],this.count=1,this.count=t||1}return t.prototype.init=function(t,r){var i=this,n=0,o=function(){if(!(++n>i.count)){var a=new e;return i.workers.push(a),a.init(t,r).then((function(){r=a.binary,o()}))}};return o().then((function(){return i}))},t.prototype.transcode=function(t,e){if(!this.workers||!this.workers.length)throw"[TranscoderWorkerPool] Pool empty, populate before!";var r=this.workers,i=void 0,n=0,o=function(t){for(var e=0,a=r;e<a.length;e++){var s=a[e];if(s.free){i=s;break}}if(n>100)throw"[TranscoderWorkerPool] Can't found free worker after 100 interation!";i?t(i):setTimeout((function(){return o(t)}),10*n),n++};return new Promise(o).then((function(r){return console.log("[TranscoderWorkerPool] run transcoding on "+r.id+" worker"),r.transcode(t,e)}))},t.prototype.destroy=function(){this.workers.forEach((function(t){t.destroy()})),this.workers=void 0},t}();t.TranscoderWorkerPool=r}(t.WorkedBASIS||(t.WorkedBASIS={}))}(pixi_compressed_textures||(pixi_compressed_textures={})),function(t){!function(t){t.basisWorkerSource=function(){onmessage=function(t){var e=t.data,r=self[e.type];r&&r(e)}},t.generateWorker=function(e){var r=t.basisWorkerSource.toString(),i=r.indexOf("{"),n=r.lastIndexOf("}");return r=e+"\n"+r.substring(i+1,n),new Worker(URL.createObjectURL(new Blob([r])))}}(t.WorkedBASIS||(t.WorkedBASIS={}))}(pixi_compressed_textures||(pixi_compressed_textures={})),this.PIXI=this.PIXI||{},this.PIXI.smooth=this.PIXI.smooth||{},function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@pixi/math"),require("@pixi/core"),require("@pixi/constants"),require("@pixi/graphics"),require("@pixi/utils"),require("@pixi/display")):"function"==typeof define&&define.amd?define(["exports","@pixi/math","@pixi/core","@pixi/constants","@pixi/graphics","@pixi/utils","@pixi/display"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self)._pixi_graphics_smooth={},t.PIXI,t.PIXI,t.PIXI,t.PIXI,t.PIXI.utils,t.PIXI)}(this,(function(t,e,r,i,n,o,a){"use strict";function s(t,e,r=.001){return this===e||Math.abs(t.a-e.a)<r&&Math.abs(t.b-e.b)<r&&Math.abs(t.c-e.c)<r&&Math.abs(t.d-e.d)<r&&Math.abs(t.tx-e.tx)<r&&Math.abs(t.ty-e.ty)<r}class h{constructor(){this.textureIds=[],this.matrices=[],this.lines=[],this.count=0}clear(){for(let t=0;t<this.count;t++)this.textureIds[t]=null,this.matrices[t]=null;this.count=0}add(t,e,r,i,n,o){const{textureIds:a,matrices:h,lines:l,count:u}=this;t=4*t+n;for(let n=0;n<u;n++)if(l[2*n]===r&&l[2*n+1]===i&&a[n]===t&&s(h[n],e))return n;return u>=o.maxStyles?-1:(a[u]=t,h[u]=e,l[2*u]=r,l[2*u+1]=i,this.count++,u)}}class l{constructor(){this.texArray=new r.BatchTextureArray,this.styleArray=new h,this.shader=null,this.blend=i.BLEND_MODES.NORMAL,this.start=0,this.size=0,this.TICK=0,this.settings=null,this.data=null}clear(){this.texArray.clear(),this.styleArray.clear(),this.settings=null,this.data=null,this.shader=null}begin(t,e){this.TICK=++r.BaseTexture._globalBatch,this.settings=t,this.shader=e,this.start=0,this.size=0,this.data=null,e&&e.settings&&(this.settings=e.settings)}check(t){return 0===this.size?(this.shader=t,!0):this.shader===t}add(t,r,i,n,o){const{texArray:a,TICK:s,styleArray:h,settings:l}=this,{baseTexture:u}=t;if(u._batchEnabled!==s&&a.count===l.maxTextures)return-1;const c=u._batchEnabled!==s?a.count:u._batchLocation,p=h.add(c,r||e.Matrix.IDENTITY,i,n,o,l);return p>=0&&u._batchEnabled!==s&&(u._batchEnabled=s,u._batchLocation=a.count,a.elements[a.count++]=u),p}}class u{constructor(){this.reset()}begin(t,e,r){this.reset(),this.style=t,this.start=e,this.attribStart=r,this.jointEnd=0}end(t,e){this.attribSize=e-this.attribStart,this.size=t-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0,this.styleId=-1,this.rgba=0,this.jointEnd=0}}class c{constructor(){this.reset()}toJSON(){return this.copyTo({})}clone(){return this.copyTo(new c)}copyTo(t){return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.shader=this.shader,t.visible=this.visible,t.smooth=this.smooth,t.matrixTex=null,t}packLineScale(){return 0}reset(){this.color=16777215,this.alpha=1,this.texture=r.Texture.WHITE,this.matrix=null,this.shader=null,this.visible=!1,this.smooth=!1,this.matrixTex=null}destroy(){this.texture=null,this.matrix=null,this.matrixTex=null}getTextureMatrix(){const t=this.texture;return this.matrix?t.frame.width===t.baseTexture.width&&t.frame.height===t.baseTexture.height?this.matrix:(this.matrixTex?this.matrixTex.copyFrom(this.matrix):this.matrixTex=this.matrix.clone(),this.matrixTex.translate(Number(t.frame.x),Number(t.frame.y)),this.matrixTex):null}}t.LINE_SCALE_MODE=void 0,function(t){t.NONE="none",t.NORMAL="normal",t.HORIZONTAL="horizontal",t.VERTICAL="vertical"}(t.LINE_SCALE_MODE||(t.LINE_SCALE_MODE={}));class p extends c{clone(){return this.copyTo(new p)}copyTo(t){return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.shader=this.shader,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t.scaleMode=this.scaleMode,t}packLineScale(){switch(this.scaleMode){case t.LINE_SCALE_MODE.NORMAL:return 1;case t.LINE_SCALE_MODE.HORIZONTAL:return 2;case t.LINE_SCALE_MODE.VERTICAL:return 3;default:return 0}}reset(){super.reset(),this.smooth=!0,this.color=0,this.width=0,this.alignment=.5,this.cap=n.LINE_CAP.BUTT,this.join=n.LINE_JOIN.MITER,this.miterLimit=10,this.scaleMode=t.LINE_SCALE_MODE.NORMAL}}class d{constructor(){d.prototype.__init.call(this),d.prototype.__init2.call(this),d.prototype.__init3.call(this),d.prototype.__init4.call(this),d.prototype.__init5.call(this)}__init(){this.verts=[]}__init2(){this.joints=[]}__init3(){this.vertexSize=0}__init4(){this.indexSize=0}__init5(){this.closePointEps=1e-4}clear(){this.verts.length=0,this.joints.length=0,this.vertexSize=0,this.indexSize=0}destroy(){this.verts.length=0,this.joints.length=0}}t.JOINT_TYPE=void 0,function(t){t[t.NONE=0]="NONE",t[t.FILL=1]="FILL",t[t.JOINT_BEVEL=4]="JOINT_BEVEL",t[t.JOINT_MITER=8]="JOINT_MITER",t[t.JOINT_ROUND=12]="JOINT_ROUND",t[t.JOINT_CAP_BUTT=16]="JOINT_CAP_BUTT",t[t.JOINT_CAP_SQUARE=18]="JOINT_CAP_SQUARE",t[t.JOINT_CAP_ROUND=20]="JOINT_CAP_ROUND",t[t.FILL_EXPAND=24]="FILL_EXPAND",t[t.CAP_BUTT=32]="CAP_BUTT",t[t.CAP_SQUARE=64]="CAP_SQUARE",t[t.CAP_ROUND=96]="CAP_ROUND",t[t.CAP_BUTT2=128]="CAP_BUTT2"}(t.JOINT_TYPE||(t.JOINT_TYPE={}));class f{constructor(){f.prototype.__init.call(this),f.prototype.__init2.call(this),f.prototype.__init3.call(this)}static __initStatic(){this.vertsByJoint=[]}__init(){this.strideFloats=12}updateBufferSize(e,r,i,n){const{joints:o}=n;let a=!1,s=0,h=0;for(let i=e;i<e+r;i++){const e=-32&o[i],r=31&o[i];if(r===t.JOINT_TYPE.FILL){a=!0,s++;continue}if(r>=t.JOINT_TYPE.FILL_EXPAND){s+=3,h+=3;continue}const n=f.vertsByJoint[r]+f.vertsByJoint[e];n>=4&&(s+=n,h+=6+3*Math.max(n-6,0))}a&&(h+=i),n.vertexSize+=s,n.indexSize+=h}__init2(){this.bufferPos=0}__init3(){this.indexPos=0}beginPack(t,e,r,i,n=0,o=0){this.buildData=t,this.bufFloat=e,this.bufUint=r,this.indices=i,this.bufferPos=n,this.indexPos=o}endPack(){this.buildData=null,this.bufFloat=null,this.bufUint=null,this.indices=null}packInterleavedGeometry(e,r,i,n,o){const{bufFloat:a,bufUint:s,indices:h,buildData:l,strideFloats:u}=this,{joints:c,verts:p}=l;let d,m,v,y,g,_,x,b,w=this.bufferPos,T=this.indexPos,E=this.bufferPos/this.strideFloats,S=!1,A=0;for(let i=e;i<e+r;i++){const e=c[i],r=-32&c[i],l=31&c[i];if(l===t.JOINT_TYPE.FILL){S=!0,d=p[2*i],m=p[2*i+1],a[w]=d,a[w+1]=m,a[w+2]=d,a[w+3]=m,a[w+4]=d,a[w+5]=m,a[w+6]=d,a[w+7]=m,a[w+8]=A,a[w+9]=16*l,a[w+10]=n,s[w+11]=o,w+=u;continue}if(l>=t.JOINT_TYPE.FILL_EXPAND){g=p[2*i],_=p[2*i+1],d=p[2*i+2],m=p[2*i+3],v=p[2*i+4],y=p[2*i+5];const t=i+3;for(let r=0;r<3;r++)a[w]=g,a[w+1]=_,a[w+2]=d,a[w+3]=m,a[w+4]=v,a[w+5]=y,a[w+6]=p[2*(t+r)],a[w+7]=p[2*(t+r)+1],a[w+8]=A,a[w+9]=16*e+r,a[w+10]=n,s[w+11]=o,w+=u;h[T]=E,h[T+1]=E+1,h[T+2]=E+2,T+=3,E+=3;continue}const I=f.vertsByJoint[l]+f.vertsByJoint[r];if(0===I)continue;d=p[2*i],m=p[2*i+1],v=p[2*i+2],y=p[2*i+3],g=p[2*i-2],_=p[2*i-1];const P=Math.sqrt((v-d)*(v-d)+(y-m)*(y-m));0===f.vertsByJoint[l]&&(A-=P),(-3&l)!==t.JOINT_TYPE.JOINT_CAP_BUTT?(x=p[2*i+4],b=p[2*i+5]):(x=d,b=m);for(let t=0;t<I;t++)a[w]=g,a[w+1]=_,a[w+2]=d,a[w+3]=m,a[w+4]=v,a[w+5]=y,a[w+6]=x,a[w+7]=b,a[w+8]=A,a[w+9]=16*e+t,a[w+10]=n,s[w+11]=o,w+=u;A+=P,h[T]=E,h[T+1]=E+1,h[T+2]=E+2,h[T+3]=E,h[T+4]=E+2,h[T+5]=E+3,T+=6;for(let t=5;t+1<I;t++)h[T]=E+4,h[T+1]=E+t,h[T+2]=E+t+1,T+=3;E+=I}if(S){for(let t=0;t<i.length;t++)h[T+t]=i[t]+E;T+=i.length}this.bufferPos=w,this.indexPos=T}}f.__initStatic();const m=f.vertsByJoint;for(let t=0;t<256;t++)m.push(0);m[t.JOINT_TYPE.FILL]=1;for(let e=0;e<8;e++)m[t.JOINT_TYPE.FILL_EXPAND+e]=3;m[t.JOINT_TYPE.JOINT_BEVEL]=9,m[t.JOINT_TYPE.JOINT_BEVEL+1]=9,m[t.JOINT_TYPE.JOINT_BEVEL+2]=9,m[t.JOINT_TYPE.JOINT_BEVEL+3]=9,m[t.JOINT_TYPE.JOINT_ROUND]=9,m[t.JOINT_TYPE.JOINT_ROUND+1]=9,m[t.JOINT_TYPE.JOINT_ROUND+2]=9,m[t.JOINT_TYPE.JOINT_ROUND+3]=9,m[t.JOINT_TYPE.JOINT_MITER]=9,m[t.JOINT_TYPE.JOINT_MITER+1]=9,m[t.JOINT_TYPE.JOINT_MITER+2]=4,m[t.JOINT_TYPE.JOINT_MITER+3]=4,m[t.JOINT_TYPE.JOINT_CAP_BUTT]=4,m[t.JOINT_TYPE.JOINT_CAP_BUTT+1]=4,m[t.JOINT_TYPE.JOINT_CAP_SQUARE]=4,m[t.JOINT_TYPE.JOINT_CAP_SQUARE+1]=4,m[t.JOINT_TYPE.JOINT_CAP_ROUND]=9,m[t.JOINT_TYPE.JOINT_CAP_ROUND+1]=9,m[t.JOINT_TYPE.CAP_ROUND]=4;class v{constructor(t,e=null,r=null,i=null){this.shape=t,this.lineStyle=r,this.fillStyle=e,this.matrix=i,this.type=t.type,this.points=[],this.holes=[],this.triangles=[],this.closeStroke=!1,this.clearBuild()}clearPath(){this.points.length=0,this.closeStroke=!0}clearBuild(){this.triangles.length=0,this.fillStart=0,this.fillLen=0,this.strokeStart=0,this.strokeLen=0,this.fillAA=!1}clone(){return new v(this.shape,this.fillStyle,this.lineStyle,this.matrix)}capType(){let e;switch(this.lineStyle.cap){case n.LINE_CAP.SQUARE:e=t.JOINT_TYPE.CAP_SQUARE;break;case n.LINE_CAP.ROUND:e=t.JOINT_TYPE.CAP_ROUND;break;default:e=t.JOINT_TYPE.CAP_BUTT}return e}goodJointType(){let e;switch(this.lineStyle.join){case n.LINE_JOIN.BEVEL:e=t.JOINT_TYPE.JOINT_BEVEL;break;case n.LINE_JOIN.ROUND:e=t.JOINT_TYPE.JOINT_ROUND;break;default:e=t.JOINT_TYPE.JOINT_MITER+3}return e}jointType(){let e;switch(this.lineStyle.join){case n.LINE_JOIN.BEVEL:e=t.JOINT_TYPE.JOINT_BEVEL;break;case n.LINE_JOIN.ROUND:e=t.JOINT_TYPE.JOINT_ROUND;break;default:e=t.JOINT_TYPE.JOINT_MITER}return e}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null,this.triangles=null}}class y{path(t,r){const i=t.points;let n,o,a,s,h,l;if(t.type===e.SHAPES.CIRC){const e=t.shape;n=e.x,o=e.y,h=l=e.radius,a=s=0}else if(t.type===e.SHAPES.ELIP){const e=t.shape;n=e.x,o=e.y,h=e.width,l=e.height,a=s=0}else{const e=t.shape,r=e.width/2,i=e.height/2;n=e.x+r,o=e.y+i,h=l=Math.max(0,Math.min(e.radius,Math.min(r,i))),a=r-h,s=i-l}const u=Math.ceil(2.3*Math.sqrt(h+l)),c=8*u+(a?4:0)+(s?4:0);if(i.length=c,0===c)return;if(0===u)return i.length=8,i[0]=i[6]=n+a,i[1]=i[3]=o+s,i[2]=i[4]=n-a,void(i[5]=i[7]=o-s);let p=0,d=4*u+(a?2:0)+2,f=d,m=c;{const t=a+h,e=s,r=n+t,l=n-t,u=o+e;if(i[p++]=r,i[p++]=u,i[--d]=u,i[--d]=l,s){const t=o-e;i[f++]=l,i[f++]=t,i[--m]=t,i[--m]=r}}for(let t=1;t<u;t++){const e=Math.PI/2*(t/u),r=a+Math.cos(e)*h,c=s+Math.sin(e)*l,v=n+r,y=n-r,g=o+c,_=o-c;i[p++]=v,i[p++]=g,i[--d]=g,i[--d]=y,i[f++]=y,i[f++]=_,i[--m]=_,i[--m]=v}{const t=s+l,e=n+a,r=n-a,h=o+t,u=o-t;i[p++]=e,i[p++]=h,i[--m]=u,i[--m]=e,a&&(i[p++]=r,i[p++]=h,i[--m]=u,i[--m]=r)}}fill(r,i){const{verts:n,joints:o}=i,{points:a,triangles:s}=r;let h,l;if(r.type!==e.SHAPES.RREC){const t=r.shape;h=t.x,l=t.y}else{const t=r.shape;h=t.x+t.width/2,l=t.y+t.height/2}const u=r.matrix,c=u?u.a*h+u.c*l+u.tx:h,p=u?u.b*h+u.d*l+u.ty:l;let d=1;if(!r.fillAA){n.push(c,p),o.push(t.JOINT_TYPE.FILL),n.push(a[0],a[1]),o.push(t.JOINT_TYPE.FILL);for(let e=2;e<a.length;e+=2)n.push(a[e],a[e+1]),o.push(t.JOINT_TYPE.FILL),s.push(d++,0,d);return void s.push(1,0,d)}const f=a.length;let m=a[f-2],v=a[f-1],y=v-a[f-3],g=a[f-4]-m;const _=Math.sqrt(y*y+g*g);let x,b;y/=_,g/=_;for(let e=0;e<f;e+=2){const r=a[e],i=a[e+1];let s=i-v,h=m-r;const l=Math.sqrt(s*s+h*h);s/=l,h/=l;let u=y+s,d=g+h;const f=s*u+h*d;u/=f,d/=f,e>0?(n.push(u),n.push(d)):(x=u,b=d),n.push(c),n.push(p),n.push(m),n.push(v),n.push(r),n.push(i),n.push(0),n.push(0),n.push(u),n.push(d),o.push(t.JOINT_TYPE.FILL_EXPAND+2),o.push(t.JOINT_TYPE.NONE),o.push(t.JOINT_TYPE.NONE),o.push(t.JOINT_TYPE.NONE),o.push(t.JOINT_TYPE.NONE),o.push(t.JOINT_TYPE.NONE),m=r,v=i,y=s,g=h}n.push(x),n.push(b)}line(e,r){const{verts:i,joints:n}=r,{points:o}=e,a=8===o.length?e.goodJointType():t.JOINT_TYPE.JOINT_MITER+3,s=o.length;i.push(o[s-2],o[s-1]),n.push(t.JOINT_TYPE.NONE);for(let t=0;t<s;t+=2)i.push(o[t],o[t+1]),n.push(a);i.push(o[0],o[1]),n.push(t.JOINT_TYPE.NONE),i.push(o[2],o[3]),n.push(t.JOINT_TYPE.NONE)}}const g=[];function _(t,e=!1){const r=t.length;if(r<6)return;let i=0;for(let e=0,n=t[r-2],o=t[r-1];e<r;e+=2){const r=t[e],a=t[e+1];i+=(r-n)*(a+o),n=r,o=a}if(!e&&i>0||e&&i<=0){const e=r/2;for(let i=e+e%2;i<r;i+=2){const e=r-i-2,n=r-i-1,o=i,a=i+1;[t[e],t[o]]=[t[o],t[e]],[t[n],t[a]]=[t[a],t[n]]}}}class x{path(t,r){const i=t.shape,n=t.points=i.points.slice(),o=r.closePointEps,a=o*o;if(0===n.length)return;const s=new e.Point(n[0],n[1]),h=new e.Point(n[n.length-2],n[n.length-1]),l=t.closeStroke=i.closeStroke;let u=n.length,c=2;for(let t=2;t<u;t+=2){const e=n[t-2],r=n[t-1],i=n[t],a=n[t+1];let s=!0;Math.abs(e-i)<o&&Math.abs(r-a)<o&&(s=!1),s&&(n[c]=n[t],n[c+1]=n[t+1],c+=2)}n.length=u=c,c=2;for(let t=2;t+2<u;t+=2){let e=n[t-2],r=n[t-1];const i=n[t],o=n[t+1];let s=n[t+2],h=n[t+3];e-=i,r-=o,s-=i,h-=o;let l=!0;Math.abs(s*r-h*e)<a&&e*s+r*h<-a&&(l=!1),l&&(n[c]=n[t],n[c+1]=n[t+1],c+=2)}n[c]=n[u-2],n[c+1]=n[u-1],c+=2,n.length=u=c,u<=2||!l||Math.abs(s.x-h.x)<o&&Math.abs(s.y-h.y)<o&&(n.pop(),n.pop())}line(e,r){const{closeStroke:i,points:n}=e,o=n.length;if(o<=2)return;const{verts:a,joints:s}=r,h=e.jointType(),l=e.capType();let u,c,p=0;i?(u=n[o-2],c=n[o-1],s.push(t.JOINT_TYPE.NONE)):(u=n[2],c=n[3],l===t.JOINT_TYPE.CAP_ROUND?(a.push(n[0],n[1]),s.push(t.JOINT_TYPE.NONE),s.push(t.JOINT_TYPE.CAP_ROUND),p=0):(p=l,s.push(t.JOINT_TYPE.NONE))),a.push(u,c);for(let e=0;e<o;e+=2){const r=n[e],d=n[e+1];let f=h;e+2>=o?i||(f=t.JOINT_TYPE.NONE):e+4>=o&&(i||(l===t.JOINT_TYPE.CAP_ROUND&&(f=t.JOINT_TYPE.JOINT_CAP_ROUND),l===t.JOINT_TYPE.CAP_BUTT&&(f=t.JOINT_TYPE.JOINT_CAP_BUTT),l===t.JOINT_TYPE.CAP_SQUARE&&(f=t.JOINT_TYPE.JOINT_CAP_SQUARE))),f+=p,p=0,a.push(r,d),s.push(f),u=r,c=d}i?(a.push(n[0],n[1]),s.push(t.JOINT_TYPE.NONE),a.push(n[2],n[3]),s.push(t.JOINT_TYPE.NONE)):(a.push(n[o-4],n[o-3]),s.push(t.JOINT_TYPE.NONE))}fill(e,r){let i=e.points;const n=e.holes,a=r.closePointEps,{verts:s,joints:h}=r;if(i.length<6)return;const l=[];let u=i.length;_(i,!1);for(let t=0;t<n.length;t++){const e=n[t];_(e.points,!0),l.push(i.length/2),i=i.concat(e.points)}const c=g;c.length<i.length&&(c.length=i.length);let p=0;for(let t=0;t<=l.length;t++){let e=u/2;t>0&&(e=t<l.length?l[t]:i.length>>1),c[2*p]=e-1,c[2*(e-1)+1]=0;for(let t=p;t+1<e;t++)c[2*t+1]=t+1,c[2*t+2]=t;p=e}if(e.triangles=o.earcut(i,l,2),!e.triangles)return;if(!e.fillAA){for(let e=0;e<i.length;e+=2)s.push(i[e],i[e+1]),h.push(t.JOINT_TYPE.FILL);return}const{triangles:d}=e;u=i.length;for(let e=0;e<d.length;e+=3){let r=0;for(let t=0;t<3;t++){const i=d[e+t],n=d[e+(t+1)%3];c[2*i]!==n&&c[2*i+1]!==n||(r|=1<<t)}h.push(t.JOINT_TYPE.FILL_EXPAND+r),h.push(t.JOINT_TYPE.NONE),h.push(t.JOINT_TYPE.NONE),h.push(t.JOINT_TYPE.NONE),h.push(t.JOINT_TYPE.NONE),h.push(t.JOINT_TYPE.NONE)}for(let t=0;t<u/2;t++){const e=c[2*t],r=c[2*t+1];let n=i[2*r+1]-i[2*t+1],o=-(i[2*r]-i[2*t]),s=i[2*t+1]-i[2*e+1],h=-(i[2*t]-i[2*e]);const l=Math.sqrt(n*n+o*o);n/=l,o/=l;const u=Math.sqrt(s*s+h*h);s/=u,h/=u;let p=n+s,d=o+h;const f=p*n+d*o;Math.abs(f)<a?(p=n,d=o):(p/=f,d/=f),c[2*t]=p,c[2*t+1]=d}for(let t=0;t<d.length;t+=3){const e=d[t],r=d[t+1],n=d[t+2],o=i[2*n+1]-i[2*r+1],a=-(i[2*n]-i[2*r]),h=i[2*r+1]-i[2*e+1];let l=1;o*-(i[2*r]-i[2*e])-h*a>0&&(l=2);for(let e=0;e<3;e++){const r=d[t+e*l%3];s.push(i[2*r],i[2*r+1])}for(let e=0;e<3;e++){const r=d[t+e*l%3];s.push(c[2*r],c[2*r+1])}}}}class b{constructor(){b.prototype.__init.call(this)}__init(){this._polyBuilder=new x}path(t,e){const r=t.shape,i=r.x,n=r.y,o=r.width,a=r.height,s=t.points;s.length=0,s.push(i,n,i+o,n,i+o,n+a,i,n+a)}line(e,r){const{verts:i,joints:n}=r,{points:o}=e,a=e.goodJointType(),s=o.length;i.push(o[s-2],o[s-1]),n.push(t.JOINT_TYPE.NONE);for(let t=0;t<s;t+=2)i.push(o[t],o[t+1]),n.push(a);i.push(o[0],o[1]),n.push(t.JOINT_TYPE.NONE),i.push(o[2],o[3]),n.push(t.JOINT_TYPE.NONE)}fill(e,r){const{verts:i,joints:n}=r,{points:o,triangles:a}=e;if(a.length=0,!e.fillAA)return i.push(o[0],o[1],o[2],o[3],o[4],o[5],o[6],o[7]),n.push(t.JOINT_TYPE.FILL,t.JOINT_TYPE.FILL,t.JOINT_TYPE.FILL,t.JOINT_TYPE.FILL),void a.push(0,1,2,0,2,3);this._polyBuilder.fill(e,r)}}function w(t,e,r){return t+(e-t)*r}function T(t,e,r,i,n,o,a=[],s=.001){const h=a;let l=0,u=0,c=0,p=0,d=0,f=0;for(let a=0,m=0;a<=20;++a)m=a/20,l=w(t,r,m),u=w(e,i,m),c=w(r,n,m),p=w(i,o,m),d=w(l,c,m),f=w(u,p,m),0===a&&Math.abs(d-h[h.length-2])<s&&Math.abs(f-h[h.length-1])<s||h.push(d,f);return h}class E{constructor(){E.prototype.__init.call(this)}__init(){this._circleBuilder=new y}path(t,e){if(n.Graphics.nextRoundedRectBehavior)return void this._circleBuilder.path(t,e);const r=t.shape,{points:i}=t,o=r.x,a=r.y,s=r.width,h=r.height,l=Math.max(0,Math.min(r.radius,Math.min(s,h)/2));if(i.length=0,l){const t=e.closePointEps;T(o,a+l,o,a,o+l,a,i,t),T(o+s-l,a,o+s,a,o+s,a+l,i,t),T(o+s,a+h-l,o+s,a+h,o+s-l,a+h,i,t),T(o+l,a+h,o,a+h,o,a+h-l,i,t),i.length>=4&&Math.abs(i[0]-i[i.length-2])<t&&Math.abs(i[1]-i[i.length-1])<t&&(i.pop(),i.pop())}else i.push(o,a,o+s,a,o+s,a+h,o,a+h)}line(t,e){this._circleBuilder.line(t,e)}fill(t,e){this._circleBuilder.fill(t,e)}}const S={[e.SHAPES.POLY]:new x,[e.SHAPES.CIRC]:new y,[e.SHAPES.ELIP]:new y,[e.SHAPES.RECT]:new b,[e.SHAPES.RREC]:new E},A=[],I=[],P=new e.Point,M=new a.Bounds;class C extends r.Geometry{static __initStatic(){this.BATCHABLE_SIZE=100}__init(){this.indicesUint16=null}get points(){return this.buildData.verts}get closePointEps(){return this.buildData.closePointEps}initAttributes(t){this._buffer=new r.Buffer(null,t,!1),this._bufferFloats=new Float32Array,this._bufferUint=new Uint32Array,this._indexBuffer=new r.Buffer(null,t,!0),this.addAttribute("aPrev",this._buffer,2,!1,i.TYPES.FLOAT).addAttribute("aPoint1",this._buffer,2,!1,i.TYPES.FLOAT).addAttribute("aPoint2",this._buffer,2,!1,i.TYPES.FLOAT).addAttribute("aNext",this._buffer,2,!1,i.TYPES.FLOAT).addAttribute("aTravel",this._buffer,1,!1,i.TYPES.FLOAT).addAttribute("aVertexJoint",this._buffer,1,!1,i.TYPES.FLOAT).addAttribute("aStyleId",this._buffer,1,!1,i.TYPES.FLOAT).addAttribute("aColor",this._buffer,4,!0,i.TYPES.UNSIGNED_BYTE).addIndex(this._indexBuffer),this.strideFloats=12}constructor(){super(),C.prototype.__init.call(this),this.initAttributes(!1),this.buildData=new d,this.graphicsData=[],this.dirty=0,this.batchDirty=-1,this.cacheDirty=-1,this.clearDirty=0,this.drawCalls=[],this.batches=[],this.shapeBuildIndex=0,this.shapeBatchIndex=0,this._bounds=new a.Bounds,this.boundsDirty=-1,this.boundsPadding=0,this.batchable=!1,this.indicesUint16=null,this.packer=null,this.packSize=0,this.pack32index=null}checkInstancing(t,e){this.packer||(this.packer=new f,this.pack32index=e)}get bounds(){return this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeBuildIndex=0,this.shapeBatchIndex=0,this.packSize=0,this.buildData.clear();for(let t=0;t<this.drawCalls.length;t++)this.drawCalls[t].clear(),I.push(this.drawCalls[t]);this.drawCalls.length=0;for(let t=0;t<this.batches.length;t++){const e=this.batches[t];e.reset(),A.push(e)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(t,e=null,r=null,i=null){const n=new v(t,e,r,i);return this.graphicsData.push(n),this.dirty++,this}drawHole(t,e=null){if(!this.graphicsData.length)return null;const r=new v(t,null,null,e),i=this.graphicsData[this.graphicsData.length-1];return r.lineStyle=i.lineStyle,i.holes.push(r),this.dirty++,this}destroy(){super.destroy();for(let t=0;t<this.graphicsData.length;++t)this.graphicsData[t].destroy();this.buildData.destroy(),this.buildData=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(t){const e=this.graphicsData;for(let r=0;r<e.length;++r){const i=e[r];if(i.fillStyle.visible&&i.shape&&(i.matrix?i.matrix.applyInverse(t,P):P.copyFrom(t),i.shape.contains(P.x,P.y))){let t=!1;if(i.holes)for(let e=0;e<i.holes.length;e++)if(i.holes[e].shape.contains(P.x,P.y)){t=!0;break}if(!t)return!0}}return!1}updatePoints(){}updateBufferSize(){this._buffer.update(new Float32Array)}updateBuild(){const{graphicsData:t,buildData:i}=this,n=t.length;for(let o=this.shapeBuildIndex;o<n;o++){const n=t[o];n.strokeStart=0,n.strokeLen=0,n.fillStart=0,n.fillLen=0;const{fillStyle:a,lineStyle:s,holes:h}=n;if(!a.visible&&!s.visible)continue;const l=S[n.type];if(n.clearPath(),l.path(n,i),n.matrix&&this.transformPoints(n.points,n.matrix),n.clearBuild(),!(n.points.length<=2)&&((a.visible||s.visible)&&this.processHoles(h),a.visible&&(n.fillAA=n.fillStyle.smooth&&n.fillStyle.texture===r.Texture.WHITE&&0===h.length&&!(n.closeStroke&&n.lineStyle.visible&&!n.lineStyle.shader&&n.lineStyle.alpha>=.99&&n.lineStyle.width*Math.min(n.lineStyle.alignment,1-n.lineStyle.alignment)>=.495),n.fillStart=i.joints.length,h.length?S[e.SHAPES.POLY].fill(n,i):l.fill(n,i),n.fillLen=i.joints.length-n.fillStart),s.visible)){n.strokeStart=i.joints.length,l.line(n,i);for(let t=0;t<h.length;t++){const e=h[t];S[e.type].line(e,i)}n.strokeLen=i.joints.length-n.strokeStart}}this.shapeBuildIndex=n}updateBatches(t){if(!this.graphicsData.length)return void(this.batchable=!0);if(this.updateBuild(),!this.validateBatching())return;const{buildData:e,graphicsData:r}=this,n=r.length;this.cacheDirty=this.dirty;let o=null,a=null;this.batches.length>0&&(o=this.batches[this.batches.length-1],a=o.style);for(let t=this.shapeBatchIndex;t<n;t++){const n=r[t],s=n.fillStyle,h=n.lineStyle;if(n.matrix&&this.transformPoints(n.points,n.matrix),s.visible||h.visible)for(let t=0;t<2;t++){const r=0===t?s:h;if(!r.visible)continue;const l=r.texture.baseTexture,c=e.vertexSize,p=e.indexSize;l.wrapMode=i.WRAP_MODES.REPEAT,0===t?this.packer.updateBufferSize(n.fillStart,n.fillLen,n.triangles.length,e):this.packer.updateBufferSize(n.strokeStart,n.strokeLen,n.triangles.length,e),e.vertexSize!==c&&(o&&!this._compareStyles(a,r)&&(o.end(p,c),o=null),o||(o=A.pop()||new u,o.begin(r,p,c),this.batches.push(o),a=r),o.jointEnd=0===t?n.fillStart+n.fillLen:n.strokeStart+n.strokeLen)}}this.shapeBatchIndex=n,o&&o.end(e.indexSize,e.vertexSize),0!==this.batches.length?(this.batchable=this.isBatchable(),this.batchable?this.packBatches():(this.buildDrawCalls(t),this.updatePack())):this.batchable=!0}updatePack(){const{vertexSize:t,indexSize:e}=this.buildData;if(this.packSize===t)return;const{strideFloats:r,packer:i,buildData:n,batches:o}=this,a=this._buffer,s=this._indexBuffer,h=t*r;if(a.data.length!==h){const t=new ArrayBuffer(4*h);this._bufferFloats=new Float32Array(t),this._bufferUint=new Uint32Array(t),a.data=this._bufferFloats}s.data.length!==e&&(t>65535&&this.pack32index?s.data=new Uint32Array(e):s.data=new Uint16Array(e)),i.beginPack(n,this._bufferFloats,this._bufferUint,s.data);let l=0;for(let t=0;t<this.graphicsData.length;t++){const e=this.graphicsData[t];if(e.fillLen){for(;o[l].jointEnd<=e.fillStart;)l++;i.packInterleavedGeometry(e.fillStart,e.fillLen,e.triangles,o[l].styleId,o[l].rgba)}if(e.strokeLen){for(;o[l].jointEnd<=e.strokeStart;)l++;i.packInterleavedGeometry(e.strokeStart,e.strokeLen,e.triangles,o[l].styleId,o[l].rgba)}}a.update(),s.update(),this.packSize=t}_compareStyles(t,r){return!(!t||!r)&&(t.texture.baseTexture===r.texture.baseTexture&&(t.color+t.alpha===r.color+r.alpha&&(t.width===r.width&&(t.scaleMode===r.scaleMode&&(t.alignment===r.alignment&&s(t.matrix||e.Matrix.IDENTITY,r.matrix||e.Matrix.IDENTITY))))))}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let t=0,e=this.graphicsData.length;t<e;t++){const e=this.graphicsData[t],r=e.fillStyle,i=e.lineStyle;if(r&&!r.texture.baseTexture.valid)return!1;if(i&&!i.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++;const t=this.batches;for(let e=0,r=t.length;e<r;e++){const r=t[e];for(let t=0;t<r.size;t++){const e=r.start+t;this.indicesUint16[e]=this.indicesUint16[e]-r.attribStart}}}isBatchable(){return!1}buildDrawCalls(t){for(let t=0;t<this.drawCalls.length;t++)this.drawCalls[t].clear(),I.push(this.drawCalls[t]);this.drawCalls.length=0;let e=I.pop()||new l;e.begin(t,null);let r=0;this.drawCalls.push(e);for(let i=0;i<this.batches.length;i++){const n=this.batches[i],a=n.style;if(0===n.attribSize)continue;let s=-1;const h=a.getTextureMatrix();e.check(a.shader)&&(s=e.add(a.texture,h,a.width,a.alignment||0,a.packLineScale())),s<0&&(e=I.pop()||new l,this.drawCalls.push(e),e.begin(t,a.shader),e.start=r,s=e.add(a.texture,h,a.width,a.alignment||0,a.packLineScale())),e.size+=n.size,r+=n.size;const{color:u,alpha:c}=a,p=(u>>16)+(65280&u)+((255&u)<<16);n.rgba=o.premultiplyTint(p,c),n.styleId=s}}processHoles(t){for(let e=0;e<t.length;e++){const r=t[e],i=S[r.type];r.clearPath(),i.path(r,this.buildData),r.matrix&&this.transformPoints(r.points,r.matrix)}}calculateBounds(){const t=this._bounds,r=M;let i=e.Matrix.IDENTITY;this._bounds.clear(),r.clear();for(let n=0;n<this.graphicsData.length;n++){const o=this.graphicsData[n],a=o.shape,s=o.type,h=o.lineStyle,l=o.matrix||e.Matrix.IDENTITY;let u=0;if(h&&h.visible&&(u=h.width,s!==e.SHAPES.POLY||o.fillStyle.visible?u*=Math.max(0,h.alignment):u*=Math.max(h.alignment,1-h.alignment)),i!==l&&(r.isEmpty()||(t.addBoundsMatrix(r,i),r.clear()),i=l),s===e.SHAPES.RECT||s===e.SHAPES.RREC){const t=a;r.addFramePad(t.x,t.y,t.x+t.width,t.y+t.height,u,u)}else if(s===e.SHAPES.CIRC){const t=a;r.addFramePad(t.x,t.y,t.x,t.y,t.radius+u,t.radius+u)}else if(s===e.SHAPES.ELIP){const t=a;r.addFramePad(t.x,t.y,t.x,t.y,t.width+u,t.height+u)}else{const e=a;t.addVerticesMatrix(i,e.points,0,e.points.length,u,u)}}r.isEmpty()||t.addBoundsMatrix(r,i),t.pad(this.boundsPadding,this.boundsPadding)}transformPoints(t,e){for(let r=0;r<t.length/2;r++){const i=t[2*r],n=t[2*r+1];t[2*r]=e.a*i+e.c*n+e.tx,t[2*r+1]=e.b*i+e.d*n+e.ty}}}C.__initStatic();const R=["\nfloat pixelLine(float x, float A, float B) {\n    return clamp(x + 0.5, 0.0, 1.0);\n}\n","\nfloat pixelLine(float x, float A, float B) {\n    float y = abs(x), s = sign(x);\n    if (y * 2.0 < A - B) {\n        return 0.5 + s * y / A;\n    }\n    y -= (A - B) * 0.5;\n    y = max(1.0 - y / B, 0.0);\n    return (1.0 + s * (1.0 - y * y)) * 0.5;\n    //return clamp(x + 0.5, 0.0, 1.0);\n}\n"];class O extends r.Program{constructor(t,e="#version 100\nprecision highp float;\nconst float FILL = 1.0;\nconst float BEVEL = 4.0;\nconst float MITER = 8.0;\nconst float ROUND = 12.0;\nconst float JOINT_CAP_BUTT = 16.0;\nconst float JOINT_CAP_SQUARE = 18.0;\nconst float JOINT_CAP_ROUND = 20.0;\n\nconst float FILL_EXPAND = 24.0;\n\nconst float CAP_BUTT = 1.0;\nconst float CAP_SQUARE = 2.0;\nconst float CAP_ROUND = 3.0;\nconst float CAP_BUTT2 = 4.0;\n\nconst float MITER_LIMIT = 10.0;\n\n// === geom ===\nattribute vec2 aPrev;\nattribute vec2 aPoint1;\nattribute vec2 aPoint2;\nattribute vec2 aNext;\nattribute float aVertexJoint;\nattribute float aTravel;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec4 vLine1;\nvarying vec4 vLine2;\nvarying vec4 vArc;\nvarying float vType;\n\nuniform float resolution;\nuniform float expand;\n\n// === style ===\nattribute float aStyleId;\nattribute vec4 aColor;\n\nvarying float vTextureId;\nvarying vec4 vColor;\nvarying vec2 vTextureCoord;\nvarying vec2 vTravel;\n\nuniform vec2 styleLine[%MAX_STYLES%];\nuniform vec3 styleMatrix[2 * %MAX_STYLES%];\nuniform float styleTextureId[%MAX_STYLES%];\nuniform vec2 samplerSize[%MAX_TEXTURES%];\n\nvec2 doBisect(vec2 norm, float len, vec2 norm2, float len2,\n    float dy, float inner) {\n    vec2 bisect = (norm + norm2) / 2.0;\n    bisect /= dot(norm, bisect);\n    vec2 shift = dy * bisect;\n    if (inner > 0.5) {\n        if (len < len2) {\n            if (abs(dy * (bisect.x * norm.y - bisect.y * norm.x)) > len) {\n                return dy * norm;\n            }\n        } else {\n            if (abs(dy * (bisect.x * norm2.y - bisect.y * norm2.x)) > len2) {\n                return dy * norm;\n            }\n        }\n    }\n    return dy * bisect;\n}\n\nvoid main(void){\n    vec2 pointA = (translationMatrix * vec3(aPoint1, 1.0)).xy;\n    vec2 pointB = (translationMatrix * vec3(aPoint2, 1.0)).xy;\n\n    vec2 xBasis = pointB - pointA;\n    float len = length(xBasis);\n    vec2 forward = xBasis / len;\n    vec2 norm = vec2(forward.y, -forward.x);\n\n    float type = floor(aVertexJoint / 16.0);\n    float vertexNum = aVertexJoint - type * 16.0;\n    float dx = 0.0, dy = 1.0;\n\n    float capType = floor(type / 32.0);\n    type -= capType * 32.0;\n\n    int styleId = int(aStyleId + 0.5);\n    float lineWidth = styleLine[styleId].x;\n    vTextureId = floor(styleTextureId[styleId] / 4.0);\n    float scaleMode = styleTextureId[styleId] - vTextureId * 4.0;\n    float avgScale = 1.0;\n    if (scaleMode > 2.5) {\n        avgScale = length(translationMatrix * vec3(1.0, 0.0, 0.0));\n    } else if (scaleMode > 1.5) {\n        avgScale = length(translationMatrix * vec3(0.0, 1.0, 0.0));\n    } else if (scaleMode > 0.5) {\n        vec2 avgDiag = (translationMatrix * vec3(1.0, 1.0, 0.0)).xy;\n        avgScale = sqrt(dot(avgDiag, avgDiag) * 0.5);\n    }\n    lineWidth *= 0.5 * avgScale;\n    float lineAlignment = 2.0 * styleLine[styleId].y - 1.0;\n    vTextureCoord = vec2(0.0);\n\n    vec2 pos;\n\n    if (capType == CAP_ROUND) {\n        vertexNum += 4.0;\n        type = JOINT_CAP_ROUND;\n        capType = 0.0;\n        lineAlignment = -lineAlignment;\n    }\n\n    vLine1 = vec4(0.0, 10.0, 1.0, 0.0);\n    vLine2 = vec4(0.0, 10.0, 1.0, 0.0);\n    vArc = vec4(0.0);\n    if (type == FILL) {\n        pos = pointA;\n        vType = 0.0;\n        vLine2 = vec4(-2.0, -2.0, -2.0, 0.0);\n        vec2 vTexturePixel;\n        vTexturePixel.x = dot(vec3(aPoint1, 1.0), styleMatrix[styleId * 2]);\n        vTexturePixel.y = dot(vec3(aPoint1, 1.0), styleMatrix[styleId * 2 + 1]);\n        vTextureCoord = vTexturePixel / samplerSize[int(vTextureId)];\n    } else if (type >= FILL_EXPAND && type < FILL_EXPAND + 7.5) {\n        // expand vertices\n        float flags = type - FILL_EXPAND;\n        float flag3 = floor(flags / 4.0);\n        float flag2 = floor((flags - flag3 * 4.0) / 2.0);\n        float flag1 = flags - flag3 * 4.0 - flag2 * 2.0;\n\n        vec2 prev = (translationMatrix * vec3(aPrev, 1.0)).xy;\n\n        if (vertexNum < 0.5) {\n            pos = prev;\n        } else if (vertexNum < 1.5) {\n            pos = pointA;\n        } else {\n            pos = pointB;\n        }\n        float len2 = length(aNext);\n        vec2 bisect = (translationMatrix * vec3(aNext, 0.0)).xy;\n        if (len2 > 0.01) {\n            bisect = normalize(bisect) * len2;\n        }\n\n        vec2 n1 = normalize(vec2(pointA.y - prev.y, -(pointA.x - prev.x)));\n        vec2 n2 = normalize(vec2(pointB.y - pointA.y, -(pointB.x - pointA.x)));\n        vec2 n3 = normalize(vec2(prev.y - pointB.y, -(prev.x - pointB.x)));\n\n        if (n1.x * n2.y - n1.y * n2.x < 0.0) {\n            n1 = -n1;\n            n2 = -n2;\n            n3 = -n3;\n        }\n        pos += bisect * expand;\n\n        vLine1 = vec4(16.0, 16.0, 16.0, -1.0);\n        if (flag1 > 0.5) {\n            vLine1.x = -dot(pos - prev, n1);\n        }\n        if (flag2 > 0.5) {\n            vLine1.y = -dot(pos - pointA, n2);\n        }\n        if (flag3 > 0.5) {\n            vLine1.z = -dot(pos - pointB, n3);\n        }\n        vLine1.xyz *= resolution;\n        vType = 2.0;\n    } else if (type >= BEVEL) {\n        float dy = lineWidth + expand;\n        float shift = lineWidth * lineAlignment;\n        float inner = 0.0;\n        if (vertexNum >= 1.5) {\n            dy = -dy;\n            inner = 1.0;\n        }\n\n        vec2 base, next, xBasis2, bisect;\n        float flag = 0.0;\n        float side2 = 1.0;\n        if (vertexNum < 0.5 || vertexNum > 2.5 && vertexNum < 3.5) {\n            next = (translationMatrix * vec3(aPrev, 1.0)).xy;\n            base = pointA;\n            flag = type - floor(type / 2.0) * 2.0;\n            side2 = -1.0;\n        } else {\n            next = (translationMatrix * vec3(aNext, 1.0)).xy;\n            base = pointB;\n            if (type >= MITER && type < MITER + 3.5) {\n                flag = step(MITER + 1.5, type);\n                // check miter limit here?\n            }\n        }\n        xBasis2 = next - base;\n        float len2 = length(xBasis2);\n        vec2 norm2 = vec2(xBasis2.y, -xBasis2.x) / len2;\n        float D = norm.x * norm2.y - norm.y * norm2.x;\n        if (D < 0.0) {\n            inner = 1.0 - inner;\n        }\n\n        norm2 *= side2;\n\n        float collinear = step(0.0, dot(norm, norm2));\n\n        vType = 0.0;\n        float dy2 = -1000.0;\n\n        if (abs(D) < 0.01 && collinear < 0.5) {\n            if (type >= ROUND && type < ROUND + 1.5) {\n                type = JOINT_CAP_ROUND;\n            }\n            //TODO: BUTT here too\n        }\n\n        vLine1 = vec4(0.0, lineWidth, max(abs(norm.x), abs(norm.y)), min(abs(norm.x), abs(norm.y)));\n        vLine2 = vec4(0.0, lineWidth, max(abs(norm2.x), abs(norm2.y)), min(abs(norm2.x), abs(norm2.y)));\n\n        if (vertexNum < 3.5) {\n            if (abs(D) < 0.01 && collinear < 0.5) {\n                pos = (shift + dy) * norm;\n            } else {\n                if (flag < 0.5 && inner < 0.5) {\n                    pos = (shift + dy) * norm;\n                } else {\n                    pos = doBisect(norm, len, norm2, len2, shift + dy, inner);\n                }\n            }\n            vLine2.y = -1000.0;\n            if (capType >= CAP_BUTT && capType < CAP_ROUND) {\n                float extra = step(CAP_SQUARE, capType) * lineWidth;\n                vec2 back = -forward;\n                if (vertexNum < 0.5 || vertexNum > 2.5) {\n                    pos += back * (expand + extra);\n                    dy2 = expand;\n                } else {\n                    dy2 = dot(pos + base - pointA, back) - extra;\n                }\n            }\n            if (type >= JOINT_CAP_BUTT && type < JOINT_CAP_SQUARE + 0.5) {\n                float extra = step(JOINT_CAP_SQUARE, type) * lineWidth;\n                if (vertexNum < 0.5 || vertexNum > 2.5) {\n                    vLine2.y = dot(pos + base - pointB, forward) - extra;\n                } else {\n                    pos += forward * (expand + extra);\n                    vLine2.y = expand;\n                    if (capType >= CAP_BUTT) {\n                        dy2 -= expand + extra;\n                    }\n                }\n            }\n        } else if (type >= JOINT_CAP_ROUND && type < JOINT_CAP_ROUND + 1.5) {\n            base += shift * norm;\n            if (inner > 0.5) {\n                dy = -dy;\n                inner = 0.0;\n            }\n            vec2 d2 = abs(dy) * forward;\n            if (vertexNum < 4.5) {\n                dy = -dy;\n                pos = dy * norm;\n            } else if (vertexNum < 5.5) {\n                pos = dy * norm;\n            } else if (vertexNum < 6.5) {\n                pos = dy * norm + d2;\n                vArc.x = abs(dy);\n            } else {\n                dy = -dy;\n                pos = dy * norm + d2;\n                vArc.x = abs(dy);\n            }\n            vLine2 = vec4(0.0, lineWidth * 2.0 + 10.0, 1.0  , 0.0); // forget about line2 with type=3\n            vArc.y = dy;\n            vArc.z = 0.0;\n            vArc.w = lineWidth;\n            vType = 3.0;\n        } else if (abs(D) < 0.01 && collinear < 0.5) {\n            pos = dy * norm;\n        } else {\n            if (inner > 0.5) {\n                dy = -dy;\n                inner = 0.0;\n            }\n            float side = sign(dy);\n            vec2 norm3 = normalize(norm + norm2);\n\n            if (type >= MITER && type < MITER + 3.5) {\n                vec2 farVertex = doBisect(norm, len, norm2, len2, shift + dy, 0.0);\n                if (length(farVertex) > abs(shift + dy) * MITER_LIMIT) {\n                    type = BEVEL;\n                }\n            }\n\n            if (vertexNum < 4.5) {\n                pos = doBisect(norm, len, norm2, len2, shift - dy, 1.0);\n            } else if (vertexNum < 5.5) {\n                pos = (shift + dy) * norm;\n            } else if (vertexNum > 7.5) {\n                pos = (shift + dy) * norm2;\n            } else {\n                if (type >= ROUND && type < ROUND + 1.5) {\n                    pos = doBisect(norm, len, norm2, len2, shift + dy, 0.0);\n                    float d2 = abs(shift + dy);\n                    if (length(pos) > abs(shift + dy) * 1.5) {\n                        if (vertexNum < 6.5) {\n                            pos.x = (shift + dy) * norm.x - d2 * norm.y;\n                            pos.y = (shift + dy) * norm.y + d2 * norm.x;\n                        } else {\n                            pos.x = (shift + dy) * norm2.x + d2 * norm2.y;\n                            pos.y = (shift + dy) * norm2.y - d2 * norm2.x;\n                        }\n                    }\n                } else if (type >= MITER && type < MITER + 3.5) {\n                    pos = doBisect(norm, len, norm2, len2, shift + dy, 0.0); //farVertex\n                } else if (type >= BEVEL && type < BEVEL + 1.5) {\n                    float d2 = side / resolution;\n                    if (vertexNum < 6.5) {\n                        pos = (shift + dy) * norm + d2 * norm3;\n                    } else {\n                        pos = (shift + dy) * norm2 + d2 * norm3;\n                    }\n                }\n            }\n\n            if (type >= ROUND && type < ROUND + 1.5) {\n                vArc.x = side * dot(pos, norm3);\n                vArc.y = pos.x * norm3.y - pos.y * norm3.x;\n                vArc.z = dot(norm, norm3) * (lineWidth + side * shift);\n                vArc.w = lineWidth + side * shift;\n                vType = 3.0;\n            } else if (type >= MITER && type < MITER + 3.5) {\n                vType = 1.0;\n            } else if (type >= BEVEL && type < BEVEL + 1.5) {\n                vType = 4.0;\n                vArc.z = dot(norm, norm3) * (lineWidth + side * shift) - side * dot(pos, norm3);\n            }\n\n            dy = side * (dot(pos, norm) - shift);\n            dy2 = side * (dot(pos, norm2) - shift);\n        }\n\n        pos += base;\n        vLine1.xy = vec2(dy, vLine1.y) * resolution;\n        vLine2.xy = vec2(dy2, vLine2.y) * resolution;\n        vArc = vArc * resolution;\n        vTravel = vec2(aTravel * avgScale + dot(pos - pointA, vec2(-norm.y, norm.x)), avgScale);\n    }\n\n    gl_Position = vec4((projectionMatrix * vec3(pos, 1.0)).xy, 0.0, 1.0);\n\n    vColor = aColor * tint;\n}",r="%PRECISION%\nvarying vec4 vColor;\nvarying vec4 vLine1;\nvarying vec4 vLine2;\nvarying vec4 vArc;\nvarying float vType;\nvarying float vTextureId;\nvarying vec2 vTextureCoord;\nvarying vec2 vTravel;\nuniform sampler2D uSamplers[%MAX_TEXTURES%];\n\n%PIXEL_LINE%\n\nvoid main(void){\n    %PIXEL_COVERAGE%\n\n    vec4 texColor;\n    float textureId = floor(vTextureId+0.5);\n    %FOR_LOOP%\n\n    gl_FragColor = vColor * texColor * alpha;\n}\n",i={}){const{maxStyles:n,maxTextures:o,pixelLine:a}=t;super(e=e.replace(/%MAX_TEXTURES%/gi,`${o}`).replace(/%MAX_STYLES%/gi,`${n}`),r=r.replace(/%PRECISION%/gi,"#version 100\n#ifdef GL_FRAGMENT_PRECISION_HIGH\n  precision highp float;\n#else\n  precision mediump float;\n#endif\n").replace(/%PIXEL_LINE%/gi,R[a]).replace(/%PIXEL_COVERAGE%/gi,"float alpha = 1.0;\nif (vType < 0.5) {\n    float left = pixelLine(-vLine1.y - vLine1.x, vLine1.z, vLine1.w);\n    float right = pixelLine(vLine1.y - vLine1.x, vLine1.z, vLine1.w);\n    float near = vLine2.x - 0.5;\n    float far = min(vLine2.x + 0.5, 0.0);\n    float top = vLine2.y - 0.5;\n    float bottom = min(vLine2.y + 0.5, 0.0);\n    alpha = (right - left) * max(bottom - top, 0.0) * max(far - near, 0.0);\n} else if (vType < 1.5) {\n    float a1 = pixelLine(- vLine1.y - vLine1.x, vLine1.z, vLine1.w);\n    float a2 = pixelLine(vLine1.y - vLine1.x, vLine1.z, vLine1.w);\n    float b1 = pixelLine(- vLine2.y - vLine2.x, vLine2.z, vLine2.w);\n    float b2 = pixelLine(vLine2.y - vLine2.x, vLine2.z, vLine2.w);\n    alpha = a2 * b2 - a1 * b1;\n} else if (vType < 2.5) {\n    alpha *= max(min(vLine1.x + 0.5, 1.0), 0.0);\n    alpha *= max(min(vLine1.y + 0.5, 1.0), 0.0);\n    alpha *= max(min(vLine1.z + 0.5, 1.0), 0.0);\n} else if (vType < 3.5) {\n    float a1 = pixelLine(- vLine1.y - vLine1.x, vLine1.z, vLine1.w);\n    float a2 = pixelLine(vLine1.y - vLine1.x, vLine1.z, vLine1.w);\n    float b1 = pixelLine(- vLine2.y - vLine2.x, vLine2.z, vLine2.w);\n    float b2 = pixelLine(vLine2.y - vLine2.x, vLine2.z, vLine2.w);\n    float alpha_miter = a2 * b2 - a1 * b1;\n    float alpha_plane = clamp(vArc.z - vArc.x + 0.5, 0.0, 1.0);\n    float d = length(vArc.xy);\n    float circle_hor = max(min(vArc.w, d + 0.5) - max(-vArc.w, d - 0.5), 0.0);\n    float circle_vert = min(vArc.w * 2.0, 1.0);\n    float alpha_circle = circle_hor * circle_vert;\n    alpha = min(alpha_miter, max(alpha_circle, alpha_plane));\n} else {\n    float a1 = pixelLine(- vLine1.y - vLine1.x, vLine1.z, vLine1.w);\n    float a2 = pixelLine(vLine1.y - vLine1.x, vLine1.z, vLine1.w);\n    float b1 = pixelLine(- vLine2.y - vLine2.x, vLine2.z, vLine2.w);\n    float b2 = pixelLine(vLine2.y - vLine2.x, vLine2.z, vLine2.w);\n    alpha = a2 * b2 - a1 * b1;\n    alpha *= clamp(vArc.z + 0.5, 0.0, 1.0);\n}\n").replace(/%MAX_TEXTURES%/gi,`${o}`).replace(/%FOR_LOOP%/gi,D.generateSampleSrc(o))),this.settings=t}}class D extends r.Shader{constructor(t,e=new O(t),r={}){const{maxStyles:i,maxTextures:n}=t,o=new Int32Array(n);for(let t=0;t<n;t++)o[t]=t;super(e,Object.assign(r,{styleMatrix:new Float32Array(6*i),styleTextureId:new Float32Array(i),styleLine:new Float32Array(2*i),samplerSize:new Float32Array(2*n),uSamplers:o,tint:new Float32Array([1,1,1,1]),resolution:1,expand:1})),this.settings=t}static generateSampleSrc(t){let e="";e+="\n",e+="\n";for(let r=0;r<t;r++)r>0&&(e+="\nelse "),r<t-1&&(e+=`if(textureId < ${r}.5)`),e+="\n{",e+=`\n\ttexColor = texture2D(uSamplers[${r}], vTextureCoord);`,e+="\n}";return e+="\n",e+="\n",e}}const B={LINE_SCALE_MODE:t.LINE_SCALE_MODE.NORMAL,SHADER_MAX_STYLES:24,SHADER_MAX_TEXTURES:4,PIXEL_LINE:0},N=n.Graphics,{BezierUtils:k,QuadraticUtils:F,ArcUtils:L}=n.graphicsUtils,V=new Float32Array(3),X={};class j extends a.Container{static get nextRoundedRectBehavior(){return N.nextRoundedRectBehavior}static set nextRoundedRectBehavior(t){N.nextRoundedRectBehavior=t}static __initStatic(){this._TEMP_POINT=new e.Point}get geometry(){return this._geometry}constructor(t=null){super(),this._geometry=t||new C,this._geometry.refCount++,this.shader=null,this.shaderSettings={maxStyles:B.SHADER_MAX_STYLES,maxTextures:B.SHADER_MAX_TEXTURES,pixelLine:B.PIXEL_LINE},this.state=r.State.for2d(),this._fillStyle=new c,this._lineStyle=new p,this._matrix=null,this._holeMode=!1,this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this.pluginName="smooth",this._transformID=-1,this.tint=16777215,this.blendMode=i.BLEND_MODES.NORMAL}clone(){return this.finishPoly(),new j(this._geometry)}set blendMode(t){this.state.blendMode=t}get blendMode(){return this.state.blendMode}get tint(){return this._tint}set tint(t){this._tint=t}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(e=null,r=0,i=1,n=.5,o=B.LINE_SCALE_MODE){if("number"==typeof e)"boolean"==typeof o&&(o=o?t.LINE_SCALE_MODE.NONE:t.LINE_SCALE_MODE.NORMAL),e={width:e,color:r,alpha:i,alignment:n,scaleMode:o};else{const r=e.native;void 0!==r&&(e.scaleMode=r?t.LINE_SCALE_MODE.NONE:t.LINE_SCALE_MODE.NORMAL)}return this.lineTextureStyle(e)}lineTextureStyle(t){t=Object.assign({width:0,texture:r.Texture.WHITE,color:t&&t.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1,cap:n.LINE_CAP.BUTT,join:n.LINE_JOIN.MITER,miterLimit:10,shader:null,scaleMode:B.LINE_SCALE_MODE},t),this.currentPath&&this.startPoly();const e=t.width>0&&t.alpha>0;return e?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._lineStyle,{visible:e},t)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const t=this.currentPath.points,r=this.currentPath.points.length;r>2&&(this.drawShape(this.currentPath),this.currentPath=new e.Polygon,this.currentPath.closeStroke=!1,this.currentPath.points.push(t[r-2],t[r-1]))}else this.currentPath=new e.Polygon,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(t,e){return this.startPoly(),this.currentPath.points[0]=t,this.currentPath.points[1]=e,this}lineTo(t,e){this.currentPath||this.moveTo(0,0);const r=this.currentPath.points,i=r[r.length-2],n=r[r.length-1];return i===t&&n===e||r.push(t,e),this}_initCurve(t=0,e=0){this.currentPath?0===this.currentPath.points.length&&(this.currentPath.points=[t,e]):this.moveTo(t,e)}quadraticCurveTo(t,e,r,i){this._initCurve();const n=this.currentPath.points;return 0===n.length&&this.moveTo(0,0),F.curveTo(t,e,r,i,n),this}bezierCurveTo(t,e,r,i,n,o){return this._initCurve(),k.curveTo(t,e,r,i,n,o,this.currentPath.points),this}arcTo(t,e,r,i,n){this._initCurve(t,e);const o=this.currentPath.points,a=L.curveTo(t,e,r,i,n,o);if(a){const{cx:t,cy:e,radius:r,startAngle:i,endAngle:n,anticlockwise:o}=a;this.arc(t,e,r,i,n,o)}return this}arc(t,r,i,n,o,a=!1){if(n===o)return this;if(!a&&o<=n?o+=e.PI_2:a&&n<=o&&(n+=e.PI_2),0==o-n)return this;const s=t+Math.cos(n)*i,h=r+Math.sin(n)*i,l=this._geometry.closePointEps;let u=this.currentPath?this.currentPath.points:null;if(u){const t=Math.abs(u[u.length-2]-s),e=Math.abs(u[u.length-1]-h);t<l&&e<l||u.push(s,h)}else this.moveTo(s,h),u=this.currentPath.points;return L.arc(s,h,t,r,i,n,o,a,u),this}beginFill(t=0,e=1,i=!1){return this.beginTextureFill({texture:r.Texture.WHITE,color:t,alpha:e,smooth:i})}beginTextureFill(t){t=Object.assign({texture:r.Texture.WHITE,color:16777215,alpha:1,matrix:null,smooth:!1},t),this.currentPath&&this.startPoly();const e=t.alpha>0;return e?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._fillStyle,{visible:e},t)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(t,r,i,n){return this.drawShape(new e.Rectangle(t,r,i,n))}drawRoundedRect(t,r,i,n,o){return this.drawShape(new e.RoundedRectangle(t,r,i,n,o))}drawCircle(t,r,i){return this.drawShape(new e.Circle(t,r,i))}drawEllipse(t,r,i,n){return this.drawShape(new e.Ellipse(t,r,i,n))}drawPolygon(...t){let r,i=!0;const n=t[0];n.points?(i=n.closeStroke,r=n.points):r=Array.isArray(t[0])?t[0]:t;const o=new e.Polygon(r);return o.closeStroke=i,this.drawShape(o),this}drawShape(t){return this._holeMode?this._geometry.drawHole(t,this._matrix):this._geometry.drawShape(t,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const t=this._geometry.graphicsData;return!(1!==t.length||t[0].shape.type!==e.SHAPES.RECT||t[0].matrix||t[0].holes.length||t[0].lineStyle.visible&&t[0].lineStyle.width)}_renderCanvas(t){N.prototype._renderCanvas.call(this,t)}_render(t){this.finishPoly();const e=this._geometry,r=t.context.supports.uint32Indices;e.checkInstancing(t.geometry.hasInstance,r),e.updateBatches(this.shaderSettings),e.batchable?(this.batchDirty!==e.batchDirty&&this._populateBatches(),this._renderBatched(t)):(t.batch.flush(),this._renderDirect(t))}_populateBatches(){const t=this._geometry,e=this.blendMode,r=t.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=t.batchDirty,this.batches.length=r,this.vertexData=new Float32Array(t.points);for(let i=0;i<r;i++){const r=t.batches[i],n=r.style.color,a={vertexData:new Float32Array(this.vertexData.buffer,4*r.attribStart*2,2*r.attribSize),blendMode:e,_batchRGB:o.hex2rgb(n),_tintRGB:n,_texture:r.style.texture,alpha:r.style.alpha,worldAlpha:1};this.batches[i]=a}}_renderBatched(t){if(this.batches.length){t.batch.setObjectRenderer(t.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let e=0,r=this.batches.length;e<r;e++){const r=this.batches[e];r.worldAlpha=this.worldAlpha*r.alpha,t.plugins[this.pluginName].render(r)}}}_renderDirect(t){const e=this._resolveDirectShader(t);let r=e;const n=this._geometry,o=this.tint,a=this.worldAlpha,s=r.uniforms,h=n.drawCalls;s.translationMatrix=this.transform.worldTransform,s.tint[0]=(o>>16&255)/255*a,s.tint[1]=(o>>8&255)/255*a,s.tint[2]=(255&o)/255*a,s.tint[3]=a,s.resolution=t.renderTexture.current?t.renderTexture.current.resolution:t.resolution;const l=t.projection.transform;if(l){const t=Math.sqrt(l.a*l.a+l.b*l.b);s.resolution*=t}s.expand=(t.options.antialias?2:1)/s.resolution,t.shader.bind(r),t.geometry.bind(n,r),t.state.set(this.state),r=null;for(let o=0,a=h.length;o<a;o++){const a=n.drawCalls[o],h=r!==a.shader;h&&(r=a.shader,r&&(r.uniforms.translationMatrix=this.transform.worldTransform,r.uniforms.tint&&(r.uniforms.tint[0]=s.tint[0],r.uniforms.tint[1]=s.tint[1],r.uniforms.tint[2]=s.tint[2],r.uniforms.tint[3]=s.tint[3])));const{texArray:l,styleArray:u,size:c,start:p}=a,d=l.count,f=r||e,m=f.uniforms.styleTextureId,v=f.uniforms.styleMatrix,y=f.uniforms.styleLine;for(let t=0;t<u.count;t++){m[t]=u.textureIds[t],y[2*t]=u.lines[2*t],y[2*t+1]=u.lines[2*t+1];const e=u.matrices[t];v[6*t]=e.a,v[6*t+1]=e.c,v[6*t+2]=e.tx,v[6*t+3]=e.b,v[6*t+4]=e.d,v[6*t+5]=e.ty}const g=f.uniforms.samplerSize;for(let t=0;t<d;t++)g[2*t]=l.elements[t].width,g[2*t+1]=l.elements[t].height;t.shader.bind(f),h&&t.geometry.bind(n);for(let e=0;e<d;e++)t.texture.bind(l.elements[e],e);t.geometry.draw(i.DRAW_MODES.TRIANGLES,c,p)}}_resolveDirectShader(t){let e=this.shader;const r=this.pluginName;return e||(X[r]||(X[r]=new D(this.shaderSettings)),e=X[r]),e}_calculateBounds(){this.finishPoly();const t=this._geometry;if(!t.graphicsData.length)return;const{minX:e,minY:r,maxX:i,maxY:n}=t.bounds;this._bounds.addFrame(this.transform,e,r,i,n)}containsPoint(t){return this.worldTransform.applyInverse(t,j._TEMP_POINT),this._geometry.containsPoint(j._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this.tint;const t=o.hex2rgb(this.tint,V);for(let e=0;e<this.batches.length;e++){const r=this.batches[e],i=r._batchRGB,n=(t[0]*i[0]*255<<16)+(t[1]*i[1]*255<<8)+(0|t[2]*i[2]*255);r._tintRGB=(n>>16)+(65280&n)+((255&n)<<16)}}}calculateVertices(){const t=this.transform._worldID;if(this._transformID===t)return;this._transformID=t;const e=this.transform.worldTransform,r=e.a,i=e.b,n=e.c,o=e.d,a=e.tx,s=e.ty,h=this._geometry.points,l=this.vertexData;let u=0;for(let t=0;t<h.length;t+=2){const e=h[t],c=h[t+1];l[u++]=r*e+n*c+a,l[u++]=o*c+i*e+s}}closePath(){const t=this.currentPath;return t&&(t.closeStroke=!0),this}setMatrix(t){return this._matrix=t,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(t){this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(t)}}j.__initStatic(),t.BATCH_POOL=A,t.BatchDrawCall=l,t.BatchPart=u,t.BatchStyleArray=h,t.BuildData=d,t.CircleBuilder=y,t.DRAW_CALL_POOL=I,t.DashLineShader=class extends D{constructor(t){const e={maxStyles:16,maxTextures:1,pixelLine:1};super(e,new O(e,void 0,"%PRECISION%\nvarying vec4 vColor;\nvarying vec4 vLine1;\nvarying vec4 vLine2;\nvarying vec4 vArc;\nvarying float vType;\nvarying float vTextureId;\nvarying vec2 vTextureCoord;\nvarying vec2 vTravel;\nuniform sampler2D uSamplers[%MAX_TEXTURES%];\nuniform float dash;\nuniform float gap;\n\n%PIXEL_LINE%\n\nvoid main(void){\n    %PIXEL_COVERAGE%\n\n    float d = dash * vTravel.y;\n    if (d > 0.0) {\n        float g = gap * vTravel.y;\n        if (g > 0.0) {\n            float t = mod(vTravel.x, d + g);\n            alpha *= mix(\n                min(0.5 * d + 0.5 - abs(t - 0.5 * d), 1.0),\n                max(abs(t - 0.5 * g - d) - 0.5 * g + 0.5, 0.0),\n                step(d, t)\n            );\n        }\n    } else {\n        alpha = 0.0;\n    }\n\n    vec4 texColor;\n    float textureId = floor(vTextureId+0.5);\n    %FOR_LOOP%\n\n    gl_FragColor = vColor * texColor * alpha;\n}\n"),t||{dash:8,gap:5})}},t.FILL_COMMANDS=S,t.FillStyle=c,t.LineStyle=p,t.PolyBuilder=x,t.RectangleBuilder=b,t.RoundedRectangleBuilder=E,t.SegmentPacker=f,t.SmoothGraphics=j,t.SmoothGraphicsData=v,t.SmoothGraphicsGeometry=C,t.SmoothGraphicsProgram=O,t.SmoothGraphicsShader=D,t.matrixEquals=s,t.settings=B,Object.defineProperty(t,"__esModule",{value:!0})})),"undefined"!=typeof _pixi_graphics_smooth&&Object.assign(this.PIXI.smooth,_pixi_graphics_smooth),function(t){!function(t){t.getIntersectionFactor=function(t,e,r,i,n){var o=e.x-t.x,a=r.x-i.x,s=r.x-t.x,h=e.y-t.y,l=r.y-i.y,u=r.y-t.y,c=o*l-h*a;if(Math.abs(c)<1e-7)return n.x=o,n.y=h,0;var p=(s*l-u*a)/c,d=(o*u-h*s)/c;return d<1e-6||d-1>-1e-6?-1:(n.x=t.x+p*(e.x-t.x),n.y=t.y+p*(e.y-t.y),1)},t.getPositionFromQuad=function(t,e,r){r=r||new PIXI.Point;var i=1-e.x,n=1-i,o=1-e.y,a=1-o;return r.x=(t[0].x*i+t[1].x*n)*o+(t[3].x*i+t[2].x*n)*a,r.y=(t[0].y*i+t[1].y*n)*o+(t[3].y*i+t[2].y*n)*a,r}}(t.utils||(t.utils={}))}(pixi_projection||(pixi_projection={})),PIXI.projection=pixi_projection,function(t){var e=function(){function t(t,e){void 0===e&&(e=!0),this._enabled=!1,this.legacy=t,e&&(this.enabled=!0),this.legacy.proj=this}return Object.defineProperty(t.prototype,"enabled",{get:function(){return this._enabled},set:function(t){this._enabled=t},enumerable:!0,configurable:!0}),t.prototype.clear=function(){},t}();t.AbstractProjection=e,function(t){t[t.NONE=0]="NONE",t[t.BEFORE_PROJ=4]="BEFORE_PROJ",t[t.PROJ=5]="PROJ",t[t.ALL=9]="ALL"}(t.TRANSFORM_STEP||(t.TRANSFORM_STEP={}))}(pixi_projection||(pixi_projection={}));var pixi_projection,_gsScope;__extends=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();!function(t){function e(t){var e=this.proj,r=this,i=t._worldID,n=r.localTransform,o=e.scaleAfterAffine&&e.affine>=2;r._localID!==r._currentLocalID&&(o?(n.a=r._cx,n.b=r._sx,n.c=r._cy,n.d=r._sy,n.tx=r.position._x,n.ty=r.position._y):(n.a=r._cx*r.scale._x,n.b=r._sx*r.scale._x,n.c=r._cy*r.scale._y,n.d=r._sy*r.scale._y,n.tx=r.position._x-(r.pivot._x*n.a+r.pivot._y*n.c),n.ty=r.position._y-(r.pivot._x*n.b+r.pivot._y*n.d)),r._currentLocalID=r._localID,e._currentProjID=-1);var a=e._projID;if(e._currentProjID!==a&&(e._currentProjID=a,e.updateLocalTransform(n),r._parentID=-1),r._parentID!==i){var s=t.proj;s&&!s._affine?e.world.setToMult(s.world,e.local):e.world.setToMultLegacy(t.worldTransform,e.local);var h=r.worldTransform;e.world.copyTo(h,e._affine,e.affinePreserveOrientation),o&&(h.a*=r.scale._x,h.b*=r.scale._x,h.c*=r.scale._y,h.d*=r.scale._y,h.tx-=r.pivot._x*h.a+r.pivot._y*h.c,h.ty-=r.pivot._x*h.b+r.pivot._y*h.d),r._parentID=i,r._worldID++}}var r=function(r){function i(){var e=null!==r&&r.apply(this,arguments)||this;return e._projID=0,e._currentProjID=-1,e._affine=t.AFFINE.NONE,e.affinePreserveOrientation=!1,e.scaleAfterAffine=!0,e}return __extends(i,r),i.prototype.updateLocalTransform=function(t){},Object.defineProperty(i.prototype,"affine",{get:function(){return this._affine},set:function(t){this._affine!=t&&(this._affine=t,this._currentProjID=-1,this.legacy._currentLocalID=-1)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"enabled",{set:function(t){t!==this._enabled&&(this._enabled=t,t?(this.legacy.updateTransform=e,this.legacy._parentID=-1):(this.legacy.updateTransform=PIXI.Transform.prototype.updateTransform,this.legacy._parentID=-1))},enumerable:!0,configurable:!0}),i.prototype.clear=function(){this._currentProjID=-1,this._projID=0},i}(t.AbstractProjection);t.LinearProjection=r}(pixi_projection||(pixi_projection={})),function(t){var e=PIXI.TYPES,r=PIXI.utils.premultiplyTint,i=function(t){function r(r){void 0===r&&(r=!1);var i=t.call(this)||this;return i._buffer=new PIXI.Buffer(null,r,!1),i._indexBuffer=new PIXI.Buffer(null,r,!0),i.addAttribute("aVertexPosition",i._buffer,3,!1,e.FLOAT).addAttribute("aTextureCoord",i._buffer,2,!1,e.FLOAT).addAttribute("aColor",i._buffer,4,!0,e.UNSIGNED_BYTE).addAttribute("aTextureId",i._buffer,1,!0,e.FLOAT).addIndex(i._indexBuffer),i}return __extends(r,t),r}(PIXI.Geometry);t.Batch3dGeometry=i;var n=function(){function t(){}return t.create=function(t){var e=Object.assign({vertex:"precision highp float;\nattribute vec3 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n\tgl_Position.xyw = projectionMatrix * aVertexPosition;\n\tgl_Position.z = 0.0;\n\n\tvTextureCoord = aTextureCoord;\n\tvTextureId = aTextureId;\n\tvColor = aColor;\n}\n",fragment:"\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\nvec4 color;\n%forloop%\ngl_FragColor = color * vColor;\n}",geometryClass:i,vertexSize:7},t),n=e.vertex,o=e.fragment,a=e.vertexSize,s=e.geometryClass;return function(t){function e(e){var r=t.call(this,e)||this;return r.shaderGenerator=new PIXI.BatchShaderGenerator(n,o),r.geometryClass=s,r.vertexSize=a,r}return __extends(e,t),e.prototype.packInterleavedGeometry=function(t,e,i,n,o){var a=e.uint32View,s=e.float32View,h=n/this.vertexSize,l=t.uvs,u=t.indices,c=t.vertexData,p=t.vertexData2d,d=t._texture.baseTexture._batchLocation,f=Math.min(t.worldAlpha,1),m=f<1&&t._texture.baseTexture.alphaMode?r(t._tintRGB,f):t._tintRGB+(255*f<<24);if(p)for(var v=0,y=0;y<p.length;y+=3,v+=2)s[n++]=p[y],s[n++]=p[y+1],s[n++]=p[y+2],s[n++]=l[v],s[n++]=l[v+1],a[n++]=m,s[n++]=d;else for(y=0;y<c.length;y+=2)s[n++]=c[y],s[n++]=c[y+1],s[n++]=1,s[n++]=l[y],s[n++]=l[y+1],a[n++]=m,s[n++]=d;for(y=0;y<u.length;y++)i[o++]=h+u[y]},e}(PIXI.AbstractBatchRenderer)},t}();t.Batch2dPluginFactory=n,PIXI.Renderer.registerPlugin("batch2d",n.create({}))}(pixi_projection||(pixi_projection={})),function(t){var e=PIXI.AbstractBatchRenderer,r=PIXI.utils.premultiplyBlendMode,i=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.forceMaxTextures=0,e.defUniforms={},e}return __extends(i,t),i.prototype.getUniforms=function(t){return this.defUniforms},i.prototype.syncUniforms=function(t){if(t){var e=this._shader;for(var r in t)e.uniforms[r]=t[r]}},i.prototype.buildDrawCalls=function(t,i,n){var o=this._bufferedElements,a=this._attributeBuffer,s=this._indexBuffer,h=this.vertexSize,l=e._drawCallPool,u=this._dcIndex,c=this._aIndex,p=this._iIndex,d=l[u];d.start=this._iIndex,d.texArray=t;for(var f=i;f<n;++f){var m=o[f],v=m._texture.baseTexture,y=r[v.alphaMode?1:0][m.blendMode],g=this.getUniforms(m);o[f]=null,i<f&&(d.blend!==y||d.uniforms!==g)&&(d.size=p-d.start,i=f,(d=l[++u]).texArray=t,d.start=p),this.packInterleavedGeometry(m,a,s,c,p),c+=m.vertexData.length/2*h,p+=m.indices.length,d.blend=y,d.uniforms=g}i<n&&(d.size=p-d.start,++u),this._dcIndex=u,this._aIndex=c,this._iIndex=p},i.prototype.drawBatches=function(){for(var t=this._dcIndex,r=this.renderer,i=r.gl,n=r.state,o=r.shader,a=e._drawCallPool,s=null,h=null,l=0;l<t;l++){var u=a[l],c=u.texArray,p=u.type,d=u.size,f=u.start,m=u.blend,v=u.uniforms;h!==c&&(h=c,this.bindAndClearTexArray(c)),s!==v&&(s=v,this.syncUniforms(v),o.syncUniformGroup(this._shader.uniformGroup)),this.state.blendMode=m,n.set(this.state),i.drawElements(p,d,i.UNSIGNED_SHORT,2*f)}},i.prototype.contextChange=function(){if(!this.forceMaxTextures)return t.prototype.contextChange.call(this),void this.syncUniforms(this.defUniforms);this.renderer.gl;this.MAX_TEXTURES=this.forceMaxTextures,this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES),this.syncUniforms(this.defUniforms);for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()},i}(e);t.UniformBatchRenderer=i}(pixi_projection||(pixi_projection={})),function(t){var e=[new PIXI.Point,new PIXI.Point,new PIXI.Point,new PIXI.Point],r=[0,0,0,0],i=function(){function t(){this.surfaceID="default",this._updateID=0,this.vertexSrc="",this.fragmentSrc=""}return t.prototype.fillUniforms=function(t){},t.prototype.clear=function(){},t.prototype.boundsQuad=function(t,i,n){for(var o=i[0],a=i[1],s=i[0],h=i[1],l=2;l<8;l+=2)o>i[l]&&(o=i[l]),s<i[l]&&(s=i[l]),a>i[l+1]&&(a=i[l+1]),h<i[l+1]&&(h=i[l+1]);if(e[0].set(o,a),this.apply(e[0],e[0]),e[1].set(s,a),this.apply(e[1],e[1]),e[2].set(s,h),this.apply(e[2],e[2]),e[3].set(o,h),this.apply(e[3],e[3]),n)n.apply(e[0],e[0]),n.apply(e[1],e[1]),n.apply(e[2],e[2]),n.apply(e[3],e[3]),i[0]=e[0].x,i[1]=e[0].y,i[2]=e[1].x,i[3]=e[1].y,i[4]=e[2].x,i[5]=e[2].y,i[6]=e[3].x,i[7]=e[3].y;else{for(l=1;l<=3;l++)if(e[l].y<e[0].y||e[l].y==e[0].y&&e[l].x<e[0].x){var u=e[0];e[0]=e[l],e[l]=u}for(l=1;l<=3;l++)r[l]=Math.atan2(e[l].y-e[0].y,e[l].x-e[0].x);for(l=1;l<=3;l++)for(var c=l+1;c<=3;c++)if(r[l]>r[c]){u=e[l];e[l]=e[c],e[c]=u;var p=r[l];r[l]=r[c],r[c]=p}if(i[0]=e[0].x,i[1]=e[0].y,i[2]=e[1].x,i[3]=e[1].y,i[4]=e[2].x,i[5]=e[2].y,i[6]=e[3].x,i[7]=e[3].y,(e[3].x-e[2].x)*(e[1].y-e[2].y)-(e[1].x-e[2].x)*(e[3].y-e[2].y)<0)return i[4]=e[3].x,void(i[5]=e[3].y)}},t}();t.Surface=i}(pixi_projection||(pixi_projection={})),function(t){var e=new PIXI.Matrix,r=new PIXI.Rectangle,i=new PIXI.Point,n=function(t){function n(){var e=t.call(this)||this;return e.distortion=new PIXI.Point,e}return __extends(n,t),n.prototype.clear=function(){this.distortion.set(0,0)},n.prototype.apply=function(t,e){e=e||new PIXI.Point;var r=this.distortion,i=t.x*t.y;return e.x=t.x+r.x*i,e.y=t.y+r.y*i,e},n.prototype.applyInverse=function(t,e){e=e||new PIXI.Point;var r=t.x,i=t.y,n=this.distortion.x,o=this.distortion.y;if(0==n)e.x=r,e.y=i/(1+o*r);else if(0==o)e.y=i,e.x=r/(1+n*i);else{var a=.5*(i*n-r*o+1)/o,s=a*a+r/o;if(s<=1e-5)return e.set(NaN,NaN),e;e.x=o>0?-a+Math.sqrt(s):-a-Math.sqrt(s),e.y=(r/e.x-1)/n}return e},n.prototype.mapSprite=function(t,e,i){var n=t.texture;return r.x=-t.anchor.x*n.orig.width,r.y=-t.anchor.y*n.orig.height,r.width=n.orig.width,r.height=n.orig.height,this.mapQuad(r,e,i||t.transform)},n.prototype.mapQuad=function(t,r,n){var o=-t.x/t.width,a=-t.y/t.height,s=(1-t.x)/t.width,h=(1-t.y)/t.height,l=r[0].x*(1-o)+r[1].x*o,u=r[0].y*(1-o)+r[1].y*o,c=r[0].x*(1-s)+r[1].x*s,p=r[0].y*(1-s)+r[1].y*s,d=r[3].x*(1-o)+r[2].x*o,f=r[3].y*(1-o)+r[2].y*o,m=r[3].x*(1-s)+r[2].x*s,v=r[3].y*(1-s)+r[2].y*s,y=l*(1-a)+d*a,g=u*(1-a)+f*a,_=c*(1-a)+m*a,x=p*(1-a)+v*a,b=l*(1-h)+d*h,w=u*(1-h)+f*h,T=c*(1-h)+m*h,E=p*(1-h)+v*h,S=e;return S.tx=y,S.ty=g,S.a=_-y,S.b=x-g,S.c=b-y,S.d=w-g,i.set(T,E),S.applyInverse(i,i),this.distortion.set(i.x-1,i.y-1),n.setFromMatrix(S),this},n.prototype.fillUniforms=function(t){t.distortion=t.distortion||new Float32Array([0,0,0,0]);var e=Math.abs(this.distortion.x),r=Math.abs(this.distortion.y);t.distortion[0]=1e4*e<=r?0:this.distortion.x,t.distortion[1]=1e4*r<=e?0:this.distortion.y,t.distortion[2]=1/t.distortion[0],t.distortion[3]=1/t.distortion[1]},n}(t.Surface);t.BilinearSurface=n}(pixi_projection||(pixi_projection={})),function(t){var e=function(e){function r(){var r=e.call(this)||this;return r.proj=new t.ProjectionSurface(r.transform),r}return __extends(r,e),Object.defineProperty(r.prototype,"worldTransform",{get:function(){return this.proj},enumerable:!0,configurable:!0}),r}(PIXI.Container);t.Container2s=e}(pixi_projection||(pixi_projection={})),function(t){var e=PIXI.Transform.prototype.updateTransform;function r(t){var r=this.proj,i=t.proj;return i?i._surface?(r._activeProjection=i,this.updateLocalTransform(),this.localTransform.copyTo(this.worldTransform),void(this._parentID<0&&++this._worldID)):(e.call(this,t),void(r._activeProjection=i._activeProjection)):(e.call(this,t),void(r._activeProjection=null))}var i=function(e){function i(t,r){var i=e.call(this,t,r)||this;return i._surface=null,i._activeProjection=null,i._currentSurfaceID=-1,i._currentLegacyID=-1,i._lastUniforms=null,i}return __extends(i,e),Object.defineProperty(i.prototype,"enabled",{set:function(t){t!==this._enabled&&(this._enabled=t,t?(this.legacy.updateTransform=r,this.legacy._parentID=-1):(this.legacy.updateTransform=PIXI.Transform.prototype.updateTransform,this.legacy._parentID=-1))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"surface",{get:function(){return this._surface},set:function(t){this._surface!=t&&(this._surface=t||null,this.legacy._parentID=-1)},enumerable:!0,configurable:!0}),i.prototype.applyPartial=function(t,e){return null!==this._activeProjection?(e=this.legacy.worldTransform.apply(t,e),this._activeProjection.surface.apply(e,e)):null!==this._surface?this.surface.apply(t,e):this.legacy.worldTransform.apply(t,e)},i.prototype.apply=function(t,e){return null!==this._activeProjection?(e=this.legacy.worldTransform.apply(t,e),this._activeProjection.surface.apply(e,e),this._activeProjection.legacy.worldTransform.apply(e,e)):null!==this._surface?(e=this.surface.apply(t,e),this.legacy.worldTransform.apply(e,e)):this.legacy.worldTransform.apply(t,e)},i.prototype.applyInverse=function(t,e){return null!==this._activeProjection?(e=this._activeProjection.legacy.worldTransform.applyInverse(t,e),this._activeProjection._surface.applyInverse(e,e),this.legacy.worldTransform.applyInverse(e,e)):null!==this._surface?(e=this.legacy.worldTransform.applyInverse(t,e),this._surface.applyInverse(e,e)):this.legacy.worldTransform.applyInverse(t,e)},i.prototype.mapBilinearSprite=function(e,r){this._surface instanceof t.BilinearSurface||(this.surface=new t.BilinearSurface),this.surface.mapSprite(e,r,this.legacy)},i.prototype.clear=function(){this.surface&&this.surface.clear()},Object.defineProperty(i.prototype,"uniforms",{get:function(){return this._currentLegacyID===this.legacy._worldID&&this._currentSurfaceID===this.surface._updateID||(this._lastUniforms=this._lastUniforms||{},this._lastUniforms.translationMatrix=this.legacy.worldTransform,this._surface.fillUniforms(this._lastUniforms)),this._lastUniforms},enumerable:!0,configurable:!0}),i}(t.AbstractProjection);t.ProjectionSurface=i}(pixi_projection||(pixi_projection={})),function(t){var e=PIXI.TYPES,r=PIXI.utils.premultiplyTint,i=function(t){function r(r){void 0===r&&(r=!1);var i=t.call(this)||this;return i._buffer=new PIXI.Buffer(null,r,!1),i._indexBuffer=new PIXI.Buffer(null,r,!0),i.addAttribute("aVertexPosition",i._buffer,2,!1,e.FLOAT).addAttribute("aTrans1",i._buffer,3,!1,e.FLOAT).addAttribute("aTrans2",i._buffer,3,!1,e.FLOAT).addAttribute("aSamplerSize",i._buffer,2,!1,e.FLOAT).addAttribute("aFrame",i._buffer,4,!1,e.FLOAT).addAttribute("aColor",i._buffer,4,!0,e.UNSIGNED_BYTE).addAttribute("aTextureId",i._buffer,1,!0,e.FLOAT).addIndex(i._indexBuffer),i}return __extends(r,t),r}(PIXI.Geometry);t.BatchBilineardGeometry=i;var n=function(){function e(){}return e.create=function(e){var n=Object.assign({vertex:"precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec3 aTrans1;\nattribute vec3 aTrans2;\nattribute vec2 aSamplerSize;\nattribute vec4 aFrame;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\n\nvarying vec2 vertexPosition;\nvarying vec3 vTrans1;\nvarying vec3 vTrans2;\nvarying vec2 vSamplerSize;\nvarying vec4 vFrame;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n\tgl_Position.xyw = projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0);\n\tgl_Position.z = 0.0;\n\n\tvertexPosition = aVertexPosition;\n\tvTrans1 = aTrans1;\n\tvTrans2 = aTrans2;\n\tvTextureId = aTextureId;\n\tvColor = aColor;\n\tvSamplerSize = aSamplerSize;\n\tvFrame = aFrame;\n}\n",fragment:"precision highp float;\nvarying vec2 vertexPosition;\nvarying vec3 vTrans1;\nvarying vec3 vTrans2;\nvarying vec2 vSamplerSize;\nvarying vec4 vFrame;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nuniform sampler2D uSamplers[%count%];\nuniform vec4 distortion;\n\nvoid main(void){\nvec2 surface;\nvec2 surface2;\n\nfloat vx = vertexPosition.x;\nfloat vy = vertexPosition.y;\nfloat dx = distortion.x;\nfloat dy = distortion.y;\nfloat revx = distortion.z;\nfloat revy = distortion.w;\n\nif (distortion.x == 0.0) {\n\tsurface.x = vx;\n\tsurface.y = vy / (1.0 + dy * vx);\n\tsurface2 = surface;\n} else\nif (distortion.y == 0.0) {\n\tsurface.y = vy;\n\tsurface.x = vx / (1.0 + dx * vy);\n\tsurface2 = surface;\n} else {\n\tfloat c = vy * dx - vx * dy;\n\tfloat b = (c + 1.0) * 0.5;\n\tfloat b2 = (-c + 1.0) * 0.5;\n\tfloat d = b * b + vx * dy;\n\tif (d < -0.00001) {\n\t    discard;\n\t}\n\td = sqrt(max(d, 0.0));\n\tsurface.x = (- b + d) * revy;\n\tsurface2.x = (- b - d) * revy;\n\tsurface.y = (- b2 + d) * revx;\n\tsurface2.y = (- b2 - d) * revx;\n}\n\nvec2 uv;\nuv.x = vTrans1.x * surface.x + vTrans1.y * surface.y + vTrans1.z;\nuv.y = vTrans2.x * surface.x + vTrans2.y * surface.y + vTrans2.z;\n\nvec2 pixels = uv * vSamplerSize;\n\nif (pixels.x < vFrame.x || pixels.x > vFrame.z ||\n\tpixels.y < vFrame.y || pixels.y > vFrame.w) {\n\tuv.x = vTrans1.x * surface2.x + vTrans1.y * surface2.y + vTrans1.z;\n\tuv.y = vTrans2.x * surface2.x + vTrans2.y * surface2.y + vTrans2.z;\n\tpixels = uv * vSamplerSize;\n\n   if (pixels.x < vFrame.x || pixels.x > vFrame.z ||\n       pixels.y < vFrame.y || pixels.y > vFrame.w) {\n       discard;\n   }\n}\n\nvec4 edge;\nedge.xy = clamp(pixels - vFrame.xy + 0.5, vec2(0.0, 0.0), vec2(1.0, 1.0));\nedge.zw = clamp(vFrame.zw - pixels + 0.5, vec2(0.0, 0.0), vec2(1.0, 1.0));\n\nfloat alpha = 1.0; //edge.x * edge.y * edge.z * edge.w;\nvec4 rColor = vColor * alpha;\n\nfloat textureId = floor(vTextureId+0.5);\nvec2 vTextureCoord = uv;\nvec4 color;\n%forloop%\ngl_FragColor = color * rColor;\n}",geometryClass:i,vertexSize:16},e),o=n.vertex,a=n.fragment,s=n.vertexSize,h=n.geometryClass;return function(t){function e(e){var r=t.call(this,e)||this;return r.defUniforms={translationMatrix:new PIXI.Matrix,distortion:new Float32Array([0,0,1/0,1/0])},r.size=1e3,r.forceMaxTextures=1,r.shaderGenerator=new PIXI.BatchShaderGenerator(o,a),r.geometryClass=h,r.vertexSize=s,r}return __extends(e,t),e.prototype.getUniforms=function(t){var e=t.proj;return null!==e.surface?e.uniforms:null!==e._activeProjection?e._activeProjection.uniforms:this.defUniforms},e.prototype.packInterleavedGeometry=function(t,e,i,n,o){for(var a=e.uint32View,s=e.float32View,h=n/this.vertexSize,l=t.indices,u=t.vertexData,c=t._texture._frame,p=t.aTrans,d=t._texture.baseTexture,f=d._batchLocation,m=d.realWidth,v=d.realHeight,y=d.resolution,g=Math.min(t.worldAlpha,1),_=g<1&&t._texture.baseTexture.alphaMode?r(t._tintRGB,g):t._tintRGB+(255*g<<24),x=0;x<u.length;x+=2)s[n]=u[x],s[n+1]=u[x+1],s[n+2]=p.a,s[n+3]=p.c,s[n+4]=p.tx,s[n+5]=p.b,s[n+6]=p.d,s[n+7]=p.ty,s[n+8]=m,s[n+9]=v,s[n+10]=c.x*y,s[n+11]=c.y*y,s[n+12]=(c.x+c.width)*y,s[n+13]=(c.y+c.height)*y,a[n+14]=_,s[n+15]=f,n+=16;for(x=0;x<l.length;x++)i[o++]=h+l[x]},e}(t.UniformBatchRenderer)},e}();t.BatchBilinearPluginFactory=n,PIXI.Renderer.registerPlugin("batch_bilinear",n.create({}))}(pixi_projection||(pixi_projection={})),function(t){var e=function(e){function r(r){var i=e.call(this,r)||this;return i.aTrans=new PIXI.Matrix,i.proj=new t.ProjectionSurface(i.transform),i.pluginName="batch_bilinear",i}return __extends(r,e),r.prototype._calculateBounds=function(){this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData)},r.prototype.calculateVertices=function(){var t=this.transform._worldID,e=this._texture._updateID;if(this._transformID!==t||this._textureID!==e){this._transformID=t,this._textureID=e;var r=this._texture,i=this.vertexData,n=r.trim,o=r.orig,a=this._anchor,s=0,h=0,l=0,u=0;if(n?(s=(h=n.x-a._x*o.width)+n.width,l=(u=n.y-a._y*o.height)+n.height):(s=(h=-a._x*o.width)+o.width,l=(u=-a._y*o.height)+o.height),this.proj._surface)i[0]=h,i[1]=u,i[2]=s,i[3]=u,i[4]=s,i[5]=l,i[6]=h,i[7]=l,this.proj._surface.boundsQuad(i,i);else{var c=this.transform.worldTransform,p=c.a,d=c.b,f=c.c,m=c.d,v=c.tx,y=c.ty;i[0]=p*h+f*u+v,i[1]=m*u+d*h+y,i[2]=p*s+f*u+v,i[3]=m*u+d*s+y,i[4]=p*s+f*l+v,i[5]=m*l+d*s+y,i[6]=p*h+f*l+v,i[7]=m*l+d*h+y,this.proj._activeProjection&&this.proj._activeProjection.surface.boundsQuad(i,i)}r.uvMatrix||(r.uvMatrix=new PIXI.TextureMatrix(r)),r.uvMatrix.update();var g=this.aTrans;g.set(o.width,0,0,o.height,h,u),null===this.proj._surface&&g.prepend(this.transform.worldTransform),g.invert(),g.prepend(r.uvMatrix.mapCoord)}},r.prototype.calculateTrimmedVertices=function(){var t=this.transform._worldID,e=this._texture._updateID;if(this.vertexTrimmedData){if(this._transformTrimmedID===t&&this._textureTrimmedID===e)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=t,this._textureTrimmedID=e;var r=this._texture,i=this.vertexTrimmedData,n=r.orig,o=this._anchor,a=-o._x*n.width,s=a+n.width,h=-o._y*n.height,l=h+n.height;if(this.proj._surface)i[0]=a,i[1]=h,i[2]=s,i[3]=h,i[4]=s,i[5]=l,i[6]=a,i[7]=l,this.proj._surface.boundsQuad(i,i,this.transform.worldTransform);else{var u=this.transform.worldTransform,c=u.a,p=u.b,d=u.c,f=u.d,m=u.tx,v=u.ty;i[0]=c*a+d*h+m,i[1]=f*h+p*a+v,i[2]=c*s+d*h+m,i[3]=f*h+p*s+v,i[4]=c*s+d*l+m,i[5]=f*l+p*s+v,i[6]=c*a+d*l+m,i[7]=f*l+p*a+v,this.proj._activeProjection&&this.proj._activeProjection.surface.boundsQuad(i,i,this.proj._activeProjection.legacy.worldTransform)}},Object.defineProperty(r.prototype,"worldTransform",{get:function(){return this.proj},enumerable:!0,configurable:!0}),r}(PIXI.Sprite);t.Sprite2s=e}(pixi_projection||(pixi_projection={})),function(t){var e=function(e){function r(r,i,n){var o=e.call(this,r,i,n)||this;return o.aTrans=new PIXI.Matrix,o.proj=new t.ProjectionSurface(o.transform),o.pluginName="batch_bilinear",o}return __extends(r,e),Object.defineProperty(r.prototype,"worldTransform",{get:function(){return this.proj},enumerable:!0,configurable:!0}),r}(PIXI.Text);t.Text2s=e,e.prototype.calculateVertices=t.Sprite2s.prototype.calculateVertices,e.prototype.calculateTrimmedVertices=t.Sprite2s.prototype.calculateTrimmedVertices,e.prototype._calculateBounds=t.Sprite2s.prototype._calculateBounds}(pixi_projection||(pixi_projection={})),function(t){PIXI.Sprite.prototype.convertTo2s=function(){this.proj||(this.pluginName="sprite_bilinear",this.aTrans=new PIXI.Matrix,this.calculateVertices=t.Sprite2s.prototype.calculateVertices,this.calculateTrimmedVertices=t.Sprite2s.prototype.calculateTrimmedVertices,this._calculateBounds=t.Sprite2s.prototype._calculateBounds,PIXI.Container.prototype.convertTo2s.call(this))},PIXI.Container.prototype.convertTo2s=function(){this.proj||(this.proj=new t.Projection2d(this.transform),Object.defineProperty(this,"worldTransform",{get:function(){return this.proj},enumerable:!0,configurable:!0}))},PIXI.Container.prototype.convertSubtreeTo2s=function(){this.convertTo2s();for(var t=0;t<this.children.length;t++)this.children[t].convertSubtreeTo2s()}}(pixi_projection||(pixi_projection={})),function(t){t.container2dWorldTransform=function(){return this.proj.affine?this.transform.worldTransform:this.proj.world};var e=function(e){function r(){var r=e.call(this)||this;return r.proj=new t.Projection2d(r.transform),r}return __extends(r,e),r.prototype.toLocal=function(e,r,i,n,o){return void 0===o&&(o=t.TRANSFORM_STEP.ALL),r&&(e=r.toGlobal(e,i,n)),n||this._recursivePostUpdateTransform(),o>=t.TRANSFORM_STEP.PROJ?(n||this.displayObjectUpdateTransform(),this.proj.affine?this.transform.worldTransform.applyInverse(e,i):this.proj.world.applyInverse(e,i)):(this.parent?i=this.parent.worldTransform.applyInverse(e,i):i.copyFrom(e),o===t.TRANSFORM_STEP.NONE?i:this.transform.localTransform.applyInverse(i,i))},Object.defineProperty(r.prototype,"worldTransform",{get:function(){return this.proj.affine?this.transform.worldTransform:this.proj.world},enumerable:!0,configurable:!0}),r}(PIXI.Container);t.Container2d=e,t.container2dToLocal=e.prototype.toLocal}(pixi_projection||(pixi_projection={})),function(t){var e,r=PIXI.Point,i=[1,0,0,0,1,0,0,0,1];!function(t){t[t.NONE=0]="NONE",t[t.FREE=1]="FREE",t[t.AXIS_X=2]="AXIS_X",t[t.AXIS_Y=3]="AXIS_Y",t[t.POINT=4]="POINT",t[t.AXIS_XR=5]="AXIS_XR"}(e=t.AFFINE||(t.AFFINE={}));var n=function(){function t(t){this.floatArray=null,this.mat3=new Float64Array(t||i)}return Object.defineProperty(t.prototype,"a",{get:function(){return this.mat3[0]/this.mat3[8]},set:function(t){this.mat3[0]=t*this.mat3[8]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"b",{get:function(){return this.mat3[1]/this.mat3[8]},set:function(t){this.mat3[1]=t*this.mat3[8]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"c",{get:function(){return this.mat3[3]/this.mat3[8]},set:function(t){this.mat3[3]=t*this.mat3[8]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"d",{get:function(){return this.mat3[4]/this.mat3[8]},set:function(t){this.mat3[4]=t*this.mat3[8]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tx",{get:function(){return this.mat3[6]/this.mat3[8]},set:function(t){this.mat3[6]=t*this.mat3[8]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ty",{get:function(){return this.mat3[7]/this.mat3[8]},set:function(t){this.mat3[7]=t*this.mat3[8]},enumerable:!0,configurable:!0}),t.prototype.set=function(t,e,r,i,n,o){var a=this.mat3;return a[0]=t,a[1]=e,a[2]=0,a[3]=r,a[4]=i,a[5]=0,a[6]=n,a[7]=o,a[8]=1,this},t.prototype.toArray=function(t,e){this.floatArray||(this.floatArray=new Float32Array(9));var r=e||this.floatArray,i=this.mat3;return t?(r[0]=i[0],r[1]=i[1],r[2]=i[2],r[3]=i[3],r[4]=i[4],r[5]=i[5],r[6]=i[6],r[7]=i[7],r[8]=i[8]):(r[0]=i[0],r[1]=i[3],r[2]=i[6],r[3]=i[1],r[4]=i[4],r[5]=i[7],r[6]=i[2],r[7]=i[5],r[8]=i[8]),r},t.prototype.apply=function(t,e){e=e||new PIXI.Point;var r=this.mat3,i=t.x,n=t.y,o=1/(r[2]*i+r[5]*n+r[8]);return e.x=o*(r[0]*i+r[3]*n+r[6]),e.y=o*(r[1]*i+r[4]*n+r[7]),e},t.prototype.translate=function(t,e){var r=this.mat3;return r[0]+=t*r[2],r[1]+=e*r[2],r[3]+=t*r[5],r[4]+=e*r[5],r[6]+=t*r[8],r[7]+=e*r[8],this},t.prototype.scale=function(t,e){var r=this.mat3;return r[0]*=t,r[1]*=e,r[3]*=t,r[4]*=e,r[6]*=t,r[7]*=e,this},t.prototype.scaleAndTranslate=function(t,e,r,i){var n=this.mat3;n[0]=t*n[0]+r*n[2],n[1]=e*n[1]+i*n[2],n[3]=t*n[3]+r*n[5],n[4]=e*n[4]+i*n[5],n[6]=t*n[6]+r*n[8],n[7]=e*n[7]+i*n[8]},t.prototype.applyInverse=function(t,e){e=e||new r;var i=this.mat3,n=t.x,o=t.y,a=i[0],s=i[3],h=i[6],l=i[1],u=i[4],c=i[7],p=i[2],d=i[5],f=i[8],m=(f*u-c*d)*n+(-f*s+h*d)*o+(c*s-h*u),v=(-f*l+c*p)*n+(f*a-h*p)*o+(-c*a+h*l),y=(d*l-u*p)*n+(-d*a+s*p)*o+(u*a-s*l);return e.x=m/y,e.y=v/y,e},t.prototype.invert=function(){var t=this.mat3,e=t[0],r=t[1],i=t[2],n=t[3],o=t[4],a=t[5],s=t[6],h=t[7],l=t[8],u=l*o-a*h,c=-l*n+a*s,p=h*n-o*s,d=e*u+r*c+i*p;return d?(d=1/d,t[0]=u*d,t[1]=(-l*r+i*h)*d,t[2]=(a*r-i*o)*d,t[3]=c*d,t[4]=(l*e-i*s)*d,t[5]=(-a*e+i*n)*d,t[6]=p*d,t[7]=(-h*e+r*s)*d,t[8]=(o*e-r*n)*d,this):this},t.prototype.identity=function(){var t=this.mat3;return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,this},t.prototype.clone=function(){return new t(this.mat3)},t.prototype.copyTo2dOr3d=function(t){var e=this.mat3,r=t.mat3;return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],t},t.prototype.copyTo=function(t,r,i){var n=this.mat3,o=1/n[8],a=n[6]*o,s=n[7]*o;if(t.a=(n[0]-n[2]*a)*o,t.b=(n[1]-n[2]*s)*o,t.c=(n[3]-n[5]*a)*o,t.d=(n[4]-n[5]*s)*o,t.tx=a,t.ty=s,r>=2){var h=t.a*t.d-t.b*t.c;i||(h=Math.abs(h)),r===e.POINT?(h=h>0?1:-1,t.a=h,t.b=0,t.c=0,t.d=h):r===e.AXIS_X?(h/=Math.sqrt(t.b*t.b+t.d*t.d),t.c=0,t.d=h):r===e.AXIS_Y?(h/=Math.sqrt(t.a*t.a+t.c*t.c),t.a=h,t.c=0):r===e.AXIS_XR&&(t.a=t.d*h,t.c=-t.b*h)}return t},t.prototype.copyFrom=function(t){var e=this.mat3;return e[0]=t.a,e[1]=t.b,e[2]=0,e[3]=t.c,e[4]=t.d,e[5]=0,e[6]=t.tx,e[7]=t.ty,e[8]=1,this},t.prototype.setToMultLegacy=function(t,e){var r=this.mat3,i=e.mat3,n=t.a,o=t.b,a=t.c,s=t.d,h=t.tx,l=t.ty,u=i[0],c=i[1],p=i[2],d=i[3],f=i[4],m=i[5],v=i[6],y=i[7],g=i[8];return r[0]=u*n+c*a+p*h,r[1]=u*o+c*s+p*l,r[2]=p,r[3]=d*n+f*a+m*h,r[4]=d*o+f*s+m*l,r[5]=m,r[6]=v*n+y*a+g*h,r[7]=v*o+y*s+g*l,r[8]=g,this},t.prototype.setToMultLegacy2=function(t,e){var r=this.mat3,i=t.mat3,n=i[0],o=i[1],a=i[2],s=i[3],h=i[4],l=i[5],u=i[6],c=i[7],p=i[8],d=e.a,f=e.b,m=e.c,v=e.d,y=e.tx,g=e.ty;return r[0]=d*n+f*s,r[1]=d*o+f*h,r[2]=d*a+f*l,r[3]=m*n+v*s,r[4]=m*o+v*h,r[5]=m*a+v*l,r[6]=y*n+g*s+u,r[7]=y*o+g*h+c,r[8]=y*a+g*l+p,this},t.prototype.setToMult=function(t,e){var r=this.mat3,i=t.mat3,n=e.mat3,o=i[0],a=i[1],s=i[2],h=i[3],l=i[4],u=i[5],c=i[6],p=i[7],d=i[8],f=n[0],m=n[1],v=n[2],y=n[3],g=n[4],_=n[5],x=n[6],b=n[7],w=n[8];return r[0]=f*o+m*h+v*c,r[1]=f*a+m*l+v*p,r[2]=f*s+m*u+v*d,r[3]=y*o+g*h+_*c,r[4]=y*a+g*l+_*p,r[5]=y*s+g*u+_*d,r[6]=x*o+b*h+w*c,r[7]=x*a+b*l+w*p,r[8]=x*s+b*u+w*d,this},t.prototype.prepend=function(t){return t.mat3?this.setToMult(t,this):this.setToMultLegacy(t,this)},t.IDENTITY=new t,t.TEMP_MATRIX=new t,t}();t.Matrix2d=n}(pixi_projection||(pixi_projection={})),function(t){var e=new PIXI.Point,r=[new PIXI.Point,new PIXI.Point,new PIXI.Point,new PIXI.Point],i=new PIXI.Rectangle,n=new t.Matrix2d,o=function(o){function a(e,r){var i=o.call(this,e,r)||this;return i.matrix=new t.Matrix2d,i.pivot=new PIXI.ObservablePoint(i.onChange,i,0,0),i.reverseLocalOrder=!1,i.local=new t.Matrix2d,i.world=new t.Matrix2d,i}return __extends(a,o),a.prototype.onChange=function(){var t=this.pivot,e=this.matrix.mat3;e[6]=-(t._x*e[0]+t._y*e[3]),e[7]=-(t._x*e[1]+t._y*e[4]),this._projID++},a.prototype.setAxisX=function(t,e){void 0===e&&(e=1);var r=t.x,i=t.y,n=Math.sqrt(r*r+i*i),o=this.matrix.mat3;o[0]=r/n,o[1]=i/n,o[2]=e/n,this.onChange()},a.prototype.setAxisY=function(t,e){void 0===e&&(e=1);var r=t.x,i=t.y,n=Math.sqrt(r*r+i*i),o=this.matrix.mat3;o[3]=r/n,o[4]=i/n,o[5]=e/n,this.onChange()},a.prototype.mapSprite=function(t,e){var r=t.texture;return i.x=-t.anchor.x*r.orig.width,i.y=-t.anchor.y*r.orig.height,i.width=r.orig.width,i.height=r.orig.height,this.mapQuad(i,e)},a.prototype.mapQuad=function(i,o){r[0].set(i.x,i.y),r[1].set(i.x+i.width,i.y),r[2].set(i.x+i.width,i.y+i.height),r[3].set(i.x,i.y+i.height);var a=1,s=2,h=3;if(0!==t.utils.getIntersectionFactor(o[0],o[2],o[1],o[3],e)){a=1,s=3,h=2;var l=Math.sqrt((o[0].x-e.x)*(o[0].x-e.x)+(o[0].y-e.y)*(o[0].y-e.y)),u=Math.sqrt((o[a].x-e.x)*(o[a].x-e.x)+(o[a].y-e.y)*(o[a].y-e.y)),c=Math.sqrt((o[s].x-e.x)*(o[s].x-e.x)+(o[s].y-e.y)*(o[s].y-e.y)),p=Math.sqrt((o[h].x-e.x)*(o[h].x-e.x)+(o[h].y-e.y)*(o[h].y-e.y)),d=(l+p)/p,f=(u+c)/c,m=(u+c)/u,v=this.matrix.mat3;v[0]=r[0].x*d,v[1]=r[0].y*d,v[2]=d,v[3]=r[a].x*f,v[4]=r[a].y*f,v[5]=f,v[6]=r[s].x*m,v[7]=r[s].y*m,v[8]=m,this.matrix.invert(),(v=n.mat3)[0]=o[0].x,v[1]=o[0].y,v[2]=1,v[3]=o[a].x,v[4]=o[a].y,v[5]=1,v[6]=o[s].x,v[7]=o[s].y,v[8]=1,this.matrix.setToMult(n,this.matrix),this._projID++}},a.prototype.updateLocalTransform=function(t){0!==this._projID?this.reverseLocalOrder?this.local.setToMultLegacy2(this.matrix,t):this.local.setToMultLegacy(t,this.matrix):this.local.copyFrom(t)},a.prototype.clear=function(){o.prototype.clear.call(this),this.matrix.identity(),this.pivot.set(0,0)},a}(t.LinearProjection);t.Projection2d=o}(pixi_projection||(pixi_projection={})),function(t){var e=function(e){function r(r,i,n,o){var a=e.call(this,r,i,n,o)||this;return a.vertexData2d=null,a.proj=new t.Projection2d(a.transform),a}return __extends(r,e),r.prototype.calculateVertices=function(){if(this.proj._affine)return this.vertexData2d=null,void e.prototype.calculateVertices.call(this);var t=this.geometry,r=t.buffers[0].data;if(t.vertexDirtyId!==this.vertexDirty||this._transformID!==this.transform._worldID){this._transformID=this.transform._worldID,this.vertexData.length!==r.length&&(this.vertexData=new Float32Array(r.length)),this.vertexData2d&&this.vertexData2d.length===3*r.length/2||(this.vertexData2d=new Float32Array(3*r.length));for(var i=this.proj.world.mat3,n=this.vertexData2d,o=this.vertexData,a=0;a<o.length/2;a++){var s=r[2*a],h=r[2*a+1],l=i[0]*s+i[3]*h+i[6],u=i[1]*s+i[4]*h+i[7],c=i[2]*s+i[5]*h+i[8];n[3*a]=l,n[3*a+1]=u,n[3*a+2]=c,o[2*a]=l/c,o[2*a+1]=u/c}this.vertexDirty=t.vertexDirtyId}},r.prototype._renderDefault=function(t){var e=this.shader;e.alpha=this.worldAlpha,e.update&&e.update(),t.batch.flush(),e.program.uniformData.translationMatrix&&(e.uniforms.translationMatrix=this.worldTransform.toArray(!0)),t.shader.bind(e,!1),t.state.set(this.state),t.geometry.bind(this.geometry,e),t.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)},r.prototype.toLocal=function(e,r,i,n,o){return void 0===o&&(o=t.TRANSFORM_STEP.ALL),t.container2dToLocal.call(this,e,r,i,n,o)},Object.defineProperty(r.prototype,"worldTransform",{get:function(){return this.proj.affine?this.transform.worldTransform:this.proj.world},enumerable:!0,configurable:!0}),r.defaultVertexShader="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTextureMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n\tgl_Position.xyw = projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0);\n\tgl_Position.z = 0.0;\n\n\tvTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\n}\n",r.defaultFragmentShader="\nvarying vec2 vTextureCoord;\nuniform vec4 uColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n\tgl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;\n}",r}(PIXI.Mesh);t.Mesh2d=e;var r=function(t){function r(r,i,n,o,a){var s=t.call(this,new PIXI.MeshGeometry(i,n,o),new PIXI.MeshMaterial(r,{program:PIXI.Program.from(e.defaultVertexShader,e.defaultFragmentShader),pluginName:"batch2d"}),null,a)||this;return s.autoUpdate=!0,s.geometry.getBuffer("aVertexPosition").static=!1,s}return __extends(r,t),Object.defineProperty(r.prototype,"vertices",{get:function(){return this.geometry.getBuffer("aVertexPosition").data},set:function(t){this.geometry.getBuffer("aVertexPosition").data=t},enumerable:!0,configurable:!0}),r.prototype._render=function(e){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),t.prototype._render.call(this,e)},r}(e);t.SimpleMesh2d=r}(pixi_projection||(pixi_projection={})),function(t){var e=function(e){function r(r){var i=e.call(this,r)||this;return i.vertexData2d=null,i.proj=new t.Projection2d(i.transform),i.pluginName="batch2d",i}return __extends(r,e),r.prototype._calculateBounds=function(){this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData)},r.prototype.calculateVertices=function(){var t=this._texture;if(this.proj._affine)return this.vertexData2d=null,void e.prototype.calculateVertices.call(this);this.vertexData2d||(this.vertexData2d=new Float32Array(12));var r=this.transform._worldID,i=t._updateID;if(this._transformID!==r||this._textureID!==i){this._textureID!==i&&(this.uvs=t._uvs.uvsFloat32),this._transformID=r,this._textureID=i;var n=this.proj.world.mat3,o=this.vertexData2d,a=this.vertexData,s=t.trim,h=t.orig,l=this._anchor,u=0,c=0,p=0,d=0;s?(u=(c=s.x-l._x*h.width)+s.width,p=(d=s.y-l._y*h.height)+s.height):(u=(c=-l._x*h.width)+h.width,p=(d=-l._y*h.height)+h.height),o[0]=n[0]*c+n[3]*d+n[6],o[1]=n[1]*c+n[4]*d+n[7],o[2]=n[2]*c+n[5]*d+n[8],o[3]=n[0]*u+n[3]*d+n[6],o[4]=n[1]*u+n[4]*d+n[7],o[5]=n[2]*u+n[5]*d+n[8],o[6]=n[0]*u+n[3]*p+n[6],o[7]=n[1]*u+n[4]*p+n[7],o[8]=n[2]*u+n[5]*p+n[8],o[9]=n[0]*c+n[3]*p+n[6],o[10]=n[1]*c+n[4]*p+n[7],o[11]=n[2]*c+n[5]*p+n[8],a[0]=o[0]/o[2],a[1]=o[1]/o[2],a[2]=o[3]/o[5],a[3]=o[4]/o[5],a[4]=o[6]/o[8],a[5]=o[7]/o[8],a[6]=o[9]/o[11],a[7]=o[10]/o[11]}},r.prototype.calculateTrimmedVertices=function(){if(this.proj._affine)e.prototype.calculateTrimmedVertices.call(this);else{var t=this.transform._worldID,r=this._texture._updateID;if(this.vertexTrimmedData){if(this._transformTrimmedID===t&&this._textureTrimmedID===r)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=t,this._textureTrimmedID=r;var i=this._texture,n=this.vertexTrimmedData,o=i.orig,a=this.tileProj?this._width:o.width,s=this.tileProj?this._height:o.height,h=this._anchor,l=this.proj.world.mat3,u=-h._x*a,c=u+a,p=-h._y*s,d=p+s,f=1/(l[2]*u+l[5]*p+l[8]);n[0]=f*(l[0]*u+l[3]*p+l[6]),n[1]=f*(l[1]*u+l[4]*p+l[7]),f=1/(l[2]*c+l[5]*p+l[8]),n[2]=f*(l[0]*c+l[3]*p+l[6]),n[3]=f*(l[1]*c+l[4]*p+l[7]),f=1/(l[2]*c+l[5]*d+l[8]),n[4]=f*(l[0]*c+l[3]*d+l[6]),n[5]=f*(l[1]*c+l[4]*d+l[7]),f=1/(l[2]*u+l[5]*d+l[8]),n[6]=f*(l[0]*u+l[3]*d+l[6]),n[7]=f*(l[1]*u+l[4]*d+l[7])}},r.prototype.toLocal=function(e,r,i,n,o){return void 0===o&&(o=t.TRANSFORM_STEP.ALL),t.container2dToLocal.call(this,e,r,i,n,o)},Object.defineProperty(r.prototype,"worldTransform",{get:function(){return this.proj.affine?this.transform.worldTransform:this.proj.world},enumerable:!0,configurable:!0}),r}(PIXI.Sprite);t.Sprite2d=e}(pixi_projection||(pixi_projection={})),function(t){var e=function(e){function r(r,i,n){var o=e.call(this,r,i,n)||this;return o.vertexData2d=null,o.proj=new t.Projection2d(o.transform),o.pluginName="batch2d",o}return __extends(r,e),Object.defineProperty(r.prototype,"worldTransform",{get:function(){return this.proj.affine?this.transform.worldTransform:this.proj.world},enumerable:!0,configurable:!0}),r}(PIXI.Text);t.Text2d=e,e.prototype.calculateVertices=t.Sprite2d.prototype.calculateVertices,e.prototype.calculateTrimmedVertices=t.Sprite2d.prototype.calculateTrimmedVertices,e.prototype._calculateBounds=t.Sprite2d.prototype._calculateBounds}(pixi_projection||(pixi_projection={})),function(t){function e(){this.proj||(this.proj=new t.Projection2d(this.transform),this.toLocal=t.Container2d.prototype.toLocal,Object.defineProperty(this,"worldTransform",{get:t.container2dWorldTransform,enumerable:!0,configurable:!0}))}PIXI.Container.prototype.convertTo2d=e,PIXI.Sprite.prototype.convertTo2d=function(){this.proj||(this.calculateVertices=t.Sprite2d.prototype.calculateVertices,this.calculateTrimmedVertices=t.Sprite2d.prototype.calculateTrimmedVertices,this._calculateBounds=t.Sprite2d.prototype._calculateBounds,this.pluginName="batch2d",e.call(this))},PIXI.Container.prototype.convertSubtreeTo2d=function(){this.convertTo2d();for(var t=0;t<this.children.length;t++)this.children[t].convertSubtreeTo2d()},PIXI.SimpleMesh&&(PIXI.SimpleMesh.prototype.convertTo2d=PIXI.SimpleRope.prototype.convertTo2d=function(){this.proj||(this.calculateVertices=t.Mesh2d.prototype.calculateVertices,this._renderDefault=t.Mesh2d.prototype._renderDefault,"batch2d"!==this.material.pluginName&&(this.material=new PIXI.MeshMaterial(this.material.texture,{program:PIXI.Program.from(t.Mesh2d.defaultVertexShader,t.Mesh2d.defaultFragmentShader),pluginName:"batch2d"})),e.call(this))}),PIXI.TilingSprite&&(PIXI.TilingSprite.prototype.convertTo2d=function(){this.proj||(this.tileProj=new t.Projection2d(this.tileTransform),this.tileProj.reverseLocalOrder=!0,this.uvRespectAnchor=!0,this.calculateTrimmedVertices=t.Sprite2d.prototype.calculateTrimmedVertices,this._calculateBounds=t.Sprite2d.prototype._calculateBounds,this._render=t.TilingSprite2d.prototype._render,this.pluginName="tilingSprite2d",e.call(this))})}(pixi_projection||(pixi_projection={})),function(t){var e=new PIXI.Transform,r=function(r){function i(e,i,n){var o=r.call(this,e,i,n)||this;return o.tileProj=new t.Projection2d(o.tileTransform),o.tileProj.reverseLocalOrder=!0,o.proj=new t.Projection2d(o.transform),o.pluginName="tilingSprite2d",o.uvRespectAnchor=!0,o}return __extends(i,r),Object.defineProperty(i.prototype,"worldTransform",{get:function(){return this.proj.affine?this.transform.worldTransform:this.proj.world},enumerable:!0,configurable:!0}),i.prototype.toLocal=function(e,r,i,n,o){return void 0===o&&(o=t.TRANSFORM_STEP.ALL),t.container2dToLocal.call(this,e,r,i,n,o)},i.prototype._render=function(t){var r=this._texture;r&&r.valid&&(this.tileTransform.updateTransform(e),this.uvMatrix.update(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this))},i}(PIXI.TilingSprite);t.TilingSprite2d=r}(pixi_projection||(pixi_projection={})),function(t){var e="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec3 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position.xyw = projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0);\n\n    vTextureCoord = uTransform * vec3(aTextureCoord, 1.0);\n}\n",r=new t.Matrix2d,i=PIXI.WRAP_MODES,n=PIXI.utils,o=function(t){function o(r){var i=t.call(this,r)||this;i.quad=new PIXI.QuadUv;var n={globals:i.renderer.globalUniforms};return i.shader=PIXI.Shader.from(e,"\nvarying vec3 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = mod(vTextureCoord.xy / vTextureCoord.z - uClampOffset, vec2(1.0, 1.0)) + uClampOffset;\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    vec4 sample = texture2D(uSampler, coord);\n    gl_FragColor = sample * uColor;\n}\n",n),i.simpleShader=PIXI.Shader.from(e,"\n\tvarying vec3 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\n\nvoid main(void)\n{\n    vec4 sample = texture2D(uSampler, vTextureCoord.xy / vTextureCoord.z);\n    gl_FragColor = sample * uColor;\n}\n",n),i}return __extends(o,t),o.prototype.render=function(t){var e=this.renderer,o=this.quad,a=o.vertices;a[0]=a[6]=t._width*-t.anchor.x,a[1]=a[3]=t._height*-t.anchor.y,a[2]=a[4]=t._width*(1-t.anchor.x),a[5]=a[7]=t._height*(1-t.anchor.y),t.uvRespectAnchor&&((a=o.uvs)[0]=a[6]=-t.anchor.x,a[1]=a[3]=-t.anchor.y,a[2]=a[4]=1-t.anchor.x,a[5]=a[7]=1-t.anchor.y),o.invalidate();var s=t._texture,h=s.baseTexture,l=t.tileProj.world,u=t.uvMatrix,c=h.isPowerOfTwo&&s.frame.width===h.width&&s.frame.height===h.height;c&&(h._glTextures[e.CONTEXT_UID]?c=h.wrapMode!==i.CLAMP:h.wrapMode===i.CLAMP&&(h.wrapMode=i.REPEAT));var p=c?this.simpleShader:this.shader;r.identity(),r.scale(s.width,s.height),r.prepend(l),r.scale(1/t._width,1/t._height),r.invert(),c?r.prepend(u.mapCoord):(p.uniforms.uMapCoord=u.mapCoord.toArray(!0),p.uniforms.uClampFrame=u.uClampFrame,p.uniforms.uClampOffset=u.uClampOffset),p.uniforms.uTransform=r.toArray(!0),p.uniforms.uColor=n.premultiplyTintToRgba(t.tint,t.worldAlpha,p.uniforms.uColor,h.premultiplyAlpha),p.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),p.uniforms.uSampler=s,e.shader.bind(p,!1),e.geometry.bind(o,void 0),e.state.setBlendMode(n.correctBlendMode(t.blendMode,h.premultiplyAlpha)),e.geometry.draw(PIXI.DRAW_MODES.TRIANGLES,6,0)},o}(PIXI.ObjectRenderer);t.TilingSprite2dRenderer=o,PIXI.Renderer.registerPlugin("tilingSprite2d",o)}(pixi_projection||(pixi_projection={})),function(t){PIXI.systems.MaskSystem.prototype.pushSpriteMask=function(e){var r=e.maskObject,i=e._target,n=this.alphaMaskPool[this.alphaMaskIndex];n||(n=this.alphaMaskPool[this.alphaMaskIndex]=[new t.SpriteMaskFilter2d(r)]),n[0].resolution=this.renderer.resolution,n[0].maskSprite=r;var o=i.filterArea;i.filterArea=r.getBounds(!0),this.renderer.filter.push(i,n),i.filterArea=o,this.alphaMaskIndex++}}(pixi_projection||(pixi_projection={})),function(t){var e=new t.Matrix2d,r=function(r){function i(e){var i=r.call(this,"\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec3 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n\tgl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n\tvTextureCoord = aTextureCoord;\n\tvMaskCoord = otherMatrix * vec3( aTextureCoord, 1.0);\n}\n","\nvarying vec3 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    vec2 uv = vMaskCoord.xy / vMaskCoord.z;\n\n    float clip = step(3.5,\n        step(maskClamp.x, uv.x) +\n        step(maskClamp.y, uv.y) +\n        step(uv.x, maskClamp.z) +\n        step(uv.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, uv);\n\n    original *= (masky.r * masky.a * alpha * clip);\n\n    gl_FragColor = original;\n}\n")||this;return i.maskMatrix=new t.Matrix2d,e.renderable=!1,i.maskSprite=e,i}return __extends(i,r),i.prototype.apply=function(t,e,r,n){var o=this.maskSprite,a=this.maskSprite.texture;a.valid&&(a.uvMatrix||(a.uvMatrix=new PIXI.TextureMatrix(a,0)),a.uvMatrix.update(),this.uniforms.npmAlpha=a.baseTexture.alphaMode?0:1,this.uniforms.mask=o.texture,this.uniforms.otherMatrix=i.calculateSpriteMatrix(e,this.maskMatrix,o).prepend(a.uvMatrix.mapCoord),this.uniforms.alpha=o.worldAlpha,this.uniforms.maskClamp=a.uvMatrix.uClampFrame,t.applyFilter(this,e,r,n))},i.calculateSpriteMatrix=function(t,r,i){var n=i.proj,o=t.filterFrame,a=n&&!n._affine?n.world.copyTo2dOr3d(e):e.copyFrom(i.transform.worldTransform),s=i.texture.orig;return r.set(t.width,0,0,t.height,o.x,o.y),a.invert(),r.setToMult(a,r),r.scaleAndTranslate(1/s.width,1/s.height,i.anchor.x,i.anchor.y),r},i}(PIXI.Filter);t.SpriteMaskFilter2d=r}(pixi_projection||(pixi_projection={})),function(t){t.container3dWorldTransform=function(){return this.proj.affine?this.transform.worldTransform:this.proj.world};var e=function(e){function r(){var r=e.call(this)||this;return r.proj=new t.Projection3d(r.transform),r}return __extends(r,e),r.prototype.isFrontFace=function(t){void 0===t&&(t=!1),t&&(this._recursivePostUpdateTransform(),this.displayObjectUpdateTransform());var e=this.proj.world.mat4,r=e[0]*e[15]-e[3]*e[12],i=e[1]*e[15]-e[3]*e[13],n=e[4]*e[15]-e[7]*e[12];return r*(e[5]*e[15]-e[7]*e[13])-n*i>0},r.prototype.getDepth=function(t){void 0===t&&(t=!1),t&&(this._recursivePostUpdateTransform(),this.displayObjectUpdateTransform());var e=this.proj.world.mat4;return e[14]/e[15]},r.prototype.toLocal=function(e,r,i,n,o){return void 0===o&&(o=t.TRANSFORM_STEP.ALL),r&&(e=r.toGlobal(e,i,n)),n||this._recursivePostUpdateTransform(),o===t.TRANSFORM_STEP.ALL?(n||this.displayObjectUpdateTransform(),this.proj.affine?this.transform.worldTransform.applyInverse(e,i):this.proj.world.applyInverse(e,i)):(this.parent?i=this.parent.worldTransform.applyInverse(e,i):i.copyFrom(e),o===t.TRANSFORM_STEP.NONE||(i=this.transform.localTransform.applyInverse(i,i),o===t.TRANSFORM_STEP.PROJ&&this.proj.cameraMode&&(i=this.proj.cameraMatrix.applyInverse(i,i))),i)},Object.defineProperty(r.prototype,"worldTransform",{get:function(){return this.proj.affine?this.transform.worldTransform:this.proj.world},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"position3d",{get:function(){return this.proj.position},set:function(t){this.proj.position.copyFrom(t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"scale3d",{get:function(){return this.proj.scale},set:function(t){this.proj.scale.copyFrom(t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"euler",{get:function(){return this.proj.euler},set:function(t){this.proj.euler.copyFrom(t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"pivot3d",{get:function(){return this.proj.pivot},set:function(t){this.proj.pivot.copyFrom(t)},enumerable:!0,configurable:!0}),r}(PIXI.Container);t.Container3d=e,t.container3dToLocal=e.prototype.toLocal,t.container3dGetDepth=e.prototype.getDepth,t.container3dIsFrontFace=e.prototype.isFrontFace}(pixi_projection||(pixi_projection={})),function(t){var e=function(t){function e(){var e=t.call(this)||this;return e._far=0,e._near=0,e._focus=0,e._orthographic=!1,e.proj.cameraMode=!0,e.setPlanes(400,10,1e4,!1),e}return __extends(e,t),Object.defineProperty(e.prototype,"far",{get:function(){return this._far},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"near",{get:function(){return this._near},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"focus",{get:function(){return this._focus},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ortographic",{get:function(){return this._orthographic},enumerable:!0,configurable:!0}),e.prototype.setPlanes=function(t,e,r,i){void 0===e&&(e=10),void 0===r&&(r=1e4),void 0===i&&(i=!1),this._focus=t,this._near=e,this._far=r,this._orthographic=i;var n=this.proj,o=n.cameraMatrix.mat4;n._projID++,o[10]=1/(r-e),o[14]=(t-e)/(r-e),this._orthographic?o[11]=0:o[11]=1/t},e}(t.Container3d);t.Camera3d=e}(pixi_projection||(pixi_projection={})),function(t){var e=function(){function t(t,e,r){this._quatUpdateId=-1,this._quatDirtyId=0,this._sign=1,this._x=t||0,this._y=e||0,this._z=r||0,this.quaternion=new Float64Array(4),this.quaternion[3]=1,this.update()}return Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this._quatDirtyId++)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this._quatDirtyId++)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"z",{get:function(){return this._z},set:function(t){this._z!==t&&(this._z=t,this._quatDirtyId++)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pitch",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this._quatDirtyId++)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"yaw",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this._quatDirtyId++)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"roll",{get:function(){return this._z},set:function(t){this._z!==t&&(this._z=t,this._quatDirtyId++)},enumerable:!0,configurable:!0}),t.prototype.set=function(t,e,r){var i=t||0,n=e||0,o=r||0;this._x===i&&this._y===n&&this._z===o||(this._x=i,this._y=n,this._z=o,this._quatDirtyId++)},t.prototype.copyFrom=function(t){var e=t.x,r=t.y,i=t.z;this._x===e&&this._y===r&&this._z===i||(this._x=e,this._y=r,this._z=i,this._quatDirtyId++)},t.prototype.copyTo=function(t){return t.set(this._x,this._y,this._z),t},t.prototype.equals=function(t){return this._x===t.x&&this._y===t.y&&this._z===t.z},t.prototype.clone=function(){return new t(this._x,this._y,this._z)},t.prototype.update=function(){if(this._quatUpdateId===this._quatDirtyId)return!1;this._quatUpdateId=this._quatDirtyId;var t=Math.cos(this._x/2),e=Math.cos(this._y/2),r=Math.cos(this._z/2),i=this._sign,n=i*Math.sin(this._x/2),o=i*Math.sin(this._y/2),a=i*Math.sin(this._z/2),s=this.quaternion;return s[0]=n*e*r+t*o*a,s[1]=t*o*r-n*e*a,s[2]=t*e*a+n*o*r,s[3]=t*e*r-n*o*a,!0},t}();t.Euler=e}(pixi_projection||(pixi_projection={})),function(t){var e=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],r=function(){function r(t){this.floatArray=null,this._dirtyId=0,this._updateId=-1,this._mat4inv=null,this.cacheInverse=!1,this.mat4=new Float64Array(t||e)}return Object.defineProperty(r.prototype,"a",{get:function(){return this.mat4[0]/this.mat4[15]},set:function(t){this.mat4[0]=t*this.mat4[15]},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"b",{get:function(){return this.mat4[1]/this.mat4[15]},set:function(t){this.mat4[1]=t*this.mat4[15]},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"c",{get:function(){return this.mat4[4]/this.mat4[15]},set:function(t){this.mat4[4]=t*this.mat4[15]},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"d",{get:function(){return this.mat4[5]/this.mat4[15]},set:function(t){this.mat4[5]=t*this.mat4[15]},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"tx",{get:function(){return this.mat4[12]/this.mat4[15]},set:function(t){this.mat4[12]=t*this.mat4[15]},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"ty",{get:function(){return this.mat4[13]/this.mat4[15]},set:function(t){this.mat4[13]=t*this.mat4[15]},enumerable:!0,configurable:!0}),r.prototype.set=function(t,e,r,i,n,o){var a=this.mat4;return a[0]=t,a[1]=e,a[2]=0,a[3]=0,a[4]=r,a[5]=i,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=n,a[13]=o,a[14]=0,a[15]=1,this},r.prototype.toArray=function(t,e){this.floatArray||(this.floatArray=new Float32Array(9));var r=e||this.floatArray,i=this.mat4;return t?(r[0]=i[0],r[1]=i[1],r[2]=i[3],r[3]=i[4],r[4]=i[5],r[5]=i[7],r[6]=i[12],r[7]=i[13],r[8]=i[15]):(r[0]=i[0],r[1]=i[4],r[2]=i[12],r[3]=i[2],r[4]=i[6],r[5]=i[13],r[6]=i[3],r[7]=i[7],r[8]=i[15]),r},r.prototype.setToTranslation=function(t,e,r){var i=this.mat4;i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=t,i[13]=e,i[14]=r,i[15]=1},r.prototype.setToRotationTranslationScale=function(t,e,r,i,n,o,a){var s=this.mat4,h=t[0],l=t[1],u=t[2],c=t[3],p=h+h,d=l+l,f=u+u,m=h*p,v=h*d,y=h*f,g=l*d,_=l*f,x=u*f,b=c*p,w=c*d,T=c*f;return s[0]=(1-(g+x))*n,s[1]=(v+T)*n,s[2]=(y-w)*n,s[3]=0,s[4]=(v-T)*o,s[5]=(1-(m+x))*o,s[6]=(_+b)*o,s[7]=0,s[8]=(y+w)*a,s[9]=(_-b)*a,s[10]=(1-(m+g))*a,s[11]=0,s[12]=e,s[13]=r,s[14]=i,s[15]=1,s},r.prototype.apply=function(e,r){r=r||new t.Point3d;var i=this.mat4,n=e.x,o=e.y,a=e.z||0,s=1/(i[3]*n+i[7]*o+i[11]*a+i[15]);return r.x=s*(i[0]*n+i[4]*o+i[8]*a+i[12]),r.y=s*(i[1]*n+i[5]*o+i[9]*a+i[13]),r.z=s*(i[2]*n+i[6]*o+i[10]*a+i[14]),r},r.prototype.translate=function(t,e,r){var i=this.mat4;return i[12]=i[0]*t+i[4]*e+i[8]*r+i[12],i[13]=i[1]*t+i[5]*e+i[9]*r+i[13],i[14]=i[2]*t+i[6]*e+i[10]*r+i[14],i[15]=i[3]*t+i[7]*e+i[11]*r+i[15],this},r.prototype.scale=function(t,e,r){var i=this.mat4;return i[0]*=t,i[1]*=t,i[2]*=t,i[3]*=t,i[4]*=e,i[5]*=e,i[6]*=e,i[7]*=e,void 0!==r&&(i[8]*=r,i[9]*=r,i[10]*=r,i[11]*=r),this},r.prototype.scaleAndTranslate=function(t,e,r,i,n,o){var a=this.mat4;a[0]=t*a[0]+i*a[3],a[1]=e*a[1]+n*a[3],a[2]=r*a[2]+o*a[3],a[4]=t*a[4]+i*a[7],a[5]=e*a[5]+n*a[7],a[6]=r*a[6]+o*a[7],a[8]=t*a[8]+i*a[11],a[9]=e*a[9]+n*a[11],a[10]=r*a[10]+o*a[11],a[12]=t*a[12]+i*a[15],a[13]=e*a[13]+n*a[15],a[14]=r*a[14]+o*a[15]},r.prototype.applyInverse=function(e,i){i=i||new t.Point3d,this._mat4inv||(this._mat4inv=new Float64Array(16));var n=this._mat4inv,o=this.mat4,a=e.x,s=e.y,h=e.z||0;this.cacheInverse&&this._updateId===this._dirtyId||(this._updateId=this._dirtyId,r.glMatrixMat4Invert(n,o));var l=1/(n[3]*a+n[7]*s+n[11]*h+n[15]),u=l*(n[0]*a+n[4]*s+n[8]*h+n[12]),c=l*(n[1]*a+n[5]*s+n[9]*h+n[13]),p=l*(n[2]*a+n[6]*s+n[10]*h+n[14]);h+=1;var d=1/(n[3]*a+n[7]*s+n[11]*h+n[15]),f=d*(n[0]*a+n[4]*s+n[8]*h+n[12]),m=d*(n[1]*a+n[5]*s+n[9]*h+n[13]),v=d*(n[2]*a+n[6]*s+n[10]*h+n[14]);Math.abs(p-v)<1e-10&&i.set(NaN,NaN,0);var y=(0-p)/(v-p);return i.set((f-u)*y+u,(m-c)*y+c,0),i},r.prototype.invert=function(){return r.glMatrixMat4Invert(this.mat4,this.mat4),this},r.prototype.invertCopyTo=function(t){this._mat4inv||(this._mat4inv=new Float64Array(16));var e=this._mat4inv,i=this.mat4;this.cacheInverse&&this._updateId===this._dirtyId||(this._updateId=this._dirtyId,r.glMatrixMat4Invert(e,i)),t.mat4.set(e)},r.prototype.identity=function(){var t=this.mat4;return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},r.prototype.clone=function(){return new r(this.mat4)},r.prototype.copyTo3d=function(t){var e=this.mat4,r=t.mat4;return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],t},r.prototype.copyTo2d=function(t){var e=this.mat4,r=t.mat3;return r[0]=e[0],r[1]=e[1],r[2]=e[3],r[3]=e[4],r[4]=e[5],r[5]=e[7],r[6]=e[12],r[7]=e[13],r[8]=e[15],t},r.prototype.copyTo2dOr3d=function(e){return e instanceof t.Matrix2d?this.copyTo2d(e):this.copyTo3d(e)},r.prototype.copyTo=function(e,r,i){var n=this.mat4,o=1/n[15],a=n[12]*o,s=n[13]*o;if(e.a=(n[0]-n[3]*a)*o,e.b=(n[1]-n[3]*s)*o,e.c=(n[4]-n[7]*a)*o,e.d=(n[5]-n[7]*s)*o,e.tx=a,e.ty=s,r>=2){var h=e.a*e.d-e.b*e.c;i||(h=Math.abs(h)),r===t.AFFINE.POINT?(h=h>0?1:-1,e.a=h,e.b=0,e.c=0,e.d=h):r===t.AFFINE.AXIS_X?(h/=Math.sqrt(e.b*e.b+e.d*e.d),e.c=0,e.d=h):r===t.AFFINE.AXIS_Y&&(h/=Math.sqrt(e.a*e.a+e.c*e.c),e.a=h,e.c=0)}return e},r.prototype.copyFrom=function(t){var e=this.mat4;return e[0]=t.a,e[1]=t.b,e[2]=0,e[3]=0,e[4]=t.c,e[5]=t.d,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t.tx,e[13]=t.ty,e[14]=0,e[15]=1,this._dirtyId++,this},r.prototype.setToMultLegacy=function(t,e){var r=this.mat4,i=e.mat4,n=t.a,o=t.b,a=t.c,s=t.d,h=t.tx,l=t.ty,u=i[0],c=i[1],p=i[2],d=i[3];return r[0]=u*n+c*a+d*h,r[1]=u*o+c*s+d*l,r[2]=p,r[3]=d,u=i[4],c=i[5],p=i[6],d=i[7],r[4]=u*n+c*a+d*h,r[5]=u*o+c*s+d*l,r[6]=p,r[7]=d,u=i[8],c=i[9],p=i[10],d=i[11],r[8]=u*n+c*a+d*h,r[9]=u*o+c*s+d*l,r[10]=p,r[11]=d,u=i[12],c=i[13],p=i[14],d=i[15],r[12]=u*n+c*a+d*h,r[13]=u*o+c*s+d*l,r[14]=p,r[15]=d,this._dirtyId++,this},r.prototype.setToMultLegacy2=function(t,e){var r=this.mat4,i=t.mat4,n=i[0],o=i[1],a=i[2],s=i[3],h=i[4],l=i[5],u=i[6],c=i[7],p=e.a,d=e.b,f=e.c,m=e.d,v=e.tx,y=e.ty;return r[0]=p*n+d*h,r[1]=p*o+d*l,r[2]=p*a+d*u,r[3]=p*s+d*c,r[4]=f*n+m*h,r[5]=f*o+m*l,r[6]=f*a+m*u,r[7]=f*s+m*c,r[8]=i[8],r[9]=i[9],r[10]=i[10],r[11]=i[11],r[12]=v*n+y*h+i[12],r[13]=v*o+y*l+i[13],r[14]=v*a+y*u+i[14],r[15]=v*s+y*c+i[15],this._dirtyId++,this},r.prototype.setToMult=function(t,e){return r.glMatrixMat4Multiply(this.mat4,t.mat4,e.mat4),this._dirtyId++,this},r.prototype.prepend=function(t){t.mat4?this.setToMult(t,this):this.setToMultLegacy(t,this)},r.glMatrixMat4Invert=function(t,e){var r=e[0],i=e[1],n=e[2],o=e[3],a=e[4],s=e[5],h=e[6],l=e[7],u=e[8],c=e[9],p=e[10],d=e[11],f=e[12],m=e[13],v=e[14],y=e[15],g=r*s-i*a,_=r*h-n*a,x=r*l-o*a,b=i*h-n*s,w=i*l-o*s,T=n*l-o*h,E=u*m-c*f,S=u*v-p*f,A=u*y-d*f,I=c*v-p*m,P=c*y-d*m,M=p*y-d*v,C=g*M-_*P+x*I+b*A-w*S+T*E;return C?(C=1/C,t[0]=(s*M-h*P+l*I)*C,t[1]=(n*P-i*M-o*I)*C,t[2]=(m*T-v*w+y*b)*C,t[3]=(p*w-c*T-d*b)*C,t[4]=(h*A-a*M-l*S)*C,t[5]=(r*M-n*A+o*S)*C,t[6]=(v*x-f*T-y*_)*C,t[7]=(u*T-p*x+d*_)*C,t[8]=(a*P-s*A+l*E)*C,t[9]=(i*A-r*P-o*E)*C,t[10]=(f*w-m*x+y*g)*C,t[11]=(c*x-u*w-d*g)*C,t[12]=(s*S-a*I-h*E)*C,t[13]=(r*I-i*S+n*E)*C,t[14]=(m*_-f*b-v*g)*C,t[15]=(u*b-c*_+p*g)*C,t):null},r.glMatrixMat4Multiply=function(t,e,r){var i=e[0],n=e[1],o=e[2],a=e[3],s=e[4],h=e[5],l=e[6],u=e[7],c=e[8],p=e[9],d=e[10],f=e[11],m=e[12],v=e[13],y=e[14],g=e[15],_=r[0],x=r[1],b=r[2],w=r[3];return t[0]=_*i+x*s+b*c+w*m,t[1]=_*n+x*h+b*p+w*v,t[2]=_*o+x*l+b*d+w*y,t[3]=_*a+x*u+b*f+w*g,_=r[4],x=r[5],b=r[6],w=r[7],t[4]=_*i+x*s+b*c+w*m,t[5]=_*n+x*h+b*p+w*v,t[6]=_*o+x*l+b*d+w*y,t[7]=_*a+x*u+b*f+w*g,_=r[8],x=r[9],b=r[10],w=r[11],t[8]=_*i+x*s+b*c+w*m,t[9]=_*n+x*h+b*p+w*v,t[10]=_*o+x*l+b*d+w*y,t[11]=_*a+x*u+b*f+w*g,_=r[12],x=r[13],b=r[14],w=r[15],t[12]=_*i+x*s+b*c+w*m,t[13]=_*n+x*h+b*p+w*v,t[14]=_*o+x*l+b*d+w*y,t[15]=_*a+x*u+b*f+w*g,t},r.IDENTITY=new r,r.TEMP_MATRIX=new r,r}();t.Matrix3d=r}(pixi_projection||(pixi_projection={})),function(t){var e=function(){function e(t,e,r,i,n){this.cb=t,this.scope=e,this._quatUpdateId=-1,this._quatDirtyId=0,this._sign=1,this._x=r||0,this._y=i||0,this._z=n||0,this.quaternion=new Float64Array(4),this.quaternion[3]=1,this.update()}return Object.defineProperty(e.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this._quatDirtyId++,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this._quatDirtyId++,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"z",{get:function(){return this._z},set:function(t){this._z!==t&&(this._z=t,this._quatDirtyId++,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pitch",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this._quatDirtyId++,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"yaw",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this._quatDirtyId++,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"roll",{get:function(){return this._z},set:function(t){this._z!==t&&(this._z=t,this._quatDirtyId++,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),e.prototype.set=function(t,e,r){var i=t||0,n=e||0,o=r||0;this._x===i&&this._y===n&&this._z===o||(this._x=i,this._y=n,this._z=o,this._quatDirtyId++,this.cb.call(this.scope))},e.prototype.copyFrom=function(t){var e=t.x,r=t.y,i=t.z;this._x===e&&this._y===r&&this._z===i||(this._x=e,this._y=r,this._z=i,this._quatDirtyId++,this.cb.call(this.scope))},e.prototype.copyTo=function(t){return t.set(this._x,this._y,this._z),t},e.prototype.equals=function(t){return this._x===t.x&&this._y===t.y&&this._z===t.z},e.prototype.clone=function(){return new t.Euler(this._x,this._y,this._z)},e.prototype.update=function(){if(this._quatUpdateId===this._quatDirtyId)return!1;this._quatUpdateId=this._quatDirtyId;var t=Math.cos(this._x/2),e=Math.cos(this._y/2),r=Math.cos(this._z/2),i=this._sign,n=i*Math.sin(this._x/2),o=i*Math.sin(this._y/2),a=i*Math.sin(this._z/2),s=this.quaternion;return s[0]=n*e*r+t*o*a,s[1]=t*o*r-n*e*a,s[2]=t*e*a+n*o*r,s[3]=t*e*r-n*o*a,!0},e}();t.ObservableEuler=e}(pixi_projection||(pixi_projection={})),function(t){var e=function(t){function e(e,r,i){var n=t.call(this,e,r)||this;return n.z=i,n}return __extends(e,t),e.prototype.set=function(t,e,r){return this.x=t||0,this.y=void 0===e?this.x:e||0,this.z=void 0===e?this.x:r||0,this},e.prototype.copyFrom=function(t){return this.set(t.x,t.y,t.z||0),this},e.prototype.copyTo=function(t){return t.set(this.x,this.y,this.z),t},e}(PIXI.Point);t.Point3d=e;var r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._z=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"z",{get:function(){return this._z},set:function(t){this._z!==t&&(this._z=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),e.prototype.set=function(t,e,r){var i=t||0,n=void 0===e?i:e||0,o=void 0===e?i:r||0;return this._x===i&&this._y===n&&this._z===o||(this._x=i,this._y=n,this._z=o,this.cb.call(this.scope)),this},e.prototype.copyFrom=function(t){return this.set(t.x,t.y,t.z||0),this},e.prototype.copyTo=function(t){return t.set(this._x,this._y,this._z),t},e}(PIXI.ObservablePoint);t.ObservablePoint3d=r}(pixi_projection||(pixi_projection={})),function(t){var e=new t.Matrix3d,r=function(r){function i(e,i){var n=r.call(this,e,i)||this;return n.cameraMatrix=null,n._cameraMode=!1,n.position=new t.ObservablePoint3d(n.onChange,n,0,0),n.scale=new t.ObservablePoint3d(n.onChange,n,1,1),n.euler=new t.ObservableEuler(n.onChange,n,0,0,0),n.pivot=new t.ObservablePoint3d(n.onChange,n,0,0),n.local=new t.Matrix3d,n.world=new t.Matrix3d,n.local.cacheInverse=!0,n.world.cacheInverse=!0,n.position._z=0,n.scale._z=1,n.pivot._z=0,n}return __extends(i,r),Object.defineProperty(i.prototype,"cameraMode",{get:function(){return this._cameraMode},set:function(e){this._cameraMode!==e&&(this._cameraMode=e,this.euler._sign=this._cameraMode?-1:1,this.euler._quatDirtyId++,e&&(this.cameraMatrix=new t.Matrix3d))},enumerable:!0,configurable:!0}),i.prototype.onChange=function(){this._projID++},i.prototype.clear=function(){this.cameraMatrix&&this.cameraMatrix.identity(),this.position.set(0,0,0),this.scale.set(1,1,1),this.euler.set(0,0,0),this.pivot.set(0,0,0),r.prototype.clear.call(this)},i.prototype.updateLocalTransform=function(t){if(0!==this._projID){var r=this.local,i=this.euler,n=this.position,o=this.scale,a=this.pivot;if(i.update(),!this.cameraMode)return r.setToRotationTranslationScale(i.quaternion,n._x,n._y,n._z,o._x,o._y,o._z),r.translate(-a._x,-a._y,-a._z),void r.setToMultLegacy(t,r);r.setToMultLegacy(t,this.cameraMatrix),r.translate(a._x,a._y,a._z),r.scale(1/o._x,1/o._y,1/o._z),e.setToRotationTranslationScale(i.quaternion,0,0,0,1,1,1),r.setToMult(r,e),r.translate(-n._x,-n._y,-n._z),this.local._dirtyId++}else this.local.copyFrom(t)},i}(t.LinearProjection);t.Projection3d=r}(pixi_projection||(pixi_projection={})),function(t){var e=function(e){function r(r,i,n,o){var a=e.call(this,r,i,n,o)||this;return a.vertexData2d=null,a.proj=new t.Projection3d(a.transform),a}return __extends(r,e),r.prototype.calculateVertices=function(){if(this.proj._affine)return this.vertexData2d=null,void e.prototype.calculateVertices.call(this);var t=this.geometry,r=t.buffers[0].data;if(t.vertexDirtyId!==this.vertexDirty||this._transformID!==this.transform._worldID){this._transformID=this.transform._worldID,this.vertexData.length!==r.length&&(this.vertexData=new Float32Array(r.length)),this.vertexData2d&&this.vertexData2d.length===3*r.length/2||(this.vertexData2d=new Float32Array(3*r.length));for(var i=this.proj.world.mat4,n=this.vertexData2d,o=this.vertexData,a=0;a<o.length/2;a++){var s=r[2*a],h=r[2*a+1],l=i[0]*s+i[4]*h+i[12],u=i[1]*s+i[5]*h+i[13],c=i[3]*s+i[7]*h+i[15];n[3*a]=l,n[3*a+1]=u,n[3*a+2]=c,o[2*a]=l/c,o[2*a+1]=u/c}this.vertexDirty=t.vertexDirtyId}},Object.defineProperty(r.prototype,"worldTransform",{get:function(){return this.proj.affine?this.transform.worldTransform:this.proj.world},enumerable:!0,configurable:!0}),r.prototype.toLocal=function(e,r,i,n,o){return void 0===o&&(o=t.TRANSFORM_STEP.ALL),t.container3dToLocal.call(this,e,r,i,n,o)},r.prototype.isFrontFace=function(e){return t.container3dIsFrontFace.call(this,e)},r.prototype.getDepth=function(e){return t.container3dGetDepth.call(this,e)},Object.defineProperty(r.prototype,"position3d",{get:function(){return this.proj.position},set:function(t){this.proj.position.copyFrom(t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"scale3d",{get:function(){return this.proj.scale},set:function(t){this.proj.scale.copyFrom(t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"euler",{get:function(){return this.proj.euler},set:function(t){this.proj.euler.copyFrom(t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"pivot3d",{get:function(){return this.proj.pivot},set:function(t){this.proj.pivot.copyFrom(t)},enumerable:!0,configurable:!0}),r}(PIXI.Mesh);t.Mesh3d2d=e,e.prototype._renderDefault=t.Mesh2d.prototype._renderDefault;var r=function(e){function r(r,i,n,o,a){var s=e.call(this,new PIXI.MeshGeometry(i,n,o),new PIXI.MeshMaterial(r,{program:PIXI.Program.from(t.Mesh2d.defaultVertexShader,t.Mesh2d.defaultFragmentShader),pluginName:"batch2d"}),null,a)||this;return s.autoUpdate=!0,s.geometry.getBuffer("aVertexPosition").static=!1,s}return __extends(r,e),Object.defineProperty(r.prototype,"vertices",{get:function(){return this.geometry.getBuffer("aVertexPosition").data},set:function(t){this.geometry.getBuffer("aVertexPosition").data=t},enumerable:!0,configurable:!0}),r.prototype._render=function(t){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),e.prototype._render.call(this,t)},r}(e);t.SimpleMesh3d2d=r}(pixi_projection||(pixi_projection={})),function(t){var e=function(e){function r(r){var i=e.call(this,r)||this;return i.vertexData2d=null,i.culledByFrustrum=!1,i.trimmedCulledByFrustrum=!1,i.proj=new t.Projection3d(i.transform),i.pluginName="batch2d",i}return __extends(r,e),r.prototype.calculateVertices=function(){var t=this._texture;if(this.proj._affine)return this.vertexData2d=null,void e.prototype.calculateVertices.call(this);this.vertexData2d||(this.vertexData2d=new Float32Array(12));var r=this.transform._worldID,i=t._updateID;if(this._transformID!==r||this._textureID!==i){this._textureID!==i&&(this.uvs=t._uvs.uvsFloat32),this._transformID=r,this._textureID=i;var n=this.proj.world.mat4,o=this.vertexData2d,a=this.vertexData,s=t.trim,h=t.orig,l=this._anchor,u=0,c=0,p=0,d=0;s?(u=(c=s.x-l._x*h.width)+s.width,p=(d=s.y-l._y*h.height)+s.height):(u=(c=-l._x*h.width)+h.width,p=(d=-l._y*h.height)+h.height);var f,m=!1;o[0]=n[0]*c+n[4]*d+n[12],o[1]=n[1]*c+n[5]*d+n[13],f=n[2]*c+n[6]*d+n[14],o[2]=n[3]*c+n[7]*d+n[15],m=m||f<0,o[3]=n[0]*u+n[4]*d+n[12],o[4]=n[1]*u+n[5]*d+n[13],f=n[2]*u+n[6]*d+n[14],o[5]=n[3]*u+n[7]*d+n[15],m=m||f<0,o[6]=n[0]*u+n[4]*p+n[12],o[7]=n[1]*u+n[5]*p+n[13],f=n[2]*u+n[6]*p+n[14],o[8]=n[3]*u+n[7]*p+n[15],m=m||f<0,o[9]=n[0]*c+n[4]*p+n[12],o[10]=n[1]*c+n[5]*p+n[13],f=n[2]*c+n[6]*p+n[14],o[11]=n[3]*c+n[7]*p+n[15],m=m||f<0,this.culledByFrustrum=m,a[0]=o[0]/o[2],a[1]=o[1]/o[2],a[2]=o[3]/o[5],a[3]=o[4]/o[5],a[4]=o[6]/o[8],a[5]=o[7]/o[8],a[6]=o[9]/o[11],a[7]=o[10]/o[11]}},r.prototype.calculateTrimmedVertices=function(){if(this.proj._affine)e.prototype.calculateTrimmedVertices.call(this);else{var t=this.transform._worldID,r=this._texture._updateID;if(this.vertexTrimmedData){if(this._transformTrimmedID===t&&this._textureTrimmedID===r)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=t,this._textureTrimmedID=r;var i,n=this._texture,o=this.vertexTrimmedData,a=n.orig,s=this._anchor,h=this.proj.world.mat4,l=-s._x*a.width,u=l+a.width,c=-s._y*a.height,p=c+a.height,d=!1,f=1/(h[3]*l+h[7]*c+h[15]);o[0]=f*(h[0]*l+h[4]*c+h[12]),o[1]=f*(h[1]*l+h[5]*c+h[13]),i=h[2]*l+h[6]*c+h[14],d=d||i<0,f=1/(h[3]*u+h[7]*c+h[15]),o[2]=f*(h[0]*u+h[4]*c+h[12]),o[3]=f*(h[1]*u+h[5]*c+h[13]),i=h[2]*u+h[6]*c+h[14],d=d||i<0,f=1/(h[3]*u+h[7]*p+h[15]),o[4]=f*(h[0]*u+h[4]*p+h[12]),o[5]=f*(h[1]*u+h[5]*p+h[13]),i=h[2]*u+h[6]*p+h[14],d=d||i<0,f=1/(h[3]*l+h[7]*p+h[15]),o[6]=f*(h[0]*l+h[4]*p+h[12]),o[7]=f*(h[1]*l+h[5]*p+h[13]),i=h[2]*l+h[6]*p+h[14],d=d||i<0,this.culledByFrustrum=d}},r.prototype._calculateBounds=function(){if(this.calculateVertices(),!this.culledByFrustrum){var t=this._texture.trim,e=this._texture.orig;!t||t.width===e.width&&t.height===e.height?this._bounds.addQuad(this.vertexData):(this.calculateTrimmedVertices(),this.trimmedCulledByFrustrum||this._bounds.addQuad(this.vertexTrimmedData))}},r.prototype._render=function(t){this.calculateVertices(),this.culledByFrustrum||(t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this))},r.prototype.containsPoint=function(t){return!this.culledByFrustrum&&e.prototype.containsPoint.call(this,t)},Object.defineProperty(r.prototype,"worldTransform",{get:function(){return this.proj.affine?this.transform.worldTransform:this.proj.world},enumerable:!0,configurable:!0}),r.prototype.toLocal=function(e,r,i,n,o){return void 0===o&&(o=t.TRANSFORM_STEP.ALL),t.container3dToLocal.call(this,e,r,i,n,o)},r.prototype.isFrontFace=function(e){return t.container3dIsFrontFace.call(this,e)},r.prototype.getDepth=function(e){return t.container3dGetDepth.call(this,e)},Object.defineProperty(r.prototype,"position3d",{get:function(){return this.proj.position},set:function(t){this.proj.position.copyFrom(t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"scale3d",{get:function(){return this.proj.scale},set:function(t){this.proj.scale.copyFrom(t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"euler",{get:function(){return this.proj.euler},set:function(t){this.proj.euler.copyFrom(t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"pivot3d",{get:function(){return this.proj.pivot},set:function(t){this.proj.pivot.copyFrom(t)},enumerable:!0,configurable:!0}),r}(PIXI.Sprite);t.Sprite3d=e}(pixi_projection||(pixi_projection={})),function(t){var e=function(e){function r(r,i,n){var o=e.call(this,r,i,n)||this;return o.vertexData2d=null,o.proj=new t.Projection3d(o.transform),o.pluginName="batch2d",o}return __extends(r,e),Object.defineProperty(r.prototype,"worldTransform",{get:function(){return this.proj.affine?this.transform.worldTransform:this.proj.world},enumerable:!0,configurable:!0}),r.prototype.toLocal=function(e,r,i,n,o){return void 0===o&&(o=t.TRANSFORM_STEP.ALL),t.container3dToLocal.call(this,e,r,i,n,o)},r.prototype.isFrontFace=function(e){return t.container3dIsFrontFace.call(this,e)},r.prototype.getDepth=function(e){return t.container3dGetDepth.call(this,e)},Object.defineProperty(r.prototype,"position3d",{get:function(){return this.proj.position},set:function(t){this.proj.position.copyFrom(t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"scale3d",{get:function(){return this.proj.scale},set:function(t){this.proj.scale.copyFrom(t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"euler",{get:function(){return this.proj.euler},set:function(t){this.proj.euler.copyFrom(t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"pivot3d",{get:function(){return this.proj.pivot},set:function(t){this.proj.pivot.copyFrom(t)},enumerable:!0,configurable:!0}),r}(PIXI.Text);t.Text3d=e,e.prototype.calculateVertices=t.Sprite3d.prototype.calculateVertices,e.prototype.calculateTrimmedVertices=t.Sprite3d.prototype.calculateTrimmedVertices,e.prototype._calculateBounds=t.Sprite3d.prototype._calculateBounds,e.prototype.containsPoint=t.Sprite3d.prototype.containsPoint,e.prototype._render=t.Sprite3d.prototype._render}(pixi_projection||(pixi_projection={})),function(t){var e={worldTransform:{get:t.container3dWorldTransform,enumerable:!0,configurable:!0},position3d:{get:function(){return this.proj.position},set:function(t){this.proj.position.copy(t)}},scale3d:{get:function(){return this.proj.scale},set:function(t){this.proj.scale.copy(t)}},pivot3d:{get:function(){return this.proj.pivot},set:function(t){this.proj.pivot.copy(t)}},euler:{get:function(){return this.proj.euler},set:function(t){this.proj.euler.copy(t)}}};function r(){this.proj||(this.proj=new t.Projection3d(this.transform),this.toLocal=t.Container3d.prototype.toLocal,this.isFrontFace=t.Container3d.prototype.isFrontFace,this.getDepth=t.Container3d.prototype.getDepth,Object.defineProperties(this,e))}PIXI.Container.prototype.convertTo3d=r,PIXI.Sprite.prototype.convertTo3d=function(){this.proj||(this.calculateVertices=t.Sprite3d.prototype.calculateVertices,this.calculateTrimmedVertices=t.Sprite3d.prototype.calculateTrimmedVertices,this._calculateBounds=t.Sprite3d.prototype._calculateBounds,this.containsPoint=t.Sprite3d.prototype.containsPoint,this.pluginName="batch2d",r.call(this))},PIXI.Container.prototype.convertSubtreeTo3d=function(){this.convertTo3d();for(var t=0;t<this.children.length;t++)this.children[t].convertSubtreeTo3d()},PIXI.SimpleMesh&&(PIXI.SimpleMesh.prototype.convertTo3d=PIXI.SimpleRope.prototype.convertTo3d=function(){this.proj||(this.calculateVertices=t.Mesh3d2d.prototype.calculateVertices,this._renderDefault=t.Mesh3d2d.prototype._renderDefault,"batch2d"!==this.material.pluginName&&(this.material=new PIXI.MeshMaterial(this.material.texture,{program:PIXI.Program.from(t.Mesh2d.defaultVertexShader,t.Mesh2d.defaultFragmentShader),pluginName:"batch2d"})),r.call(this))})}(pixi_projection||(pixi_projection={})),((_gsScope="undefined"!=typeof module&&module.exports&&"undefined"!=typeof global?global:this||window)._gsQueue||(_gsScope._gsQueue=[])).push((function(){"use strict";var t,e,r,i,n,o,a,s,h,l,u,c,p,d;_gsScope._gsDefine("TweenMax",["core.Animation","core.SimpleTimeline","TweenLite"],(function(t,e,r){var i=function(t){var e,r=[],i=t.length;for(e=0;e!==i;r.push(t[e++]));return r},n=function(t,e,r){var i,n,o=t.cycle;for(i in o)n=o[i],t[i]="function"==typeof n?n(r,e[r],e):n[r%n.length];delete t.cycle},o=function(t){if("function"==typeof t)return t;var e="object"==typeof t?t:{each:t},r=e.ease,i=e.from||0,n=e.base||0,o={},a=isNaN(i),s=e.axis,h={center:.5,end:1}[i]||0;return function(t,l,u){var c,p,d,f,m,v,y,g,_,x=(u||e).length,b=o[x];if(!b){if(!(_="auto"===e.grid?0:(e.grid||[1/0])[0])){for(y=-1/0;y<(y=u[_++].getBoundingClientRect().left)&&_<x;);_--}for(b=o[x]=[],c=a?Math.min(_,x)*h-.5:i%_,p=a?x*h/_-.5:i/_|0,y=0,g=1/0,v=0;v<x;v++)d=v%_-c,f=p-(v/_|0),b[v]=m=s?Math.abs("y"===s?f:d):Math.sqrt(d*d+f*f),m>y&&(y=m),m<g&&(g=m);b.max=y-g,b.min=g,b.v=x=e.amount||e.each*(_>x?x:s?"y"===s?x/_:_:Math.max(_,x/_))||0,b.b=x<0?n-x:n}return x=(b[t]-b.min)/b.max,b.b+(r?r.getRatio(x):x)*b.v}},a=function(t,e,i){r.call(this,t,e,i),this._cycle=0,this._yoyo=!0===this.vars.yoyo||!!this.vars.yoyoEase,this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._repeat&&this._uncache(!0),this.render=a.prototype.render},s=r._internals,h=s.isSelector,l=s.isArray,u=a.prototype=r.to({},.1,{}),c=[];a.version="2.1.2",u.constructor=a,u.kill()._gc=!1,a.killTweensOf=a.killDelayedCallsTo=r.killTweensOf,a.getTweensOf=r.getTweensOf,a.lagSmoothing=r.lagSmoothing,a.ticker=r.ticker,a.render=r.render,a.distribute=o,u.invalidate=function(){return this._yoyo=!0===this.vars.yoyo||!!this.vars.yoyoEase,this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._yoyoEase=null,this._uncache(!0),r.prototype.invalidate.call(this)},u.updateTo=function(t,e){var i,n=this.ratio,o=this.vars.immediateRender||t.immediateRender;for(i in e&&this._startTime<this._timeline._time&&(this._startTime=this._timeline._time,this._uncache(!1),this._gc?this._enabled(!0,!1):this._timeline.insert(this,this._startTime-this._delay)),t)this.vars[i]=t[i];if(this._initted||o)if(e)this._initted=!1,o&&this.render(0,!0,!0);else if(this._gc&&this._enabled(!0,!1),this._notifyPluginsOfEnabled&&this._firstPT&&r._onPluginEvent("_onDisable",this),this._time/this._duration>.998){var a=this._totalTime;this.render(0,!0,!1),this._initted=!1,this.render(a,!0,!1)}else if(this._initted=!1,this._init(),this._time>0||o)for(var s,h=1/(1-n),l=this._firstPT;l;)s=l.s+l.c,l.c*=h,l.s=s-l.c,l=l._next;return this},u.render=function(t,e,i){this._initted||0===this._duration&&this.vars.repeat&&this.invalidate();var n,o,a,h,l,u,c,p,d,f=this._dirty?this.totalDuration():this._totalDuration,m=this._time,v=this._totalTime,y=this._cycle,g=this._duration,_=this._rawPrevTime;if(t>=f-1e-8&&t>=0?(this._totalTime=f,this._cycle=this._repeat,this._yoyo&&0!=(1&this._cycle)?(this._time=0,this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0):(this._time=g,this.ratio=this._ease._calcEnd?this._ease.getRatio(1):1),this._reversed||(n=!0,o="onComplete",i=i||this._timeline.autoRemoveChildren),0===g&&(this._initted||!this.vars.lazy||i)&&(this._startTime===this._timeline._duration&&(t=0),(_<0||t<=0&&t>=-1e-8||1e-8===_&&"isPause"!==this.data)&&_!==t&&(i=!0,_>1e-8&&(o="onReverseComplete")),this._rawPrevTime=p=!e||t||_===t?t:1e-8)):t<1e-8?(this._totalTime=this._time=this._cycle=0,this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0,(0!==v||0===g&&_>0)&&(o="onReverseComplete",n=this._reversed),t>-1e-8?t=0:t<0&&(this._active=!1,0===g&&(this._initted||!this.vars.lazy||i)&&(_>=0&&(i=!0),this._rawPrevTime=p=!e||t||_===t?t:1e-8)),this._initted||(i=!0)):(this._totalTime=this._time=t,0!==this._repeat&&(h=g+this._repeatDelay,this._cycle=this._totalTime/h>>0,0!==this._cycle&&this._cycle===this._totalTime/h&&v<=t&&this._cycle--,this._time=this._totalTime-this._cycle*h,this._yoyo&&0!=(1&this._cycle)&&(this._time=g-this._time,(d=this._yoyoEase||this.vars.yoyoEase)&&(this._yoyoEase||(!0!==d||this._initted?this._yoyoEase=d=!0===d?this._ease:d instanceof Ease?d:Ease.map[d]:(d=this.vars.ease,this._yoyoEase=d=d?d instanceof Ease?d:"function"==typeof d?new Ease(d,this.vars.easeParams):Ease.map[d]||r.defaultEase:r.defaultEase)),this.ratio=d?1-d.getRatio((g-this._time)/g):0)),this._time>g?this._time=g:this._time<0&&(this._time=0)),this._easeType&&!d?(l=this._time/g,(1===(u=this._easeType)||3===u&&l>=.5)&&(l=1-l),3===u&&(l*=2),1===(c=this._easePower)?l*=l:2===c?l*=l*l:3===c?l*=l*l*l:4===c&&(l*=l*l*l*l),this.ratio=1===u?1-l:2===u?l:this._time/g<.5?l/2:1-l/2):d||(this.ratio=this._ease.getRatio(this._time/g))),m!==this._time||i||y!==this._cycle){if(!this._initted){if(this._init(),!this._initted||this._gc)return;if(!i&&this._firstPT&&(!1!==this.vars.lazy&&this._duration||this.vars.lazy&&!this._duration))return this._time=m,this._totalTime=v,this._rawPrevTime=_,this._cycle=y,s.lazyTweens.push(this),void(this._lazy=[t,e]);!this._time||n||d?n&&this._ease._calcEnd&&!d&&(this.ratio=this._ease.getRatio(0===this._time?0:1)):this.ratio=this._ease.getRatio(this._time/g)}for(!1!==this._lazy&&(this._lazy=!1),this._active||!this._paused&&this._time!==m&&t>=0&&(this._active=!0),0===v&&(2===this._initted&&t>0&&this._init(),this._startAt&&(t>=0?this._startAt.render(t,!0,i):o||(o="_dummyGS")),this.vars.onStart&&(0===this._totalTime&&0!==g||e||this._callback("onStart"))),a=this._firstPT;a;)a.f?a.t[a.p](a.c*this.ratio+a.s):a.t[a.p]=a.c*this.ratio+a.s,a=a._next;this._onUpdate&&(t<0&&this._startAt&&this._startTime&&this._startAt.render(t,!0,i),e||(this._totalTime!==v||o)&&this._callback("onUpdate")),this._cycle!==y&&(e||this._gc||this.vars.onRepeat&&this._callback("onRepeat")),o&&(this._gc&&!i||(t<0&&this._startAt&&!this._onUpdate&&this._startTime&&this._startAt.render(t,!0,i),n&&(this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!e&&this.vars[o]&&this._callback(o),0===g&&1e-8===this._rawPrevTime&&1e-8!==p&&(this._rawPrevTime=0)))}else v!==this._totalTime&&this._onUpdate&&(e||this._callback("onUpdate"))},a.to=function(t,e,r){return new a(t,e,r)},a.from=function(t,e,r){return r.runBackwards=!0,r.immediateRender=0!=r.immediateRender,new a(t,e,r)},a.fromTo=function(t,e,r,i){return i.startAt=r,i.immediateRender=0!=i.immediateRender&&0!=r.immediateRender,new a(t,e,i)},a.staggerTo=a.allTo=function(t,e,s,u,p,d,f){var m,v,y,g,_=[],x=o(s.stagger||u),b=s.cycle,w=(s.startAt||c).cycle;for(l(t)||("string"==typeof t&&(t=r.selector(t)||t),h(t)&&(t=i(t))),m=(t=t||[]).length-1,y=0;y<=m;y++){for(g in v={},s)v[g]=s[g];if(b&&(n(v,t,y),null!=v.duration&&(e=v.duration,delete v.duration)),w){for(g in w=v.startAt={},s.startAt)w[g]=s.startAt[g];n(v.startAt,t,y)}v.delay=x(y,t[y],t)+(v.delay||0),y===m&&p&&(v.onComplete=function(){s.onComplete&&s.onComplete.apply(s.onCompleteScope||this,arguments),p.apply(f||s.callbackScope||this,d||c)}),_[y]=new a(t[y],e,v)}return _},a.staggerFrom=a.allFrom=function(t,e,r,i,n,o,s){return r.runBackwards=!0,r.immediateRender=0!=r.immediateRender,a.staggerTo(t,e,r,i,n,o,s)},a.staggerFromTo=a.allFromTo=function(t,e,r,i,n,o,s,h){return i.startAt=r,i.immediateRender=0!=i.immediateRender&&0!=r.immediateRender,a.staggerTo(t,e,i,n,o,s,h)},a.delayedCall=function(t,e,r,i,n){return new a(e,0,{delay:t,onComplete:e,onCompleteParams:r,callbackScope:i,onReverseComplete:e,onReverseCompleteParams:r,immediateRender:!1,useFrames:n,overwrite:0})},a.set=function(t,e){return new a(t,0,e)},a.isTweening=function(t){return r.getTweensOf(t,!0).length>0};var p=function(t,e){for(var i=[],n=0,o=t._first;o;)o instanceof r?i[n++]=o:(e&&(i[n++]=o),n=(i=i.concat(p(o,e))).length),o=o._next;return i},d=a.getAllTweens=function(e){return p(t._rootTimeline,e).concat(p(t._rootFramesTimeline,e))};a.killAll=function(t,r,i,n){null==r&&(r=!0),null==i&&(i=!0);var o,a,s,h=d(0!=n),l=h.length,u=r&&i&&n;for(s=0;s<l;s++)a=h[s],(u||a instanceof e||(o=a.target===a.vars.onComplete)&&i||r&&!o)&&(t?a.totalTime(a._reversed?0:a.totalDuration()):a._enabled(!1,!1))},a.killChildTweensOf=function(t,e){if(null!=t){var n,o,u,c,p,d=s.tweenLookup;if("string"==typeof t&&(t=r.selector(t)||t),h(t)&&(t=i(t)),l(t))for(c=t.length;--c>-1;)a.killChildTweensOf(t[c],e);else{for(u in n=[],d)for(o=d[u].target.parentNode;o;)o===t&&(n=n.concat(d[u].tweens)),o=o.parentNode;for(p=n.length,c=0;c<p;c++)e&&n[c].totalTime(n[c].totalDuration()),n[c]._enabled(!1,!1)}}};var f=function(t,r,i,n){r=!1!==r,i=!1!==i;for(var o,a,s=d(n=!1!==n),h=r&&i&&n,l=s.length;--l>-1;)a=s[l],(h||a instanceof e||(o=a.target===a.vars.onComplete)&&i||r&&!o)&&a.paused(t)};return a.pauseAll=function(t,e,r){f(!0,t,e,r)},a.resumeAll=function(t,e,r){f(!1,t,e,r)},a.globalTimeScale=function(e){var i=t._rootTimeline,n=r.ticker.time;return arguments.length?(e=e||1e-8,i._startTime=n-(n-i._startTime)*i._timeScale/e,i=t._rootFramesTimeline,n=r.ticker.frame,i._startTime=n-(n-i._startTime)*i._timeScale/e,i._timeScale=t._rootTimeline._timeScale=e,e):i._timeScale},u.progress=function(t,e){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&0!=(1&this._cycle)?1-t:t)+this._cycle*(this._duration+this._repeatDelay),e):this._time/this.duration()},u.totalProgress=function(t,e){return arguments.length?this.totalTime(this.totalDuration()*t,e):this._totalTime/this.totalDuration()},u.time=function(t,e){if(!arguments.length)return this._time;this._dirty&&this.totalDuration();var r=this._duration,i=this._cycle,n=i*(r+this._repeatDelay);return t>r&&(t=r),this.totalTime(this._yoyo&&1&i?r-t+n:this._repeat?t+n:t,e)},u.duration=function(e){return arguments.length?t.prototype.duration.call(this,e):this._duration},u.totalDuration=function(t){return arguments.length?-1===this._repeat?this:this.duration((t-this._repeat*this._repeatDelay)/(this._repeat+1)):(this._dirty&&(this._totalDuration=-1===this._repeat?999999999999:this._duration*(this._repeat+1)+this._repeatDelay*this._repeat,this._dirty=!1),this._totalDuration)},u.repeat=function(t){return arguments.length?(this._repeat=t,this._uncache(!0)):this._repeat},u.repeatDelay=function(t){return arguments.length?(this._repeatDelay=t,this._uncache(!0)):this._repeatDelay},u.yoyo=function(t){return arguments.length?(this._yoyo=t,this):this._yoyo},a}),!0),_gsScope._gsDefine("TimelineLite",["core.Animation","core.SimpleTimeline","TweenLite"],(function(t,e,r){var i=function(t){e.call(this,t);var r,i,n=this.vars;for(i in this._labels={},this.autoRemoveChildren=!!n.autoRemoveChildren,this.smoothChildTiming=!!n.smoothChildTiming,this._sortChildren=!0,this._onUpdate=n.onUpdate,n)r=n[i],s(r)&&-1!==r.join("").indexOf("{self}")&&(n[i]=this._swapSelfInParams(r));s(n.tweens)&&this.add(n.tweens,0,n.align,n.stagger)},n=r._internals,o=i._internals={},a=n.isSelector,s=n.isArray,h=n.lazyTweens,l=n.lazyRender,u=_gsScope._gsDefine.globals,c=function(t){var e,r={};for(e in t)r[e]=t[e];return r},p=function(t,e,r){var i,n,o=t.cycle;for(i in o)n=o[i],t[i]="function"==typeof n?n(r,e[r],e):n[r%n.length];delete t.cycle},d=o.pauseCallback=function(){},f=function(t,e,r,i){var n="immediateRender";return n in e||(e[n]=!(r&&!1===r[n]||i)),e},m=function(t){if("function"==typeof t)return t;var e="object"==typeof t?t:{each:t},r=e.ease,i=e.from||0,n=e.base||0,o={},a=isNaN(i),s=e.axis,h={center:.5,end:1}[i]||0;return function(t,l,u){var c,p,d,f,m,v,y,g,_,x=(u||e).length,b=o[x];if(!b){if(!(_="auto"===e.grid?0:(e.grid||[1/0])[0])){for(y=-1/0;y<(y=u[_++].getBoundingClientRect().left)&&_<x;);_--}for(b=o[x]=[],c=a?Math.min(_,x)*h-.5:i%_,p=a?x*h/_-.5:i/_|0,y=0,g=1/0,v=0;v<x;v++)d=v%_-c,f=p-(v/_|0),b[v]=m=s?Math.abs("y"===s?f:d):Math.sqrt(d*d+f*f),m>y&&(y=m),m<g&&(g=m);b.max=y-g,b.min=g,b.v=x=e.amount||e.each*(_>x?x:s?"y"===s?x/_:_:Math.max(_,x/_))||0,b.b=x<0?n-x:n}return x=(b[t]-b.min)/b.max,b.b+(r?r.getRatio(x):x)*b.v}},v=i.prototype=new e;return i.version="2.1.2",i.distribute=m,v.constructor=i,v.kill()._gc=v._forcingPlayhead=v._hasPause=!1,v.to=function(t,e,i,n){var o=i.repeat&&u.TweenMax||r;return e?this.add(new o(t,e,i),n):this.set(t,i,n)},v.from=function(t,e,i,n){return this.add((i.repeat&&u.TweenMax||r).from(t,e,f(0,i)),n)},v.fromTo=function(t,e,i,n,o){var a=n.repeat&&u.TweenMax||r;return n=f(0,n,i),e?this.add(a.fromTo(t,e,i,n),o):this.set(t,n,o)},v.staggerTo=function(t,e,n,o,s,h,l,u){var d,f,v=new i({onComplete:h,onCompleteParams:l,callbackScope:u,smoothChildTiming:this.smoothChildTiming}),y=m(n.stagger||o),g=n.startAt,_=n.cycle;for("string"==typeof t&&(t=r.selector(t)||t),a(t=t||[])&&(t=function(t){var e,r=[],i=t.length;for(e=0;e!==i;r.push(t[e++]));return r}(t)),f=0;f<t.length;f++)d=c(n),g&&(d.startAt=c(g),g.cycle&&p(d.startAt,t,f)),_&&(p(d,t,f),null!=d.duration&&(e=d.duration,delete d.duration)),v.to(t[f],e,d,y(f,t[f],t));return this.add(v,s)},v.staggerFrom=function(t,e,r,i,n,o,a,s){return r.runBackwards=!0,this.staggerTo(t,e,f(0,r),i,n,o,a,s)},v.staggerFromTo=function(t,e,r,i,n,o,a,s,h){return i.startAt=r,this.staggerTo(t,e,f(0,i,r),n,o,a,s,h)},v.call=function(t,e,i,n){return this.add(r.delayedCall(0,t,e,i),n)},v.set=function(t,e,i){return this.add(new r(t,0,f(0,e,null,!0)),i)},i.exportRoot=function(t,e){null==(t=t||{}).smoothChildTiming&&(t.smoothChildTiming=!0);var n,o,a,s,h=new i(t),l=h._timeline;for(null==e&&(e=!0),l._remove(h,!0),h._startTime=0,h._rawPrevTime=h._time=h._totalTime=l._time,a=l._first;a;)s=a._next,e&&a instanceof r&&a.target===a.vars.onComplete||((o=a._startTime-a._delay)<0&&(n=1),h.add(a,o)),a=s;return l.add(h,0),n&&h.totalDuration(),h},v.add=function(n,o,a,h){var l,u,c,p,d,f;if("number"!=typeof o&&(o=this._parseTimeOrLabel(o,0,!0,n)),!(n instanceof t)){if(n instanceof Array||n&&n.push&&s(n)){for(a=a||"normal",h=h||0,l=o,u=n.length,c=0;c<u;c++)s(p=n[c])&&(p=new i({tweens:p})),this.add(p,l),"string"!=typeof p&&"function"!=typeof p&&("sequence"===a?l=p._startTime+p.totalDuration()/p._timeScale:"start"===a&&(p._startTime-=p.delay())),l+=h;return this._uncache(!0)}if("string"==typeof n)return this.addLabel(n,o);if("function"!=typeof n)throw"Cannot add "+n+" into the timeline; it is not a tween, timeline, function, or string.";n=r.delayedCall(0,n)}if(e.prototype.add.call(this,n,o),(n._time||!n._duration&&n._initted)&&(l=(this.rawTime()-n._startTime)*n._timeScale,(!n._duration||Math.abs(Math.max(0,Math.min(n.totalDuration(),l)))-n._totalTime>1e-5)&&n.render(l,!1,!1)),(this._gc||this._time===this._duration)&&!this._paused&&this._duration<this.duration())for(f=(d=this).rawTime()>n._startTime;d._timeline;)f&&d._timeline.smoothChildTiming?d.totalTime(d._totalTime,!0):d._gc&&d._enabled(!0,!1),d=d._timeline;return this},v.remove=function(e){if(e instanceof t){this._remove(e,!1);var r=e._timeline=e.vars.useFrames?t._rootFramesTimeline:t._rootTimeline;return e._startTime=(e._paused?e._pauseTime:r._time)-(e._reversed?e.totalDuration()-e._totalTime:e._totalTime)/e._timeScale,this}if(e instanceof Array||e&&e.push&&s(e)){for(var i=e.length;--i>-1;)this.remove(e[i]);return this}return"string"==typeof e?this.removeLabel(e):this.kill(null,e)},v._remove=function(t,r){return e.prototype._remove.call(this,t,r),this._last?this._time>this.duration()&&(this._time=this._duration,this._totalTime=this._totalDuration):this._time=this._totalTime=this._duration=this._totalDuration=0,this},v.append=function(t,e){return this.add(t,this._parseTimeOrLabel(null,e,!0,t))},v.insert=v.insertMultiple=function(t,e,r,i){return this.add(t,e||0,r,i)},v.appendMultiple=function(t,e,r,i){return this.add(t,this._parseTimeOrLabel(null,e,!0,t),r,i)},v.addLabel=function(t,e){return this._labels[t]=this._parseTimeOrLabel(e),this},v.addPause=function(t,e,i,n){var o=r.delayedCall(0,d,i,n||this);return o.vars.onComplete=o.vars.onReverseComplete=e,o.data="isPause",this._hasPause=!0,this.add(o,t)},v.removeLabel=function(t){return delete this._labels[t],this},v.getLabelTime=function(t){return null!=this._labels[t]?this._labels[t]:-1},v._parseTimeOrLabel=function(e,r,i,n){var o,a;if(n instanceof t&&n.timeline===this)this.remove(n);else if(n&&(n instanceof Array||n.push&&s(n)))for(a=n.length;--a>-1;)n[a]instanceof t&&n[a].timeline===this&&this.remove(n[a]);if(o="number"!=typeof e||r?this.duration()>99999999999?this.recent().endTime(!1):this._duration:0,"string"==typeof r)return this._parseTimeOrLabel(r,i&&"number"==typeof e&&null==this._labels[r]?e-o:0,i);if(r=r||0,"string"!=typeof e||!isNaN(e)&&null==this._labels[e])null==e&&(e=o);else{if(-1===(a=e.indexOf("=")))return null==this._labels[e]?i?this._labels[e]=o+r:r:this._labels[e]+r;r=parseInt(e.charAt(a-1)+"1",10)*Number(e.substr(a+1)),e=a>1?this._parseTimeOrLabel(e.substr(0,a-1),0,i):o}return Number(e)+r},v.seek=function(t,e){return this.totalTime("number"==typeof t?t:this._parseTimeOrLabel(t),!1!==e)},v.stop=function(){return this.paused(!0)},v.gotoAndPlay=function(t,e){return this.play(t,e)},v.gotoAndStop=function(t,e){return this.pause(t,e)},v.render=function(t,e,r){this._gc&&this._enabled(!0,!1);var i,n,o,a,s,u,c,p,d=this._time,f=this._dirty?this.totalDuration():this._totalDuration,m=this._startTime,v=this._timeScale,y=this._paused;if(d!==this._time&&(t+=this._time-d),t>=f-1e-8&&t>=0)this._totalTime=this._time=f,this._reversed||this._hasPausedChild()||(n=!0,a="onComplete",s=!!this._timeline.autoRemoveChildren,0===this._duration&&(t<=0&&t>=-1e-8||this._rawPrevTime<0||1e-8===this._rawPrevTime)&&this._rawPrevTime!==t&&this._first&&(s=!0,this._rawPrevTime>1e-8&&(a="onReverseComplete"))),this._rawPrevTime=this._duration||!e||t||this._rawPrevTime===t?t:1e-8,t=f+1e-4;else if(t<1e-8)if(this._totalTime=this._time=0,t>-1e-8&&(t=0),(0!==d||0===this._duration&&1e-8!==this._rawPrevTime&&(this._rawPrevTime>0||t<0&&this._rawPrevTime>=0))&&(a="onReverseComplete",n=this._reversed),t<0)this._active=!1,this._timeline.autoRemoveChildren&&this._reversed?(s=n=!0,a="onReverseComplete"):this._rawPrevTime>=0&&this._first&&(s=!0),this._rawPrevTime=t;else{if(this._rawPrevTime=this._duration||!e||t||this._rawPrevTime===t?t:1e-8,0===t&&n)for(i=this._first;i&&0===i._startTime;)i._duration||(n=!1),i=i._next;t=0,this._initted||(s=!0)}else{if(this._hasPause&&!this._forcingPlayhead&&!e){if(t>=d)for(i=this._first;i&&i._startTime<=t&&!u;)i._duration||"isPause"!==i.data||i.ratio||0===i._startTime&&0===this._rawPrevTime||(u=i),i=i._next;else for(i=this._last;i&&i._startTime>=t&&!u;)i._duration||"isPause"===i.data&&i._rawPrevTime>0&&(u=i),i=i._prev;u&&(this._time=this._totalTime=t=u._startTime,p=this._startTime+t/this._timeScale)}this._totalTime=this._time=this._rawPrevTime=t}if(this._time!==d&&this._first||r||s||u){if(this._initted||(this._initted=!0),this._active||!this._paused&&this._time!==d&&t>0&&(this._active=!0),0===d&&this.vars.onStart&&(0===this._time&&this._duration||e||this._callback("onStart")),(c=this._time)>=d)for(i=this._first;i&&(o=i._next,c===this._time&&(!this._paused||y));)(i._active||i._startTime<=c&&!i._paused&&!i._gc)&&(u===i&&(this.pause(),this._pauseTime=p),i._reversed?i.render((i._dirty?i.totalDuration():i._totalDuration)-(t-i._startTime)*i._timeScale,e,r):i.render((t-i._startTime)*i._timeScale,e,r)),i=o;else for(i=this._last;i&&(o=i._prev,c===this._time&&(!this._paused||y));){if(i._active||i._startTime<=d&&!i._paused&&!i._gc){if(u===i){for(u=i._prev;u&&u.endTime()>this._time;)u.render(u._reversed?u.totalDuration()-(t-u._startTime)*u._timeScale:(t-u._startTime)*u._timeScale,e,r),u=u._prev;u=null,this.pause(),this._pauseTime=p}i._reversed?i.render((i._dirty?i.totalDuration():i._totalDuration)-(t-i._startTime)*i._timeScale,e,r):i.render((t-i._startTime)*i._timeScale,e,r)}i=o}this._onUpdate&&(e||(h.length&&l(),this._callback("onUpdate"))),a&&(this._gc||m!==this._startTime&&v===this._timeScale||(0===this._time||f>=this.totalDuration())&&(n&&(h.length&&l(),this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!e&&this.vars[a]&&this._callback(a)))}},v._hasPausedChild=function(){for(var t=this._first;t;){if(t._paused||t instanceof i&&t._hasPausedChild())return!0;t=t._next}return!1},v.getChildren=function(t,e,i,n){n=n||-9999999999;for(var o=[],a=this._first,s=0;a;)a._startTime<n||(a instanceof r?!1!==e&&(o[s++]=a):(!1!==i&&(o[s++]=a),!1!==t&&(s=(o=o.concat(a.getChildren(!0,e,i))).length))),a=a._next;return o},v.getTweensOf=function(t,e){var i,n,o=this._gc,a=[],s=0;for(o&&this._enabled(!0,!0),n=(i=r.getTweensOf(t)).length;--n>-1;)(i[n].timeline===this||e&&this._contains(i[n]))&&(a[s++]=i[n]);return o&&this._enabled(!1,!0),a},v.recent=function(){return this._recent},v._contains=function(t){for(var e=t.timeline;e;){if(e===this)return!0;e=e.timeline}return!1},v.shiftChildren=function(t,e,r){r=r||0;for(var i,n=this._first,o=this._labels;n;)n._startTime>=r&&(n._startTime+=t),n=n._next;if(e)for(i in o)o[i]>=r&&(o[i]+=t);return this._uncache(!0)},v._kill=function(t,e){if(!t&&!e)return this._enabled(!1,!1);for(var r=e?this.getTweensOf(e):this.getChildren(!0,!0,!1),i=r.length,n=!1;--i>-1;)r[i]._kill(t,e)&&(n=!0);return n},v.clear=function(t){var e=this.getChildren(!1,!0,!0),r=e.length;for(this._time=this._totalTime=0;--r>-1;)e[r]._enabled(!1,!1);return!1!==t&&(this._labels={}),this._uncache(!0)},v.invalidate=function(){for(var e=this._first;e;)e.invalidate(),e=e._next;return t.prototype.invalidate.call(this)},v._enabled=function(t,r){if(t===this._gc)for(var i=this._first;i;)i._enabled(t,!0),i=i._next;return e.prototype._enabled.call(this,t,r)},v.totalTime=function(e,r,i){this._forcingPlayhead=!0;var n=t.prototype.totalTime.apply(this,arguments);return this._forcingPlayhead=!1,n},v.duration=function(t){return arguments.length?(0!==this.duration()&&0!==t&&this.timeScale(this._duration/t),this):(this._dirty&&this.totalDuration(),this._duration)},v.totalDuration=function(t){if(!arguments.length){if(this._dirty){for(var e,r,i=0,n=this,o=n._last,a=999999999999;o;)e=o._prev,o._dirty&&o.totalDuration(),o._startTime>a&&n._sortChildren&&!o._paused&&!n._calculatingDuration?(n._calculatingDuration=1,n.add(o,o._startTime-o._delay),n._calculatingDuration=0):a=o._startTime,o._startTime<0&&!o._paused&&(i-=o._startTime,n._timeline.smoothChildTiming&&(n._startTime+=o._startTime/n._timeScale,n._time-=o._startTime,n._totalTime-=o._startTime,n._rawPrevTime-=o._startTime),n.shiftChildren(-o._startTime,!1,-9999999999),a=0),(r=o._startTime+o._totalDuration/o._timeScale)>i&&(i=r),o=e;n._duration=n._totalDuration=i,n._dirty=!1}return this._totalDuration}return t&&this.totalDuration()?this.timeScale(this._totalDuration/t):this},v.paused=function(e){if(!1===e&&this._paused)for(var r=this._first;r;)r._startTime===this._time&&"isPause"===r.data&&(r._rawPrevTime=0),r=r._next;return t.prototype.paused.apply(this,arguments)},v.usesFrames=function(){for(var e=this._timeline;e._timeline;)e=e._timeline;return e===t._rootFramesTimeline},v.rawTime=function(t){return t&&(this._paused||this._repeat&&this.time()>0&&this.totalProgress()<1)?this._totalTime%(this._duration+this._repeatDelay):this._paused?this._totalTime:(this._timeline.rawTime(t)-this._startTime)*this._timeScale},i}),!0),_gsScope._gsDefine("TimelineMax",["TimelineLite","TweenLite","easing.Ease"],(function(t,e,r){var i=function(e){t.call(this,e),this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._cycle=0,this._yoyo=!!this.vars.yoyo,this._dirty=!0},n=e._internals,o=n.lazyTweens,a=n.lazyRender,s=_gsScope._gsDefine.globals,h=new r(null,null,1,0),l=i.prototype=new t;return l.constructor=i,l.kill()._gc=!1,i.version="2.1.2",l.invalidate=function(){return this._yoyo=!!this.vars.yoyo,this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._uncache(!0),t.prototype.invalidate.call(this)},l.addCallback=function(t,r,i,n){return this.add(e.delayedCall(0,t,i,n),r)},l.removeCallback=function(t,e){if(t)if(null==e)this._kill(null,t);else for(var r=this.getTweensOf(t,!1),i=r.length,n=this._parseTimeOrLabel(e);--i>-1;)r[i]._startTime===n&&r[i]._enabled(!1,!1);return this},l.removePause=function(e){return this.removeCallback(t._internals.pauseCallback,e)},l.tweenTo=function(t,r){r=r||{};var i,n,o,a={ease:h,useFrames:this.usesFrames(),immediateRender:!1,lazy:!1},l=r.repeat&&s.TweenMax||e;for(n in r)a[n]=r[n];return a.time=this._parseTimeOrLabel(t),i=Math.abs(Number(a.time)-this._time)/this._timeScale||.001,o=new l(this,i,a),a.onStart=function(){o.target.paused(!0),o.vars.time===o.target.time()||i!==o.duration()||o.isFromTo||o.duration(Math.abs(o.vars.time-o.target.time())/o.target._timeScale).render(o.time(),!0,!0),r.onStart&&r.onStart.apply(r.onStartScope||r.callbackScope||o,r.onStartParams||[])},o},l.tweenFromTo=function(t,e,r){r=r||{},t=this._parseTimeOrLabel(t),r.startAt={onComplete:this.seek,onCompleteParams:[t],callbackScope:this},r.immediateRender=!1!==r.immediateRender;var i=this.tweenTo(e,r);return i.isFromTo=1,i.duration(Math.abs(i.vars.time-t)/this._timeScale||.001)},l.render=function(t,e,r){this._gc&&this._enabled(!0,!1);var i,n,s,h,l,u,c,p,d,f=this._time,m=this._dirty?this.totalDuration():this._totalDuration,v=this._duration,y=this._totalTime,g=this._startTime,_=this._timeScale,x=this._rawPrevTime,b=this._paused,w=this._cycle;if(f!==this._time&&(t+=this._time-f),t>=m-1e-8&&t>=0)this._locked||(this._totalTime=m,this._cycle=this._repeat),this._reversed||this._hasPausedChild()||(n=!0,h="onComplete",l=!!this._timeline.autoRemoveChildren,0===this._duration&&(t<=0&&t>=-1e-8||x<0||1e-8===x)&&x!==t&&this._first&&(l=!0,x>1e-8&&(h="onReverseComplete"))),this._rawPrevTime=this._duration||!e||t||this._rawPrevTime===t?t:1e-8,this._yoyo&&1&this._cycle?this._time=t=0:(this._time=v,t=v+1e-4);else if(t<1e-8)if(this._locked||(this._totalTime=this._cycle=0),this._time=0,t>-1e-8&&(t=0),(0!==f||0===v&&1e-8!==x&&(x>0||t<0&&x>=0)&&!this._locked)&&(h="onReverseComplete",n=this._reversed),t<0)this._active=!1,this._timeline.autoRemoveChildren&&this._reversed?(l=n=!0,h="onReverseComplete"):x>=0&&this._first&&(l=!0),this._rawPrevTime=t;else{if(this._rawPrevTime=v||!e||t||this._rawPrevTime===t?t:1e-8,0===t&&n)for(i=this._first;i&&0===i._startTime;)i._duration||(n=!1),i=i._next;t=0,this._initted||(l=!0)}else if(0===v&&x<0&&(l=!0),this._time=this._rawPrevTime=t,this._locked||(this._totalTime=t,0!==this._repeat&&(u=v+this._repeatDelay,this._cycle=this._totalTime/u>>0,this._cycle&&this._cycle===this._totalTime/u&&y<=t&&this._cycle--,this._time=this._totalTime-this._cycle*u,this._yoyo&&1&this._cycle&&(this._time=v-this._time),this._time>v?(this._time=v,t=v+1e-4):this._time<0?this._time=t=0:t=this._time)),this._hasPause&&!this._forcingPlayhead&&!e){if((t=this._time)>=f||this._repeat&&w!==this._cycle)for(i=this._first;i&&i._startTime<=t&&!c;)i._duration||"isPause"!==i.data||i.ratio||0===i._startTime&&0===this._rawPrevTime||(c=i),i=i._next;else for(i=this._last;i&&i._startTime>=t&&!c;)i._duration||"isPause"===i.data&&i._rawPrevTime>0&&(c=i),i=i._prev;c&&(d=this._startTime+c._startTime/this._timeScale,c._startTime<v&&(this._time=this._rawPrevTime=t=c._startTime,this._totalTime=t+this._cycle*(this._totalDuration+this._repeatDelay)))}if(this._cycle!==w&&!this._locked){var T=this._yoyo&&0!=(1&w),E=T===(this._yoyo&&0!=(1&this._cycle)),S=this._totalTime,A=this._cycle,I=this._rawPrevTime,P=this._time;if(this._totalTime=w*v,this._cycle<w?T=!T:this._totalTime+=v,this._time=f,this._rawPrevTime=0===v?x-1e-4:x,this._cycle=w,this._locked=!0,f=T?0:v,this.render(f,e,0===v),e||this._gc||this.vars.onRepeat&&(this._cycle=A,this._locked=!1,this._callback("onRepeat")),f!==this._time)return;if(E&&(this._cycle=w,this._locked=!0,f=T?v+1e-4:-1e-4,this.render(f,!0,!1)),this._locked=!1,this._paused&&!b)return;this._time=P,this._totalTime=S,this._cycle=A,this._rawPrevTime=I}if(this._time!==f&&this._first||r||l||c){if(this._initted||(this._initted=!0),this._active||!this._paused&&this._totalTime!==y&&t>0&&(this._active=!0),0===y&&this.vars.onStart&&(0===this._totalTime&&this._totalDuration||e||this._callback("onStart")),(p=this._time)>=f)for(i=this._first;i&&(s=i._next,p===this._time&&(!this._paused||b));)(i._active||i._startTime<=this._time&&!i._paused&&!i._gc)&&(c===i&&(this.pause(),this._pauseTime=d),i._reversed?i.render((i._dirty?i.totalDuration():i._totalDuration)-(t-i._startTime)*i._timeScale,e,r):i.render((t-i._startTime)*i._timeScale,e,r)),i=s;else for(i=this._last;i&&(s=i._prev,p===this._time&&(!this._paused||b));){if(i._active||i._startTime<=f&&!i._paused&&!i._gc){if(c===i){for(c=i._prev;c&&c.endTime()>this._time;)c.render(c._reversed?c.totalDuration()-(t-c._startTime)*c._timeScale:(t-c._startTime)*c._timeScale,e,r),c=c._prev;c=null,this.pause(),this._pauseTime=d}i._reversed?i.render((i._dirty?i.totalDuration():i._totalDuration)-(t-i._startTime)*i._timeScale,e,r):i.render((t-i._startTime)*i._timeScale,e,r)}i=s}this._onUpdate&&(e||(o.length&&a(),this._callback("onUpdate"))),h&&(this._locked||this._gc||g!==this._startTime&&_===this._timeScale||(0===this._time||m>=this.totalDuration())&&(n&&(o.length&&a(),this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!e&&this.vars[h]&&this._callback(h)))}else y!==this._totalTime&&this._onUpdate&&(e||this._callback("onUpdate"))},l.getActive=function(t,e,r){var i,n,o=[],a=this.getChildren(t||null==t,e||null==t,!!r),s=0,h=a.length;for(i=0;i<h;i++)(n=a[i]).isActive()&&(o[s++]=n);return o},l.getLabelAfter=function(t){t||0!==t&&(t=this._time);var e,r=this.getLabelsArray(),i=r.length;for(e=0;e<i;e++)if(r[e].time>t)return r[e].name;return null},l.getLabelBefore=function(t){null==t&&(t=this._time);for(var e=this.getLabelsArray(),r=e.length;--r>-1;)if(e[r].time<t)return e[r].name;return null},l.getLabelsArray=function(){var t,e=[],r=0;for(t in this._labels)e[r++]={time:this._labels[t],name:t};return e.sort((function(t,e){return t.time-e.time})),e},l.invalidate=function(){return this._locked=!1,t.prototype.invalidate.call(this)},l.progress=function(t,e){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&0!=(1&this._cycle)?1-t:t)+this._cycle*(this._duration+this._repeatDelay),e):this._time/this.duration()||0},l.totalProgress=function(t,e){return arguments.length?this.totalTime(this.totalDuration()*t,e):this._totalTime/this.totalDuration()||0},l.totalDuration=function(e){return arguments.length?-1!==this._repeat&&e?this.timeScale(this.totalDuration()/e):this:(this._dirty&&(t.prototype.totalDuration.call(this),this._totalDuration=-1===this._repeat?999999999999:this._duration*(this._repeat+1)+this._repeatDelay*this._repeat),this._totalDuration)},l.time=function(t,e){if(!arguments.length)return this._time;this._dirty&&this.totalDuration();var r=this._duration,i=this._cycle,n=i*(r+this._repeatDelay);return t>r&&(t=r),this.totalTime(this._yoyo&&1&i?r-t+n:this._repeat?t+n:t,e)},l.repeat=function(t){return arguments.length?(this._repeat=t,this._uncache(!0)):this._repeat},l.repeatDelay=function(t){return arguments.length?(this._repeatDelay=t,this._uncache(!0)):this._repeatDelay},l.yoyo=function(t){return arguments.length?(this._yoyo=t,this):this._yoyo},l.currentLabel=function(t){return arguments.length?this.seek(t,!0):this.getLabelBefore(this._time+1e-8)},i}),!0),t=180/Math.PI,e=[],r=[],i=[],n={},o=_gsScope._gsDefine.globals,a=function(t,e,r,i){r===i&&(r=i-(i-e)/1e6),t===e&&(e=t+(r-t)/1e6),this.a=t,this.b=e,this.c=r,this.d=i,this.da=i-t,this.ca=r-t,this.ba=e-t},s=function(t,e,r,i){var n={a:t},o={},a={},s={c:i},h=(t+e)/2,l=(e+r)/2,u=(r+i)/2,c=(h+l)/2,p=(l+u)/2,d=(p-c)/8;return n.b=h+(t-h)/4,o.b=c+d,n.c=o.a=(n.b+o.b)/2,o.c=a.a=(c+p)/2,a.b=p-d,s.b=u+(i-u)/4,a.c=s.a=(a.b+s.b)/2,[n,o,a,s]},h=function(t,n,o,a,h){var l,u,c,p,d,f,m,v,y,g,_,x,b,w=t.length-1,T=0,E=t[0].a;for(l=0;l<w;l++)u=(d=t[T]).a,c=d.d,p=t[T+1].d,h?(_=e[l],b=((x=r[l])+_)*n*.25/(a?.5:i[l]||.5),v=c-((f=c-(c-u)*(a?.5*n:0!==_?b/_:0))+(((m=c+(p-c)*(a?.5*n:0!==x?b/x:0))-f)*(3*_/(_+x)+.5)/4||0))):v=c-((f=c-(c-u)*n*.5)+(m=c+(p-c)*n*.5))/2,f+=v,m+=v,d.c=y=f,d.b=0!==l?E:E=d.a+.6*(d.c-d.a),d.da=c-u,d.ca=y-u,d.ba=E-u,o?(g=s(u,E,y,c),t.splice(T,1,g[0],g[1],g[2],g[3]),T+=4):T++,E=m;(d=t[T]).b=E,d.c=E+.4*(d.d-E),d.da=d.d-d.a,d.ca=d.c-d.a,d.ba=E-d.a,o&&(g=s(d.a,E,d.c,d.d),t.splice(T,1,g[0],g[1],g[2],g[3]))},l=function(t,i,n,o){var s,h,l,u,c,p,d=[];if(o)for(h=(t=[o].concat(t)).length;--h>-1;)"string"==typeof(p=t[h][i])&&"="===p.charAt(1)&&(t[h][i]=o[i]+Number(p.charAt(0)+p.substr(2)));if((s=t.length-2)<0)return d[0]=new a(t[0][i],0,0,t[0][i]),d;for(h=0;h<s;h++)l=t[h][i],u=t[h+1][i],d[h]=new a(l,0,0,u),n&&(c=t[h+2][i],e[h]=(e[h]||0)+(u-l)*(u-l),r[h]=(r[h]||0)+(c-u)*(c-u));return d[h]=new a(t[h][i],0,0,t[h+1][i]),d},u=function(t,o,a,s,u,c){var p,d,f,m,v,y,g,_,x={},b=[],w=c||t[0];for(d in u="string"==typeof u?","+u+",":",x,y,z,left,top,right,bottom,marginTop,marginLeft,marginRight,marginBottom,paddingLeft,paddingTop,paddingRight,paddingBottom,backgroundPosition,backgroundPosition_y,",null==o&&(o=1),t[0])b.push(d);if(t.length>1){for(_=t[t.length-1],g=!0,p=b.length;--p>-1;)if(d=b[p],Math.abs(w[d]-_[d])>.05){g=!1;break}g&&(t=t.concat(),c&&t.unshift(c),t.push(t[1]),c=t[t.length-3])}for(e.length=r.length=i.length=0,p=b.length;--p>-1;)d=b[p],n[d]=-1!==u.indexOf(","+d+","),x[d]=l(t,d,n[d],c);for(p=e.length;--p>-1;)e[p]=Math.sqrt(e[p]),r[p]=Math.sqrt(r[p]);if(!s){for(p=b.length;--p>-1;)if(n[d])for(y=(f=x[b[p]]).length-1,m=0;m<y;m++)v=f[m+1].da/r[m]+f[m].da/e[m]||0,i[m]=(i[m]||0)+v*v;for(p=i.length;--p>-1;)i[p]=Math.sqrt(i[p])}for(p=b.length,m=a?4:1;--p>-1;)f=x[d=b[p]],h(f,o,a,s,n[d]),g&&(f.splice(0,m),f.splice(f.length-m,m));return x},c=function(t,e,r){for(var i,n,o,a,s,h,l,u,c,p,d,f=1/r,m=t.length;--m>-1;)for(o=(p=t[m]).a,a=p.d-o,s=p.c-o,h=p.b-o,i=n=0,u=1;u<=r;u++)i=n-(n=((l=f*u)*l*a+3*(c=1-l)*(l*s+c*h))*l),e[d=m*r+u-1]=(e[d]||0)+i*i},p=_gsScope._gsDefine.plugin({propName:"bezier",priority:-1,version:"1.3.8",API:2,global:!0,init:function(t,e,r){this._target=t,e instanceof Array&&(e={values:e}),this._func={},this._mod={},this._props=[],this._timeRes=null==e.timeResolution?6:parseInt(e.timeResolution,10);var i,n,o,s,h,l=e.values||[],p={},d=l[0],f=e.autoRotate||r.vars.orientToBezier;for(i in this._autoRotate=f?f instanceof Array?f:[["x","y","rotation",!0===f?0:Number(f)||0]]:null,d)this._props.push(i);for(o=this._props.length;--o>-1;)i=this._props[o],this._overwriteProps.push(i),n=this._func[i]="function"==typeof t[i],p[i]=n?t[i.indexOf("set")||"function"!=typeof t["get"+i.substr(3)]?i:"get"+i.substr(3)]():parseFloat(t[i]),h||p[i]!==l[0][i]&&(h=p);if(this._beziers="cubic"!==e.type&&"quadratic"!==e.type&&"soft"!==e.type?u(l,isNaN(e.curviness)?1:e.curviness,!1,"thruBasic"===e.type,e.correlate,h):function(t,e,r){var i,n,o,s,h,l,u,c,p,d,f,m={},v="cubic"===(e=e||"soft")?3:2,y="soft"===e,g=[];if(y&&r&&(t=[r].concat(t)),null==t||t.length<v+1)throw"invalid Bezier data";for(p in t[0])g.push(p);for(l=g.length;--l>-1;){for(m[p=g[l]]=h=[],d=0,c=t.length,u=0;u<c;u++)i=null==r?t[u][p]:"string"==typeof(f=t[u][p])&&"="===f.charAt(1)?r[p]+Number(f.charAt(0)+f.substr(2)):Number(f),y&&u>1&&u<c-1&&(h[d++]=(i+h[d-2])/2),h[d++]=i;for(c=d-v+1,d=0,u=0;u<c;u+=v)i=h[u],n=h[u+1],o=h[u+2],s=2===v?0:h[u+3],h[d++]=f=3===v?new a(i,n,o,s):new a(i,(2*n+i)/3,(2*n+o)/3,o);h.length=d}return m}(l,e.type,p),this._segCount=this._beziers[i].length,this._timeRes){var m=function(t,e){var r,i,n,o,a=[],s=[],h=0,l=0,u=(e=e>>0||6)-1,p=[],d=[];for(r in t)c(t[r],a,e);for(n=a.length,i=0;i<n;i++)h+=Math.sqrt(a[i]),d[o=i%e]=h,o===u&&(l+=h,p[o=i/e>>0]=d,s[o]=l,h=0,d=[]);return{length:l,lengths:s,segments:p}}(this._beziers,this._timeRes);this._length=m.length,this._lengths=m.lengths,this._segments=m.segments,this._l1=this._li=this._s1=this._si=0,this._l2=this._lengths[0],this._curSeg=this._segments[0],this._s2=this._curSeg[0],this._prec=1/this._curSeg.length}if(f=this._autoRotate)for(this._initialRotations=[],f[0]instanceof Array||(this._autoRotate=f=[f]),o=f.length;--o>-1;){for(s=0;s<3;s++)i=f[o][s],this._func[i]="function"==typeof t[i]&&t[i.indexOf("set")||"function"!=typeof t["get"+i.substr(3)]?i:"get"+i.substr(3)];i=f[o][2],this._initialRotations[o]=(this._func[i]?this._func[i].call(this._target):this._target[i])||0,this._overwriteProps.push(i)}return this._startRatio=r.vars.runBackwards?1:0,!0},set:function(e){var r,i,n,o,a,s,h,l,u,c,p=this._segCount,d=this._func,f=this._target,m=e!==this._startRatio;if(this._timeRes){if(u=this._lengths,c=this._curSeg,e*=this._length,n=this._li,e>this._l2&&n<p-1){for(l=p-1;n<l&&(this._l2=u[++n])<=e;);this._l1=u[n-1],this._li=n,this._curSeg=c=this._segments[n],this._s2=c[this._s1=this._si=0]}else if(e<this._l1&&n>0){for(;n>0&&(this._l1=u[--n])>=e;);0===n&&e<this._l1?this._l1=0:n++,this._l2=u[n],this._li=n,this._curSeg=c=this._segments[n],this._s1=c[(this._si=c.length-1)-1]||0,this._s2=c[this._si]}if(r=n,e-=this._l1,n=this._si,e>this._s2&&n<c.length-1){for(l=c.length-1;n<l&&(this._s2=c[++n])<=e;);this._s1=c[n-1],this._si=n}else if(e<this._s1&&n>0){for(;n>0&&(this._s1=c[--n])>=e;);0===n&&e<this._s1?this._s1=0:n++,this._s2=c[n],this._si=n}s=(n+(e-this._s1)/(this._s2-this._s1))*this._prec||0}else s=(e-(r=e<0?0:e>=1?p-1:p*e>>0)*(1/p))*p;for(i=1-s,n=this._props.length;--n>-1;)o=this._props[n],h=(s*s*(a=this._beziers[o][r]).da+3*i*(s*a.ca+i*a.ba))*s+a.a,this._mod[o]&&(h=this._mod[o](h,f)),d[o]?f[o](h):f[o]=h;if(this._autoRotate){var v,y,g,_,x,b,w,T=this._autoRotate;for(n=T.length;--n>-1;)o=T[n][2],b=T[n][3]||0,w=!0===T[n][4]?1:t,a=this._beziers[T[n][0]],v=this._beziers[T[n][1]],a&&v&&(a=a[r],v=v[r],y=a.a+(a.b-a.a)*s,y+=((_=a.b+(a.c-a.b)*s)-y)*s,_+=(a.c+(a.d-a.c)*s-_)*s,g=v.a+(v.b-v.a)*s,g+=((x=v.b+(v.c-v.b)*s)-g)*s,x+=(v.c+(v.d-v.c)*s-x)*s,h=m?Math.atan2(x-g,_-y)*w+b:this._initialRotations[n],this._mod[o]&&(h=this._mod[o](h,f)),d[o]?f[o](h):f[o]=h)}}}),d=p.prototype,p.bezierThrough=u,p.cubicToQuadratic=s,p._autoCSS=!0,p.quadraticToCubic=function(t,e,r){return new a(t,(2*e+t)/3,(2*e+r)/3,r)},p._cssRegister=function(){var t=o.CSSPlugin;if(t){var e=t._internals,r=e._parseToProxy,i=e._setPluginRatio,n=e.CSSPropTween;e._registerComplexSpecialProp("bezier",{parser:function(t,e,o,a,s,h){e instanceof Array&&(e={values:e}),h=new p;var l,u,c,d=e.values,f=d.length-1,m=[],v={};if(f<0)return s;for(l=0;l<=f;l++)c=r(t,d[l],a,s,h,f!==l),m[l]=c.end;for(u in e)v[u]=e[u];return v.values=m,(s=new n(t,"bezier",0,0,c.pt,2)).data=c,s.plugin=h,s.setRatio=i,0===v.autoRotate&&(v.autoRotate=!0),!v.autoRotate||v.autoRotate instanceof Array||(l=!0===v.autoRotate?0:Number(v.autoRotate),v.autoRotate=null!=c.end.left?[["left","top","rotation",l,!1]]:null!=c.end.x&&[["x","y","rotation",l,!1]]),v.autoRotate&&(a._transform||a._enableTransforms(!1),c.autoRotate=a._target._gsTransform,c.proxy.rotation=c.autoRotate.rotation||0,a._overwriteProps.push("rotation")),h._onInitTween(c.proxy,v,a._tween),s}})}},d._mod=function(t){for(var e,r=this._overwriteProps,i=r.length;--i>-1;)(e=t[r[i]])&&"function"==typeof e&&(this._mod[r[i]]=e)},d._kill=function(t){var e,r,i=this._props;for(e in this._beziers)if(e in t)for(delete this._beziers[e],delete this._func[e],r=i.length;--r>-1;)i[r]===e&&i.splice(r,1);if(i=this._autoRotate)for(r=i.length;--r>-1;)t[i[r][2]]&&i.splice(r,1);return this._super._kill.call(this,t)},function(){var t=_gsScope._gsDefine.plugin({propName:"roundProps",version:"1.7.0",priority:-1,API:2,init:function(t,e,r){return this._tween=r,!0}}),e=function(t){var e=t<1?Math.pow(10,(t+"").length-2):1;return function(r){return(Math.round(r/t)*t*e|0)/e}},r=function(t,e){for(;t;)t.f||t.blob||(t.m=e||Math.round),t=t._next},i=t.prototype;i._onInitAllProps=function(){var t,i,n,o,a=this._tween,s=a.vars.roundProps,h={},l=a._propLookup.roundProps;if("object"!=typeof s||s.push)for("string"==typeof s&&(s=s.split(",")),n=s.length;--n>-1;)h[s[n]]=Math.round;else for(o in s)h[o]=e(s[o]);for(o in h)for(t=a._firstPT;t;)i=t._next,t.pg?t.t._mod(h):t.n===o&&(2===t.f&&t.t?r(t.t._firstPT,h[o]):(this._add(t.t,o,t.s,t.c,h[o]),i&&(i._prev=t._prev),t._prev?t._prev._next=i:a._firstPT===t&&(a._firstPT=i),t._next=t._prev=null,a._propLookup[o]=l)),t=i;return!1},i._add=function(t,e,r,i,n){this._addTween(t,e,r,r+i,e,n||Math.round),this._overwriteProps.push(e)}}(),_gsScope._gsDefine.plugin({propName:"attr",API:2,version:"0.6.1",init:function(t,e,r,i){var n,o;if("function"!=typeof t.setAttribute)return!1;for(n in e)"function"==typeof(o=e[n])&&(o=o(i,t)),this._addTween(t,"setAttribute",t.getAttribute(n)+"",o+"",n,!1,n),this._overwriteProps.push(n);return!0}}),_gsScope._gsDefine.plugin({propName:"directionalRotation",version:"0.3.1",API:2,init:function(t,e,r,i){"object"!=typeof e&&(e={rotation:e}),this.finals={};var n,o,a,s,h,l,u=!0===e.useRadians?2*Math.PI:360;for(n in e)"useRadians"!==n&&("function"==typeof(s=e[n])&&(s=s(i,t)),o=(l=(s+"").split("_"))[0],a=parseFloat("function"!=typeof t[n]?t[n]:t[n.indexOf("set")||"function"!=typeof t["get"+n.substr(3)]?n:"get"+n.substr(3)]()),h=(s=this.finals[n]="string"==typeof o&&"="===o.charAt(1)?a+parseInt(o.charAt(0)+"1",10)*Number(o.substr(2)):Number(o)||0)-a,l.length&&(-1!==(o=l.join("_")).indexOf("short")&&(h%=u)!==h%(u/2)&&(h=h<0?h+u:h-u),-1!==o.indexOf("_cw")&&h<0?h=(h+9999999999*u)%u-(h/u|0)*u:-1!==o.indexOf("ccw")&&h>0&&(h=(h-9999999999*u)%u-(h/u|0)*u)),(h>1e-6||h<-1e-6)&&(this._addTween(t,n,a,a+h,n),this._overwriteProps.push(n)));return!0},set:function(t){var e;if(1!==t)this._super.setRatio.call(this,t);else for(e=this._firstPT;e;)e.f?e.t[e.p](this.finals[e.p]):e.t[e.p]=this.finals[e.p],e=e._next}})._autoCSS=!0,_gsScope._gsDefine("easing.Back",["easing.Ease"],(function(t){var e,r,i,n,o=_gsScope.GreenSockGlobals||_gsScope,a=o.com.greensock,s=2*Math.PI,h=Math.PI/2,l=a._class,u=function(e,r){var i=l("easing."+e,(function(){}),!0),n=i.prototype=new t;return n.constructor=i,n.getRatio=r,i},c=t.register||function(){},p=function(t,e,r,i,n){var o=l("easing."+t,{easeOut:new e,easeIn:new r,easeInOut:new i},!0);return c(o,t),o},d=function(t,e,r){this.t=t,this.v=e,r&&(this.next=r,r.prev=this,this.c=r.v-e,this.gap=r.t-t)},f=function(e,r){var i=l("easing."+e,(function(t){this._p1=t||0===t?t:1.70158,this._p2=1.525*this._p1}),!0),n=i.prototype=new t;return n.constructor=i,n.getRatio=r,n.config=function(t){return new i(t)},i},m=p("Back",f("BackOut",(function(t){return(t-=1)*t*((this._p1+1)*t+this._p1)+1})),f("BackIn",(function(t){return t*t*((this._p1+1)*t-this._p1)})),f("BackInOut",(function(t){return(t*=2)<1?.5*t*t*((this._p2+1)*t-this._p2):.5*((t-=2)*t*((this._p2+1)*t+this._p2)+2)}))),v=l("easing.SlowMo",(function(t,e,r){e=e||0===e?e:.7,null==t?t=.7:t>1&&(t=1),this._p=1!==t?e:0,this._p1=(1-t)/2,this._p2=t,this._p3=this._p1+this._p2,this._calcEnd=!0===r}),!0),y=v.prototype=new t;return y.constructor=v,y.getRatio=function(t){var e=t+(.5-t)*this._p;return t<this._p1?this._calcEnd?1-(t=1-t/this._p1)*t:e-(t=1-t/this._p1)*t*t*t*e:t>this._p3?this._calcEnd?1===t?0:1-(t=(t-this._p3)/this._p1)*t:e+(t-e)*(t=(t-this._p3)/this._p1)*t*t*t:this._calcEnd?1:e},v.ease=new v(.7,.7),y.config=v.config=function(t,e,r){return new v(t,e,r)},(y=(e=l("easing.SteppedEase",(function(t,e){t=t||1,this._p1=1/t,this._p2=t+(e?0:1),this._p3=e?1:0}),!0)).prototype=new t).constructor=e,y.getRatio=function(t){return t<0?t=0:t>=1&&(t=.999999999),((this._p2*t|0)+this._p3)*this._p1},y.config=e.config=function(t,r){return new e(t,r)},(y=(r=l("easing.ExpoScaleEase",(function(t,e,r){this._p1=Math.log(e/t),this._p2=e-t,this._p3=t,this._ease=r}),!0)).prototype=new t).constructor=r,y.getRatio=function(t){return this._ease&&(t=this._ease.getRatio(t)),(this._p3*Math.exp(this._p1*t)-this._p3)/this._p2},y.config=r.config=function(t,e,i){return new r(t,e,i)},(y=(i=l("easing.RoughEase",(function(e){for(var r,i,n,o,a,s,h=(e=e||{}).taper||"none",l=[],u=0,c=0|(e.points||20),p=c,f=!1!==e.randomize,m=!0===e.clamp,v=e.template instanceof t?e.template:null,y="number"==typeof e.strength?.4*e.strength:.4;--p>-1;)r=f?Math.random():1/c*p,i=v?v.getRatio(r):r,n="none"===h?y:"out"===h?(o=1-r)*o*y:"in"===h?r*r*y:r<.5?(o=2*r)*o*.5*y:(o=2*(1-r))*o*.5*y,f?i+=Math.random()*n-.5*n:p%2?i+=.5*n:i-=.5*n,m&&(i>1?i=1:i<0&&(i=0)),l[u++]={x:r,y:i};for(l.sort((function(t,e){return t.x-e.x})),s=new d(1,1,null),p=c;--p>-1;)a=l[p],s=new d(a.x,a.y,s);this._prev=new d(0,0,0!==s.t?s:s.next)}),!0)).prototype=new t).constructor=i,y.getRatio=function(t){var e=this._prev;if(t>e.t){for(;e.next&&t>=e.t;)e=e.next;e=e.prev}else for(;e.prev&&t<=e.t;)e=e.prev;return this._prev=e,e.v+(t-e.t)/e.gap*e.c},y.config=function(t){return new i(t)},i.ease=new i,p("Bounce",u("BounceOut",(function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375})),u("BounceIn",(function(t){return(t=1-t)<1/2.75?1-7.5625*t*t:t<2/2.75?1-(7.5625*(t-=1.5/2.75)*t+.75):t<2.5/2.75?1-(7.5625*(t-=2.25/2.75)*t+.9375):1-(7.5625*(t-=2.625/2.75)*t+.984375)})),u("BounceInOut",(function(t){var e=t<.5;return(t=e?1-2*t:2*t-1)<1/2.75?t*=7.5625*t:t=t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375,e?.5*(1-t):.5*t+.5}))),p("Circ",u("CircOut",(function(t){return Math.sqrt(1-(t-=1)*t)})),u("CircIn",(function(t){return-(Math.sqrt(1-t*t)-1)})),u("CircInOut",(function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}))),p("Elastic",(n=function(e,r,i){var n=l("easing."+e,(function(t,e){this._p1=t>=1?t:1,this._p2=(e||i)/(t<1?t:1),this._p3=this._p2/s*(Math.asin(1/this._p1)||0),this._p2=s/this._p2}),!0),o=n.prototype=new t;return o.constructor=n,o.getRatio=r,o.config=function(t,e){return new n(t,e)},n})("ElasticOut",(function(t){return this._p1*Math.pow(2,-10*t)*Math.sin((t-this._p3)*this._p2)+1}),.3),n("ElasticIn",(function(t){return-this._p1*Math.pow(2,10*(t-=1))*Math.sin((t-this._p3)*this._p2)}),.3),n("ElasticInOut",(function(t){return(t*=2)<1?this._p1*Math.pow(2,10*(t-=1))*Math.sin((t-this._p3)*this._p2)*-.5:this._p1*Math.pow(2,-10*(t-=1))*Math.sin((t-this._p3)*this._p2)*.5+1}),.45)),p("Expo",u("ExpoOut",(function(t){return 1-Math.pow(2,-10*t)})),u("ExpoIn",(function(t){return Math.pow(2,10*(t-1))-.001})),u("ExpoInOut",(function(t){return(t*=2)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*(t-1)))}))),p("Sine",u("SineOut",(function(t){return Math.sin(t*h)})),u("SineIn",(function(t){return 1-Math.cos(t*h)})),u("SineInOut",(function(t){return-.5*(Math.cos(Math.PI*t)-1)}))),l("easing.EaseLookup",{find:function(e){return t.map[e]}},!0),c(o.SlowMo,"SlowMo","ease,"),c(i,"RoughEase","ease,"),c(e,"SteppedEase","ease,"),m}),!0)})),_gsScope._gsDefine&&_gsScope._gsQueue.pop()(),function(t,e){"use strict";var r={},i=t.document,n=t.GreenSockGlobals=t.GreenSockGlobals||t,o=n.TweenMax;if(o)return"undefined"!=typeof module&&module.exports&&(module.exports=o),o;var a,s,h,l,u,c,p,d=function(t){var e,r=t.split("."),i=n;for(e=0;e<r.length;e++)i[r[e]]=i=i[r[e]]||{};return i},f=d("com.greensock"),m=function(t){var e,r=[],i=t.length;for(e=0;e!==i;r.push(t[e++]));return r},v=function(){},y=(c=Object.prototype.toString,p=c.call([]),function(t){return null!=t&&(t instanceof Array||"object"==typeof t&&!!t.push&&c.call(t)===p)}),g={},_=function(e,i,o,a){this.sc=g[e]?g[e].sc:[],g[e]=this,this.gsClass=null,this.func=o;var s=[];this.check=function(h){for(var l,u,c,p,f=i.length,m=f;--f>-1;)(l=g[i[f]]||new _(i[f],[])).gsClass?(s[f]=l.gsClass,m--):h&&l.sc.push(this);if(0===m&&o){if(c=(u=("com.greensock."+e).split(".")).pop(),p=d(u.join("."))[c]=this.gsClass=o.apply(o,s),a)if(n[c]=r[c]=p,"undefined"!=typeof module&&module.exports)if("TweenMax"===e)for(f in module.exports=r.TweenMax=p,r)p[f]=r[f];else r.TweenMax&&(r.TweenMax[c]=p);else"function"==typeof define&&define.amd&&define((t.GreenSockAMDPath?t.GreenSockAMDPath+"/":"")+e.split(".").pop(),[],(function(){return p}));for(f=0;f<this.sc.length;f++)this.sc[f].check()}},this.check(!0)},x=t._gsDefine=function(t,e,r,i){return new _(t,e,r,i)},b=f._class=function(t,e,r){return e=e||function(){},x(t,[],(function(){return e}),r),e};x.globals=n;var w=[0,0,1,1],T=b("easing.Ease",(function(t,e,r,i){this._func=t,this._type=r||0,this._power=i||0,this._params=e?w.concat(e):w}),!0),E=T.map={},S=T.register=function(t,e,r,i){for(var n,o,a,s,h=e.split(","),l=h.length,u=(r||"easeIn,easeOut,easeInOut").split(",");--l>-1;)for(o=h[l],n=i?b("easing."+o,null,!0):f.easing[o]||{},a=u.length;--a>-1;)s=u[a],E[o+"."+s]=E[s+o]=n[s]=t.getRatio?t:t[s]||new t};for((h=T.prototype)._calcEnd=!1,h.getRatio=function(t){if(this._func)return this._params[0]=t,this._func.apply(null,this._params);var e=this._type,r=this._power,i=1===e?1-t:2===e?t:t<.5?2*t:2*(1-t);return 1===r?i*=i:2===r?i*=i*i:3===r?i*=i*i*i:4===r&&(i*=i*i*i*i),1===e?1-i:2===e?i:t<.5?i/2:1-i/2},s=(a=["Linear","Quad","Cubic","Quart","Quint,Strong"]).length;--s>-1;)h=a[s]+",Power"+s,S(new T(null,null,1,s),h,"easeOut",!0),S(new T(null,null,2,s),h,"easeIn"+(0===s?",easeNone":"")),S(new T(null,null,3,s),h,"easeInOut");E.linear=f.easing.Linear.easeIn,E.swing=f.easing.Quad.easeInOut;var A=b("events.EventDispatcher",(function(t){this._listeners={},this._eventTarget=t||this}));(h=A.prototype).addEventListener=function(t,e,r,i,n){n=n||0;var o,a,s=this._listeners[t],h=0;for(this!==l||u||l.wake(),null==s&&(this._listeners[t]=s=[]),a=s.length;--a>-1;)(o=s[a]).c===e&&o.s===r?s.splice(a,1):0===h&&o.pr<n&&(h=a+1);s.splice(h,0,{c:e,s:r,up:i,pr:n})},h.removeEventListener=function(t,e){var r,i=this._listeners[t];if(i)for(r=i.length;--r>-1;)if(i[r].c===e)return void i.splice(r,1)},h.dispatchEvent=function(t){var e,r,i,n=this._listeners[t];if(n)for((e=n.length)>1&&(n=n.slice(0)),r=this._eventTarget;--e>-1;)(i=n[e])&&(i.up?i.c.call(i.s||r,{type:t,target:r}):i.c.call(i.s||r))};var I=t.requestAnimationFrame,P=t.cancelAnimationFrame,M=Date.now||function(){return(new Date).getTime()},C=M();for(s=(a=["ms","moz","webkit","o"]).length;--s>-1&&!I;)I=t[a[s]+"RequestAnimationFrame"],P=t[a[s]+"CancelAnimationFrame"]||t[a[s]+"CancelRequestAnimationFrame"];b("Ticker",(function(t,e){var r,n,o,a,s,h=this,c=M(),p=!(!1===e||!I)&&"auto",d=500,f=33,m=function(t){var e,i,l=M()-C;l>d&&(c+=l-f),C+=l,h.time=(C-c)/1e3,e=h.time-s,(!r||e>0||!0===t)&&(h.frame++,s+=e+(e>=a?.004:a-e),i=!0),!0!==t&&(o=n(m)),i&&h.dispatchEvent("tick")};A.call(h),h.time=h.frame=0,h.tick=function(){m(!0)},h.lagSmoothing=function(t,e){if(!arguments.length)return d<1/1e-8;d=t||1/1e-8,f=Math.min(e,d,0)},h.sleep=function(){null!=o&&(p&&P?P(o):clearTimeout(o),n=v,o=null,h===l&&(u=!1))},h.wake=function(t){null!==o?h.sleep():t?c+=-C+(C=M()):h.frame>10&&(C=M()-d+5),n=0===r?v:p&&I?I:function(t){return setTimeout(t,1e3*(s-h.time)+1|0)},h===l&&(u=!0),m(2)},h.fps=function(t){if(!arguments.length)return r;a=1/((r=t)||60),s=this.time+a,h.wake()},h.useRAF=function(t){if(!arguments.length)return p;h.sleep(),p=t,h.fps(r)},h.fps(t),setTimeout((function(){"auto"===p&&h.frame<5&&"hidden"!==(i||{}).visibilityState&&h.useRAF(!1)}),1500)})),(h=f.Ticker.prototype=new f.events.EventDispatcher).constructor=f.Ticker;var R=b("core.Animation",(function(t,e){if(this.vars=e=e||{},this._duration=this._totalDuration=t||0,this._delay=Number(e.delay)||0,this._timeScale=1,this._active=!!e.immediateRender,this.data=e.data,this._reversed=!!e.reversed,Z){u||l.wake();var r=this.vars.useFrames?J:Z;r.add(this,r._time),this.vars.paused&&this.paused(!0)}}));l=R.ticker=new f.Ticker,(h=R.prototype)._dirty=h._gc=h._initted=h._paused=!1,h._totalTime=h._time=0,h._rawPrevTime=-1,h._next=h._last=h._onUpdate=h._timeline=h.timeline=null,h._paused=!1;var O=function(){u&&M()-C>2e3&&("hidden"!==(i||{}).visibilityState||!l.lagSmoothing())&&l.wake();var t=setTimeout(O,2e3);t.unref&&t.unref()};O(),h.play=function(t,e){return null!=t&&this.seek(t,e),this.reversed(!1).paused(!1)},h.pause=function(t,e){return null!=t&&this.seek(t,e),this.paused(!0)},h.resume=function(t,e){return null!=t&&this.seek(t,e),this.paused(!1)},h.seek=function(t,e){return this.totalTime(Number(t),!1!==e)},h.restart=function(t,e){return this.reversed(!1).paused(!1).totalTime(t?-this._delay:0,!1!==e,!0)},h.reverse=function(t,e){return null!=t&&this.seek(t||this.totalDuration(),e),this.reversed(!0).paused(!1)},h.render=function(t,e,r){},h.invalidate=function(){return this._time=this._totalTime=0,this._initted=this._gc=!1,this._rawPrevTime=-1,!this._gc&&this.timeline||this._enabled(!0),this},h.isActive=function(){var t,e=this._timeline,r=this._startTime;return!e||!this._gc&&!this._paused&&e.isActive()&&(t=e.rawTime(!0))>=r&&t<r+this.totalDuration()/this._timeScale-1e-8},h._enabled=function(t,e){return u||l.wake(),this._gc=!t,this._active=this.isActive(),!0!==e&&(t&&!this.timeline?this._timeline.add(this,this._startTime-this._delay):!t&&this.timeline&&this._timeline._remove(this,!0)),!1},h._kill=function(t,e){return this._enabled(!1,!1)},h.kill=function(t,e){return this._kill(t,e),this},h._uncache=function(t){for(var e=t?this:this.timeline;e;)e._dirty=!0,e=e.timeline;return this},h._swapSelfInParams=function(t){for(var e=t.length,r=t.concat();--e>-1;)"{self}"===t[e]&&(r[e]=this);return r},h._callback=function(t){var e=this.vars,r=e[t],i=e[t+"Params"],n=e[t+"Scope"]||e.callbackScope||this;switch(i?i.length:0){case 0:r.call(n);break;case 1:r.call(n,i[0]);break;case 2:r.call(n,i[0],i[1]);break;default:r.apply(n,i)}},h.eventCallback=function(t,e,r,i){if("on"===(t||"").substr(0,2)){var n=this.vars;if(1===arguments.length)return n[t];null==e?delete n[t]:(n[t]=e,n[t+"Params"]=y(r)&&-1!==r.join("").indexOf("{self}")?this._swapSelfInParams(r):r,n[t+"Scope"]=i),"onUpdate"===t&&(this._onUpdate=e)}return this},h.delay=function(t){return arguments.length?(this._timeline.smoothChildTiming&&this.startTime(this._startTime+t-this._delay),this._delay=t,this):this._delay},h.duration=function(t){return arguments.length?(this._duration=this._totalDuration=t,this._uncache(!0),this._timeline.smoothChildTiming&&this._time>0&&this._time<this._duration&&0!==t&&this.totalTime(this._totalTime*(t/this._duration),!0),this):(this._dirty=!1,this._duration)},h.totalDuration=function(t){return this._dirty=!1,arguments.length?this.duration(t):this._totalDuration},h.time=function(t,e){return arguments.length?(this._dirty&&this.totalDuration(),this.totalTime(t>this._duration?this._duration:t,e)):this._time},h.totalTime=function(t,e,r){if(u||l.wake(),!arguments.length)return this._totalTime;if(this._timeline){if(t<0&&!r&&(t+=this.totalDuration()),this._timeline.smoothChildTiming){this._dirty&&this.totalDuration();var i=this._totalDuration,n=this._timeline;if(t>i&&!r&&(t=i),this._startTime=(this._paused?this._pauseTime:n._time)-(this._reversed?i-t:t)/this._timeScale,n._dirty||this._uncache(!1),n._timeline)for(;n._timeline;)n._timeline._time!==(n._startTime+n._totalTime)/n._timeScale&&n.totalTime(n._totalTime,!0),n=n._timeline}this._gc&&this._enabled(!0,!1),this._totalTime===t&&0!==this._duration||(k.length&&K(),this.render(t,e,!1),k.length&&K())}return this},h.progress=h.totalProgress=function(t,e){var r=this.duration();return arguments.length?this.totalTime(r*t,e):r?this._time/r:this.ratio},h.startTime=function(t){return arguments.length?(t!==this._startTime&&(this._startTime=t,this.timeline&&this.timeline._sortChildren&&this.timeline.add(this,t-this._delay)),this):this._startTime},h.endTime=function(t){return this._startTime+(0!=t?this.totalDuration():this.duration())/this._timeScale},h.timeScale=function(t){if(!arguments.length)return this._timeScale;var e,r;for(t=t||1e-8,this._timeline&&this._timeline.smoothChildTiming&&(r=(e=this._pauseTime)||0===e?e:this._timeline.totalTime(),this._startTime=r-(r-this._startTime)*this._timeScale/t),this._timeScale=t,r=this.timeline;r&&r.timeline;)r._dirty=!0,r.totalDuration(),r=r.timeline;return this},h.reversed=function(t){return arguments.length?(t!=this._reversed&&(this._reversed=t,this.totalTime(this._timeline&&!this._timeline.smoothChildTiming?this.totalDuration()-this._totalTime:this._totalTime,!0)),this):this._reversed},h.paused=function(t){if(!arguments.length)return this._paused;var e,r,i=this._timeline;return t!=this._paused&&i&&(u||t||l.wake(),r=(e=i.rawTime())-this._pauseTime,!t&&i.smoothChildTiming&&(this._startTime+=r,this._uncache(!1)),this._pauseTime=t?e:null,this._paused=t,this._active=this.isActive(),!t&&0!==r&&this._initted&&this.duration()&&(e=i.smoothChildTiming?this._totalTime:(e-this._startTime)/this._timeScale,this.render(e,e===this._totalTime,!0))),this._gc&&!t&&this._enabled(!0,!1),this};var D=b("core.SimpleTimeline",(function(t){R.call(this,0,t),this.autoRemoveChildren=this.smoothChildTiming=!0}));(h=D.prototype=new R).constructor=D,h.kill()._gc=!1,h._first=h._last=h._recent=null,h._sortChildren=!1,h.add=h.insert=function(t,e,r,i){var n,o;if(t._startTime=Number(e||0)+t._delay,t._paused&&this!==t._timeline&&(t._pauseTime=this.rawTime()-(t._timeline.rawTime()-t._pauseTime)),t.timeline&&t.timeline._remove(t,!0),t.timeline=t._timeline=this,t._gc&&t._enabled(!0,!0),n=this._last,this._sortChildren)for(o=t._startTime;n&&n._startTime>o;)n=n._prev;return n?(t._next=n._next,n._next=t):(t._next=this._first,this._first=t),t._next?t._next._prev=t:this._last=t,t._prev=n,this._recent=t,this._timeline&&this._uncache(!0),this},h._remove=function(t,e){return t.timeline===this&&(e||t._enabled(!1,!0),t._prev?t._prev._next=t._next:this._first===t&&(this._first=t._next),t._next?t._next._prev=t._prev:this._last===t&&(this._last=t._prev),t._next=t._prev=t.timeline=null,t===this._recent&&(this._recent=this._last),this._timeline&&this._uncache(!0)),this},h.render=function(t,e,r){var i,n=this._first;for(this._totalTime=this._time=this._rawPrevTime=t;n;)i=n._next,(n._active||t>=n._startTime&&!n._paused&&!n._gc)&&(n._reversed?n.render((n._dirty?n.totalDuration():n._totalDuration)-(t-n._startTime)*n._timeScale,e,r):n.render((t-n._startTime)*n._timeScale,e,r)),n=i},h.rawTime=function(){return u||l.wake(),this._totalTime};var B=b("TweenLite",(function(e,r,i){if(R.call(this,r,i),this.render=B.prototype.render,null==e)throw"Cannot tween a null target.";this.target=e="string"!=typeof e?e:B.selector(e)||e;var n,o,a,s=e.jquery||e.length&&e!==t&&e[0]&&(e[0]===t||e[0].nodeType&&e[0].style&&!e.nodeType),h=this.vars.overwrite;if(this._overwrite=h=null==h?$[B.defaultOverwrite]:"number"==typeof h?h>>0:$[h],(s||e instanceof Array||e.push&&y(e))&&"number"!=typeof e[0])for(this._targets=a=m(e),this._propLookup=[],this._siblings=[],n=0;n<a.length;n++)(o=a[n])?"string"!=typeof o?o.length&&o!==t&&o[0]&&(o[0]===t||o[0].nodeType&&o[0].style&&!o.nodeType)?(a.splice(n--,1),this._targets=a=a.concat(m(o))):(this._siblings[n]=tt(o,this,!1),1===h&&this._siblings[n].length>1&&rt(o,this,null,1,this._siblings[n])):"string"==typeof(o=a[n--]=B.selector(o))&&a.splice(n+1,1):a.splice(n--,1);else this._propLookup={},this._siblings=tt(e,this,!1),1===h&&this._siblings.length>1&&rt(e,this,null,1,this._siblings);(this.vars.immediateRender||0===r&&0===this._delay&&!1!==this.vars.immediateRender)&&(this._time=-1e-8,this.render(Math.min(0,-this._delay)))}),!0),N=function(e){return e&&e.length&&e!==t&&e[0]&&(e[0]===t||e[0].nodeType&&e[0].style&&!e.nodeType)};(h=B.prototype=new R).constructor=B,h.kill()._gc=!1,h.ratio=0,h._firstPT=h._targets=h._overwrittenProps=h._startAt=null,h._notifyPluginsOfEnabled=h._lazy=!1,B.version="2.1.2",B.defaultEase=h._ease=new T(null,null,1,1),B.defaultOverwrite="auto",B.ticker=l,B.autoSleep=120,B.lagSmoothing=function(t,e){l.lagSmoothing(t,e)},B.selector=t.$||t.jQuery||function(e){var r=t.$||t.jQuery;return r?(B.selector=r,r(e)):(i||(i=t.document),i?i.querySelectorAll?i.querySelectorAll(e):i.getElementById("#"===e.charAt(0)?e.substr(1):e):e)};var k=[],F={},L=/(?:(-|-=|\+=)?\d*\.?\d*(?:e[\-+]?\d+)?)[0-9]/gi,V=/[\+-]=-?[\.\d]/,X=function(t){for(var e,r=this._firstPT;r;)e=r.blob?1===t&&null!=this.end?this.end:t?this.join(""):this.start:r.c*t+r.s,r.m?e=r.m.call(this._tween,e,this._target||r.t,this._tween):e<1e-6&&e>-1e-6&&!r.blob&&(e=0),r.f?r.fp?r.t[r.p](r.fp,e):r.t[r.p](e):r.t[r.p]=e,r=r._next},j=function(t){return(1e3*t|0)/1e3+""},U=function(t,e,r,i){var n,o,a,s,h,l,u,c=[],p=0,d="",f=0;for(c.start=t,c.end=e,t=c[0]=t+"",e=c[1]=e+"",r&&(r(c),t=c[0],e=c[1]),c.length=0,n=t.match(L)||[],o=e.match(L)||[],i&&(i._next=null,i.blob=1,c._firstPT=c._applyPT=i),h=o.length,s=0;s<h;s++)u=o[s],d+=(l=e.substr(p,e.indexOf(u,p)-p))||!s?l:",",p+=l.length,f?f=(f+1)%5:"rgba("===l.substr(-5)&&(f=1),u===n[s]||n.length<=s?d+=u:(d&&(c.push(d),d=""),a=parseFloat(n[s]),c.push(a),c._firstPT={_next:c._firstPT,t:c,p:c.length-1,s:a,c:("="===u.charAt(1)?parseInt(u.charAt(0)+"1",10)*parseFloat(u.substr(2)):parseFloat(u)-a)||0,f:0,m:f&&f<4?Math.round:j}),p+=u.length;return(d+=e.substr(p))&&c.push(d),c.setRatio=X,V.test(e)&&(c.end=null),c},Y=function(t,e,r,i,n,o,a,s,h){"function"==typeof i&&(i=i(h||0,t));var l=typeof t[e],u="function"!==l?"":e.indexOf("set")||"function"!=typeof t["get"+e.substr(3)]?e:"get"+e.substr(3),c="get"!==r?r:u?a?t[u](a):t[u]():t[e],p="string"==typeof i&&"="===i.charAt(1),d={t:t,p:e,s:c,f:"function"===l,pg:0,n:n||e,m:o?"function"==typeof o?o:Math.round:0,pr:0,c:p?parseInt(i.charAt(0)+"1",10)*parseFloat(i.substr(2)):parseFloat(i)-c||0};if(("number"!=typeof c||"number"!=typeof i&&!p)&&(a||isNaN(c)||!p&&isNaN(i)||"boolean"==typeof c||"boolean"==typeof i?(d.fp=a,d={t:U(c,p?parseFloat(d.s)+d.c+(d.s+"").replace(/[0-9\-\.]/g,""):i,s||B.defaultStringFilter,d),p:"setRatio",s:0,c:1,f:2,pg:0,n:n||e,pr:0,m:0}):(d.s=parseFloat(c),p||(d.c=parseFloat(i)-d.s||0))),d.c)return(d._next=this._firstPT)&&(d._next._prev=d),this._firstPT=d,d},z=B._internals={isArray:y,isSelector:N,lazyTweens:k,blobDif:U},W=B._plugins={},q=z.tweenLookup={},G=0,H=z.reservedProps={ease:1,delay:1,overwrite:1,onComplete:1,onCompleteParams:1,onCompleteScope:1,useFrames:1,runBackwards:1,startAt:1,onUpdate:1,onUpdateParams:1,onUpdateScope:1,onStart:1,onStartParams:1,onStartScope:1,onReverseComplete:1,onReverseCompleteParams:1,onReverseCompleteScope:1,onRepeat:1,onRepeatParams:1,onRepeatScope:1,easeParams:1,yoyo:1,immediateRender:1,repeat:1,repeatDelay:1,data:1,paused:1,reversed:1,autoCSS:1,lazy:1,onOverwrite:1,callbackScope:1,stringFilter:1,id:1,yoyoEase:1,stagger:1},$={none:0,all:1,auto:2,concurrent:3,allOnStart:4,preexisting:5,true:1,false:0},J=R._rootFramesTimeline=new D,Z=R._rootTimeline=new D,Q=30,K=z.lazyRender=function(){var t,e,r=k.length;for(F={},t=0;t<r;t++)(e=k[t])&&!1!==e._lazy&&(e.render(e._lazy[0],e._lazy[1],!0),e._lazy=!1);k.length=0};Z._startTime=l.time,J._startTime=l.frame,Z._active=J._active=!0,setTimeout(K,1),R._updateRoot=B.render=function(){var t,e,r;if(k.length&&K(),Z.render((l.time-Z._startTime)*Z._timeScale,!1,!1),J.render((l.frame-J._startTime)*J._timeScale,!1,!1),k.length&&K(),l.frame>=Q){for(r in Q=l.frame+(parseInt(B.autoSleep,10)||120),q){for(t=(e=q[r].tweens).length;--t>-1;)e[t]._gc&&e.splice(t,1);0===e.length&&delete q[r]}if((!(r=Z._first)||r._paused)&&B.autoSleep&&!J._first&&1===l._listeners.tick.length){for(;r&&r._paused;)r=r._next;r||l.sleep()}}},l.addEventListener("tick",R._updateRoot);var tt=function(t,e,r){var i,n,o=t._gsTweenID;if(q[o||(t._gsTweenID=o="t"+G++)]||(q[o]={target:t,tweens:[]}),e&&((i=q[o].tweens)[n=i.length]=e,r))for(;--n>-1;)i[n]===e&&i.splice(n,1);return q[o].tweens},et=function(t,e,r,i){var n,o,a=t.vars.onOverwrite;return a&&(n=a(t,e,r,i)),(a=B.onOverwrite)&&(o=a(t,e,r,i)),!1!==n&&!1!==o},rt=function(t,e,r,i,n){var o,a,s,h;if(1===i||i>=4){for(h=n.length,o=0;o<h;o++)if((s=n[o])!==e)s._gc||s._kill(null,t,e)&&(a=!0);else if(5===i)break;return a}var l,u=e._startTime+1e-8,c=[],p=0,d=0===e._duration;for(o=n.length;--o>-1;)(s=n[o])===e||s._gc||s._paused||(s._timeline!==e._timeline?(l=l||it(e,0,d),0===it(s,l,d)&&(c[p++]=s)):s._startTime<=u&&s._startTime+s.totalDuration()/s._timeScale>u&&((d||!s._initted)&&u-s._startTime<=2e-8||(c[p++]=s)));for(o=p;--o>-1;)if(h=(s=c[o])._firstPT,2===i&&s._kill(r,t,e)&&(a=!0),2!==i||!s._firstPT&&s._initted&&h){if(2!==i&&!et(s,e))continue;s._enabled(!1,!1)&&(a=!0)}return a},it=function(t,e,r){for(var i=t._timeline,n=i._timeScale,o=t._startTime;i._timeline;){if(o+=i._startTime,n*=i._timeScale,i._paused)return-100;i=i._timeline}return(o/=n)>e?o-e:r&&o===e||!t._initted&&o-e<2e-8?1e-8:(o+=t.totalDuration()/t._timeScale/n)>e+1e-8?0:o-e-1e-8};h._init=function(){var t,e,r,i,n,o,a=this.vars,s=this._overwrittenProps,h=this._duration,l=!!a.immediateRender,u=a.ease,c=this._startAt;if(a.startAt){for(i in c&&(c.render(-1,!0),c.kill()),n={},a.startAt)n[i]=a.startAt[i];if(n.data="isStart",n.overwrite=!1,n.immediateRender=!0,n.lazy=l&&!1!==a.lazy,n.startAt=n.delay=null,n.onUpdate=a.onUpdate,n.onUpdateParams=a.onUpdateParams,n.onUpdateScope=a.onUpdateScope||a.callbackScope||this,this._startAt=B.to(this.target||{},0,n),l)if(this._time>0)this._startAt=null;else if(0!==h)return}else if(a.runBackwards&&0!==h)if(c)c.render(-1,!0),c.kill(),this._startAt=null;else{for(i in 0!==this._time&&(l=!1),r={},a)H[i]&&"autoCSS"!==i||(r[i]=a[i]);if(r.overwrite=0,r.data="isFromStart",r.lazy=l&&!1!==a.lazy,r.immediateRender=l,this._startAt=B.to(this.target,0,r),l){if(0===this._time)return}else this._startAt._init(),this._startAt._enabled(!1),this.vars.immediateRender&&(this._startAt=null)}if(this._ease=u=u?u instanceof T?u:"function"==typeof u?new T(u,a.easeParams):E[u]||B.defaultEase:B.defaultEase,a.easeParams instanceof Array&&u.config&&(this._ease=u.config.apply(u,a.easeParams)),this._easeType=this._ease._type,this._easePower=this._ease._power,this._firstPT=null,this._targets)for(o=this._targets.length,t=0;t<o;t++)this._initProps(this._targets[t],this._propLookup[t]={},this._siblings[t],s?s[t]:null,t)&&(e=!0);else e=this._initProps(this.target,this._propLookup,this._siblings,s,0);if(e&&B._onPluginEvent("_onInitAllProps",this),s&&(this._firstPT||"function"!=typeof this.target&&this._enabled(!1,!1)),a.runBackwards)for(r=this._firstPT;r;)r.s+=r.c,r.c=-r.c,r=r._next;this._onUpdate=a.onUpdate,this._initted=!0},h._initProps=function(e,r,i,n,o){var a,s,h,l,u,c;if(null==e)return!1;for(a in F[e._gsTweenID]&&K(),this.vars.css||e.style&&e!==t&&e.nodeType&&W.css&&!1!==this.vars.autoCSS&&function(t,e){var r,i={};for(r in t)H[r]||r in e&&"transform"!==r&&"x"!==r&&"y"!==r&&"width"!==r&&"height"!==r&&"className"!==r&&"border"!==r||!(!W[r]||W[r]&&W[r]._autoCSS)||(i[r]=t[r],delete t[r]);t.css=i}(this.vars,e),this.vars)if(c=this.vars[a],H[a])c&&(c instanceof Array||c.push&&y(c))&&-1!==c.join("").indexOf("{self}")&&(this.vars[a]=c=this._swapSelfInParams(c,this));else if(W[a]&&(l=new W[a])._onInitTween(e,this.vars[a],this,o)){for(this._firstPT=u={_next:this._firstPT,t:l,p:"setRatio",s:0,c:1,f:1,n:a,pg:1,pr:l._priority,m:0},s=l._overwriteProps.length;--s>-1;)r[l._overwriteProps[s]]=this._firstPT;(l._priority||l._onInitAllProps)&&(h=!0),(l._onDisable||l._onEnable)&&(this._notifyPluginsOfEnabled=!0),u._next&&(u._next._prev=u)}else r[a]=Y.call(this,e,a,"get",c,a,0,null,this.vars.stringFilter,o);return n&&this._kill(n,e)?this._initProps(e,r,i,n,o):this._overwrite>1&&this._firstPT&&i.length>1&&rt(e,this,r,this._overwrite,i)?(this._kill(r,e),this._initProps(e,r,i,n,o)):(this._firstPT&&(!1!==this.vars.lazy&&this._duration||this.vars.lazy&&!this._duration)&&(F[e._gsTweenID]=!0),h)},h.render=function(t,e,r){var i,n,o,a,s=this._time,h=this._duration,l=this._rawPrevTime;if(t>=h-1e-8&&t>=0)this._totalTime=this._time=h,this.ratio=this._ease._calcEnd?this._ease.getRatio(1):1,this._reversed||(i=!0,n="onComplete",r=r||this._timeline.autoRemoveChildren),0===h&&(this._initted||!this.vars.lazy||r)&&(this._startTime===this._timeline._duration&&(t=0),(l<0||t<=0&&t>=-1e-8||1e-8===l&&"isPause"!==this.data)&&l!==t&&(r=!0,l>1e-8&&(n="onReverseComplete")),this._rawPrevTime=a=!e||t||l===t?t:1e-8);else if(t<1e-8)this._totalTime=this._time=0,this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0,(0!==s||0===h&&l>0)&&(n="onReverseComplete",i=this._reversed),t>-1e-8?t=0:t<0&&(this._active=!1,0===h&&(this._initted||!this.vars.lazy||r)&&(l>=0&&(1e-8!==l||"isPause"!==this.data)&&(r=!0),this._rawPrevTime=a=!e||t||l===t?t:1e-8)),(!this._initted||this._startAt&&this._startAt.progress())&&(r=!0);else if(this._totalTime=this._time=t,this._easeType){var u=t/h,c=this._easeType,p=this._easePower;(1===c||3===c&&u>=.5)&&(u=1-u),3===c&&(u*=2),1===p?u*=u:2===p?u*=u*u:3===p?u*=u*u*u:4===p&&(u*=u*u*u*u),this.ratio=1===c?1-u:2===c?u:t/h<.5?u/2:1-u/2}else this.ratio=this._ease.getRatio(t/h);if(this._time!==s||r){if(!this._initted){if(this._init(),!this._initted||this._gc)return;if(!r&&this._firstPT&&(!1!==this.vars.lazy&&this._duration||this.vars.lazy&&!this._duration))return this._time=this._totalTime=s,this._rawPrevTime=l,k.push(this),void(this._lazy=[t,e]);this._time&&!i?this.ratio=this._ease.getRatio(this._time/h):i&&this._ease._calcEnd&&(this.ratio=this._ease.getRatio(0===this._time?0:1))}for(!1!==this._lazy&&(this._lazy=!1),this._active||!this._paused&&this._time!==s&&t>=0&&(this._active=!0),0===s&&(this._startAt&&(t>=0?this._startAt.render(t,!0,r):n||(n="_dummyGS")),this.vars.onStart&&(0===this._time&&0!==h||e||this._callback("onStart"))),o=this._firstPT;o;)o.f?o.t[o.p](o.c*this.ratio+o.s):o.t[o.p]=o.c*this.ratio+o.s,o=o._next;this._onUpdate&&(t<0&&this._startAt&&-1e-4!==t&&this._startAt.render(t,!0,r),e||(this._time!==s||i||r)&&this._callback("onUpdate")),n&&(this._gc&&!r||(t<0&&this._startAt&&!this._onUpdate&&-1e-4!==t&&this._startAt.render(t,!0,r),i&&(this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!e&&this.vars[n]&&this._callback(n),0===h&&1e-8===this._rawPrevTime&&1e-8!==a&&(this._rawPrevTime=0)))}},h._kill=function(t,e,r){if("all"===t&&(t=null),null==t&&(null==e||e===this.target))return this._lazy=!1,this._enabled(!1,!1);e="string"!=typeof e?e||this._targets||this.target:B.selector(e)||e;var i,n,o,a,s,h,l,u,c,p=r&&this._time&&r._startTime===this._startTime&&this._timeline===r._timeline,d=this._firstPT;if((y(e)||N(e))&&"number"!=typeof e[0])for(i=e.length;--i>-1;)this._kill(t,e[i],r)&&(h=!0);else{if(this._targets){for(i=this._targets.length;--i>-1;)if(e===this._targets[i]){s=this._propLookup[i]||{},this._overwrittenProps=this._overwrittenProps||[],n=this._overwrittenProps[i]=t?this._overwrittenProps[i]||{}:"all";break}}else{if(e!==this.target)return!1;s=this._propLookup,n=this._overwrittenProps=t?this._overwrittenProps||{}:"all"}if(s){if(l=t||s,u=t!==n&&"all"!==n&&t!==s&&("object"!=typeof t||!t._tempKill),r&&(B.onOverwrite||this.vars.onOverwrite)){for(o in l)s[o]&&(c||(c=[]),c.push(o));if((c||!t)&&!et(this,r,e,c))return!1}for(o in l)(a=s[o])&&(p&&(a.f?a.t[a.p](a.s):a.t[a.p]=a.s,h=!0),a.pg&&a.t._kill(l)&&(h=!0),a.pg&&0!==a.t._overwriteProps.length||(a._prev?a._prev._next=a._next:a===this._firstPT&&(this._firstPT=a._next),a._next&&(a._next._prev=a._prev),a._next=a._prev=null),delete s[o]),u&&(n[o]=1);!this._firstPT&&this._initted&&d&&this._enabled(!1,!1)}}return h},h.invalidate=function(){this._notifyPluginsOfEnabled&&B._onPluginEvent("_onDisable",this);var t=this._time;return this._firstPT=this._overwrittenProps=this._startAt=this._onUpdate=null,this._notifyPluginsOfEnabled=this._active=this._lazy=!1,this._propLookup=this._targets?{}:[],R.prototype.invalidate.call(this),this.vars.immediateRender&&(this._time=-1e-8,this.render(t,!1,!1!==this.vars.lazy)),this},h._enabled=function(t,e){if(u||l.wake(),t&&this._gc){var r,i=this._targets;if(i)for(r=i.length;--r>-1;)this._siblings[r]=tt(i[r],this,!0);else this._siblings=tt(this.target,this,!0)}return R.prototype._enabled.call(this,t,e),!(!this._notifyPluginsOfEnabled||!this._firstPT)&&B._onPluginEvent(t?"_onEnable":"_onDisable",this)},B.to=function(t,e,r){return new B(t,e,r)},B.from=function(t,e,r){return r.runBackwards=!0,r.immediateRender=0!=r.immediateRender,new B(t,e,r)},B.fromTo=function(t,e,r,i){return i.startAt=r,i.immediateRender=0!=i.immediateRender&&0!=r.immediateRender,new B(t,e,i)},B.delayedCall=function(t,e,r,i,n){return new B(e,0,{delay:t,onComplete:e,onCompleteParams:r,callbackScope:i,onReverseComplete:e,onReverseCompleteParams:r,immediateRender:!1,lazy:!1,useFrames:n,overwrite:0})},B.set=function(t,e){return new B(t,0,e)},B.getTweensOf=function(t,e){if(null==t)return[];var r,i,n,o;if(t="string"!=typeof t?t:B.selector(t)||t,(y(t)||N(t))&&"number"!=typeof t[0]){for(r=t.length,i=[];--r>-1;)i=i.concat(B.getTweensOf(t[r],e));for(r=i.length;--r>-1;)for(o=i[r],n=r;--n>-1;)o===i[n]&&i.splice(r,1)}else if(t._gsTweenID)for(r=(i=tt(t).concat()).length;--r>-1;)(i[r]._gc||e&&!i[r].isActive())&&i.splice(r,1);return i||[]},B.killTweensOf=B.killDelayedCallsTo=function(t,e,r){"object"==typeof e&&(r=e,e=!1);for(var i=B.getTweensOf(t,e),n=i.length;--n>-1;)i[n]._kill(r,t)};var nt=b("plugins.TweenPlugin",(function(t,e){this._overwriteProps=(t||"").split(","),this._propName=this._overwriteProps[0],this._priority=e||0,this._super=nt.prototype}),!0);if(h=nt.prototype,nt.version="1.19.0",nt.API=2,h._firstPT=null,h._addTween=Y,h.setRatio=X,h._kill=function(t){var e,r=this._overwriteProps,i=this._firstPT;if(null!=t[this._propName])this._overwriteProps=[];else for(e=r.length;--e>-1;)null!=t[r[e]]&&r.splice(e,1);for(;i;)null!=t[i.n]&&(i._next&&(i._next._prev=i._prev),i._prev?(i._prev._next=i._next,i._prev=null):this._firstPT===i&&(this._firstPT=i._next)),i=i._next;return!1},h._mod=h._roundProps=function(t){for(var e,r=this._firstPT;r;)(e=t[this._propName]||null!=r.n&&t[r.n.split(this._propName+"_").join("")])&&"function"==typeof e&&(2===r.f?r.t._applyPT.m=e:r.m=e),r=r._next},B._onPluginEvent=function(t,e){var r,i,n,o,a,s=e._firstPT;if("_onInitAllProps"===t){for(;s;){for(a=s._next,i=n;i&&i.pr>s.pr;)i=i._next;(s._prev=i?i._prev:o)?s._prev._next=s:n=s,(s._next=i)?i._prev=s:o=s,s=a}s=e._firstPT=n}for(;s;)s.pg&&"function"==typeof s.t[t]&&s.t[t]()&&(r=!0),s=s._next;return r},nt.activate=function(t){for(var e=t.length;--e>-1;)t[e].API===nt.API&&(W[(new t[e])._propName]=t[e]);return!0},x.plugin=function(t){if(!(t&&t.propName&&t.init&&t.API))throw"illegal plugin definition.";var e,r=t.propName,i=t.priority||0,n=t.overwriteProps,o={init:"_onInitTween",set:"setRatio",kill:"_kill",round:"_mod",mod:"_mod",initAll:"_onInitAllProps"},a=b("plugins."+r.charAt(0).toUpperCase()+r.substr(1)+"Plugin",(function(){nt.call(this,r,i),this._overwriteProps=n||[]}),!0===t.global),s=a.prototype=new nt(r);for(e in s.constructor=a,a.API=t.API,o)"function"==typeof t[e]&&(s[o[e]]=t[e]);return a.version=t.version,nt.activate([a]),a},a=t._gsQueue){for(s=0;s<a.length;s++)a[s]();for(h in g)g[h].func||t.console.log("GSAP encountered missing dependency: "+h)}u=!1}("undefined"!=typeof module&&module.exports&&"undefined"!=typeof global?global:this||window),((_gsScope="undefined"!=typeof module&&module.exports&&"undefined"!=typeof global?global:this||window)._gsQueue||(_gsScope._gsQueue=[])).push((function(){"use strict";var t,e,r,i=/(\d|\.)+/g,n=/(?:\d|\-\d|\.\d|\-\.\d|\+=\d|\-=\d|\+=.\d|\-=\.\d)+/g,o={aqua:[0,255,255],lime:[0,255,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,255],navy:[0,0,128],white:[255,255,255],fuchsia:[255,0,255],olive:[128,128,0],yellow:[255,255,0],orange:[255,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[255,0,0],pink:[255,192,203],cyan:[0,255,255],transparent:[255,255,255,0]},a=function(t,e,r){return 255*(6*(t=t<0?t+1:t>1?t-1:t)<1?e+(r-e)*t*6:t<.5?r:3*t<2?e+(r-e)*(2/3-t)*6:e)+.5|0},s=function(t,e){var r,s,h,l,u,c,p,d,f,m,v,y="hsl"===e;if(t)if("number"==typeof t)r=[t>>16,t>>8&255,255&t];else{if(","===t.charAt(t.length-1)&&(t=t.substr(0,t.length-1)),o[t])r=o[t];else if("#"===t.charAt(0))4===t.length&&(s=t.charAt(1),h=t.charAt(2),l=t.charAt(3),t="#"+s+s+h+h+l+l),r=[(t=parseInt(t.substr(1),16))>>16,t>>8&255,255&t];else if("hsl"===t.substr(0,3))if(r=v=t.match(i),y){if(-1!==t.indexOf("="))return t.match(n)}else u=Number(r[0])%360/360,c=Number(r[1])/100,s=2*(p=Number(r[2])/100)-(h=p<=.5?p*(c+1):p+c-p*c),r.length>3&&(r[3]=Number(t[3])),r[0]=a(u+1/3,s,h),r[1]=a(u,s,h),r[2]=a(u-1/3,s,h);else r=t.match(i)||o.transparent;r[0]=Number(r[0]),r[1]=Number(r[1]),r[2]=Number(r[2]),r.length>3&&(r[3]=Number(r[3]))}else r=o.black;return y&&!v&&(s=r[0]/255,h=r[1]/255,l=r[2]/255,p=((d=Math.max(s,h,l))+(f=Math.min(s,h,l)))/2,d===f?u=c=0:(m=d-f,c=p>.5?m/(2-d-f):m/(d+f),u=d===s?(h-l)/m+(h<l?6:0):d===h?(l-s)/m+2:(s-h)/m+4,u*=60),r[0]=u+.5|0,r[1]=100*c+.5|0,r[2]=100*p+.5|0),"number"===e?r[0]<<16|r[1]<<8|r[2]:r},h=function(t,e){var r,i,n,o=(t+"").match(u)||[],a=0,h="";if(!o.length)return t;for(r=0;r<o.length;r++)i=o[r],a+=(n=t.substr(a,t.indexOf(i,a)-a)).length+i.length,3===(i=s(i,e?"hsl":"rgb")).length&&i.push(1),h+=n+(e?"hsla("+i[0]+","+i[1]+"%,"+i[2]+"%,"+i[3]:"rgba("+i.join(","))+")";return h+t.substr(a)},l=(_gsScope.GreenSockGlobals||_gsScope).TweenLite,u="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3}){1,2}\\b",c=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],p=.212671,d=.71516,f=.072169,m=function(t,e){var r,i,n=[],o=0,a=0;for(r=0;r<4;r++){for(i=0;i<5;i++)a=4===i?t[o+4]:0,n[o+i]=t[o]*e[i]+t[o+1]*e[i+5]+t[o+2]*e[i+10]+t[o+3]*e[i+15]+a;o+=5}return n},v=function(t,e){var r=1-e,i=r*p,n=r*d,o=r*f;return m([i+e,n,o,0,0,i,n+e,o,0,0,i,n,o+e,0,0,0,0,0,1,0],t)},y=function(t,e,r){var i=s(e),n=i[0]/255,o=i[1]/255,a=i[2]/255,h=1-r;return m([h+r*n*p,r*n*d,r*n*f,0,0,r*o*p,h+r*o*d,r*o*f,0,0,r*a*p,r*a*d,h+r*a*f,0,0,0,0,0,1,0],t)},g=function(t,e){e*=Math.PI/180;var r=Math.cos(e),i=Math.sin(e);return m([p+r*(1-p)+i*-p,d+r*-d+i*-d,f+r*-f+i*(1-f),0,0,p+r*-p+.143*i,d+r*(1-d)+.14*i,f+r*-f+-.283*i,0,0,p+r*-p+i*-(1-p),d+r*-d+i*d,f+r*(1-f)+i*f,0,0,0,0,0,1,0,0,0,0,0,1],t)},_=function(t,e){return m([e,0,0,0,.5*(1-e),0,e,0,0,.5*(1-e),0,0,e,0,.5*(1-e),0,0,0,1,0],t)},x=function(t,e){var r,i=_gsScope.PIXI.filters[e],n=t.filters||[],o=n.length;if(!i)throw"PixiPlugin error: "+e+" isn't present.";for(;--o>-1;)if(n[o]instanceof i)return n[o];return r=new i,"BlurFilter"===e&&(r.blur=0),n.push(r),t.filters=n,r},b=function(t,e,r,i){e._addTween(r,t,r[t],i[t],t),e._overwriteProps.push(t)},w=function(t,e){var r=new _gsScope.PIXI.filters.ColorMatrixFilter;return r.matrix=e,r.brightness(t,!0),r.matrix},T={contrast:1,saturation:1,colorizeAmount:0,colorize:"rgb(255,255,255)",hue:0,brightness:1},E=function(t,e,r){var i,n,o,a=x(t,"ColorMatrixFilter"),s=t._gsColorMatrixFilter=t._gsColorMatrixFilter||{contrast:1,saturation:1,colorizeAmount:0,colorize:"rgb(255,255,255)",hue:0,brightness:1},h=e.combineCMF&&!("colorMatrixFilter"in e&&!e.colorMatrixFilter);o=a.matrix,e.resolution&&(a.resolution=e.resolution),e.matrix&&e.matrix.length===o.length?(n=e.matrix,1!==s.contrast&&b("contrast",r,s,T),s.hue&&b("hue",r,s,T),1!==s.brightness&&b("brightness",r,s,T),s.colorizeAmount&&(b("colorize",r,s,T),b("colorizeAmount",r,s,T)),1!==s.saturation&&b("saturation",r,s,T)):(n=c.slice(),null!=e.contrast?(n=_(n,Number(e.contrast)),b("contrast",r,s,e)):1!==s.contrast&&(h?n=_(n,s.contrast):b("contrast",r,s,T)),null!=e.hue?(n=g(n,Number(e.hue)),b("hue",r,s,e)):s.hue&&(h?n=g(n,s.hue):b("hue",r,s,T)),null!=e.brightness?(n=w(Number(e.brightness),n),b("brightness",r,s,e)):1!==s.brightness&&(h?n=w(s.brightness,n):b("brightness",r,s,T)),null!=e.colorize?(e.colorizeAmount="colorizeAmount"in e?Number(e.colorizeAmount):1,n=y(n,e.colorize,e.colorizeAmount),b("colorize",r,s,e),b("colorizeAmount",r,s,e)):s.colorizeAmount&&(h?n=y(n,s.colorize,s.colorizeAmount):(b("colorize",r,s,T),b("colorizeAmount",r,s,T))),null!=e.saturation?(n=v(n,Number(e.saturation)),b("saturation",r,s,e)):1!==s.saturation&&(h?n=v(n,s.saturation):b("saturation",r,s,T))),i=n.length;for(;--i>-1;)n[i]!==o[i]&&r._addTween(o,i,o[i],n[i],"colorMatrixFilter");r._overwriteProps.push("colorMatrixFilter")},S=function(e,r,i,n,o){var a=n._firstPT={_next:n._firstPT,t:e,p:r,proxy:{},f:"function"==typeof e[r]};a.proxy[r]="rgb("+s(a.f?e[r.indexOf("set")||"function"!=typeof e["get"+r.substr(3)]?r:"get"+r.substr(3)]():e[r]).join(",")+")",o._addTween(a.proxy,r,"get","number"==typeof i?"rgb("+s(i,!1).join(",")+")":i,r,null,null,t)},A=function(t,e){var r=e.setRatio,i=function(t){var n,o=i._firstPT;for(r.call(e,t);o;)n=s(o.proxy[o.p],"number"),o.f?o.t[o.p](n):o.t[o.p]=n,o=o._next;i.graphics&&(i.graphics.dirty++,i.graphics.clearDirty++)};return e.setRatio=i,i},I={tint:1,lineColor:1,fillColor:1},P="position,scale,skew,pivot,anchor,tilePosition,tileScale".split(","),M={x:"position",y:"position",tileX:"tilePosition",tileY:"tilePosition"},C={colorMatrixFilter:1,saturation:1,contrast:1,hue:1,colorize:1,colorizeAmount:1,brightness:1,combineCMF:1},R=Math.PI/180,O=function(t){return"string"==typeof t&&"="===t.charAt(1)?t.substr(0,2)+parseFloat(t.substr(2))*R:t*R};for(e=0;e<P.length;e++)r=P[e],M[r+"X"]=r,M[r+"Y"]=r;for(r in o)u+="|"+r+"\\b";u=new RegExp(u+")","gi"),t=function(t){var e,r=t[0]+" "+t[1];u.lastIndex=0,u.test(r)&&(e=-1!==r.indexOf("hsl(")||-1!==r.indexOf("hsla("),t[0]=h(t[0],e),t[1]=h(t[1],e))},l.defaultStringFilter||(l.defaultStringFilter=t);var D=_gsScope._gsDefine.plugin({propName:"pixi",priority:0,API:2,global:!0,version:"0.2.1",init:function(t,e,r,i){if(!t instanceof _gsScope.PIXI.DisplayObject)return!1;var n,o,a,s,h,l,u,c,p,d,f;for(l in e){if(n=M[l],"function"==typeof(a=e[l])&&(a=a(i||0,t)),n)o=-1!==l.charAt(l.length-1).toLowerCase().indexOf("x")?"x":"y",this._addTween(t[n],o,t[n][o],"skew"===n?O(a):a,l);else if("scale"===l||"anchor"===l||"pivot"===l||"tileScale"===l)this._addTween(t[l],"x",t[l].x,a,l+"X"),this._addTween(t[l],"y",t[l].y,a,l+"Y");else if("rotation"===l)this._addTween(t,l,t.rotation,O(a),l);else if(C[l])s||(E(t,e.colorMatrixFilter||e,this),s=!0);else if("blur"===l||"blurX"===l||"blurY"===l||"blurPadding"===l){if(h=x(t,"BlurFilter"),this._addTween(h,l,h[l],a,l),0!==e.blurPadding)for(u=e.blurPadding||2*Math.max(h[l],a),p=t.filters.length;--p>-1;)t.filters[p].padding=Math.max(t.filters[p].padding,u)}else if(I[l])if(c||(c=A(0,this)),("lineColor"===l||"fillColor"===l)&&t instanceof _gsScope.PIXI.Graphics){for(p=(d=t.graphicsData).length;--p>-1;)S(d[p],l,a,c,this);c.graphics=t}else S(t,l,a,c,this);else"autoAlpha"===l?(this._firstPT=f={t:{setRatio:function(){t.visible=!!t.alpha}},p:"setRatio",s:0,c:1,f:1,pg:0,n:"visible",pr:0,m:0,_next:this._firstPT},f._next&&(f._next._prev=f),this._addTween(t,"alpha",t.alpha,a,"alpha"),this._overwriteProps.push("alpha","visible")):this._addTween(t,l,t[l],a,l);this._overwriteProps.push(l)}return!0}});D.colorProps=I,D.parseColor=s,D.formatColors=h,D.colorStringFilter=t})),_gsScope._gsDefine&&_gsScope._gsQueue.pop()(),
/*!
 *  howler.js v2.1.1
 *  howlerjs.com
 *
 *  (c) 2013-2018, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */
function(){"use strict";var t=function(){this.init()};t.prototype={init:function(){var t=this||e;return t._counter=1e3,t._html5AudioPool=[],t.html5PoolSize=10,t._codecs={},t._howls=[],t._muted=!1,t._volume=1,t._canPlayEvent="canplaythrough",t._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,t.masterGain=null,t.noAudio=!1,t.usingWebAudio=!0,t.autoSuspend=!0,t.ctx=null,t.autoUnlock=!0,t._setup(),t},volume:function(t){var r=this||e;if(t=parseFloat(t),r.ctx||l(),void 0!==t&&t>=0&&t<=1){if(r._volume=t,r._muted)return r;r.usingWebAudio&&r.masterGain.gain.setValueAtTime(t,e.ctx.currentTime);for(var i=0;i<r._howls.length;i++)if(!r._howls[i]._webAudio)for(var n=r._howls[i]._getSoundIds(),o=0;o<n.length;o++){var a=r._howls[i]._soundById(n[o]);a&&a._node&&(a._node.volume=a._volume*t)}return r}return r._volume},mute:function(t){var r=this||e;r.ctx||l(),r._muted=t,r.usingWebAudio&&r.masterGain.gain.setValueAtTime(t?0:r._volume,e.ctx.currentTime);for(var i=0;i<r._howls.length;i++)if(!r._howls[i]._webAudio)for(var n=r._howls[i]._getSoundIds(),o=0;o<n.length;o++){var a=r._howls[i]._soundById(n[o]);a&&a._node&&(a._node.muted=!!t||a._muted)}return r},unload:function(){for(var t=this||e,r=t._howls.length-1;r>=0;r--)t._howls[r].unload();return t.usingWebAudio&&t.ctx&&void 0!==t.ctx.close&&(t.ctx.close(),t.ctx=null,l()),t},codecs:function(t){return(this||e)._codecs[t.replace(/^x-/,"")]},_setup:function(){var t=this||e;if(t.state=t.ctx&&t.ctx.state||"suspended",t._autoSuspend(),!t.usingWebAudio)if("undefined"!=typeof Audio)try{void 0===(new Audio).oncanplaythrough&&(t._canPlayEvent="canplay")}catch(e){t.noAudio=!0}else t.noAudio=!0;try{(new Audio).muted&&(t.noAudio=!0)}catch(t){}return t.noAudio||t._setupCodecs(),t},_setupCodecs:function(){var t=this||e,r=null;try{r="undefined"!=typeof Audio?new Audio:null}catch(e){return t}if(!r||"function"!=typeof r.canPlayType)return t;var i=r.canPlayType("audio/mpeg;").replace(/^no$/,""),n=t._navigator&&t._navigator.userAgent.match(/OPR\/([0-6].)/g),o=n&&parseInt(n[0].split("/")[1],10)<33;return t._codecs={mp3:!(o||!i&&!r.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!i,opus:!!r.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!r.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!r.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!r.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!r.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!r.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(r.canPlayType("audio/x-m4a;")||r.canPlayType("audio/m4a;")||r.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(r.canPlayType("audio/x-mp4;")||r.canPlayType("audio/mp4;")||r.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!r.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),webm:!!r.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),dolby:!!r.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(r.canPlayType("audio/x-flac;")||r.canPlayType("audio/flac;")).replace(/^no$/,"")},t},_unlockAudio:function(){var t=this||e,r=/iPhone|iPad|iPod|Android|BlackBerry|BB10|Silk|Mobi|Chrome|Safari/i.test(t._navigator&&t._navigator.userAgent);if(!t._audioUnlocked&&t.ctx&&r){t._audioUnlocked=!1,t.autoUnlock=!1,t._mobileUnloaded||44100===t.ctx.sampleRate||(t._mobileUnloaded=!0,t.unload()),t._scratchBuffer=t.ctx.createBuffer(1,1,22050);var i=function(e){for(var r=0;r<t.html5PoolSize;r++){var n=new Audio;n._unlocked=!0,t._releaseHtml5Audio(n)}for(r=0;r<t._howls.length;r++)if(!t._howls[r]._webAudio)for(var o=t._howls[r]._getSoundIds(),a=0;a<o.length;a++){var s=t._howls[r]._soundById(o[a]);s&&s._node&&!s._node._unlocked&&(s._node._unlocked=!0,s._node.load())}t._autoResume();var h=t.ctx.createBufferSource();h.buffer=t._scratchBuffer,h.connect(t.ctx.destination),void 0===h.start?h.noteOn(0):h.start(0),"function"==typeof t.ctx.resume&&t.ctx.resume(),h.onended=function(){h.disconnect(0),t._audioUnlocked=!0,document.removeEventListener("touchstart",i,!0),document.removeEventListener("touchend",i,!0),document.removeEventListener("click",i,!0);for(var e=0;e<t._howls.length;e++)t._howls[e]._emit("unlock")}};return document.addEventListener("touchstart",i,!0),document.addEventListener("touchend",i,!0),document.addEventListener("click",i,!0),t}},_obtainHtml5Audio:function(){var t=this||e;if(t._html5AudioPool.length)return t._html5AudioPool.pop();var r=(new Audio).play();return r&&"undefined"!=typeof Promise&&(r instanceof Promise||"function"==typeof r.then)&&r.catch((function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")})),new Audio},_releaseHtml5Audio:function(t){var r=this||e;return t._unlocked&&r._html5AudioPool.push(t),r},_autoSuspend:function(){var t=this;if(t.autoSuspend&&t.ctx&&void 0!==t.ctx.suspend&&e.usingWebAudio){for(var r=0;r<t._howls.length;r++)if(t._howls[r]._webAudio)for(var i=0;i<t._howls[r]._sounds.length;i++)if(!t._howls[r]._sounds[i]._paused)return t;return t._suspendTimer&&clearTimeout(t._suspendTimer),t._suspendTimer=setTimeout((function(){t.autoSuspend&&(t._suspendTimer=null,t.state="suspending",t.ctx.suspend().then((function(){t.state="suspended",t._resumeAfterSuspend&&(delete t._resumeAfterSuspend,t._autoResume())})))}),3e4),t}},_autoResume:function(){var t=this;if(t.ctx&&void 0!==t.ctx.resume&&e.usingWebAudio)return"running"===t.state&&t._suspendTimer?(clearTimeout(t._suspendTimer),t._suspendTimer=null):"suspended"===t.state?(t.ctx.resume().then((function(){t.state="running";for(var e=0;e<t._howls.length;e++)t._howls[e]._emit("resume")})),t._suspendTimer&&(clearTimeout(t._suspendTimer),t._suspendTimer=null)):"suspending"===t.state&&(t._resumeAfterSuspend=!0),t}};var e=new t,r=function(t){t.src&&0!==t.src.length?this.init(t):console.error("An array of source files must be passed with any new Howl.")};r.prototype={init:function(t){var r=this;return e.ctx||l(),r._autoplay=t.autoplay||!1,r._format="string"!=typeof t.format?t.format:[t.format],r._html5=t.html5||!1,r._muted=t.mute||!1,r._loop=t.loop||!1,r._pool=t.pool||5,r._preload="boolean"!=typeof t.preload||t.preload,r._rate=t.rate||1,r._sprite=t.sprite||{},r._src="string"!=typeof t.src?t.src:[t.src],r._volume=void 0!==t.volume?t.volume:1,r._xhrWithCredentials=t.xhrWithCredentials||!1,r._duration=0,r._state="unloaded",r._sounds=[],r._endTimers={},r._queue=[],r._playLock=!1,r._onend=t.onend?[{fn:t.onend}]:[],r._onfade=t.onfade?[{fn:t.onfade}]:[],r._onload=t.onload?[{fn:t.onload}]:[],r._onloaderror=t.onloaderror?[{fn:t.onloaderror}]:[],r._onplayerror=t.onplayerror?[{fn:t.onplayerror}]:[],r._onpause=t.onpause?[{fn:t.onpause}]:[],r._onplay=t.onplay?[{fn:t.onplay}]:[],r._onstop=t.onstop?[{fn:t.onstop}]:[],r._onmute=t.onmute?[{fn:t.onmute}]:[],r._onvolume=t.onvolume?[{fn:t.onvolume}]:[],r._onrate=t.onrate?[{fn:t.onrate}]:[],r._onseek=t.onseek?[{fn:t.onseek}]:[],r._onunlock=t.onunlock?[{fn:t.onunlock}]:[],r._onresume=[],r._webAudio=e.usingWebAudio&&!r._html5,void 0!==e.ctx&&e.ctx&&e.autoUnlock&&e._unlockAudio(),e._howls.push(r),r._autoplay&&r._queue.push({event:"play",action:function(){r.play()}}),r._preload&&r.load(),r},load:function(){var t=null;if(e.noAudio)this._emit("loaderror",null,"No audio support.");else{"string"==typeof this._src&&(this._src=[this._src]);for(var r=0;r<this._src.length;r++){var n,a;if(this._format&&this._format[r])n=this._format[r];else{if("string"!=typeof(a=this._src[r])){this._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(n=/^data:audio\/([^;,]+);/i.exec(a))||(n=/\.([^.]+)$/.exec(a.split("?",1)[0])),n&&(n=n[1].toLowerCase())}if(n||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),n&&e.codecs(n)){t=this._src[r];break}}if(t)return this._src=t,this._state="loading","https:"===window.location.protocol&&"http:"===t.slice(0,5)&&(this._html5=!0,this._webAudio=!1),new i(this),this._webAudio&&o(this),this;this._emit("loaderror",null,"No codec support for selected audio sources.")}},play:function(t,r){var i=this,n=null;if("number"==typeof t)n=t,t=null;else{if("string"==typeof t&&"loaded"===i._state&&!i._sprite[t])return null;if(void 0===t&&(t="__default",!i._playLock)){for(var o=0,a=0;a<i._sounds.length;a++)i._sounds[a]._paused&&!i._sounds[a]._ended&&(o++,n=i._sounds[a]._id);1===o?t=null:n=null}}var s=n?i._soundById(n):i._inactiveSound();if(!s)return null;if(n&&!t&&(t=s._sprite||"__default"),"loaded"!==i._state){s._sprite=t,s._ended=!1;var h=s._id;return i._queue.push({event:"play",action:function(){i.play(h)}}),h}if(n&&!s._paused)return r||i._loadQueue("play"),s._id;i._webAudio&&e._autoResume();var l=Math.max(0,s._seek>0?s._seek:i._sprite[t][0]/1e3),u=Math.max(0,(i._sprite[t][0]+i._sprite[t][1])/1e3-l),c=1e3*u/Math.abs(s._rate),p=i._sprite[t][0]/1e3,d=(i._sprite[t][0]+i._sprite[t][1])/1e3,f=!(!s._loop&&!i._sprite[t][2]);s._sprite=t,s._ended=!1;var m=function(){s._paused=!1,s._seek=l,s._start=p,s._stop=d,s._loop=f};if(!(l>=d)){var v=s._node;if(i._webAudio){var y=function(){i._playLock=!1,m(),i._refreshBuffer(s);var t=s._muted||i._muted?0:s._volume;v.gain.setValueAtTime(t,e.ctx.currentTime),s._playStart=e.ctx.currentTime,void 0===v.bufferSource.start?s._loop?v.bufferSource.noteGrainOn(0,l,86400):v.bufferSource.noteGrainOn(0,l,u):s._loop?v.bufferSource.start(0,l,86400):v.bufferSource.start(0,l,u),c!==1/0&&(i._endTimers[s._id]=setTimeout(i._ended.bind(i,s),c)),r||setTimeout((function(){i._emit("play",s._id),i._loadQueue()}),0)};"running"===e.state?y():(i._playLock=!0,i.once("resume",y),i._clearTimer(s._id))}else{var g=function(){v.currentTime=l,v.muted=s._muted||i._muted||e._muted||v.muted,v.volume=s._volume*e.volume(),v.playbackRate=s._rate;try{var n=v.play();if(n&&"undefined"!=typeof Promise&&(n instanceof Promise||"function"==typeof n.then)?(i._playLock=!0,m(),n.then((function(){i._playLock=!1,v._unlocked=!0,r||(i._emit("play",s._id),i._loadQueue())})).catch((function(){i._playLock=!1,i._emit("playerror",s._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),s._ended=!0,s._paused=!0}))):r||(i._playLock=!1,m(),i._emit("play",s._id),i._loadQueue()),v.playbackRate=s._rate,v.paused)return void i._emit("playerror",s._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");"__default"!==t||s._loop?i._endTimers[s._id]=setTimeout(i._ended.bind(i,s),c):(i._endTimers[s._id]=function(){i._ended(s),v.removeEventListener("ended",i._endTimers[s._id],!1)},v.addEventListener("ended",i._endTimers[s._id],!1))}catch(t){i._emit("playerror",s._id,t)}},_=window&&window.ejecta||!v.readyState&&e._navigator.isCocoonJS;if(v.readyState>=3||_)g();else{i._playLock=!0;var x=function(){g(),v.removeEventListener(e._canPlayEvent,x,!1)};v.addEventListener(e._canPlayEvent,x,!1),i._clearTimer(s._id)}}return s._id}i._ended(s)},pause:function(t){var e=this;if("loaded"!==e._state||e._playLock)return e._queue.push({event:"pause",action:function(){e.pause(t)}}),e;for(var r=e._getSoundIds(t),i=0;i<r.length;i++){e._clearTimer(r[i]);var n=e._soundById(r[i]);if(n&&!n._paused&&(n._seek=e.seek(r[i]),n._rateSeek=0,n._paused=!0,e._stopFade(r[i]),n._node))if(e._webAudio){if(!n._node.bufferSource)continue;void 0===n._node.bufferSource.stop?n._node.bufferSource.noteOff(0):n._node.bufferSource.stop(0),e._cleanBuffer(n._node)}else isNaN(n._node.duration)&&n._node.duration!==1/0||n._node.pause();arguments[1]||e._emit("pause",n?n._id:null)}return e},stop:function(t,e){var r=this;if("loaded"!==r._state||r._playLock)return r._queue.push({event:"stop",action:function(){r.stop(t)}}),r;for(var i=r._getSoundIds(t),n=0;n<i.length;n++){r._clearTimer(i[n]);var o=r._soundById(i[n]);o&&(o._seek=o._start||0,o._rateSeek=0,o._paused=!0,o._ended=!0,r._stopFade(i[n]),o._node&&(r._webAudio?o._node.bufferSource&&(void 0===o._node.bufferSource.stop?o._node.bufferSource.noteOff(0):o._node.bufferSource.stop(0),r._cleanBuffer(o._node)):isNaN(o._node.duration)&&o._node.duration!==1/0||(o._node.currentTime=o._start||0,o._node.pause())),e||r._emit("stop",o._id))}return r},mute:function(t,r){var i=this;if("loaded"!==i._state||i._playLock)return i._queue.push({event:"mute",action:function(){i.mute(t,r)}}),i;if(void 0===r){if("boolean"!=typeof t)return i._muted;i._muted=t}for(var n=i._getSoundIds(r),o=0;o<n.length;o++){var a=i._soundById(n[o]);a&&(a._muted=t,a._interval&&i._stopFade(a._id),i._webAudio&&a._node?a._node.gain.setValueAtTime(t?0:a._volume,e.ctx.currentTime):a._node&&(a._node.muted=!!e._muted||t),i._emit("mute",a._id))}return i},volume:function(){var t,r,i,n=this,o=arguments;if(0===o.length)return n._volume;if(1===o.length||2===o.length&&void 0===o[1]){var a=n._getSoundIds(),s=a.indexOf(o[0]);s>=0?r=parseInt(o[0],10):t=parseFloat(o[0])}else o.length>=2&&(t=parseFloat(o[0]),r=parseInt(o[1],10));if(!(void 0!==t&&t>=0&&t<=1))return(i=r?n._soundById(r):n._sounds[0])?i._volume:0;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"volume",action:function(){n.volume.apply(n,o)}}),n;void 0===r&&(n._volume=t),r=n._getSoundIds(r);for(var h=0;h<r.length;h++)(i=n._soundById(r[h]))&&(i._volume=t,o[2]||n._stopFade(r[h]),n._webAudio&&i._node&&!i._muted?i._node.gain.setValueAtTime(t,e.ctx.currentTime):i._node&&!i._muted&&(i._node.volume=t*e.volume()),n._emit("volume",i._id));return n},fade:function(t,r,i,n){var o=this;if("loaded"!==o._state||o._playLock)return o._queue.push({event:"fade",action:function(){o.fade(t,r,i,n)}}),o;t=parseFloat(t),r=parseFloat(r),i=parseFloat(i),o.volume(t,n);for(var a=o._getSoundIds(n),s=0;s<a.length;s++){var h=o._soundById(a[s]);if(h){if(n||o._stopFade(a[s]),o._webAudio&&!h._muted){var l=e.ctx.currentTime,u=l+i/1e3;h._volume=t,h._node.gain.setValueAtTime(t,l),h._node.gain.linearRampToValueAtTime(r,u)}o._startFadeInterval(h,t,r,i,a[s],void 0===n)}}return o},_startFadeInterval:function(t,e,r,i,n,o){var a=this,s=e,h=r-e,l=Math.abs(h/.01),u=Math.max(4,l>0?i/l:i),c=Date.now();t._fadeTo=r,t._interval=setInterval((function(){var n=(Date.now()-c)/i;c=Date.now(),s+=h*n,s=Math.max(0,s),s=Math.min(1,s),s=Math.round(100*s)/100,a._webAudio?t._volume=s:a.volume(s,t._id,!0),o&&(a._volume=s),(r<e&&s<=r||r>e&&s>=r)&&(clearInterval(t._interval),t._interval=null,t._fadeTo=null,a.volume(r,t._id),a._emit("fade",t._id))}),u)},_stopFade:function(t){var r=this._soundById(t);return r&&r._interval&&(this._webAudio&&r._node.gain.cancelScheduledValues(e.ctx.currentTime),clearInterval(r._interval),r._interval=null,this.volume(r._fadeTo,t),r._fadeTo=null,this._emit("fade",t)),this},loop:function(){var t,e,r,i=this,n=arguments;if(0===n.length)return i._loop;if(1===n.length){if("boolean"!=typeof n[0])return!!(r=i._soundById(parseInt(n[0],10)))&&r._loop;t=n[0],i._loop=t}else 2===n.length&&(t=n[0],e=parseInt(n[1],10));for(var o=i._getSoundIds(e),a=0;a<o.length;a++)(r=i._soundById(o[a]))&&(r._loop=t,i._webAudio&&r._node&&r._node.bufferSource&&(r._node.bufferSource.loop=t,t&&(r._node.bufferSource.loopStart=r._start||0,r._node.bufferSource.loopEnd=r._stop)));return i},rate:function(){var t,r,i,n=this,o=arguments;if(0===o.length)r=n._sounds[0]._id;else if(1===o.length){var a=n._getSoundIds(),s=a.indexOf(o[0]);s>=0?r=parseInt(o[0],10):t=parseFloat(o[0])}else 2===o.length&&(t=parseFloat(o[0]),r=parseInt(o[1],10));if("number"!=typeof t)return(i=n._soundById(r))?i._rate:n._rate;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"rate",action:function(){n.rate.apply(n,o)}}),n;void 0===r&&(n._rate=t),r=n._getSoundIds(r);for(var h=0;h<r.length;h++)if(i=n._soundById(r[h])){n.playing(r[h])&&(i._rateSeek=n.seek(r[h]),i._playStart=n._webAudio?e.ctx.currentTime:i._playStart),i._rate=t,n._webAudio&&i._node&&i._node.bufferSource?i._node.bufferSource.playbackRate.setValueAtTime(t,e.ctx.currentTime):i._node&&(i._node.playbackRate=t);var l=n.seek(r[h]),u=(n._sprite[i._sprite][0]+n._sprite[i._sprite][1])/1e3-l,c=1e3*u/Math.abs(i._rate);!n._endTimers[r[h]]&&i._paused||(n._clearTimer(r[h]),n._endTimers[r[h]]=setTimeout(n._ended.bind(n,i),c)),n._emit("rate",i._id)}return n},seek:function(){var t,r,i=this,n=arguments;if(0===n.length)r=i._sounds[0]._id;else if(1===n.length){var o=i._getSoundIds(),a=o.indexOf(n[0]);a>=0?r=parseInt(n[0],10):i._sounds.length&&(r=i._sounds[0]._id,t=parseFloat(n[0]))}else 2===n.length&&(t=parseFloat(n[0]),r=parseInt(n[1],10));if(void 0===r)return i;if("loaded"!==i._state||i._playLock)return i._queue.push({event:"seek",action:function(){i.seek.apply(i,n)}}),i;var s=i._soundById(r);if(s){if(!("number"==typeof t&&t>=0)){if(i._webAudio){var h=i.playing(r)?e.ctx.currentTime-s._playStart:0,l=s._rateSeek?s._rateSeek-s._seek:0;return s._seek+(l+h*Math.abs(s._rate))}return s._node.currentTime}var u=i.playing(r);u&&i.pause(r,!0),s._seek=t,s._ended=!1,i._clearTimer(r),i._webAudio||!s._node||isNaN(s._node.duration)||(s._node.currentTime=t);var c=function(){i._emit("seek",r),u&&i.play(r,!0)};if(u&&!i._webAudio){var p=function(){i._playLock?setTimeout(p,0):c()};setTimeout(p,0)}else c()}return i},playing:function(t){if("number"==typeof t){var e=this._soundById(t);return!!e&&!e._paused}for(var r=0;r<this._sounds.length;r++)if(!this._sounds[r]._paused)return!0;return!1},duration:function(t){var e=this._duration,r=this._soundById(t);return r&&(e=this._sprite[r._sprite][1]/1e3),e},state:function(){return this._state},unload:function(){for(var t=this,r=t._sounds,i=0;i<r.length;i++){if(r[i]._paused||t.stop(r[i]._id),!t._webAudio)/MSIE |Trident\//.test(e._navigator&&e._navigator.userAgent)||(r[i]._node.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"),r[i]._node.removeEventListener("error",r[i]._errorFn,!1),r[i]._node.removeEventListener(e._canPlayEvent,r[i]._loadFn,!1),e._releaseHtml5Audio(r[i]._node);delete r[i]._node,t._clearTimer(r[i]._id)}var o=e._howls.indexOf(t);o>=0&&e._howls.splice(o,1);var a=!0;for(i=0;i<e._howls.length;i++)if(e._howls[i]._src===t._src||t._src.indexOf(e._howls[i]._src)>=0){a=!1;break}return n&&a&&delete n[t._src],e.noAudio=!1,t._state="unloaded",t._sounds=[],t=null,null},on:function(t,e,r,i){var n=this["_on"+t];return"function"==typeof e&&n.push(i?{id:r,fn:e,once:i}:{id:r,fn:e}),this},off:function(t,e,r){var i=this["_on"+t],n=0;if("number"==typeof e&&(r=e,e=null),e||r)for(n=0;n<i.length;n++){var o=r===i[n].id;if(e===i[n].fn&&o||!e&&o){i.splice(n,1);break}}else if(t)this["_on"+t]=[];else{var a=Object.keys(this);for(n=0;n<a.length;n++)0===a[n].indexOf("_on")&&Array.isArray(this[a[n]])&&(this[a[n]]=[])}return this},once:function(t,e,r){return this.on(t,e,r,1),this},_emit:function(t,e,r){for(var i=this["_on"+t],n=i.length-1;n>=0;n--)i[n].id&&i[n].id!==e&&"load"!==t||(setTimeout(function(t){t.call(this,e,r)}.bind(this,i[n].fn),0),i[n].once&&this.off(t,i[n].fn,i[n].id));return this._loadQueue(t),this},_loadQueue:function(t){if(this._queue.length>0){var e=this._queue[0];e.event===t&&(this._queue.shift(),this._loadQueue()),t||e.action()}return this},_ended:function(t){var r=t._sprite;if(!this._webAudio&&t._node&&!t._node.paused&&!t._node.ended&&t._node.currentTime<t._stop)return setTimeout(this._ended.bind(this,t),100),this;var i=!(!t._loop&&!this._sprite[r][2]);if(this._emit("end",t._id),!this._webAudio&&i&&this.stop(t._id,!0).play(t._id),this._webAudio&&i){this._emit("play",t._id),t._seek=t._start||0,t._rateSeek=0,t._playStart=e.ctx.currentTime;var n=1e3*(t._stop-t._start)/Math.abs(t._rate);this._endTimers[t._id]=setTimeout(this._ended.bind(this,t),n)}return this._webAudio&&!i&&(t._paused=!0,t._ended=!0,t._seek=t._start||0,t._rateSeek=0,this._clearTimer(t._id),this._cleanBuffer(t._node),e._autoSuspend()),this._webAudio||i||this.stop(t._id,!0),this},_clearTimer:function(t){if(this._endTimers[t]){if("function"!=typeof this._endTimers[t])clearTimeout(this._endTimers[t]);else{var e=this._soundById(t);e&&e._node&&e._node.removeEventListener("ended",this._endTimers[t],!1)}delete this._endTimers[t]}return this},_soundById:function(t){for(var e=0;e<this._sounds.length;e++)if(t===this._sounds[e]._id)return this._sounds[e];return null},_inactiveSound:function(){this._drain();for(var t=0;t<this._sounds.length;t++)if(this._sounds[t]._ended)return this._sounds[t].reset();return new i(this)},_drain:function(){var t=this._pool,e=0,r=0;if(!(this._sounds.length<t)){for(r=0;r<this._sounds.length;r++)this._sounds[r]._ended&&e++;for(r=this._sounds.length-1;r>=0;r--){if(e<=t)return;this._sounds[r]._ended&&(this._webAudio&&this._sounds[r]._node&&this._sounds[r]._node.disconnect(0),this._sounds.splice(r,1),e--)}}},_getSoundIds:function(t){if(void 0===t){for(var e=[],r=0;r<this._sounds.length;r++)e.push(this._sounds[r]._id);return e}return[t]},_refreshBuffer:function(t){return t._node.bufferSource=e.ctx.createBufferSource(),t._node.bufferSource.buffer=n[this._src],t._panner?t._node.bufferSource.connect(t._panner):t._node.bufferSource.connect(t._node),t._node.bufferSource.loop=t._loop,t._loop&&(t._node.bufferSource.loopStart=t._start||0,t._node.bufferSource.loopEnd=t._stop||0),t._node.bufferSource.playbackRate.setValueAtTime(t._rate,e.ctx.currentTime),this},_cleanBuffer:function(t){var r=e._navigator&&e._navigator.vendor.indexOf("Apple")>=0;if(e._scratchBuffer&&t.bufferSource&&(t.bufferSource.onended=null,t.bufferSource.disconnect(0),r))try{t.bufferSource.buffer=e._scratchBuffer}catch(t){}return t.bufferSource=null,this}};var i=function(t){this._parent=t,this.init()};i.prototype={init:function(){var t=this._parent;return this._muted=t._muted,this._loop=t._loop,this._volume=t._volume,this._rate=t._rate,this._seek=0,this._paused=!0,this._ended=!0,this._sprite="__default",this._id=++e._counter,t._sounds.push(this),this.create(),this},create:function(){var t=this._parent,r=e._muted||this._muted||this._parent._muted?0:this._volume;return t._webAudio?(this._node=void 0===e.ctx.createGain?e.ctx.createGainNode():e.ctx.createGain(),this._node.gain.setValueAtTime(r,e.ctx.currentTime),this._node.paused=!0,this._node.connect(e.masterGain)):(this._node=e._obtainHtml5Audio(),this._errorFn=this._errorListener.bind(this),this._node.addEventListener("error",this._errorFn,!1),this._loadFn=this._loadListener.bind(this),this._node.addEventListener(e._canPlayEvent,this._loadFn,!1),this._node.src=t._src,this._node.preload="auto",this._node.volume=r*e.volume(),this._node.load()),this},reset:function(){var t=this._parent;return this._muted=t._muted,this._loop=t._loop,this._volume=t._volume,this._rate=t._rate,this._seek=0,this._rateSeek=0,this._paused=!0,this._ended=!0,this._sprite="__default",this._id=++e._counter,this},_errorListener:function(){this._parent._emit("loaderror",this._id,this._node.error?this._node.error.code:0),this._node.removeEventListener("error",this._errorFn,!1)},_loadListener:function(){var t=this._parent;t._duration=Math.ceil(10*this._node.duration)/10,0===Object.keys(t._sprite).length&&(t._sprite={__default:[0,1e3*t._duration]}),"loaded"!==t._state&&(t._state="loaded",t._emit("load"),t._loadQueue()),this._node.removeEventListener(e._canPlayEvent,this._loadFn,!1)}};var n={},o=function(t){var e=t._src;if(n[e])return t._duration=n[e].duration,void h(t);if(/^data:[^;]+;base64,/.test(e)){for(var r=atob(e.split(",")[1]),i=new Uint8Array(r.length),o=0;o<r.length;++o)i[o]=r.charCodeAt(o);s(i.buffer,t)}else{var l=new XMLHttpRequest;l.open("GET",e,!0),l.withCredentials=t._xhrWithCredentials,l.responseType="arraybuffer",l.onload=function(){var e=(l.status+"")[0];"0"===e||"2"===e||"3"===e?s(l.response,t):t._emit("loaderror",null,"Failed loading audio file with status: "+l.status+".")},l.onerror=function(){t._webAudio&&(t._html5=!0,t._webAudio=!1,t._sounds=[],delete n[e],t.load())},a(l)}},a=function(t){try{t.send()}catch(e){t.onerror()}},s=function(t,r){var i=function(){r._emit("loaderror",null,"Decoding audio data failed.")},o=function(t){t&&r._sounds.length>0?(n[r._src]=t,h(r,t)):i()};"undefined"!=typeof Promise&&1===e.ctx.decodeAudioData.length?e.ctx.decodeAudioData(t).then(o).catch(i):e.ctx.decodeAudioData(t,o,i)},h=function(t,e){e&&!t._duration&&(t._duration=e.duration),0===Object.keys(t._sprite).length&&(t._sprite={__default:[0,1e3*t._duration]}),"loaded"!==t._state&&(t._state="loaded",t._emit("load"),t._loadQueue())},l=function(){if(e.usingWebAudio){try{"undefined"!=typeof AudioContext?e.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?e.ctx=new webkitAudioContext:e.usingWebAudio=!1}catch(t){e.usingWebAudio=!1}e.ctx||(e.usingWebAudio=!1);var t=/iP(hone|od|ad)/.test(e._navigator&&e._navigator.platform),r=e._navigator&&e._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),i=r?parseInt(r[1],10):null;if(t&&i&&i<9){var n=/safari/.test(e._navigator&&e._navigator.userAgent.toLowerCase());(e._navigator&&e._navigator.standalone&&!n||e._navigator&&!e._navigator.standalone&&!n)&&(e.usingWebAudio=!1)}e.usingWebAudio&&(e.masterGain=void 0===e.ctx.createGain?e.ctx.createGainNode():e.ctx.createGain(),e.masterGain.gain.setValueAtTime(e._muted?0:1,e.ctx.currentTime),e.masterGain.connect(e.ctx.destination)),e._setup()}};"function"==typeof define&&define.amd&&define([],(function(){return{Howler:e,Howl:r}})),"undefined"!=typeof exports&&(exports.Howler=e,exports.Howl=r),"undefined"!=typeof window?(window.HowlerGlobal=t,window.Howler=e,window.Howl=r,window.Sound=i):"undefined"!=typeof global&&(global.HowlerGlobal=t,global.Howler=e,global.Howl=r,global.Sound=i)}(),
/*!
 *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
 *  
 *  howler.js v2.1.1
 *  howlerjs.com
 *
 *  (c) 2013-2018, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */
function(){"use strict";var t;HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(t){if(!this.ctx||!this.ctx.listener)return this;for(var e=this._howls.length-1;e>=0;e--)this._howls[e].stereo(t);return this},HowlerGlobal.prototype.pos=function(t,e,r){return this.ctx&&this.ctx.listener?(e="number"!=typeof e?this._pos[1]:e,r="number"!=typeof r?this._pos[2]:r,"number"!=typeof t?this._pos:(this._pos=[t,e,r],void 0!==this.ctx.listener.positionX?(this.ctx.listener.positionX.setTargetAtTime(this._pos[0],Howler.ctx.currentTime,.1),this.ctx.listener.positionY.setTargetAtTime(this._pos[1],Howler.ctx.currentTime,.1),this.ctx.listener.positionZ.setTargetAtTime(this._pos[2],Howler.ctx.currentTime,.1)):this.ctx.listener.setPosition(this._pos[0],this._pos[1],this._pos[2]),this)):this},HowlerGlobal.prototype.orientation=function(t,e,r,i,n,o){if(!this.ctx||!this.ctx.listener)return this;var a=this._orientation;return e="number"!=typeof e?a[1]:e,r="number"!=typeof r?a[2]:r,i="number"!=typeof i?a[3]:i,n="number"!=typeof n?a[4]:n,o="number"!=typeof o?a[5]:o,"number"!=typeof t?a:(this._orientation=[t,e,r,i,n,o],void 0!==this.ctx.listener.forwardX?(this.ctx.listener.forwardX.setTargetAtTime(t,Howler.ctx.currentTime,.1),this.ctx.listener.forwardY.setTargetAtTime(e,Howler.ctx.currentTime,.1),this.ctx.listener.forwardZ.setTargetAtTime(r,Howler.ctx.currentTime,.1),this.ctx.listener.upX.setTargetAtTime(t,Howler.ctx.currentTime,.1),this.ctx.listener.upY.setTargetAtTime(e,Howler.ctx.currentTime,.1),this.ctx.listener.upZ.setTargetAtTime(r,Howler.ctx.currentTime,.1)):this.ctx.listener.setOrientation(t,e,r,i,n,o),this)},Howl.prototype.init=(t=Howl.prototype.init,function(e){return this._orientation=e.orientation||[1,0,0],this._stereo=e.stereo||null,this._pos=e.pos||null,this._pannerAttr={coneInnerAngle:void 0!==e.coneInnerAngle?e.coneInnerAngle:360,coneOuterAngle:void 0!==e.coneOuterAngle?e.coneOuterAngle:360,coneOuterGain:void 0!==e.coneOuterGain?e.coneOuterGain:0,distanceModel:void 0!==e.distanceModel?e.distanceModel:"inverse",maxDistance:void 0!==e.maxDistance?e.maxDistance:1e4,panningModel:void 0!==e.panningModel?e.panningModel:"HRTF",refDistance:void 0!==e.refDistance?e.refDistance:1,rolloffFactor:void 0!==e.rolloffFactor?e.rolloffFactor:1},this._onstereo=e.onstereo?[{fn:e.onstereo}]:[],this._onpos=e.onpos?[{fn:e.onpos}]:[],this._onorientation=e.onorientation?[{fn:e.onorientation}]:[],t.call(this,e)}),Howl.prototype.stereo=function(t,r){var i=this;if(!i._webAudio)return i;if("loaded"!==i._state)return i._queue.push({event:"stereo",action:function(){i.stereo(t,r)}}),i;var n=void 0===Howler.ctx.createStereoPanner?"spatial":"stereo";if(void 0===r){if("number"!=typeof t)return i._stereo;i._stereo=t,i._pos=[t,0,0]}for(var o=i._getSoundIds(r),a=0;a<o.length;a++){var s=i._soundById(o[a]);if(s){if("number"!=typeof t)return s._stereo;s._stereo=t,s._pos=[t,0,0],s._node&&(s._pannerAttr.panningModel="equalpower",s._panner&&s._panner.pan||e(s,n),"spatial"===n?void 0!==s._panner.positionX?(s._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),s._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),s._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):s._panner.setPosition(t,0,0):s._panner.pan.setValueAtTime(t,Howler.ctx.currentTime)),i._emit("stereo",s._id)}}return i},Howl.prototype.pos=function(t,r,i,n){var o=this;if(!o._webAudio)return o;if("loaded"!==o._state)return o._queue.push({event:"pos",action:function(){o.pos(t,r,i,n)}}),o;if(r="number"!=typeof r?0:r,i="number"!=typeof i?-.5:i,void 0===n){if("number"!=typeof t)return o._pos;o._pos=[t,r,i]}for(var a=o._getSoundIds(n),s=0;s<a.length;s++){var h=o._soundById(a[s]);if(h){if("number"!=typeof t)return h._pos;h._pos=[t,r,i],h._node&&(h._panner&&!h._panner.pan||e(h,"spatial"),void 0!==h._panner.positionX?(h._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),h._panner.positionY.setValueAtTime(r,Howler.ctx.currentTime),h._panner.positionZ.setValueAtTime(i,Howler.ctx.currentTime)):h._panner.setPosition(t,r,i)),o._emit("pos",h._id)}}return o},Howl.prototype.orientation=function(t,r,i,n){var o=this;if(!o._webAudio)return o;if("loaded"!==o._state)return o._queue.push({event:"orientation",action:function(){o.orientation(t,r,i,n)}}),o;if(r="number"!=typeof r?o._orientation[1]:r,i="number"!=typeof i?o._orientation[2]:i,void 0===n){if("number"!=typeof t)return o._orientation;o._orientation=[t,r,i]}for(var a=o._getSoundIds(n),s=0;s<a.length;s++){var h=o._soundById(a[s]);if(h){if("number"!=typeof t)return h._orientation;h._orientation=[t,r,i],h._node&&(h._panner||(h._pos||(h._pos=o._pos||[0,0,-.5]),e(h,"spatial")),void 0!==h._panner.orientationX?(h._panner.orientationX.setValueAtTime(t,Howler.ctx.currentTime),h._panner.orientationY.setValueAtTime(r,Howler.ctx.currentTime),h._panner.orientationZ.setValueAtTime(i,Howler.ctx.currentTime)):h._panner.setOrientation(t,r,i)),o._emit("orientation",h._id)}}return o},Howl.prototype.pannerAttr=function(){var t,r,i,n=this,o=arguments;if(!n._webAudio)return n;if(0===o.length)return n._pannerAttr;if(1===o.length){if("object"!=typeof o[0])return(i=n._soundById(parseInt(o[0],10)))?i._pannerAttr:n._pannerAttr;t=o[0],void 0===r&&(t.pannerAttr||(t.pannerAttr={coneInnerAngle:t.coneInnerAngle,coneOuterAngle:t.coneOuterAngle,coneOuterGain:t.coneOuterGain,distanceModel:t.distanceModel,maxDistance:t.maxDistance,refDistance:t.refDistance,rolloffFactor:t.rolloffFactor,panningModel:t.panningModel}),n._pannerAttr={coneInnerAngle:void 0!==t.pannerAttr.coneInnerAngle?t.pannerAttr.coneInnerAngle:n._coneInnerAngle,coneOuterAngle:void 0!==t.pannerAttr.coneOuterAngle?t.pannerAttr.coneOuterAngle:n._coneOuterAngle,coneOuterGain:void 0!==t.pannerAttr.coneOuterGain?t.pannerAttr.coneOuterGain:n._coneOuterGain,distanceModel:void 0!==t.pannerAttr.distanceModel?t.pannerAttr.distanceModel:n._distanceModel,maxDistance:void 0!==t.pannerAttr.maxDistance?t.pannerAttr.maxDistance:n._maxDistance,refDistance:void 0!==t.pannerAttr.refDistance?t.pannerAttr.refDistance:n._refDistance,rolloffFactor:void 0!==t.pannerAttr.rolloffFactor?t.pannerAttr.rolloffFactor:n._rolloffFactor,panningModel:void 0!==t.pannerAttr.panningModel?t.pannerAttr.panningModel:n._panningModel})}else 2===o.length&&(t=o[0],r=parseInt(o[1],10));for(var a=n._getSoundIds(r),s=0;s<a.length;s++)if(i=n._soundById(a[s])){var h=i._pannerAttr;h={coneInnerAngle:void 0!==t.coneInnerAngle?t.coneInnerAngle:h.coneInnerAngle,coneOuterAngle:void 0!==t.coneOuterAngle?t.coneOuterAngle:h.coneOuterAngle,coneOuterGain:void 0!==t.coneOuterGain?t.coneOuterGain:h.coneOuterGain,distanceModel:void 0!==t.distanceModel?t.distanceModel:h.distanceModel,maxDistance:void 0!==t.maxDistance?t.maxDistance:h.maxDistance,refDistance:void 0!==t.refDistance?t.refDistance:h.refDistance,rolloffFactor:void 0!==t.rolloffFactor?t.rolloffFactor:h.rolloffFactor,panningModel:void 0!==t.panningModel?t.panningModel:h.panningModel};var l=i._panner;l?(l.coneInnerAngle=h.coneInnerAngle,l.coneOuterAngle=h.coneOuterAngle,l.coneOuterGain=h.coneOuterGain,l.distanceModel=h.distanceModel,l.maxDistance=h.maxDistance,l.refDistance=h.refDistance,l.rolloffFactor=h.rolloffFactor,l.panningModel=h.panningModel):(i._pos||(i._pos=n._pos||[0,0,-.5]),e(i,"spatial"))}return n},Sound.prototype.init=function(t){return function(){var e=this._parent;this._orientation=e._orientation,this._stereo=e._stereo,this._pos=e._pos,this._pannerAttr=e._pannerAttr,t.call(this),this._stereo?e.stereo(this._stereo):this._pos&&e.pos(this._pos[0],this._pos[1],this._pos[2],this._id)}}(Sound.prototype.init),Sound.prototype.reset=function(t){return function(){var e=this._parent;return this._orientation=e._orientation,this._stereo=e._stereo,this._pos=e._pos,this._pannerAttr=e._pannerAttr,this._stereo?e.stereo(this._stereo):this._pos?e.pos(this._pos[0],this._pos[1],this._pos[2],this._id):this._panner&&(this._panner.disconnect(0),this._panner=void 0,e._refreshBuffer(this)),t.call(this)}}(Sound.prototype.reset);var e=function(t,e){"spatial"===(e=e||"spatial")?(t._panner=Howler.ctx.createPanner(),t._panner.coneInnerAngle=t._pannerAttr.coneInnerAngle,t._panner.coneOuterAngle=t._pannerAttr.coneOuterAngle,t._panner.coneOuterGain=t._pannerAttr.coneOuterGain,t._panner.distanceModel=t._pannerAttr.distanceModel,t._panner.maxDistance=t._pannerAttr.maxDistance,t._panner.refDistance=t._pannerAttr.refDistance,t._panner.rolloffFactor=t._pannerAttr.rolloffFactor,t._panner.panningModel=t._pannerAttr.panningModel,void 0!==t._panner.positionX?(t._panner.positionX.setValueAtTime(t._pos[0],Howler.ctx.currentTime),t._panner.positionY.setValueAtTime(t._pos[1],Howler.ctx.currentTime),t._panner.positionZ.setValueAtTime(t._pos[2],Howler.ctx.currentTime)):t._panner.setPosition(t._pos[0],t._pos[1],t._pos[2]),void 0!==t._panner.orientationX?(t._panner.orientationX.setValueAtTime(t._orientation[0],Howler.ctx.currentTime),t._panner.orientationY.setValueAtTime(t._orientation[1],Howler.ctx.currentTime),t._panner.orientationZ.setValueAtTime(t._orientation[2],Howler.ctx.currentTime)):t._panner.setOrientation(t._orientation[0],t._orientation[1],t._orientation[2])):(t._panner=Howler.ctx.createStereoPanner(),t._panner.pan.setValueAtTime(t._stereo,Howler.ctx.currentTime)),t._panner.connect(t._node),t._paused||t._parent.pause(t._id,!0).play(t._id,!0)}}(),function(t){var e;"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():("undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.CANNON=t())}((function(){return function t(e,r,i){function n(a,s){if(!r[a]){if(!e[a]){var h="function"==typeof require&&require;if(!s&&h)return h(a,!0);if(o)return o(a,!0);throw new Error("Cannot find module '"+a+"'")}var l=r[a]={exports:{}};e[a][0].call(l.exports,(function(t){var r=e[a][1][t];return n(r||t)}),l,l.exports,t,e,r,i)}return r[a].exports}for(var o="function"==typeof require&&require,a=0;a<i.length;a++)n(i[a]);return n}({1:[function(t,e,r){e.exports={name:"cannon",version:"0.6.2",description:"A lightweight 3D physics engine written in JavaScript.",homepage:"https://github.com/schteppe/cannon.js",author:"Stefan Hedman <schteppe@gmail.com> (http://steffe.se)",keywords:["cannon.js","cannon","physics","engine","3d"],main:"./build/cannon.js",engines:{node:"*"},repository:{type:"git",url:"https://github.com/schteppe/cannon.js.git"},bugs:{url:"https://github.com/schteppe/cannon.js/issues"},licenses:[{type:"MIT"}],devDependencies:{jshint:"latest","uglify-js":"latest",nodeunit:"^0.9.0",grunt:"~0.4.0","grunt-contrib-jshint":"~0.1.1","grunt-contrib-nodeunit":"^0.4.1","grunt-contrib-concat":"~0.1.3","grunt-contrib-uglify":"^0.5.1","grunt-browserify":"^2.1.4","grunt-contrib-yuidoc":"^0.5.2",browserify:"*"},dependencies:{}}},{}],2:[function(t,e,r){e.exports={version:t("../package.json").version,AABB:t("./collision/AABB"),ArrayCollisionMatrix:t("./collision/ArrayCollisionMatrix"),Body:t("./objects/Body"),Box:t("./shapes/Box"),Broadphase:t("./collision/Broadphase"),Constraint:t("./constraints/Constraint"),ContactEquation:t("./equations/ContactEquation"),Narrowphase:t("./world/Narrowphase"),ConeTwistConstraint:t("./constraints/ConeTwistConstraint"),ContactMaterial:t("./material/ContactMaterial"),ConvexPolyhedron:t("./shapes/ConvexPolyhedron"),Cylinder:t("./shapes/Cylinder"),DistanceConstraint:t("./constraints/DistanceConstraint"),Equation:t("./equations/Equation"),EventTarget:t("./utils/EventTarget"),FrictionEquation:t("./equations/FrictionEquation"),GSSolver:t("./solver/GSSolver"),GridBroadphase:t("./collision/GridBroadphase"),Heightfield:t("./shapes/Heightfield"),HingeConstraint:t("./constraints/HingeConstraint"),LockConstraint:t("./constraints/LockConstraint"),Mat3:t("./math/Mat3"),Material:t("./material/Material"),NaiveBroadphase:t("./collision/NaiveBroadphase"),ObjectCollisionMatrix:t("./collision/ObjectCollisionMatrix"),Pool:t("./utils/Pool"),Particle:t("./shapes/Particle"),Plane:t("./shapes/Plane"),PointToPointConstraint:t("./constraints/PointToPointConstraint"),Quaternion:t("./math/Quaternion"),Ray:t("./collision/Ray"),RaycastVehicle:t("./objects/RaycastVehicle"),RaycastResult:t("./collision/RaycastResult"),RigidVehicle:t("./objects/RigidVehicle"),RotationalEquation:t("./equations/RotationalEquation"),RotationalMotorEquation:t("./equations/RotationalMotorEquation"),SAPBroadphase:t("./collision/SAPBroadphase"),SPHSystem:t("./objects/SPHSystem"),Shape:t("./shapes/Shape"),Solver:t("./solver/Solver"),Sphere:t("./shapes/Sphere"),SplitSolver:t("./solver/SplitSolver"),Spring:t("./objects/Spring"),Trimesh:t("./shapes/Trimesh"),Vec3:t("./math/Vec3"),Vec3Pool:t("./utils/Vec3Pool"),World:t("./world/World")}},{"../package.json":1,"./collision/AABB":3,"./collision/ArrayCollisionMatrix":4,"./collision/Broadphase":5,"./collision/GridBroadphase":6,"./collision/NaiveBroadphase":7,"./collision/ObjectCollisionMatrix":8,"./collision/Ray":9,"./collision/RaycastResult":10,"./collision/SAPBroadphase":11,"./constraints/ConeTwistConstraint":12,"./constraints/Constraint":13,"./constraints/DistanceConstraint":14,"./constraints/HingeConstraint":15,"./constraints/LockConstraint":16,"./constraints/PointToPointConstraint":17,"./equations/ContactEquation":19,"./equations/Equation":20,"./equations/FrictionEquation":21,"./equations/RotationalEquation":22,"./equations/RotationalMotorEquation":23,"./material/ContactMaterial":24,"./material/Material":25,"./math/Mat3":27,"./math/Quaternion":28,"./math/Vec3":30,"./objects/Body":31,"./objects/RaycastVehicle":32,"./objects/RigidVehicle":33,"./objects/SPHSystem":34,"./objects/Spring":35,"./shapes/Box":37,"./shapes/ConvexPolyhedron":38,"./shapes/Cylinder":39,"./shapes/Heightfield":40,"./shapes/Particle":41,"./shapes/Plane":42,"./shapes/Shape":43,"./shapes/Sphere":44,"./shapes/Trimesh":45,"./solver/GSSolver":46,"./solver/Solver":47,"./solver/SplitSolver":48,"./utils/EventTarget":49,"./utils/Pool":51,"./utils/Vec3Pool":54,"./world/Narrowphase":55,"./world/World":56}],3:[function(t,e,r){var i=t("../math/Vec3");t("../utils/Utils");function n(t){t=t||{},this.lowerBound=new i,t.lowerBound&&this.lowerBound.copy(t.lowerBound),this.upperBound=new i,t.upperBound&&this.upperBound.copy(t.upperBound)}e.exports=n;var o=new i;n.prototype.setFromPoints=function(t,e,r,i){var n=this.lowerBound,a=this.upperBound,s=r;n.copy(t[0]),s&&s.vmult(n,n),a.copy(n);for(var h=1;h<t.length;h++){var l=t[h];s&&(s.vmult(l,o),l=o),l.x>a.x&&(a.x=l.x),l.x<n.x&&(n.x=l.x),l.y>a.y&&(a.y=l.y),l.y<n.y&&(n.y=l.y),l.z>a.z&&(a.z=l.z),l.z<n.z&&(n.z=l.z)}return e&&(e.vadd(n,n),e.vadd(a,a)),i&&(n.x-=i,n.y-=i,n.z-=i,a.x+=i,a.y+=i,a.z+=i),this},n.prototype.copy=function(t){return this.lowerBound.copy(t.lowerBound),this.upperBound.copy(t.upperBound),this},n.prototype.clone=function(){return(new n).copy(this)},n.prototype.extend=function(t){var e=t.lowerBound.x;this.lowerBound.x>e&&(this.lowerBound.x=e);var r=t.upperBound.x;this.upperBound.x<r&&(this.upperBound.x=r);e=t.lowerBound.y;this.lowerBound.y>e&&(this.lowerBound.y=e);r=t.upperBound.y;this.upperBound.y<r&&(this.upperBound.y=r);e=t.lowerBound.z;this.lowerBound.z>e&&(this.lowerBound.z=e);r=t.upperBound.z;this.upperBound.z<r&&(this.upperBound.z=r)},n.prototype.overlaps=function(t){var e=this.lowerBound,r=this.upperBound,i=t.lowerBound,n=t.upperBound;return(i.x<=r.x&&r.x<=n.x||e.x<=n.x&&n.x<=r.x)&&(i.y<=r.y&&r.y<=n.y||e.y<=n.y&&n.y<=r.y)&&(i.z<=r.z&&r.z<=n.z||e.z<=n.z&&n.z<=r.z)},n.prototype.contains=function(t){var e=this.lowerBound,r=this.upperBound,i=t.lowerBound,n=t.upperBound;return e.x<=i.x&&r.x>=n.x&&e.y<=i.y&&r.y>=n.y&&e.z<=i.z&&r.z>=n.z},n.prototype.getCorners=function(t,e,r,i,n,o,a,s){var h=this.lowerBound,l=this.upperBound;t.copy(h),e.set(l.x,h.y,h.z),r.set(l.x,l.y,h.z),i.set(h.x,l.y,l.z),n.set(l.x,h.y,h.z),o.set(h.x,l.y,h.z),a.set(h.x,h.y,l.z),s.copy(l)};var a=[new i,new i,new i,new i,new i,new i,new i,new i];n.prototype.toLocalFrame=function(t,e){var r=a,i=r[0],n=r[1],o=r[2],s=r[3],h=r[4],l=r[5],u=r[6],c=r[7];this.getCorners(i,n,o,s,h,l,u,c);for(var p=0;8!==p;p++){var d=r[p];t.pointToLocal(d,d)}return e.setFromPoints(r)},n.prototype.toWorldFrame=function(t,e){var r=a,i=r[0],n=r[1],o=r[2],s=r[3],h=r[4],l=r[5],u=r[6],c=r[7];this.getCorners(i,n,o,s,h,l,u,c);for(var p=0;8!==p;p++){var d=r[p];t.pointToWorld(d,d)}return e.setFromPoints(r)}},{"../math/Vec3":30,"../utils/Utils":53}],4:[function(t,e,r){function i(){this.matrix=[]}e.exports=i,i.prototype.get=function(t,e){if(t=t.index,(e=e.index)>t){var r=e;e=t,t=r}return this.matrix[(t*(t+1)>>1)+e-1]},i.prototype.set=function(t,e,r){if(t=t.index,(e=e.index)>t){var i=e;e=t,t=i}this.matrix[(t*(t+1)>>1)+e-1]=r?1:0},i.prototype.reset=function(){for(var t=0,e=this.matrix.length;t!==e;t++)this.matrix[t]=0},i.prototype.setNumObjects=function(t){this.matrix.length=t*(t-1)>>1}},{}],5:[function(t,e,r){var i=t("../objects/Body"),n=t("../math/Vec3"),o=t("../math/Quaternion");t("../shapes/Shape"),t("../shapes/Plane");function a(){this.world=null,this.useBoundingBoxes=!1,this.dirty=!0}e.exports=a,a.prototype.collisionPairs=function(t,e,r){throw new Error("collisionPairs not implemented for this BroadPhase class!")};var s=i.STATIC|i.KINEMATIC;a.prototype.needBroadphaseCollision=function(t,e){return 0!=(t.collisionFilterGroup&e.collisionFilterMask)&&0!=(e.collisionFilterGroup&t.collisionFilterMask)&&(0==(t.type&s)&&t.sleepState!==i.SLEEPING||0==(e.type&s)&&e.sleepState!==i.SLEEPING)},a.prototype.intersectionTest=function(t,e,r,i){this.useBoundingBoxes?this.doBoundingBoxBroadphase(t,e,r,i):this.doBoundingSphereBroadphase(t,e,r,i)};var h=new n;new n,new o,new n;a.prototype.doBoundingSphereBroadphase=function(t,e,r,i){var n=h;e.position.vsub(t.position,n);var o=Math.pow(t.boundingRadius+e.boundingRadius,2);n.norm2()<o&&(r.push(t),i.push(e))},a.prototype.doBoundingBoxBroadphase=function(t,e,r,i){t.aabbNeedsUpdate&&t.computeAABB(),e.aabbNeedsUpdate&&e.computeAABB(),t.aabb.overlaps(e.aabb)&&(r.push(t),i.push(e))};var l={keys:[]},u=[],c=[];a.prototype.makePairsUnique=function(t,e){for(var r=l,i=u,n=c,o=t.length,a=0;a!==o;a++)i[a]=t[a],n[a]=e[a];t.length=0,e.length=0;for(a=0;a!==o;a++){var s=i[a].id,h=n[a].id;r[p=s<h?s+","+h:h+","+s]=a,r.keys.push(p)}for(a=0;a!==r.keys.length;a++){var p=r.keys.pop(),d=r[p];t.push(i[d]),e.push(n[d]),delete r[p]}},a.prototype.setWorld=function(t){};var p=new n;a.boundingSphereCheck=function(t,e){var r=p;return t.position.vsub(e.position,r),Math.pow(t.shape.boundingSphereRadius+e.shape.boundingSphereRadius,2)>r.norm2()},a.prototype.aabbQuery=function(t,e,r){return console.warn(".aabbQuery is not implemented in this Broadphase subclass."),[]}},{"../math/Quaternion":28,"../math/Vec3":30,"../objects/Body":31,"../shapes/Plane":42,"../shapes/Shape":43}],6:[function(t,e,r){e.exports=a;var i=t("./Broadphase"),n=t("../math/Vec3"),o=t("../shapes/Shape");function a(t,e,r,o,a){i.apply(this),this.nx=r||10,this.ny=o||10,this.nz=a||10,this.aabbMin=t||new n(100,100,100),this.aabbMax=e||new n(-100,-100,-100);var s=this.nx*this.ny*this.nz;if(s<=0)throw"GridBroadphase: Each dimension's n must be >0";this.bins=[],this.binLengths=[],this.bins.length=s,this.binLengths.length=s;for(var h=0;h<s;h++)this.bins[h]=[],this.binLengths[h]=0}a.prototype=new i,a.prototype.constructor=a;var s=new n;new n;a.prototype.collisionPairs=function(t,e,r){for(var i=t.numObjects(),n=t.bodies,a=this.aabbMax,h=this.aabbMin,l=this.nx,u=this.ny,c=this.nz,p=u*c,d=c,f=a.x,m=a.y,v=a.z,y=h.x,g=h.y,_=h.z,x=l/(f-y),b=u/(m-g),w=c/(v-_),T=(f-y)/l,E=(m-g)/u,S=(v-_)/c,A=.5*Math.sqrt(T*T+E*E+S*S),I=o.types,P=I.SPHERE,M=I.PLANE,C=(I.BOX,I.COMPOUND,I.CONVEXPOLYHEDRON,this.bins),R=this.binLengths,O=this.bins.length,D=0;D!==O;D++)R[D]=0;var B=Math.ceil;h=Math.min,a=Math.max;function N(t,e,r,i,n,o,a){var s=(t-y)*x|0,h=(e-g)*b|0,f=(r-_)*w|0,m=B((i-y)*x),v=B((n-g)*b),T=B((o-_)*w);s<0?s=0:s>=l&&(s=l-1),h<0?h=0:h>=u&&(h=u-1),f<0?f=0:f>=c&&(f=c-1),m<0?m=0:m>=l&&(m=l-1),v<0?v=0:v>=u&&(v=u-1),T<0?T=0:T>=c&&(T=c-1),h*=d,f*=1,m*=p,v*=d,T*=1;for(var E=s*=p;E<=m;E+=p)for(var S=h;S<=v;S+=d)for(var A=f;A<=T;A+=1){var I=E+S+A;C[I][R[I]++]=a}}for(D=0;D!==i;D++){var k=(et=n[D]).shape;switch(k.type){case P:var F=et.position.x,L=et.position.y,V=et.position.z,X=k.radius;N(F-X,L-X,V-X,F+X,L+X,V+X,et);break;case M:k.worldNormalNeedsUpdate&&k.computeWorldNormal(et.quaternion);var j=k.worldNormal,U=y+.5*T-et.position.x,Y=g+.5*E-et.position.y,z=_+.5*S-et.position.z,W=s;W.set(U,Y,z);for(var q=0,G=0;q!==l;q++,G+=p,W.y=Y,W.x+=T)for(var H=0,$=0;H!==u;H++,$+=d,W.z=z,W.y+=E)for(var J=0,Z=0;J!==c;J++,Z+=1,W.z+=S)if(W.dot(j)<A){var Q=G+$+Z;C[Q][R[Q]++]=et}break;default:et.aabbNeedsUpdate&&et.computeAABB(),N(et.aabb.lowerBound.x,et.aabb.lowerBound.y,et.aabb.lowerBound.z,et.aabb.upperBound.x,et.aabb.upperBound.y,et.aabb.upperBound.z,et)}}for(D=0;D!==O;D++){var K=R[D];if(K>1){var tt=C[D];for(q=0;q!==K;q++){var et=tt[q];for(H=0;H!==q;H++){var rt=tt[H];this.needBroadphaseCollision(et,rt)&&this.intersectionTest(et,rt,e,r)}}}}this.makePairsUnique(e,r)}},{"../math/Vec3":30,"../shapes/Shape":43,"./Broadphase":5}],7:[function(t,e,r){e.exports=o;var i=t("./Broadphase"),n=t("./AABB");function o(){i.apply(this)}o.prototype=new i,o.prototype.constructor=o,o.prototype.collisionPairs=function(t,e,r){var i,n,o,a,s=t.bodies,h=s.length;for(i=0;i!==h;i++)for(n=0;n!==i;n++)o=s[i],a=s[n],this.needBroadphaseCollision(o,a)&&this.intersectionTest(o,a,e,r)};new n;o.prototype.aabbQuery=function(t,e,r){r=r||[];for(var i=0;i<t.bodies.length;i++){var n=t.bodies[i];n.aabbNeedsUpdate&&n.computeAABB(),n.aabb.overlaps(e)&&r.push(n)}return r}},{"./AABB":3,"./Broadphase":5}],8:[function(t,e,r){function i(){this.matrix={}}e.exports=i,i.prototype.get=function(t,e){if(t=t.id,(e=e.id)>t){var r=e;e=t,t=r}return t+"-"+e in this.matrix},i.prototype.set=function(t,e,r){if(t=t.id,(e=e.id)>t){var i=e;e=t,t=i}r?this.matrix[t+"-"+e]=!0:delete this.matrix[t+"-"+e]},i.prototype.reset=function(){this.matrix={}},i.prototype.setNumObjects=function(t){}},{}],9:[function(t,e,r){e.exports=l;var i=t("../math/Vec3"),n=t("../math/Quaternion"),o=t("../math/Transform"),a=(t("../shapes/ConvexPolyhedron"),t("../shapes/Box"),t("../collision/RaycastResult")),s=t("../shapes/Shape"),h=t("../collision/AABB");function l(t,e){this.from=t?t.clone():new i,this.to=e?e.clone():new i,this._direction=new i,this.precision=1e-4,this.checkCollisionResponse=!0,this.skipBackfaces=!1,this.collisionFilterMask=-1,this.collisionFilterGroup=-1,this.mode=l.ANY,this.result=new a,this.hasHit=!1,this.callback=function(t){}}l.prototype.constructor=l,l.CLOSEST=1,l.ANY=2,l.ALL=4;var u=new h,c=[];l.prototype.intersectWorld=function(t,e){return this.mode=e.mode||l.ANY,this.result=e.result||new a,this.skipBackfaces=!!e.skipBackfaces,this.collisionFilterMask=void 0!==e.collisionFilterMask?e.collisionFilterMask:-1,this.collisionFilterGroup=void 0!==e.collisionFilterGroup?e.collisionFilterGroup:-1,e.from&&this.from.copy(e.from),e.to&&this.to.copy(e.to),this.callback=e.callback||function(){},this.hasHit=!1,this.result.reset(),this._updateDirection(),this.getAABB(u),c.length=0,t.broadphase.aabbQuery(t,u,c),this.intersectBodies(c),this.hasHit};var p=new i,d=new i;function f(t,e,r,i){i.vsub(e,B),r.vsub(e,p),t.vsub(e,d);var n,o,a=B.dot(B),s=B.dot(p),h=B.dot(d),l=p.dot(p),u=p.dot(d);return(n=l*h-s*u)>=0&&(o=a*u-s*h)>=0&&n+o<a*l-s*s}l.pointInTriangle=f;var m=new i,v=new n;l.prototype.intersectBody=function(t,e){e&&(this.result=e,this._updateDirection());var r=this.checkCollisionResponse;if((!r||t.collisionResponse)&&0!=(this.collisionFilterGroup&t.collisionFilterMask)&&0!=(t.collisionFilterGroup&this.collisionFilterMask))for(var i=m,n=v,o=0,a=t.shapes.length;o<a;o++){var s=t.shapes[o];if((!r||s.collisionResponse)&&(t.quaternion.mult(t.shapeOrientations[o],n),t.quaternion.vmult(t.shapeOffsets[o],i),i.vadd(t.position,i),this.intersectShape(s,n,i,t),this.result._shouldStop))break}},l.prototype.intersectBodies=function(t,e){e&&(this.result=e,this._updateDirection());for(var r=0,i=t.length;!this.result._shouldStop&&r<i;r++)this.intersectBody(t[r])},l.prototype._updateDirection=function(){this.to.vsub(this.from,this._direction),this._direction.normalize()},l.prototype.intersectShape=function(t,e,r,i){if(!(function(t,e,r){r.vsub(t,B);var i=B.dot(e);return e.mult(i,N),N.vadd(t,N),r.distanceTo(N)}(this.from,this._direction,r)>t.boundingSphereRadius)){var n=this[t.type];n&&n.call(this,t,e,r,i)}};new i,new i;var y=new i,g=new i,_=new i,x=new i;new i,new a;l.prototype.intersectBox=function(t,e,r,i){return this.intersectConvex(t.convexPolyhedronRepresentation,e,r,i)},l.prototype[s.types.BOX]=l.prototype.intersectBox,l.prototype.intersectPlane=function(t,e,r,n){var o=this.from,a=this.to,s=this._direction,h=new i(0,0,1);e.vmult(h,h);var l=new i;o.vsub(r,l);var u=l.dot(h);if(a.vsub(r,l),!(u*l.dot(h)>0||o.distanceTo(a)<u)){var c=h.dot(s);if(!(Math.abs(c)<this.precision)){var p=new i,d=new i,f=new i;o.vsub(r,p);var m=-h.dot(p)/c;s.scale(m,d),o.vadd(d,f),this.reportIntersection(h,f,t,n,-1)}}},l.prototype[s.types.PLANE]=l.prototype.intersectPlane,l.prototype.getAABB=function(t){var e=this.to,r=this.from;t.lowerBound.x=Math.min(e.x,r.x),t.lowerBound.y=Math.min(e.y,r.y),t.lowerBound.z=Math.min(e.z,r.z),t.upperBound.x=Math.max(e.x,r.x),t.upperBound.y=Math.max(e.y,r.y),t.upperBound.z=Math.max(e.z,r.z)};var b={faceList:[0]};l.prototype.intersectHeightfield=function(t,e,r,n){t.data,t.elementSize;var a=new i,s=new l(this.from,this.to);o.pointToLocalFrame(r,e,s.from,s.from),o.pointToLocalFrame(r,e,s.to,s.to);var h=[],u=null,c=null,p=null,d=null,f=t.getIndexOfPosition(s.from.x,s.from.y,h,!1);if(f&&(u=h[0],c=h[1],p=h[0],d=h[1]),(f=t.getIndexOfPosition(s.to.x,s.to.y,h,!1))&&((null===u||h[0]<u)&&(u=h[0]),(null===p||h[0]>p)&&(p=h[0]),(null===c||h[1]<c)&&(c=h[1]),(null===d||h[1]>d)&&(d=h[1])),null!==u){var m=[];t.getRectMinMax(u,c,p,d,m);for(var v=u;v<=p;v++)for(var y=c;y<=d;y++){if(this.result._shouldStop)return;if(t.getConvexTrianglePillar(v,y,!1),o.pointToWorldFrame(r,e,t.pillarOffset,a),this.intersectConvex(t.pillarConvex,e,a,n,b),this.result._shouldStop)return;t.getConvexTrianglePillar(v,y,!0),o.pointToWorldFrame(r,e,t.pillarOffset,a),this.intersectConvex(t.pillarConvex,e,a,n,b)}}},l.prototype[s.types.HEIGHTFIELD]=l.prototype.intersectHeightfield;var w=new i,T=new i;l.prototype.intersectSphere=function(t,e,r,i){var n=this.from,o=this.to,a=t.radius,s=Math.pow(o.x-n.x,2)+Math.pow(o.y-n.y,2)+Math.pow(o.z-n.z,2),h=2*((o.x-n.x)*(n.x-r.x)+(o.y-n.y)*(n.y-r.y)+(o.z-n.z)*(n.z-r.z)),l=Math.pow(n.x-r.x,2)+Math.pow(n.y-r.y,2)+Math.pow(n.z-r.z,2)-Math.pow(a,2),u=Math.pow(h,2)-4*s*l,c=w,p=T;if(!(u<0))if(0===u)n.lerp(o,u,c),c.vsub(r,p),p.normalize(),this.reportIntersection(p,c,t,i,-1);else{var d=(-h-Math.sqrt(u))/(2*s),f=(-h+Math.sqrt(u))/(2*s);if(d>=0&&d<=1&&(n.lerp(o,d,c),c.vsub(r,p),p.normalize(),this.reportIntersection(p,c,t,i,-1)),this.result._shouldStop)return;f>=0&&f<=1&&(n.lerp(o,f,c),c.vsub(r,p),p.normalize(),this.reportIntersection(p,c,t,i,-1))}},l.prototype[s.types.SPHERE]=l.prototype.intersectSphere;var E=new i,S=(new i,new i,new i);l.prototype.intersectConvex=function(t,e,r,i,n){for(var o=E,a=S,s=n&&n.faceList||null,h=t.faces,l=t.vertices,u=t.faceNormals,c=this._direction,p=this.from,d=this.to,m=p.distanceTo(d),v=s?s.length:h.length,b=this.result,w=0;!b._shouldStop&&w<v;w++){var T=s?s[w]:w,A=h[T],I=u[T],P=e,M=r;a.copy(l[A[0]]),P.vmult(a,a),a.vadd(M,a),a.vsub(p,a),P.vmult(I,o);var C=c.dot(o);if(!(Math.abs(C)<this.precision)){var R=o.dot(a)/C;if(!(R<0)){c.mult(R,y),y.vadd(p,y),g.copy(l[A[0]]),P.vmult(g,g),M.vadd(g,g);for(var O=1;!b._shouldStop&&O<A.length-1;O++){_.copy(l[A[O]]),x.copy(l[A[O+1]]),P.vmult(_,_),P.vmult(x,x),M.vadd(_,_),M.vadd(x,x);var D=y.distanceTo(p);!f(y,g,_,x)&&!f(y,_,g,x)||D>m||this.reportIntersection(o,y,t,i,T)}}}}},l.prototype[s.types.CONVEXPOLYHEDRON]=l.prototype.intersectConvex;var A=new i,I=new i,P=new i,M=new i,C=new i,R=new i,O=(new h,[]),D=new o;l.prototype.intersectTrimesh=function(t,e,r,i,n){var a=A,s=O,h=D,l=S,u=I,c=P,p=M,d=R,m=C,v=(n&&n.faceList,t.indices),b=(t.vertices,t.faceNormals,this.from),w=this.to,T=this._direction;h.position.copy(r),h.quaternion.copy(e),o.vectorToLocalFrame(r,e,T,u),o.pointToLocalFrame(r,e,b,c),o.pointToLocalFrame(r,e,w,p);var E=c.distanceSquared(p);t.tree.rayQuery(this,h,s);for(var B=0,N=s.length;!this.result._shouldStop&&B!==N;B++){var k=s[B];t.getNormal(k,a),t.getVertex(v[3*k],g),g.vsub(c,l);var F=u.dot(a),L=a.dot(l)/F;if(!(L<0)){u.scale(L,y),y.vadd(c,y),t.getVertex(v[3*k+1],_),t.getVertex(v[3*k+2],x);var V=y.distanceSquared(c);!f(y,_,g,x)&&!f(y,g,_,x)||V>E||(o.vectorToWorldFrame(e,a,m),o.pointToWorldFrame(r,e,y,d),this.reportIntersection(m,d,t,i,k))}}s.length=0},l.prototype[s.types.TRIMESH]=l.prototype.intersectTrimesh,l.prototype.reportIntersection=function(t,e,r,i,n){var o=this.from,a=this.to,s=o.distanceTo(e),h=this.result;if(!(this.skipBackfaces&&t.dot(this._direction)>0))switch(h.hitFaceIndex=void 0!==n?n:-1,this.mode){case l.ALL:this.hasHit=!0,h.set(o,a,t,e,r,i,s),h.hasHit=!0,this.callback(h);break;case l.CLOSEST:(s<h.distance||!h.hasHit)&&(this.hasHit=!0,h.hasHit=!0,h.set(o,a,t,e,r,i,s));break;case l.ANY:this.hasHit=!0,h.hasHit=!0,h.set(o,a,t,e,r,i,s),h._shouldStop=!0}};var B=new i,N=new i},{"../collision/AABB":3,"../collision/RaycastResult":10,"../math/Quaternion":28,"../math/Transform":29,"../math/Vec3":30,"../shapes/Box":37,"../shapes/ConvexPolyhedron":38,"../shapes/Shape":43}],10:[function(t,e,r){var i=t("../math/Vec3");function n(){this.rayFromWorld=new i,this.rayToWorld=new i,this.hitNormalWorld=new i,this.hitPointWorld=new i,this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this._shouldStop=!1}e.exports=n,n.prototype.reset=function(){this.rayFromWorld.setZero(),this.rayToWorld.setZero(),this.hitNormalWorld.setZero(),this.hitPointWorld.setZero(),this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this._shouldStop=!1},n.prototype.abort=function(){this._shouldStop=!0},n.prototype.set=function(t,e,r,i,n,o,a){this.rayFromWorld.copy(t),this.rayToWorld.copy(e),this.hitNormalWorld.copy(r),this.hitPointWorld.copy(i),this.shape=n,this.body=o,this.distance=a}},{"../math/Vec3":30}],11:[function(t,e,r){t("../shapes/Shape");var i=t("../collision/Broadphase");function n(t){i.apply(this),this.axisList=[],this.world=null,this.axisIndex=0;var e=this.axisList;this._addBodyHandler=function(t){e.push(t.body)},this._removeBodyHandler=function(t){var r=e.indexOf(t.body);-1!==r&&e.splice(r,1)},t&&this.setWorld(t)}e.exports=n,n.prototype=new i,n.prototype.setWorld=function(t){this.axisList.length=0;for(var e=0;e<t.bodies.length;e++)this.axisList.push(t.bodies[e]);t.removeEventListener("addBody",this._addBodyHandler),t.removeEventListener("removeBody",this._removeBodyHandler),t.addEventListener("addBody",this._addBodyHandler),t.addEventListener("removeBody",this._removeBodyHandler),this.world=t,this.dirty=!0},n.insertionSortX=function(t){for(var e=1,r=t.length;e<r;e++){for(var i=t[e],n=e-1;n>=0&&!(t[n].aabb.lowerBound.x<=i.aabb.lowerBound.x);n--)t[n+1]=t[n];t[n+1]=i}return t},n.insertionSortY=function(t){for(var e=1,r=t.length;e<r;e++){for(var i=t[e],n=e-1;n>=0&&!(t[n].aabb.lowerBound.y<=i.aabb.lowerBound.y);n--)t[n+1]=t[n];t[n+1]=i}return t},n.insertionSortZ=function(t){for(var e=1,r=t.length;e<r;e++){for(var i=t[e],n=e-1;n>=0&&!(t[n].aabb.lowerBound.z<=i.aabb.lowerBound.z);n--)t[n+1]=t[n];t[n+1]=i}return t},n.prototype.collisionPairs=function(t,e,r){var i,o,a=this.axisList,s=a.length,h=this.axisIndex;for(this.dirty&&(this.sortList(),this.dirty=!1),i=0;i!==s;i++){var l=a[i];for(o=i+1;o<s;o++){var u=a[o];if(this.needBroadphaseCollision(l,u)){if(!n.checkBounds(l,u,h))break;this.intersectionTest(l,u,e,r)}}}},n.prototype.sortList=function(){for(var t=this.axisList,e=this.axisIndex,r=t.length,i=0;i!==r;i++){var o=t[i];o.aabbNeedsUpdate&&o.computeAABB()}0===e?n.insertionSortX(t):1===e?n.insertionSortY(t):2===e&&n.insertionSortZ(t)},n.checkBounds=function(t,e,r){var i,n;0===r?(i=t.position.x,n=e.position.x):1===r?(i=t.position.y,n=e.position.y):2===r&&(i=t.position.z,n=e.position.z);var o=t.boundingRadius,a=e.boundingRadius;return n-a<i+o},n.prototype.autoDetectAxis=function(){for(var t=0,e=0,r=0,i=0,n=0,o=0,a=this.axisList,s=a.length,h=1/s,l=0;l!==s;l++){var u=a[l],c=u.position.x;t+=c,e+=c*c;var p=u.position.y;r+=p,i+=p*p;var d=u.position.z;n+=d,o+=d*d}var f=e-t*t*h,m=i-r*r*h,v=o-n*n*h;this.axisIndex=f>m?f>v?0:2:m>v?1:2},n.prototype.aabbQuery=function(t,e,r){r=r||[],this.dirty&&(this.sortList(),this.dirty=!1);var i=this.axisIndex,n="x";1===i&&(n="y"),2===i&&(n="z");for(var o=this.axisList,a=(e.lowerBound[n],e.upperBound[n],0);a<o.length;a++){var s=o[a];s.aabbNeedsUpdate&&s.computeAABB(),s.aabb.overlaps(e)&&r.push(s)}return r}},{"../collision/Broadphase":5,"../shapes/Shape":43}],12:[function(t,e,r){e.exports=s;t("./Constraint");var i=t("./PointToPointConstraint"),n=t("../equations/ConeEquation"),o=t("../equations/RotationalEquation"),a=(t("../equations/ContactEquation"),t("../math/Vec3"));function s(t,e,r){var s=void 0!==(r=r||{}).maxForce?r.maxForce:1e6,h=r.pivotA?r.pivotA.clone():new a,l=r.pivotB?r.pivotB.clone():new a;this.axisA=r.axisA?r.axisA.clone():new a,this.axisB=r.axisB?r.axisB.clone():new a,i.call(this,t,h,e,l,s),this.collideConnected=!!r.collideConnected,this.angle=void 0!==r.angle?r.angle:0;var u=this.coneEquation=new n(t,e,r),c=this.twistEquation=new o(t,e,r);this.twistAngle=void 0!==r.twistAngle?r.twistAngle:0,u.maxForce=0,u.minForce=-s,c.maxForce=0,c.minForce=-s,this.equations.push(u,c)}s.prototype=new i,s.constructor=s;new a,new a;s.prototype.update=function(){var t=this.bodyA,e=this.bodyB,r=this.coneEquation,n=this.twistEquation;i.prototype.update.call(this),t.vectorToWorldFrame(this.axisA,r.axisA),e.vectorToWorldFrame(this.axisB,r.axisB),this.axisA.tangents(n.axisA,n.axisA),t.vectorToWorldFrame(n.axisA,n.axisA),this.axisB.tangents(n.axisB,n.axisB),e.vectorToWorldFrame(n.axisB,n.axisB),r.angle=this.angle,n.maxAngle=this.twistAngle}},{"../equations/ConeEquation":18,"../equations/ContactEquation":19,"../equations/RotationalEquation":22,"../math/Vec3":30,"./Constraint":13,"./PointToPointConstraint":17}],13:[function(t,e,r){e.exports=n;var i=t("../utils/Utils");function n(t,e,r){r=i.defaults(r,{collideConnected:!0,wakeUpBodies:!0}),this.equations=[],this.bodyA=t,this.bodyB=e,this.id=n.idCounter++,this.collideConnected=r.collideConnected,r.wakeUpBodies&&(t&&t.wakeUp(),e&&e.wakeUp())}n.prototype.update=function(){throw new Error("method update() not implmemented in this Constraint subclass!")},n.prototype.enable=function(){for(var t=this.equations,e=0;e<t.length;e++)t[e].enabled=!0},n.prototype.disable=function(){for(var t=this.equations,e=0;e<t.length;e++)t[e].enabled=!1},n.idCounter=0},{"../utils/Utils":53}],14:[function(t,e,r){e.exports=o;var i=t("./Constraint"),n=t("../equations/ContactEquation");function o(t,e,r,o){i.call(this,t,e),void 0===r&&(r=t.position.distanceTo(e.position)),void 0===o&&(o=1e6),this.distance=r;var a=this.distanceEquation=new n(t,e);this.equations.push(a),a.minForce=-o,a.maxForce=o}o.prototype=new i,o.prototype.update=function(){var t=this.bodyA,e=this.bodyB,r=this.distanceEquation,i=.5*this.distance,n=r.ni;e.position.vsub(t.position,n),n.normalize(),n.mult(i,r.ri),n.mult(-i,r.rj)}},{"../equations/ContactEquation":19,"./Constraint":13}],15:[function(t,e,r){e.exports=s;t("./Constraint");var i=t("./PointToPointConstraint"),n=t("../equations/RotationalEquation"),o=t("../equations/RotationalMotorEquation"),a=(t("../equations/ContactEquation"),t("../math/Vec3"));function s(t,e,r){var s=void 0!==(r=r||{}).maxForce?r.maxForce:1e6,h=r.pivotA?r.pivotA.clone():new a,l=r.pivotB?r.pivotB.clone():new a;i.call(this,t,h,e,l,s),(this.axisA=r.axisA?r.axisA.clone():new a(1,0,0)).normalize(),(this.axisB=r.axisB?r.axisB.clone():new a(1,0,0)).normalize();var u=this.rotationalEquation1=new n(t,e,r),c=this.rotationalEquation2=new n(t,e,r),p=this.motorEquation=new o(t,e,s);p.enabled=!1,this.equations.push(u,c,p)}s.prototype=new i,s.constructor=s,s.prototype.enableMotor=function(){this.motorEquation.enabled=!0},s.prototype.disableMotor=function(){this.motorEquation.enabled=!1},s.prototype.setMotorSpeed=function(t){this.motorEquation.targetVelocity=t},s.prototype.setMotorMaxForce=function(t){this.motorEquation.maxForce=t,this.motorEquation.minForce=-t};var h=new a,l=new a;s.prototype.update=function(){var t=this.bodyA,e=this.bodyB,r=this.motorEquation,n=this.rotationalEquation1,o=this.rotationalEquation2,a=h,s=l,u=this.axisA,c=this.axisB;i.prototype.update.call(this),t.quaternion.vmult(u,a),e.quaternion.vmult(c,s),a.tangents(n.axisA,o.axisA),n.axisB.copy(s),o.axisB.copy(s),this.motorEquation.enabled&&(t.quaternion.vmult(this.axisA,r.axisA),e.quaternion.vmult(this.axisB,r.axisB))}},{"../equations/ContactEquation":19,"../equations/RotationalEquation":22,"../equations/RotationalMotorEquation":23,"../math/Vec3":30,"./Constraint":13,"./PointToPointConstraint":17}],16:[function(t,e,r){e.exports=a;t("./Constraint");var i=t("./PointToPointConstraint"),n=t("../equations/RotationalEquation"),o=(t("../equations/RotationalMotorEquation"),t("../equations/ContactEquation"),t("../math/Vec3"));function a(t,e,r){var a=void 0!==(r=r||{}).maxForce?r.maxForce:1e6,s=new o,h=new o,l=new o;t.position.vadd(e.position,l),l.scale(.5,l),e.pointToLocalFrame(l,h),t.pointToLocalFrame(l,s),i.call(this,t,s,e,h,a);var u=this.rotationalEquation1=new n(t,e,r),c=this.rotationalEquation2=new n(t,e,r),p=this.rotationalEquation3=new n(t,e,r);this.equations.push(u,c,p)}a.prototype=new i,a.constructor=a;new o,new o;a.prototype.update=function(){var t=this.bodyA,e=this.bodyB,r=(this.motorEquation,this.rotationalEquation1),n=this.rotationalEquation2,a=this.rotationalEquation3;i.prototype.update.call(this),t.vectorToWorldFrame(o.UNIT_X,r.axisA),e.vectorToWorldFrame(o.UNIT_Y,r.axisB),t.vectorToWorldFrame(o.UNIT_Y,n.axisA),e.vectorToWorldFrame(o.UNIT_Z,n.axisB),t.vectorToWorldFrame(o.UNIT_Z,a.axisA),e.vectorToWorldFrame(o.UNIT_X,a.axisB)}},{"../equations/ContactEquation":19,"../equations/RotationalEquation":22,"../equations/RotationalMotorEquation":23,"../math/Vec3":30,"./Constraint":13,"./PointToPointConstraint":17}],17:[function(t,e,r){e.exports=a;var i=t("./Constraint"),n=t("../equations/ContactEquation"),o=t("../math/Vec3");function a(t,e,r,a,s){i.call(this,t,r),s=void 0!==s?s:1e6,this.pivotA=e?e.clone():new o,this.pivotB=a?a.clone():new o;var h=this.equationX=new n(t,r),l=this.equationY=new n(t,r),u=this.equationZ=new n(t,r);this.equations.push(h,l,u),h.minForce=l.minForce=u.minForce=-s,h.maxForce=l.maxForce=u.maxForce=s,h.ni.set(1,0,0),l.ni.set(0,1,0),u.ni.set(0,0,1)}a.prototype=new i,a.prototype.update=function(){var t=this.bodyA,e=this.bodyB,r=this.equationX,i=this.equationY,n=this.equationZ;t.quaternion.vmult(this.pivotA,r.ri),e.quaternion.vmult(this.pivotB,r.rj),i.ri.copy(r.ri),i.rj.copy(r.rj),n.ri.copy(r.ri),n.rj.copy(r.rj)}},{"../equations/ContactEquation":19,"../math/Vec3":30,"./Constraint":13}],18:[function(t,e,r){e.exports=o;var i=t("../math/Vec3"),n=(t("../math/Mat3"),t("./Equation"));function o(t,e,r){var o=void 0!==(r=r||{}).maxForce?r.maxForce:1e6;n.call(this,t,e,-o,o),this.axisA=r.axisA?r.axisA.clone():new i(1,0,0),this.axisB=r.axisB?r.axisB.clone():new i(0,1,0),this.angle=void 0!==r.angle?r.angle:0}o.prototype=new n,o.prototype.constructor=o;var a=new i,s=new i;o.prototype.computeB=function(t){var e=this.a,r=this.b,i=this.axisA,n=this.axisB,o=a,h=s,l=this.jacobianElementA,u=this.jacobianElementB;return i.cross(n,o),n.cross(i,h),l.rotational.copy(h),u.rotational.copy(o),-(Math.cos(this.angle)-i.dot(n))*e-this.computeGW()*r-t*this.computeGiMf()}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],19:[function(t,e,r){e.exports=o;var i=t("./Equation"),n=t("../math/Vec3");t("../math/Mat3");function o(t,e,r){r=void 0!==r?r:1e6,i.call(this,t,e,0,r),this.restitution=0,this.ri=new n,this.rj=new n,this.ni=new n}o.prototype=new i,o.prototype.constructor=o;var a=new n,s=new n,h=new n;o.prototype.computeB=function(t){var e=this.a,r=this.b,i=this.bi,n=this.bj,o=this.ri,l=this.rj,u=a,c=s,p=i.velocity,d=i.angularVelocity,f=(i.force,i.torque,n.velocity),m=n.angularVelocity,v=(n.force,n.torque,h),y=this.jacobianElementA,g=this.jacobianElementB,_=this.ni;o.cross(_,u),l.cross(_,c),_.negate(y.spatial),u.negate(y.rotational),g.spatial.copy(_),g.rotational.copy(c),v.copy(n.position),v.vadd(l,v),v.vsub(i.position,v),v.vsub(o,v);var x=_.dot(v),b=this.restitution+1;return-x*e-(b*f.dot(_)-b*p.dot(_)+m.dot(c)-d.dot(u))*r-t*this.computeGiMf()};var l=new n,u=new n,c=new n,p=new n,d=new n;o.prototype.getImpactVelocityAlongNormal=function(){var t=l,e=u,r=c,i=p,n=d;return this.bi.position.vadd(this.ri,r),this.bj.position.vadd(this.rj,i),this.bi.getVelocityAtWorldPoint(r,t),this.bj.getVelocityAtWorldPoint(i,e),t.vsub(e,n),this.ni.dot(n)}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],20:[function(t,e,r){e.exports=o;var i=t("../math/JacobianElement"),n=t("../math/Vec3");function o(t,e,r,n){this.id=o.id++,this.minForce=void 0===r?-1e6:r,this.maxForce=void 0===n?1e6:n,this.bi=t,this.bj=e,this.a=0,this.b=0,this.eps=0,this.jacobianElementA=new i,this.jacobianElementB=new i,this.enabled=!0,this.setSpookParams(1e7,4,1/60)}o.prototype.constructor=o,o.id=0,o.prototype.setSpookParams=function(t,e,r){var i=e,n=t,o=r;this.a=4/(o*(1+4*i)),this.b=4*i/(1+4*i),this.eps=4/(o*o*n*(1+4*i))},o.prototype.computeB=function(t,e,r){var i=this.computeGW();return-this.computeGq()*t-i*e-this.computeGiMf()*r},o.prototype.computeGq=function(){var t=this.jacobianElementA,e=this.jacobianElementB,r=this.bi,i=this.bj,n=r.position,o=i.position;return t.spatial.dot(n)+e.spatial.dot(o)};var a=new n;o.prototype.computeGW=function(){var t=this.jacobianElementA,e=this.jacobianElementB,r=this.bi,i=this.bj,n=r.velocity,o=i.velocity,s=r.angularVelocity||a,h=i.angularVelocity||a;return t.multiplyVectors(n,s)+e.multiplyVectors(o,h)},o.prototype.computeGWlambda=function(){var t=this.jacobianElementA,e=this.jacobianElementB,r=this.bi,i=this.bj,n=r.vlambda,o=i.vlambda,s=r.wlambda||a,h=i.wlambda||a;return t.multiplyVectors(n,s)+e.multiplyVectors(o,h)};var s=new n,h=new n,l=new n,u=new n;o.prototype.computeGiMf=function(){var t=this.jacobianElementA,e=this.jacobianElementB,r=this.bi,i=this.bj,n=r.force,o=r.torque,a=i.force,c=i.torque,p=r.invMassSolve,d=i.invMassSolve;return r.invInertiaWorldSolve?r.invInertiaWorldSolve.vmult(o,l):l.set(0,0,0),i.invInertiaWorldSolve?i.invInertiaWorldSolve.vmult(c,u):u.set(0,0,0),n.mult(p,s),a.mult(d,h),t.multiplyVectors(s,l)+e.multiplyVectors(h,u)};var c=new n;o.prototype.computeGiMGt=function(){var t=this.jacobianElementA,e=this.jacobianElementB,r=this.bi,i=this.bj,n=r.invMassSolve,o=i.invMassSolve,a=r.invInertiaWorldSolve,s=i.invInertiaWorldSolve,h=n+o;return a&&(a.vmult(t.rotational,c),h+=c.dot(t.rotational)),s&&(s.vmult(e.rotational,c),h+=c.dot(e.rotational)),h};var p=new n;new n,new n,new n,new n,new n;o.prototype.addToWlambda=function(t){var e=this.jacobianElementA,r=this.jacobianElementB,i=this.bi,n=this.bj,o=p;e.spatial.mult(i.invMassSolve*t,o),i.vlambda.vadd(o,i.vlambda),r.spatial.mult(n.invMassSolve*t,o),n.vlambda.vadd(o,n.vlambda),i.invInertiaWorldSolve&&(i.invInertiaWorldSolve.vmult(e.rotational,o),o.mult(t,o),i.wlambda.vadd(o,i.wlambda)),n.invInertiaWorldSolve&&(n.invInertiaWorldSolve.vmult(r.rotational,o),o.mult(t,o),n.wlambda.vadd(o,n.wlambda))},o.prototype.computeC=function(){return this.computeGiMGt()+this.eps}},{"../math/JacobianElement":26,"../math/Vec3":30}],21:[function(t,e,r){e.exports=o;var i=t("./Equation"),n=t("../math/Vec3");t("../math/Mat3");function o(t,e,r){i.call(this,t,e,-r,r),this.ri=new n,this.rj=new n,this.t=new n}o.prototype=new i,o.prototype.constructor=o;var a=new n,s=new n;o.prototype.computeB=function(t){this.a;var e=this.b,r=(this.bi,this.bj,this.ri),i=this.rj,n=a,o=s,h=this.t;r.cross(h,n),i.cross(h,o);var l=this.jacobianElementA,u=this.jacobianElementB;return h.negate(l.spatial),n.negate(l.rotational),u.spatial.copy(h),u.rotational.copy(o),-this.computeGW()*e-t*this.computeGiMf()}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],22:[function(t,e,r){e.exports=o;var i=t("../math/Vec3"),n=(t("../math/Mat3"),t("./Equation"));function o(t,e,r){var o=void 0!==(r=r||{}).maxForce?r.maxForce:1e6;n.call(this,t,e,-o,o),this.axisA=r.axisA?r.axisA.clone():new i(1,0,0),this.axisB=r.axisB?r.axisB.clone():new i(0,1,0),this.maxAngle=Math.PI/2}o.prototype=new n,o.prototype.constructor=o;var a=new i,s=new i;o.prototype.computeB=function(t){var e=this.a,r=this.b,i=this.axisA,n=this.axisB,o=a,h=s,l=this.jacobianElementA,u=this.jacobianElementB;return i.cross(n,o),n.cross(i,h),l.rotational.copy(h),u.rotational.copy(o),-(Math.cos(this.maxAngle)-i.dot(n))*e-this.computeGW()*r-t*this.computeGiMf()}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],23:[function(t,e,r){e.exports=o;var i=t("../math/Vec3"),n=(t("../math/Mat3"),t("./Equation"));function o(t,e,r){r=void 0!==r?r:1e6,n.call(this,t,e,-r,r),this.axisA=new i,this.axisB=new i,this.targetVelocity=0}o.prototype=new n,o.prototype.constructor=o,o.prototype.computeB=function(t){this.a;var e=this.b,r=(this.bi,this.bj,this.axisA),i=this.axisB,n=this.jacobianElementA,o=this.jacobianElementB;return n.rotational.copy(r),i.negate(o.rotational),-(this.computeGW()-this.targetVelocity)*e-t*this.computeGiMf()}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],24:[function(t,e,r){var i=t("../utils/Utils");function n(t,e,r){r=i.defaults(r,{friction:.3,restitution:.3,contactEquationStiffness:1e7,contactEquationRelaxation:3,frictionEquationStiffness:1e7,frictionEquationRelaxation:3}),this.id=n.idCounter++,this.materials=[t,e],this.friction=r.friction,this.restitution=r.restitution,this.contactEquationStiffness=r.contactEquationStiffness,this.contactEquationRelaxation=r.contactEquationRelaxation,this.frictionEquationStiffness=r.frictionEquationStiffness,this.frictionEquationRelaxation=r.frictionEquationRelaxation}e.exports=n,n.idCounter=0},{"../utils/Utils":53}],25:[function(t,e,r){function i(t){var e="";"string"==typeof(t=t||{})?(e=t,t={}):"object"==typeof t&&(e=""),this.name=e,this.id=i.idCounter++,this.friction=void 0!==t.friction?t.friction:-1,this.restitution=void 0!==t.restitution?t.restitution:-1}e.exports=i,i.idCounter=0},{}],26:[function(t,e,r){e.exports=n;var i=t("./Vec3");function n(){this.spatial=new i,this.rotational=new i}n.prototype.multiplyElement=function(t){return t.spatial.dot(this.spatial)+t.rotational.dot(this.rotational)},n.prototype.multiplyVectors=function(t,e){return t.dot(this.spatial)+e.dot(this.rotational)}},{"./Vec3":30}],27:[function(t,e,r){e.exports=n;var i=t("./Vec3");function n(t){this.elements=t||[0,0,0,0,0,0,0,0,0]}n.prototype.identity=function(){var t=this.elements;t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1},n.prototype.setZero=function(){var t=this.elements;t[0]=0,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t[8]=0},n.prototype.setTrace=function(t){var e=this.elements;e[0]=t.x,e[4]=t.y,e[8]=t.z},n.prototype.getTrace=function(t){t=t||new i;var e=this.elements;t.x=e[0],t.y=e[4],t.z=e[8]},n.prototype.vmult=function(t,e){e=e||new i;var r=this.elements,n=t.x,o=t.y,a=t.z;return e.x=r[0]*n+r[1]*o+r[2]*a,e.y=r[3]*n+r[4]*o+r[5]*a,e.z=r[6]*n+r[7]*o+r[8]*a,e},n.prototype.smult=function(t){for(var e=0;e<this.elements.length;e++)this.elements[e]*=t},n.prototype.mmult=function(t,e){for(var r=e||new n,i=0;i<3;i++)for(var o=0;o<3;o++){for(var a=0,s=0;s<3;s++)a+=t.elements[i+3*s]*this.elements[s+3*o];r.elements[i+3*o]=a}return r},n.prototype.scale=function(t,e){e=e||new n;for(var r=this.elements,i=e.elements,o=0;3!==o;o++)i[3*o+0]=t.x*r[3*o+0],i[3*o+1]=t.y*r[3*o+1],i[3*o+2]=t.z*r[3*o+2];return e},n.prototype.solve=function(t,e){e=e||new i;for(var r,n=[],o=0;o<12;o++)n.push(0);for(o=0;o<3;o++)for(r=0;r<3;r++)n[o+4*r]=this.elements[o+3*r];n[3]=t.x,n[7]=t.y,n[11]=t.z;var a,s,h=3,l=h;do{if(0===n[(o=l-h)+4*o])for(r=o+1;r<l;r++)if(0!==n[o+4*r]){a=4;do{n[(s=4-a)+4*o]+=n[s+4*r]}while(--a);break}if(0!==n[o+4*o])for(r=o+1;r<l;r++){var u=n[o+4*r]/n[o+4*o];a=4;do{n[(s=4-a)+4*r]=s<=o?0:n[s+4*r]-n[s+4*o]*u}while(--a)}}while(--h);if(e.z=n[11]/n[10],e.y=(n[7]-n[6]*e.z)/n[5],e.x=(n[3]-n[2]*e.z-n[1]*e.y)/n[0],isNaN(e.x)||isNaN(e.y)||isNaN(e.z)||e.x===1/0||e.y===1/0||e.z===1/0)throw"Could not solve equation! Got x=["+e.toString()+"], b=["+t.toString()+"], A=["+this.toString()+"]";return e},n.prototype.e=function(t,e,r){if(void 0===r)return this.elements[e+3*t];this.elements[e+3*t]=r},n.prototype.copy=function(t){for(var e=0;e<t.elements.length;e++)this.elements[e]=t.elements[e];return this},n.prototype.toString=function(){for(var t="",e=0;e<9;e++)t+=this.elements[e]+",";return t},n.prototype.reverse=function(t){t=t||new n;for(var e,r=[],i=0;i<18;i++)r.push(0);for(i=0;i<3;i++)for(e=0;e<3;e++)r[i+6*e]=this.elements[i+3*e];r[3]=1,r[9]=0,r[15]=0,r[4]=0,r[10]=1,r[16]=0,r[5]=0,r[11]=0,r[17]=1;var o,a,s=3,h=s;do{if(0===r[(i=h-s)+6*i])for(e=i+1;e<h;e++)if(0!==r[i+6*e]){o=6;do{r[(a=6-o)+6*i]+=r[a+6*e]}while(--o);break}if(0!==r[i+6*i])for(e=i+1;e<h;e++){var l=r[i+6*e]/r[i+6*i];o=6;do{r[(a=6-o)+6*e]=a<=i?0:r[a+6*e]-r[a+6*i]*l}while(--o)}}while(--s);i=2;do{e=i-1;do{l=r[i+6*e]/r[i+6*i];o=6;do{r[(a=6-o)+6*e]=r[a+6*e]-r[a+6*i]*l}while(--o)}while(e--)}while(--i);i=2;do{l=1/r[i+6*i];o=6;do{r[(a=6-o)+6*i]=r[a+6*i]*l}while(--o)}while(i--);i=2;do{e=2;do{if(a=r[3+e+6*i],isNaN(a)||a===1/0)throw"Could not reverse! A=["+this.toString()+"]";t.e(i,e,a)}while(e--)}while(i--);return t},n.prototype.setRotationFromQuaternion=function(t){var e=t.x,r=t.y,i=t.z,n=t.w,o=e+e,a=r+r,s=i+i,h=e*o,l=e*a,u=e*s,c=r*a,p=r*s,d=i*s,f=n*o,m=n*a,v=n*s,y=this.elements;return y[0]=1-(c+d),y[1]=l-v,y[2]=u+m,y[3]=l+v,y[4]=1-(h+d),y[5]=p-f,y[6]=u-m,y[7]=p+f,y[8]=1-(h+c),this},n.prototype.transpose=function(t){for(var e=(t=t||new n).elements,r=this.elements,i=0;3!==i;i++)for(var o=0;3!==o;o++)e[3*i+o]=r[3*o+i];return t}},{"./Vec3":30}],28:[function(t,e,r){e.exports=n;var i=t("./Vec3");function n(t,e,r,i){this.x=void 0!==t?t:0,this.y=void 0!==e?e:0,this.z=void 0!==r?r:0,this.w=void 0!==i?i:1}n.prototype.set=function(t,e,r,i){this.x=t,this.y=e,this.z=r,this.w=i},n.prototype.toString=function(){return this.x+","+this.y+","+this.z+","+this.w},n.prototype.toArray=function(){return[this.x,this.y,this.z,this.w]},n.prototype.setFromAxisAngle=function(t,e){var r=Math.sin(.5*e);this.x=t.x*r,this.y=t.y*r,this.z=t.z*r,this.w=Math.cos(.5*e)},n.prototype.toAxisAngle=function(t){t=t||new i,this.normalize();var e=2*Math.acos(this.w),r=Math.sqrt(1-this.w*this.w);return r<.001?(t.x=this.x,t.y=this.y,t.z=this.z):(t.x=this.x/r,t.y=this.y/r,t.z=this.z/r),[t,e]};var o=new i,a=new i;n.prototype.setFromVectors=function(t,e){if(t.isAntiparallelTo(e)){var r=o,i=a;t.tangents(r,i),this.setFromAxisAngle(r,Math.PI)}else{var n=t.cross(e);this.x=n.x,this.y=n.y,this.z=n.z,this.w=Math.sqrt(Math.pow(t.norm(),2)*Math.pow(e.norm(),2))+t.dot(e),this.normalize()}};var s=new i,h=new i,l=new i;n.prototype.mult=function(t,e){e=e||new n;var r=this.w,i=s,o=h,a=l;return i.set(this.x,this.y,this.z),o.set(t.x,t.y,t.z),e.w=r*t.w-i.dot(o),i.cross(o,a),e.x=r*o.x+t.w*i.x+a.x,e.y=r*o.y+t.w*i.y+a.y,e.z=r*o.z+t.w*i.z+a.z,e},n.prototype.inverse=function(t){var e=this.x,r=this.y,i=this.z,o=this.w;t=t||new n,this.conjugate(t);var a=1/(e*e+r*r+i*i+o*o);return t.x*=a,t.y*=a,t.z*=a,t.w*=a,t},n.prototype.conjugate=function(t){return(t=t||new n).x=-this.x,t.y=-this.y,t.z=-this.z,t.w=this.w,t},n.prototype.normalize=function(){var t=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);0===t?(this.x=0,this.y=0,this.z=0,this.w=0):(t=1/t,this.x*=t,this.y*=t,this.z*=t,this.w*=t)},n.prototype.normalizeFast=function(){var t=(3-(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w))/2;0===t?(this.x=0,this.y=0,this.z=0,this.w=0):(this.x*=t,this.y*=t,this.z*=t,this.w*=t)},n.prototype.vmult=function(t,e){e=e||new i;var r=t.x,n=t.y,o=t.z,a=this.x,s=this.y,h=this.z,l=this.w,u=l*r+s*o-h*n,c=l*n+h*r-a*o,p=l*o+a*n-s*r,d=-a*r-s*n-h*o;return e.x=u*l+d*-a+c*-h-p*-s,e.y=c*l+d*-s+p*-a-u*-h,e.z=p*l+d*-h+u*-s-c*-a,e},n.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this},n.prototype.toEuler=function(t,e){var r,i,n;e=e||"YZX";var o=this.x,a=this.y,s=this.z,h=this.w;switch(e){case"YZX":var l=o*a+s*h;if(l>.499&&(r=2*Math.atan2(o,h),i=Math.PI/2,n=0),l<-.499&&(r=-2*Math.atan2(o,h),i=-Math.PI/2,n=0),isNaN(r)){var u=o*o,c=a*a,p=s*s;r=Math.atan2(2*a*h-2*o*s,1-2*c-2*p),i=Math.asin(2*l),n=Math.atan2(2*o*h-2*a*s,1-2*u-2*p)}break;default:throw new Error("Euler order "+e+" not supported yet.")}t.y=r,t.z=i,t.x=n},n.prototype.setFromEuler=function(t,e,r,i){i=i||"XYZ";var n=Math.cos(t/2),o=Math.cos(e/2),a=Math.cos(r/2),s=Math.sin(t/2),h=Math.sin(e/2),l=Math.sin(r/2);return"XYZ"===i?(this.x=s*o*a+n*h*l,this.y=n*h*a-s*o*l,this.z=n*o*l+s*h*a,this.w=n*o*a-s*h*l):"YXZ"===i?(this.x=s*o*a+n*h*l,this.y=n*h*a-s*o*l,this.z=n*o*l-s*h*a,this.w=n*o*a+s*h*l):"ZXY"===i?(this.x=s*o*a-n*h*l,this.y=n*h*a+s*o*l,this.z=n*o*l+s*h*a,this.w=n*o*a-s*h*l):"ZYX"===i?(this.x=s*o*a-n*h*l,this.y=n*h*a+s*o*l,this.z=n*o*l-s*h*a,this.w=n*o*a+s*h*l):"YZX"===i?(this.x=s*o*a+n*h*l,this.y=n*h*a+s*o*l,this.z=n*o*l-s*h*a,this.w=n*o*a-s*h*l):"XZY"===i&&(this.x=s*o*a-n*h*l,this.y=n*h*a-s*o*l,this.z=n*o*l+s*h*a,this.w=n*o*a+s*h*l),this},n.prototype.clone=function(){return new n(this.x,this.y,this.z,this.w)}},{"./Vec3":30}],29:[function(t,e,r){var i=t("./Vec3"),n=t("./Quaternion");function o(t){t=t||{},this.position=new i,t.position&&this.position.copy(t.position),this.quaternion=new n,t.quaternion&&this.quaternion.copy(t.quaternion)}e.exports=o;var a=new n;o.pointToLocalFrame=function(t,e,r,n){n=n||new i;return r.vsub(t,n),e.conjugate(a),a.vmult(n,n),n},o.prototype.pointToLocal=function(t,e){return o.pointToLocalFrame(this.position,this.quaternion,t,e)},o.pointToWorldFrame=function(t,e,r,n){n=n||new i;return e.vmult(r,n),n.vadd(t,n),n},o.prototype.pointToWorld=function(t,e){return o.pointToWorldFrame(this.position,this.quaternion,t,e)},o.prototype.vectorToWorldFrame=function(t,e){e=e||new i;return this.quaternion.vmult(t,e),e},o.vectorToWorldFrame=function(t,e,r){return t.vmult(e,r),r},o.vectorToLocalFrame=function(t,e,r,n){n=n||new i;return e.w*=-1,e.vmult(r,n),e.w*=-1,n}},{"./Quaternion":28,"./Vec3":30}],30:[function(t,e,r){e.exports=n;var i=t("./Mat3");function n(t,e,r){this.x=t||0,this.y=e||0,this.z=r||0}n.ZERO=new n(0,0,0),n.UNIT_X=new n(1,0,0),n.UNIT_Y=new n(0,1,0),n.UNIT_Z=new n(0,0,1),n.prototype.cross=function(t,e){var r=t.x,i=t.y,o=t.z,a=this.x,s=this.y,h=this.z;return(e=e||new n).x=s*o-h*i,e.y=h*r-a*o,e.z=a*i-s*r,e},n.prototype.set=function(t,e,r){return this.x=t,this.y=e,this.z=r,this},n.prototype.setZero=function(){this.x=this.y=this.z=0},n.prototype.vadd=function(t,e){if(!e)return new n(this.x+t.x,this.y+t.y,this.z+t.z);e.x=t.x+this.x,e.y=t.y+this.y,e.z=t.z+this.z},n.prototype.vsub=function(t,e){if(!e)return new n(this.x-t.x,this.y-t.y,this.z-t.z);e.x=this.x-t.x,e.y=this.y-t.y,e.z=this.z-t.z},n.prototype.crossmat=function(){return new i([0,-this.z,this.y,this.z,0,-this.x,-this.y,this.x,0])},n.prototype.normalize=function(){var t=this.x,e=this.y,r=this.z,i=Math.sqrt(t*t+e*e+r*r);if(i>0){var n=1/i;this.x*=n,this.y*=n,this.z*=n}else this.x=0,this.y=0,this.z=0;return i},n.prototype.unit=function(t){t=t||new n;var e=this.x,r=this.y,i=this.z,o=Math.sqrt(e*e+r*r+i*i);return o>0?(o=1/o,t.x=e*o,t.y=r*o,t.z=i*o):(t.x=1,t.y=0,t.z=0),t},n.prototype.norm=function(){var t=this.x,e=this.y,r=this.z;return Math.sqrt(t*t+e*e+r*r)},n.prototype.length=n.prototype.norm,n.prototype.norm2=function(){return this.dot(this)},n.prototype.lengthSquared=n.prototype.norm2,n.prototype.distanceTo=function(t){var e=this.x,r=this.y,i=this.z,n=t.x,o=t.y,a=t.z;return Math.sqrt((n-e)*(n-e)+(o-r)*(o-r)+(a-i)*(a-i))},n.prototype.distanceSquared=function(t){var e=this.x,r=this.y,i=this.z,n=t.x,o=t.y,a=t.z;return(n-e)*(n-e)+(o-r)*(o-r)+(a-i)*(a-i)},n.prototype.mult=function(t,e){e=e||new n;var r=this.x,i=this.y,o=this.z;return e.x=t*r,e.y=t*i,e.z=t*o,e},n.prototype.scale=n.prototype.mult,n.prototype.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z},n.prototype.isZero=function(){return 0===this.x&&0===this.y&&0===this.z},n.prototype.negate=function(t){return(t=t||new n).x=-this.x,t.y=-this.y,t.z=-this.z,t};var o=new n,a=new n;n.prototype.tangents=function(t,e){var r=this.norm();if(r>0){var i=o,n=1/r;i.set(this.x*n,this.y*n,this.z*n);var s=a;Math.abs(i.x)<.9?(s.set(1,0,0),i.cross(s,t)):(s.set(0,1,0),i.cross(s,t)),i.cross(t,e)}else t.set(1,0,0),e.set(0,1,0)},n.prototype.toString=function(){return this.x+","+this.y+","+this.z},n.prototype.toArray=function(){return[this.x,this.y,this.z]},n.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},n.prototype.lerp=function(t,e,r){var i=this.x,n=this.y,o=this.z;r.x=i+(t.x-i)*e,r.y=n+(t.y-n)*e,r.z=o+(t.z-o)*e},n.prototype.almostEquals=function(t,e){return void 0===e&&(e=1e-6),!(Math.abs(this.x-t.x)>e||Math.abs(this.y-t.y)>e||Math.abs(this.z-t.z)>e)},n.prototype.almostZero=function(t){return void 0===t&&(t=1e-6),!(Math.abs(this.x)>t||Math.abs(this.y)>t||Math.abs(this.z)>t)};var s=new n;n.prototype.isAntiparallelTo=function(t,e){return this.negate(s),s.almostEquals(t,e)},n.prototype.clone=function(){return new n(this.x,this.y,this.z)}},{"./Mat3":27}],31:[function(t,e,r){e.exports=l;var i=t("../utils/EventTarget"),n=(t("../shapes/Shape"),t("../math/Vec3")),o=t("../math/Mat3"),a=t("../math/Quaternion"),s=(t("../material/Material"),t("../collision/AABB")),h=t("../shapes/Box");function l(t){t=t||{},i.apply(this),this.id=l.idCounter++,this.world=null,this.preStep=null,this.postStep=null,this.vlambda=new n,this.collisionFilterGroup="number"==typeof t.collisionFilterGroup?t.collisionFilterGroup:1,this.collisionFilterMask="number"==typeof t.collisionFilterMask?t.collisionFilterMask:1,this.collisionResponse=!0,this.position=new n,t.position&&this.position.copy(t.position),this.previousPosition=new n,this.initPosition=new n,this.velocity=new n,t.velocity&&this.velocity.copy(t.velocity),this.initVelocity=new n,this.force=new n;var e="number"==typeof t.mass?t.mass:0;this.mass=e,this.invMass=e>0?1/e:0,this.material=t.material||null,this.linearDamping="number"==typeof t.linearDamping?t.linearDamping:.01,this.type=e<=0?l.STATIC:l.DYNAMIC,typeof t.type==typeof l.STATIC&&(this.type=t.type),this.allowSleep=void 0===t.allowSleep||t.allowSleep,this.sleepState=0,this.sleepSpeedLimit=void 0!==t.sleepSpeedLimit?t.sleepSpeedLimit:.1,this.sleepTimeLimit=void 0!==t.sleepTimeLimit?t.sleepTimeLimit:1,this.timeLastSleepy=0,this._wakeUpAfterNarrowphase=!1,this.torque=new n,this.quaternion=new a,t.quaternion&&this.quaternion.copy(t.quaternion),this.initQuaternion=new a,this.angularVelocity=new n,t.angularVelocity&&this.angularVelocity.copy(t.angularVelocity),this.initAngularVelocity=new n,this.interpolatedPosition=new n,this.interpolatedQuaternion=new a,this.shapes=[],this.shapeOffsets=[],this.shapeOrientations=[],this.inertia=new n,this.invInertia=new n,this.invInertiaWorld=new o,this.invMassSolve=0,this.invInertiaSolve=new n,this.invInertiaWorldSolve=new o,this.fixedRotation=void 0!==t.fixedRotation&&t.fixedRotation,this.angularDamping=void 0!==t.angularDamping?t.angularDamping:.01,this.aabb=new s,this.aabbNeedsUpdate=!0,this.wlambda=new n,t.shape&&this.addShape(t.shape),this.updateMassProperties()}l.prototype=new i,l.prototype.constructor=l,l.DYNAMIC=1,l.STATIC=2,l.KINEMATIC=4,l.AWAKE=0,l.SLEEPY=1,l.SLEEPING=2,l.idCounter=0,l.prototype.wakeUp=function(){var t=this.sleepState;this.sleepState=0,t===l.SLEEPING&&this.dispatchEvent({type:"wakeup"})},l.prototype.sleep=function(){this.sleepState=l.SLEEPING,this.velocity.set(0,0,0),this.angularVelocity.set(0,0,0)},l.sleepyEvent={type:"sleepy"},l.sleepEvent={type:"sleep"},l.prototype.sleepTick=function(t){if(this.allowSleep){var e=this.sleepState,r=this.velocity.norm2()+this.angularVelocity.norm2(),i=Math.pow(this.sleepSpeedLimit,2);e===l.AWAKE&&r<i?(this.sleepState=l.SLEEPY,this.timeLastSleepy=t,this.dispatchEvent(l.sleepyEvent)):e===l.SLEEPY&&r>i?this.wakeUp():e===l.SLEEPY&&t-this.timeLastSleepy>this.sleepTimeLimit&&(this.sleep(),this.dispatchEvent(l.sleepEvent))}},l.prototype.updateSolveMassProperties=function(){this.sleepState===l.SLEEPING||this.type===l.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve.setZero(),this.invInertiaWorldSolve.setZero()):(this.invMassSolve=this.invMass,this.invInertiaSolve.copy(this.invInertia),this.invInertiaWorldSolve.copy(this.invInertiaWorld))},l.prototype.pointToLocalFrame=function(t,e){e=e||new n;return t.vsub(this.position,e),this.quaternion.conjugate().vmult(e,e),e},l.prototype.vectorToLocalFrame=function(t,e){e=e||new n;return this.quaternion.conjugate().vmult(t,e),e},l.prototype.pointToWorldFrame=function(t,e){e=e||new n;return this.quaternion.vmult(t,e),e.vadd(this.position,e),e},l.prototype.vectorToWorldFrame=function(t,e){e=e||new n;return this.quaternion.vmult(t,e),e};var u=new n,c=new a;l.prototype.addShape=function(t,e,r){var i=new n,o=new a;return e&&i.copy(e),r&&o.copy(r),this.shapes.push(t),this.shapeOffsets.push(i),this.shapeOrientations.push(o),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,this},l.prototype.updateBoundingRadius=function(){for(var t=this.shapes,e=this.shapeOffsets,r=t.length,i=0,n=0;n!==r;n++){var o=t[n];o.updateBoundingSphereRadius();var a=e[n].norm(),s=o.boundingSphereRadius;a+s>i&&(i=a+s)}this.boundingRadius=i};var p=new s;l.prototype.computeAABB=function(){for(var t=this.shapes,e=this.shapeOffsets,r=this.shapeOrientations,i=t.length,n=u,o=c,a=this.quaternion,s=this.aabb,h=p,l=0;l!==i;l++){var d=t[l];r[l].mult(a,o),o.vmult(e[l],n),n.vadd(this.position,n),d.calculateWorldAABB(n,o,h.lowerBound,h.upperBound),0===l?s.copy(h):s.extend(h)}this.aabbNeedsUpdate=!1};var d=new o,f=new o;new o;l.prototype.updateInertiaWorld=function(t){var e=this.invInertia;if(e.x!==e.y||e.y!==e.z||t){var r=d,i=f;r.setRotationFromQuaternion(this.quaternion),r.transpose(i),r.scale(e,r),r.mmult(i,this.invInertiaWorld)}else;};var m=new n,v=new n;l.prototype.applyForce=function(t,e){if(this.type===l.DYNAMIC){var r=m;e.vsub(this.position,r);var i=v;r.cross(t,i),this.force.vadd(t,this.force),this.torque.vadd(i,this.torque)}};var y=new n,g=new n;l.prototype.applyLocalForce=function(t,e){if(this.type===l.DYNAMIC){var r=y,i=g;this.vectorToWorldFrame(t,r),this.pointToWorldFrame(e,i),this.applyForce(r,i)}};var _=new n,x=new n,b=new n;l.prototype.applyImpulse=function(t,e){if(this.type===l.DYNAMIC){var r=_;e.vsub(this.position,r);var i=x;i.copy(t),i.mult(this.invMass,i),this.velocity.vadd(i,this.velocity);var n=b;r.cross(t,n),this.invInertiaWorld.vmult(n,n),this.angularVelocity.vadd(n,this.angularVelocity)}};var w=new n,T=new n;l.prototype.applyLocalImpulse=function(t,e){if(this.type===l.DYNAMIC){var r=w,i=T;this.vectorToWorldFrame(t,r),this.pointToWorldFrame(e,i),this.applyImpulse(r,i)}};var E=new n;l.prototype.updateMassProperties=function(){var t=E;this.invMass=this.mass>0?1/this.mass:0;var e=this.inertia,r=this.fixedRotation;this.computeAABB(),t.set((this.aabb.upperBound.x-this.aabb.lowerBound.x)/2,(this.aabb.upperBound.y-this.aabb.lowerBound.y)/2,(this.aabb.upperBound.z-this.aabb.lowerBound.z)/2),h.calculateInertia(t,this.mass,e),this.invInertia.set(e.x>0&&!r?1/e.x:0,e.y>0&&!r?1/e.y:0,e.z>0&&!r?1/e.z:0),this.updateInertiaWorld(!0)},l.prototype.getVelocityAtWorldPoint=function(t,e){var r=new n;return t.vsub(this.position,r),this.angularVelocity.cross(r,e),this.velocity.vadd(e,e),e}},{"../collision/AABB":3,"../material/Material":25,"../math/Mat3":27,"../math/Quaternion":28,"../math/Vec3":30,"../shapes/Box":37,"../shapes/Shape":43,"../utils/EventTarget":49}],32:[function(t,e,r){t("./Body");var i=t("../math/Vec3"),n=t("../math/Quaternion"),o=(t("../collision/RaycastResult"),t("../collision/Ray")),a=t("../objects/WheelInfo");function s(t){this.chassisBody=t.chassisBody,this.wheelInfos=[],this.sliding=!1,this.world=null,this.indexRightAxis=void 0!==t.indexRightAxis?t.indexRightAxis:1,this.indexForwardAxis=void 0!==t.indexForwardAxis?t.indexForwardAxis:0,this.indexUpAxis=void 0!==t.indexUpAxis?t.indexUpAxis:2}e.exports=s;new i,new i,new i;var h=new i,l=new i,u=new i;new o;s.prototype.addWheel=function(t){var e=new a(t=t||{}),r=this.wheelInfos.length;return this.wheelInfos.push(e),r},s.prototype.setSteeringValue=function(t,e){this.wheelInfos[e].steering=t};new i;s.prototype.applyEngineForce=function(t,e){this.wheelInfos[e].engineForce=t},s.prototype.setBrake=function(t,e){this.wheelInfos[e].brake=t},s.prototype.addToWorld=function(t){this.constraints;t.add(this.chassisBody);var e=this;this.preStepCallback=function(){e.updateVehicle(t.dt)},t.addEventListener("preStep",this.preStepCallback),this.world=t},s.prototype.getVehicleAxisWorld=function(t,e){e.set(0===t?1:0,1===t?1:0,2===t?1:0),this.chassisBody.vectorToWorldFrame(e,e)},s.prototype.updateVehicle=function(t){for(var e=this.wheelInfos,r=e.length,n=this.chassisBody,o=0;o<r;o++)this.updateWheelTransform(o);this.currentVehicleSpeedKmHour=3.6*n.velocity.norm();var a=new i;this.getVehicleAxisWorld(this.indexForwardAxis,a),a.dot(n.velocity)<0&&(this.currentVehicleSpeedKmHour*=-1);for(o=0;o<r;o++)this.castRay(e[o]);this.updateSuspension(t);var s=new i,h=new i;for(o=0;o<r;o++){var l=(d=e[o]).suspensionForce;l>d.maxSuspensionForce&&(l=d.maxSuspensionForce),d.raycastResult.hitNormalWorld.scale(l*t,s),d.raycastResult.hitPointWorld.vsub(n.position,h),n.applyImpulse(s,d.raycastResult.hitPointWorld)}this.updateFriction(t);var u=new i,c=new i,p=new i;for(o=0;o<r;o++){var d=e[o];n.getVelocityAtWorldPoint(d.chassisConnectionPointWorld,p);var f=1;switch(this.indexUpAxis){case 1:f=-1}if(d.isInContact){this.getVehicleAxisWorld(this.indexForwardAxis,c);var m=c.dot(d.raycastResult.hitNormalWorld);d.raycastResult.hitNormalWorld.scale(m,u),c.vsub(u,c);var v=c.dot(p);d.deltaRotation=f*v*t/d.radius}!d.sliding&&d.isInContact||0===d.engineForce||!d.useCustomSlidingRotationalSpeed||(d.deltaRotation=(d.engineForce>0?1:-1)*d.customSlidingRotationalSpeed*t),Math.abs(d.brake)>Math.abs(d.engineForce)&&(d.deltaRotation=0),d.rotation+=d.deltaRotation,d.deltaRotation*=.99}},s.prototype.updateSuspension=function(t){for(var e=this.chassisBody.mass,r=this.wheelInfos,i=r.length,n=0;n<i;n++){var o=r[n];if(o.isInContact){var a,s=o.suspensionRestLength-o.suspensionLength;a=o.suspensionStiffness*s*o.clippedInvContactDotSuspension;var h=o.suspensionRelativeVelocity;a-=(h<0?o.dampingCompression:o.dampingRelaxation)*h,o.suspensionForce=a*e,o.suspensionForce<0&&(o.suspensionForce=0)}else o.suspensionForce=0}},s.prototype.removeFromWorld=function(t){this.constraints;t.remove(this.chassisBody),t.removeEventListener("preStep",this.preStepCallback),this.world=null};var c=new i,p=new i;s.prototype.castRay=function(t){var e=c,r=p;this.updateWheelTransformWorld(t);var n=this.chassisBody,o=-1,a=t.suspensionRestLength+t.radius;t.directionWorld.scale(a,e);var s=t.chassisConnectionPointWorld;s.vadd(e,r);var h=t.raycastResult;h.reset();var l=n.collisionResponse;n.collisionResponse=!1,this.world.rayTest(s,r,h),n.collisionResponse=l;var u=h.body;if(t.raycastResult.groundObject=0,u){o=h.distance,t.raycastResult.hitNormalWorld=h.hitNormalWorld,t.isInContact=!0;var d=h.distance;t.suspensionLength=d-t.radius;var f=t.suspensionRestLength-t.maxSuspensionTravel,m=t.suspensionRestLength+t.maxSuspensionTravel;t.suspensionLength<f&&(t.suspensionLength=f),t.suspensionLength>m&&(t.suspensionLength=m,t.raycastResult.reset());var v=t.raycastResult.hitNormalWorld.dot(t.directionWorld),y=new i;n.getVelocityAtWorldPoint(t.raycastResult.hitPointWorld,y);var g=t.raycastResult.hitNormalWorld.dot(y);if(v>=-.1)t.suspensionRelativeVelocity=0,t.clippedInvContactDotSuspension=10;else{var _=-1/v;t.suspensionRelativeVelocity=g*_,t.clippedInvContactDotSuspension=_}}else t.suspensionLength=t.suspensionRestLength+0*t.maxSuspensionTravel,t.suspensionRelativeVelocity=0,t.directionWorld.scale(-1,t.raycastResult.hitNormalWorld),t.clippedInvContactDotSuspension=1;return o},s.prototype.updateWheelTransformWorld=function(t){t.isInContact=!1;var e=this.chassisBody;e.pointToWorldFrame(t.chassisConnectionPointLocal,t.chassisConnectionPointWorld),e.vectorToWorldFrame(t.directionLocal,t.directionWorld),e.vectorToWorldFrame(t.axleLocal,t.axleWorld)},s.prototype.updateWheelTransform=function(t){var e=h,r=l,i=u,o=this.wheelInfos[t];this.updateWheelTransformWorld(o),o.directionLocal.scale(-1,e),r.copy(o.axleLocal),e.cross(r,i),i.normalize(),r.normalize();var a=o.steering,s=new n;s.setFromAxisAngle(e,a);var c=new n;c.setFromAxisAngle(r,o.rotation);var p=o.worldTransform.quaternion;this.chassisBody.quaternion.mult(s,p),p.mult(c,p),p.normalize();var d=o.worldTransform.position;d.copy(o.directionWorld),d.scale(o.suspensionLength,d),d.vadd(o.chassisConnectionPointWorld,d)};var d=[new i(1,0,0),new i(0,1,0),new i(0,0,1)];s.prototype.getWheelTransformWorld=function(t){return this.wheelInfos[t].worldTransform};var f=new i,m=[],v=[];s.prototype.updateFriction=function(t){for(var e=f,r=this.wheelInfos,n=r.length,o=this.chassisBody,a=v,s=m,h=0;h<n;h++){(p=(A=r[h]).raycastResult.body)&&0,A.sideImpulse=0,A.forwardImpulse=0,a[h]||(a[h]=new i),s[h]||(s[h]=new i)}for(h=0;h<n;h++){if(p=(A=r[h]).raycastResult.body){var l=s[h];this.getWheelTransformWorld(h).vectorToWorldFrame(d[this.indexRightAxis],l);var u=A.raycastResult.hitNormalWorld,c=l.dot(u);u.scale(c,e),l.vsub(e,l),l.normalize(),u.cross(l,a[h]),a[h].normalize(),A.sideImpulse=M(o,A.raycastResult.hitPointWorld,p,A.raycastResult.hitPointWorld,l),A.sideImpulse*=1}}this.sliding=!1;for(h=0;h<n;h++){var p=(A=r[h]).raycastResult.body,y=0;if(A.slipInfo=1,p){var g=A.brake?A.brake:0;y=x(o,p,A.raycastResult.hitPointWorld,a[h],g);var _=g/(y+=A.engineForce*t);A.slipInfo*=_}if(A.forwardImpulse=0,A.skidInfo=1,p){A.skidInfo=1;var b=A.suspensionForce*t*A.frictionSlip,w=b*b;A.forwardImpulse=y;var T=.5*A.forwardImpulse,E=1*A.sideImpulse,S=T*T+E*E;if(A.sliding=!1,S>w){this.sliding=!0,A.sliding=!0;_=b/Math.sqrt(S);A.skidInfo*=_}}}if(this.sliding)for(h=0;h<n;h++){0!==(A=r[h]).sideImpulse&&A.skidInfo<1&&(A.forwardImpulse*=A.skidInfo,A.sideImpulse*=A.skidInfo)}for(h=0;h<n;h++){var A=r[h],I=new i;if(I.copy(A.raycastResult.hitPointWorld),0!==A.forwardImpulse){var P=new i;a[h].scale(A.forwardImpulse,P),o.applyImpulse(P,I)}if(0!==A.sideImpulse){p=A.raycastResult.body;var C=new i;C.copy(A.raycastResult.hitPointWorld);var R=new i;s[h].scale(A.sideImpulse,R),o.pointToLocalFrame(I,I),I["xyz"[this.indexUpAxis]]*=A.rollInfluence,o.pointToWorldFrame(I,I),o.applyImpulse(R,I),R.scale(-1,R),p.applyImpulse(R,C)}}};var y=new i,g=new i,_=new i;function x(t,e,r,i,n){var o=0,a=r,s=y,h=g,l=_;t.getVelocityAtWorldPoint(a,s),e.getVelocityAtWorldPoint(a,h),s.vsub(h,l);return n<(o=-i.dot(l)*(1/(S(t,r,i)+S(e,r,i))))&&(o=n),o<-n&&(o=-n),o}var b=new i,w=new i,T=new i,E=new i;function S(t,e,r){var i=b,n=w,o=T,a=E;return e.vsub(t.position,i),i.cross(r,n),t.invInertiaWorld.vmult(n,a),a.cross(i,o),t.invMass+r.dot(o)}var A=new i,I=new i,P=new i;function M(t,e,r,i,n,o){if(n.norm2()>1.1)return 0;var a=A,s=I,h=P;t.getVelocityAtWorldPoint(e,a),r.getVelocityAtWorldPoint(i,s),a.vsub(s,h);return-.2*n.dot(h)*(1/(t.invMass+r.invMass))}},{"../collision/Ray":9,"../collision/RaycastResult":10,"../math/Quaternion":28,"../math/Vec3":30,"../objects/WheelInfo":36,"./Body":31}],33:[function(t,e,r){var i=t("./Body"),n=t("../shapes/Sphere"),o=t("../shapes/Box"),a=t("../math/Vec3"),s=t("../constraints/HingeConstraint");function h(t){if(this.wheelBodies=[],this.coordinateSystem=void 0===t.coordinateSystem?new a(1,2,3):t.coordinateSystem.clone(),this.chassisBody=t.chassisBody,!this.chassisBody){var e=new o(new a(5,2,.5));this.chassisBody=new i(1,e)}this.constraints=[],this.wheelAxes=[],this.wheelForces=[]}e.exports=h,h.prototype.addWheel=function(t){var e=(t=t||{}).body;e||(e=new i(1,new n(1.2))),this.wheelBodies.push(e),this.wheelForces.push(0);new a;var r=void 0!==t.position?t.position.clone():new a,o=new a;this.chassisBody.pointToWorldFrame(r,o),e.position.set(o.x,o.y,o.z);var h=void 0!==t.axis?t.axis.clone():new a(0,1,0);this.wheelAxes.push(h);var l=new s(this.chassisBody,e,{pivotA:r,axisA:h,pivotB:a.ZERO,axisB:h,collideConnected:!1});return this.constraints.push(l),this.wheelBodies.length-1},h.prototype.setSteeringValue=function(t,e){var r=this.wheelAxes[e],i=Math.cos(t),n=Math.sin(t),o=r.x,a=r.y;this.constraints[e].axisA.set(i*o-n*a,n*o+i*a,0)},h.prototype.setMotorSpeed=function(t,e){var r=this.constraints[e];r.enableMotor(),r.motorTargetVelocity=t},h.prototype.disableMotor=function(t){this.constraints[t].disableMotor()};var l=new a;h.prototype.setWheelForce=function(t,e){this.wheelForces[e]=t},h.prototype.applyWheelForce=function(t,e){var r=this.wheelAxes[e],i=this.wheelBodies[e],n=i.torque;r.scale(t,l),i.vectorToWorldFrame(l,l),n.vadd(l,n)},h.prototype.addToWorld=function(t){for(var e=this.constraints,r=this.wheelBodies.concat([this.chassisBody]),i=0;i<r.length;i++)t.add(r[i]);for(i=0;i<e.length;i++)t.addConstraint(e[i]);t.addEventListener("preStep",this._update.bind(this))},h.prototype._update=function(){for(var t=this.wheelForces,e=0;e<t.length;e++)this.applyWheelForce(t[e],e)},h.prototype.removeFromWorld=function(t){for(var e=this.constraints,r=this.wheelBodies.concat([this.chassisBody]),i=0;i<r.length;i++)t.remove(r[i]);for(i=0;i<e.length;i++)t.removeConstraint(e[i])};var u=new a;h.prototype.getWheelSpeed=function(t){var e=this.wheelAxes[t],r=this.wheelBodies[t].angularVelocity;return this.chassisBody.vectorToWorldFrame(e,u),r.dot(u)}},{"../constraints/HingeConstraint":15,"../math/Vec3":30,"../shapes/Box":37,"../shapes/Sphere":44,"./Body":31}],34:[function(t,e,r){e.exports=n;t("../shapes/Shape");var i=t("../math/Vec3");t("../math/Quaternion"),t("../shapes/Particle"),t("../objects/Body"),t("../material/Material");function n(){this.particles=[],this.density=1,this.smoothingRadius=1,this.speedOfSound=1,this.viscosity=.01,this.eps=1e-6,this.pressures=[],this.densities=[],this.neighbors=[]}n.prototype.add=function(t){this.particles.push(t),this.neighbors.length<this.particles.length&&this.neighbors.push([])},n.prototype.remove=function(t){var e=this.particles.indexOf(t);-1!==e&&(this.particles.splice(e,1),this.neighbors.length>this.particles.length&&this.neighbors.pop())};var o=new i;n.prototype.getNeighbors=function(t,e){for(var r=this.particles.length,i=t.id,n=this.smoothingRadius*this.smoothingRadius,a=o,s=0;s!==r;s++){var h=this.particles[s];h.position.vsub(t.position,a),i!==h.id&&a.norm2()<n&&e.push(h)}};var a=new i,s=new i,h=new i,l=new i,u=new i,c=new i;n.prototype.update=function(){for(var t=this.particles.length,e=a,r=this.speedOfSound,i=this.eps,n=0;n!==t;n++){var o=this.particles[n];(S=this.neighbors[n]).length=0,this.getNeighbors(o,S),S.push(this.particles[n]);for(var p=S.length,d=0,f=0;f!==p;f++){o.position.vsub(S[f].position,e);var m=e.norm(),v=this.w(m);d+=S[f].mass*v}this.densities[n]=d,this.pressures[n]=r*r*(this.densities[n]-this.density)}var y=s,g=h,_=l,x=u,b=c;for(n=0;n!==t;n++){var w,T,E=this.particles[n];y.set(0,0,0),g.set(0,0,0);var S;for(p=(S=this.neighbors[n]).length,f=0;f!==p;f++){var A=S[f];E.position.vsub(A.position,x);var I=x.norm();w=-A.mass*(this.pressures[n]/(this.densities[n]*this.densities[n]+i)+this.pressures[f]/(this.densities[f]*this.densities[f]+i)),this.gradw(x,_),_.mult(w,_),y.vadd(_,y),A.velocity.vsub(E.velocity,b),b.mult(1/(1e-4+this.densities[n]*this.densities[f])*this.viscosity*A.mass,b),T=this.nablaw(I),b.mult(T,b),g.vadd(b,g)}g.mult(E.mass,g),y.mult(E.mass,y),E.force.vadd(g,E.force),E.force.vadd(y,E.force)}},n.prototype.w=function(t){var e=this.smoothingRadius;return 315/(64*Math.PI*Math.pow(e,9))*Math.pow(e*e-t*t,3)},n.prototype.gradw=function(t,e){var r=t.norm(),i=this.smoothingRadius;t.mult(945/(32*Math.PI*Math.pow(i,9))*Math.pow(i*i-r*r,2),e)},n.prototype.nablaw=function(t){var e=this.smoothingRadius;return 945/(32*Math.PI*Math.pow(e,9))*(e*e-t*t)*(7*t*t-3*e*e)}},{"../material/Material":25,"../math/Quaternion":28,"../math/Vec3":30,"../objects/Body":31,"../shapes/Particle":41,"../shapes/Shape":43}],35:[function(t,e,r){var i=t("../math/Vec3");function n(t,e,r){r=r||{},this.restLength="number"==typeof r.restLength?r.restLength:1,this.stiffness=r.stiffness||100,this.damping=r.damping||1,this.bodyA=t,this.bodyB=e,this.localAnchorA=new i,this.localAnchorB=new i,r.localAnchorA&&this.localAnchorA.copy(r.localAnchorA),r.localAnchorB&&this.localAnchorB.copy(r.localAnchorB),r.worldAnchorA&&this.setWorldAnchorA(r.worldAnchorA),r.worldAnchorB&&this.setWorldAnchorB(r.worldAnchorB)}e.exports=n,n.prototype.setWorldAnchorA=function(t){this.bodyA.pointToLocalFrame(t,this.localAnchorA)},n.prototype.setWorldAnchorB=function(t){this.bodyB.pointToLocalFrame(t,this.localAnchorB)},n.prototype.getWorldAnchorA=function(t){this.bodyA.pointToWorldFrame(this.localAnchorA,t)},n.prototype.getWorldAnchorB=function(t){this.bodyB.pointToWorldFrame(this.localAnchorB,t)};var o=new i,a=new i,s=new i,h=new i,l=new i,u=new i,c=new i,p=new i,d=new i,f=new i,m=new i;n.prototype.applyForce=function(){var t=this.stiffness,e=this.damping,r=this.restLength,i=this.bodyA,n=this.bodyB,v=o,y=a,g=s,_=h,x=m,b=l,w=u,T=c,E=p,S=d,A=f;this.getWorldAnchorA(b),this.getWorldAnchorB(w),b.vsub(i.position,T),w.vsub(n.position,E),w.vsub(b,v);var I=v.norm();y.copy(v),y.normalize(),n.velocity.vsub(i.velocity,g),n.angularVelocity.cross(E,x),g.vadd(x,g),i.angularVelocity.cross(T,x),g.vsub(x,g),y.mult(-t*(I-r)-e*g.dot(y),_),i.force.vsub(_,i.force),n.force.vadd(_,n.force),T.cross(_,S),E.cross(_,A),i.torque.vsub(S,i.torque),n.torque.vadd(A,n.torque)}},{"../math/Vec3":30}],36:[function(t,e,r){var i=t("../math/Vec3"),n=t("../math/Transform"),o=t("../collision/RaycastResult"),a=t("../utils/Utils");function s(t){t=a.defaults(t,{chassisConnectionPointLocal:new i,chassisConnectionPointWorld:new i,directionLocal:new i,directionWorld:new i,axleLocal:new i,axleWorld:new i,suspensionRestLength:1,suspensionMaxLength:2,radius:1,suspensionStiffness:100,dampingCompression:10,dampingRelaxation:10,frictionSlip:1e4,steering:0,rotation:0,deltaRotation:0,rollInfluence:.01,maxSuspensionForce:Number.MAX_VALUE,isFrontWheel:!0,clippedInvContactDotSuspension:1,suspensionRelativeVelocity:0,suspensionForce:0,skidInfo:0,suspensionLength:0,maxSuspensionTravel:1,useCustomSlidingRotationalSpeed:!1,customSlidingRotationalSpeed:-.1}),this.maxSuspensionTravel=t.maxSuspensionTravel,this.customSlidingRotationalSpeed=t.customSlidingRotationalSpeed,this.useCustomSlidingRotationalSpeed=t.useCustomSlidingRotationalSpeed,this.sliding=!1,this.chassisConnectionPointLocal=t.chassisConnectionPointLocal.clone(),this.chassisConnectionPointWorld=t.chassisConnectionPointWorld.clone(),this.directionLocal=t.directionLocal.clone(),this.directionWorld=t.directionWorld.clone(),this.axleLocal=t.axleLocal.clone(),this.axleWorld=t.axleWorld.clone(),this.suspensionRestLength=t.suspensionRestLength,this.suspensionMaxLength=t.suspensionMaxLength,this.radius=t.radius,this.suspensionStiffness=t.suspensionStiffness,this.dampingCompression=t.dampingCompression,this.dampingRelaxation=t.dampingRelaxation,this.frictionSlip=t.frictionSlip,this.steering=0,this.rotation=0,this.deltaRotation=0,this.rollInfluence=t.rollInfluence,this.maxSuspensionForce=t.maxSuspensionForce,this.engineForce=0,this.brake=0,this.isFrontWheel=t.isFrontWheel,this.clippedInvContactDotSuspension=1,this.suspensionRelativeVelocity=0,this.suspensionForce=0,this.skidInfo=0,this.suspensionLength=0,this.sideImpulse=0,this.forwardImpulse=0,this.raycastResult=new o,this.worldTransform=new n,this.isInContact=!1}e.exports=s;var h=new i,l=new i;h=new i;s.prototype.updateWheel=function(t){var e=this.raycastResult;if(this.isInContact){var r=e.hitNormalWorld.dot(e.directionWorld);e.hitPointWorld.vsub(t.position,l),t.getVelocityAtWorldPoint(l,h);var i=e.hitNormalWorld.dot(h);if(r>=-.1)this.suspensionRelativeVelocity=0,this.clippedInvContactDotSuspension=10;else{var n=-1/r;this.suspensionRelativeVelocity=i*n,this.clippedInvContactDotSuspension=n}}else e.suspensionLength=this.suspensionRestLength,this.suspensionRelativeVelocity=0,e.directionWorld.scale(-1,e.hitNormalWorld),this.clippedInvContactDotSuspension=1}},{"../collision/RaycastResult":10,"../math/Transform":29,"../math/Vec3":30,"../utils/Utils":53}],37:[function(t,e,r){e.exports=a;var i=t("./Shape"),n=t("../math/Vec3"),o=t("./ConvexPolyhedron");function a(t){i.call(this),this.type=i.types.BOX,this.halfExtents=t,this.convexPolyhedronRepresentation=null,this.updateConvexPolyhedronRepresentation(),this.updateBoundingSphereRadius()}a.prototype=new i,a.prototype.constructor=a,a.prototype.updateConvexPolyhedronRepresentation=function(){var t=this.halfExtents.x,e=this.halfExtents.y,r=this.halfExtents.z,i=n,a=[new i(-t,-e,-r),new i(t,-e,-r),new i(t,e,-r),new i(-t,e,-r),new i(-t,-e,r),new i(t,-e,r),new i(t,e,r),new i(-t,e,r)],s=(new i(0,0,1),new i(0,1,0),new i(1,0,0),new o(a,[[3,2,1,0],[4,5,6,7],[5,4,0,1],[2,3,7,6],[0,4,7,3],[1,2,6,5]]));this.convexPolyhedronRepresentation=s,s.material=this.material},a.prototype.calculateLocalInertia=function(t,e){return e=e||new n,a.calculateInertia(this.halfExtents,t,e),e},a.calculateInertia=function(t,e,r){var i=t;r.x=1/12*e*(2*i.y*2*i.y+2*i.z*2*i.z),r.y=1/12*e*(2*i.x*2*i.x+2*i.z*2*i.z),r.z=1/12*e*(2*i.y*2*i.y+2*i.x*2*i.x)},a.prototype.getSideNormals=function(t,e){var r=t,i=this.halfExtents;if(r[0].set(i.x,0,0),r[1].set(0,i.y,0),r[2].set(0,0,i.z),r[3].set(-i.x,0,0),r[4].set(0,-i.y,0),r[5].set(0,0,-i.z),void 0!==e)for(var n=0;n!==r.length;n++)e.vmult(r[n],r[n]);return r},a.prototype.volume=function(){return 8*this.halfExtents.x*this.halfExtents.y*this.halfExtents.z},a.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=this.halfExtents.norm()};var s=new n;new n;a.prototype.forEachWorldCorner=function(t,e,r){for(var i=this.halfExtents,n=[[i.x,i.y,i.z],[-i.x,i.y,i.z],[-i.x,-i.y,i.z],[-i.x,-i.y,-i.z],[i.x,-i.y,-i.z],[i.x,i.y,-i.z],[-i.x,i.y,-i.z],[i.x,-i.y,i.z]],o=0;o<n.length;o++)s.set(n[o][0],n[o][1],n[o][2]),e.vmult(s,s),t.vadd(s,s),r(s.x,s.y,s.z)};var h=[new n,new n,new n,new n,new n,new n,new n,new n];a.prototype.calculateWorldAABB=function(t,e,r,i){var n=this.halfExtents;h[0].set(n.x,n.y,n.z),h[1].set(-n.x,n.y,n.z),h[2].set(-n.x,-n.y,n.z),h[3].set(-n.x,-n.y,-n.z),h[4].set(n.x,-n.y,-n.z),h[5].set(n.x,n.y,-n.z),h[6].set(-n.x,n.y,-n.z),h[7].set(n.x,-n.y,n.z);var o=h[0];e.vmult(o,o),t.vadd(o,o),i.copy(o),r.copy(o);for(var a=1;a<8;a++){o=h[a];e.vmult(o,o),t.vadd(o,o);var s=o.x,l=o.y,u=o.z;s>i.x&&(i.x=s),l>i.y&&(i.y=l),u>i.z&&(i.z=u),s<r.x&&(r.x=s),l<r.y&&(r.y=l),u<r.z&&(r.z=u)}}},{"../math/Vec3":30,"./ConvexPolyhedron":38,"./Shape":43}],38:[function(t,e,r){e.exports=a;var i=t("./Shape"),n=t("../math/Vec3"),o=(t("../math/Quaternion"),t("../math/Transform"));function a(t,e,r){i.call(this),this.type=i.types.CONVEXPOLYHEDRON,this.vertices=t||[],this.worldVertices=[],this.worldVerticesNeedsUpdate=!0,this.faces=e||[],this.faceNormals=[],this.computeNormals(),this.worldFaceNormalsNeedsUpdate=!0,this.worldFaceNormals=[],this.uniqueEdges=[],this.uniqueAxes=r?r.slice():null,this.computeEdges(),this.updateBoundingSphereRadius()}a.prototype=new i,a.prototype.constructor=a;var s=new n;a.prototype.computeEdges=function(){var t=this.faces,e=this.vertices,r=(e.length,this.uniqueEdges);r.length=0;for(var i=s,n=0;n!==t.length;n++)for(var o=t[n],a=o.length,h=0;h!==a;h++){var l=(h+1)%a;e[o[h]].vsub(e[o[l]],i),i.normalize();for(var u=!1,c=0;c!==r.length;c++)if(r[c].almostEquals(i)||r[c].almostEquals(i)){u=!0;break}u||r.push(i.clone())}},a.prototype.computeNormals=function(){this.faceNormals.length=this.faces.length;for(var t=0;t<this.faces.length;t++){for(var e=0;e<this.faces[t].length;e++)if(!this.vertices[this.faces[t][e]])throw new Error("Vertex "+this.faces[t][e]+" not found!");var r=this.faceNormals[t]||new n;this.getFaceNormal(t,r),r.negate(r),this.faceNormals[t]=r;var i=this.vertices[this.faces[t][0]];if(r.dot(i)<0){console.error(".faceNormals["+t+"] = Vec3("+r.toString()+") looks like it points into the shape? The vertices follow. Make sure they are ordered CCW around the normal, using the right hand rule.");for(e=0;e<this.faces[t].length;e++)console.warn(".vertices["+this.faces[t][e]+"] = Vec3("+this.vertices[this.faces[t][e]].toString()+")")}}};var h=new n,l=new n;a.computeNormal=function(t,e,r,i){e.vsub(t,l),r.vsub(e,h),h.cross(l,i),i.isZero()||i.normalize()},a.prototype.getFaceNormal=function(t,e){var r=this.faces[t],i=this.vertices[r[0]],n=this.vertices[r[1]],o=this.vertices[r[2]];return a.computeNormal(i,n,o,e)};var u=new n;a.prototype.clipAgainstHull=function(t,e,r,i,o,a,s,h,l){for(var c=u,p=-1,d=-Number.MAX_VALUE,f=0;f<r.faces.length;f++){c.copy(r.faceNormals[f]),o.vmult(c,c);var m=c.dot(a);m>d&&(d=m,p=f)}for(var v=[],y=r.faces[p],g=y.length,_=0;_<g;_++){var x=r.vertices[y[_]],b=new n;b.copy(x),o.vmult(b,b),i.vadd(b,b),v.push(b)}p>=0&&this.clipFaceAgainstHull(a,t,e,v,s,h,l)};var c=new n,p=new n,d=new n,f=new n,m=new n,v=new n;a.prototype.findSeparatingAxis=function(t,e,r,i,n,o,a,s){var h=c,l=p,u=d,y=f,g=m,_=v,x=Number.MAX_VALUE;if(this.uniqueAxes)for(w=0;w!==this.uniqueAxes.length;w++){if(r.vmult(this.uniqueAxes[w],h),!1===(S=this.testSepAxis(h,t,e,r,i,n)))return!1;S<x&&(x=S,o.copy(h))}else for(var b=a?a.length:this.faces.length,w=0;w<b;w++){var T=a?a[w]:w;if(h.copy(this.faceNormals[T]),r.vmult(h,h),!1===(S=this.testSepAxis(h,t,e,r,i,n)))return!1;S<x&&(x=S,o.copy(h))}if(t.uniqueAxes)for(w=0;w!==t.uniqueAxes.length;w++){if(n.vmult(t.uniqueAxes[w],l),!1===(S=this.testSepAxis(l,t,e,r,i,n)))return!1;S<x&&(x=S,o.copy(l))}else for(var E=s?s.length:t.faces.length,w=0;w<E;w++){var S;T=s?s[w]:w;if(l.copy(t.faceNormals[T]),n.vmult(l,l),!1===(S=this.testSepAxis(l,t,e,r,i,n)))return!1;S<x&&(x=S,o.copy(l))}for(var A=0;A!==this.uniqueEdges.length;A++){r.vmult(this.uniqueEdges[A],y);for(var I=0;I!==t.uniqueEdges.length;I++)if(n.vmult(t.uniqueEdges[I],g),y.cross(g,_),!_.almostZero()){_.normalize();var P=this.testSepAxis(_,t,e,r,i,n);if(!1===P)return!1;P<x&&(x=P,o.copy(_))}}return i.vsub(e,u),u.dot(o)>0&&o.negate(o),!0};var y=[],g=[];a.prototype.testSepAxis=function(t,e,r,i,n,o){a.project(this,t,r,i,y),a.project(e,t,n,o,g);var s=y[0],h=y[1],l=g[0],u=g[1];if(s<u||l<h)return!1;var c=s-u,p=l-h;return c<p?c:p};var _=new n,x=new n;a.prototype.calculateLocalInertia=function(t,e){this.computeLocalAABB(_,x);var r=x.x-_.x,i=x.y-_.y,n=x.z-_.z;e.x=1/12*t*(2*i*2*i+2*n*2*n),e.y=1/12*t*(2*r*2*r+2*n*2*n),e.z=1/12*t*(2*i*2*i+2*r*2*r)},a.prototype.getPlaneConstantOfFace=function(t){var e=this.faces[t],r=this.faceNormals[t],i=this.vertices[e[0]];return-r.dot(i)};var b=new n,w=new n,T=new n,E=new n,S=new n,A=new n,I=new n,P=new n;a.prototype.clipFaceAgainstHull=function(t,e,r,i,n,o,a){for(var s=b,h=w,l=T,u=E,c=S,p=A,d=I,f=P,m=i,v=[],y=-1,g=Number.MAX_VALUE,_=0;_<this.faces.length;_++){s.copy(this.faceNormals[_]),r.vmult(s,s);var x=s.dot(t);x<g&&(g=x,y=_)}if(!(y<0)){var M=this.faces[y];M.connectedFaces=[];for(var C=0;C<this.faces.length;C++)for(var R=0;R<this.faces[C].length;R++)-1!==M.indexOf(this.faces[C][R])&&C!==y&&-1===M.connectedFaces.indexOf(C)&&M.connectedFaces.push(C);m.length;for(var O=M.length,D=0;D<O;D++){var B=this.vertices[M[D]],N=this.vertices[M[(D+1)%O]];B.vsub(N,h),l.copy(h),r.vmult(l,l),e.vadd(l,l),u.copy(this.faceNormals[y]),r.vmult(u,u),e.vadd(u,u),l.cross(u,c),c.negate(c),p.copy(B),r.vmult(p,p),e.vadd(p,p);p.dot(c);var k=M.connectedFaces[D];d.copy(this.faceNormals[k]);var F=this.getPlaneConstantOfFace(k);f.copy(d),r.vmult(f,f);var L=F-f.dot(e);for(this.clipFaceAgainstPlane(m,v,f,L);m.length;)m.shift();for(;v.length;)m.push(v.shift())}d.copy(this.faceNormals[y]);F=this.getPlaneConstantOfFace(y);f.copy(d),r.vmult(f,f);for(L=F-f.dot(e),C=0;C<m.length;C++){var V=f.dot(m[C])+L;if(V<=n&&(console.log("clamped: depth="+V+" to minDist="+n),V=n),V<=o){var X=m[C];if(V<=0){var j={point:X,normal:f,depth:V};a.push(j)}}}}},a.prototype.clipFaceAgainstPlane=function(t,e,r,i){var o,a,s=t.length;if(s<2)return e;var h=t[t.length-1],l=t[0];o=r.dot(h)+i;for(var u=0;u<s;u++){if(l=t[u],a=r.dot(l)+i,o<0)if(a<0){(c=new n).copy(l),e.push(c)}else{var c=new n;h.lerp(l,o/(o-a),c),e.push(c)}else if(a<0){c=new n;h.lerp(l,o/(o-a),c),e.push(c),e.push(l)}h=l,o=a}return e},a.prototype.computeWorldVertices=function(t,e){for(var r=this.vertices.length;this.worldVertices.length<r;)this.worldVertices.push(new n);for(var i=this.vertices,o=this.worldVertices,a=0;a!==r;a++)e.vmult(i[a],o[a]),t.vadd(o[a],o[a]);this.worldVerticesNeedsUpdate=!1};new n;a.prototype.computeLocalAABB=function(t,e){var r=this.vertices.length,i=this.vertices;t.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),e.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(var n=0;n<r;n++){var o=i[n];o.x<t.x?t.x=o.x:o.x>e.x&&(e.x=o.x),o.y<t.y?t.y=o.y:o.y>e.y&&(e.y=o.y),o.z<t.z?t.z=o.z:o.z>e.z&&(e.z=o.z)}},a.prototype.computeWorldFaceNormals=function(t){for(var e=this.faceNormals.length;this.worldFaceNormals.length<e;)this.worldFaceNormals.push(new n);for(var r=this.faceNormals,i=this.worldFaceNormals,o=0;o!==e;o++)t.vmult(r[o],i[o]);this.worldFaceNormalsNeedsUpdate=!1},a.prototype.updateBoundingSphereRadius=function(){for(var t=0,e=this.vertices,r=0,i=e.length;r!==i;r++){var n=e[r].norm2();n>t&&(t=n)}this.boundingSphereRadius=Math.sqrt(t)};var M=new n;a.prototype.calculateWorldAABB=function(t,e,r,i){for(var n,o,a,s,h,l,u=this.vertices.length,c=this.vertices,p=0;p<u;p++){M.copy(c[p]),e.vmult(M,M),t.vadd(M,M);var d=M;d.x<n||void 0===n?n=d.x:(d.x>s||void 0===s)&&(s=d.x),d.y<o||void 0===o?o=d.y:(d.y>h||void 0===h)&&(h=d.y),d.z<a||void 0===a?a=d.z:(d.z>l||void 0===l)&&(l=d.z)}r.set(n,o,a),i.set(s,h,l)},a.prototype.volume=function(){return 4*Math.PI*this.boundingSphereRadius/3},a.prototype.getAveragePointLocal=function(t){t=t||new n;for(var e=this.vertices.length,r=this.vertices,i=0;i<e;i++)t.vadd(r[i],t);return t.mult(1/e,t),t},a.prototype.transformAllPoints=function(t,e){var r=this.vertices.length,i=this.vertices;if(e){for(var n=0;n<r;n++){var o=i[n];e.vmult(o,o)}for(n=0;n<this.faceNormals.length;n++){o=this.faceNormals[n];e.vmult(o,o)}}if(t)for(n=0;n<r;n++){(o=i[n]).vadd(t,o)}};var C=new n,R=new n,O=new n;a.prototype.pointIsInside=function(t){var e=this.vertices.length,r=this.vertices,i=this.faces,n=this.faceNormals,o=this.faces.length,a=C;this.getAveragePointLocal(a);for(var s=0;s<o;s++){this.faces[s].length,e=n[s];var h=r[i[s][0]],l=R;t.vsub(h,l);var u=e.dot(l),c=O;a.vsub(h,c);var p=e.dot(c);if(u<0&&p>0||u>0&&p<0)return!1}return-1};new n;var D=new n,B=new n;a.project=function(t,e,r,i,n){var a=t.vertices.length,s=D,h=0,l=0,u=B,c=t.vertices;u.setZero(),o.vectorToLocalFrame(r,i,e,s),o.pointToLocalFrame(r,i,u,u);var p=u.dot(s);l=h=c[0].dot(s);for(var d=1;d<a;d++){var f=c[d].dot(s);f>h&&(h=f),f<l&&(l=f)}if((l-=p)>(h-=p)){var m=l;l=h,h=m}n[0]=h,n[1]=l}},{"../math/Quaternion":28,"../math/Transform":29,"../math/Vec3":30,"./Shape":43}],39:[function(t,e,r){e.exports=a;var i=t("./Shape"),n=t("../math/Vec3"),o=(t("../math/Quaternion"),t("./ConvexPolyhedron"));function a(t,e,r,a){var s=a,h=[],l=[],u=[],c=[],p=[],d=Math.cos,f=Math.sin;h.push(new n(e*d(0),e*f(0),.5*-r)),c.push(0),h.push(new n(t*d(0),t*f(0),.5*r)),p.push(1);for(var m=0;m<s;m++){var v=2*Math.PI/s*(m+1),y=2*Math.PI/s*(m+.5);m<s-1?(h.push(new n(e*d(v),e*f(v),.5*-r)),c.push(2*m+2),h.push(new n(t*d(v),t*f(v),.5*r)),p.push(2*m+3),u.push([2*m+2,2*m+3,2*m+1,2*m])):u.push([0,1,2*m+1,2*m]),(s%2==1||m<s/2)&&l.push(new n(d(y),f(y),0))}u.push(p),l.push(new n(0,0,1));var g=[];for(m=0;m<c.length;m++)g.push(c[c.length-m-1]);u.push(g),this.type=i.types.CONVEXPOLYHEDRON,o.call(this,h,u,l)}a.prototype=new o},{"../math/Quaternion":28,"../math/Vec3":30,"./ConvexPolyhedron":38,"./Shape":43}],40:[function(t,e,r){var i=t("./Shape"),n=t("./ConvexPolyhedron"),o=t("../math/Vec3"),a=t("../utils/Utils");function s(t,e){e=a.defaults(e,{maxValue:null,minValue:null,elementSize:1}),this.data=t,this.maxValue=e.maxValue,this.minValue=e.minValue,this.elementSize=e.elementSize,null===e.minValue&&this.updateMinValue(),null===e.maxValue&&this.updateMaxValue(),this.cacheEnabled=!0,i.call(this),this.pillarConvex=new n,this.pillarOffset=new o,this.type=i.types.HEIGHTFIELD,this.updateBoundingSphereRadius(),this._cachedPillars={}}e.exports=s,s.prototype=new i,s.prototype.update=function(){this._cachedPillars={}},s.prototype.updateMinValue=function(){for(var t=this.data,e=t[0][0],r=0;r!==t.length;r++)for(var i=0;i!==t[r].length;i++){var n=t[r][i];n<e&&(e=n)}this.minValue=e},s.prototype.updateMaxValue=function(){for(var t=this.data,e=t[0][0],r=0;r!==t.length;r++)for(var i=0;i!==t[r].length;i++){var n=t[r][i];n>e&&(e=n)}this.maxValue=e},s.prototype.setHeightValueAtIndex=function(t,e,r){this.data[t][e]=r,this.clearCachedConvexTrianglePillar(t,e,!1),t>0&&(this.clearCachedConvexTrianglePillar(t-1,e,!0),this.clearCachedConvexTrianglePillar(t-1,e,!1)),e>0&&(this.clearCachedConvexTrianglePillar(t,e-1,!0),this.clearCachedConvexTrianglePillar(t,e-1,!1)),e>0&&t>0&&this.clearCachedConvexTrianglePillar(t-1,e-1,!0)},s.prototype.getRectMinMax=function(t,e,r,i,n){n=n||[];for(var o=this.data,a=this.minValue,s=t;s<=r;s++)for(var h=e;h<=i;h++){var l=o[s][h];l>a&&(a=l)}n[0]=this.minValue,n[1]=a},s.prototype.getIndexOfPosition=function(t,e,r,i){var n=this.elementSize,o=this.data,a=Math.floor(t/n),s=Math.floor(e/n);return r[0]=a,r[1]=s,i&&(a<0&&(a=0),s<0&&(s=0),a>=o.length-1&&(a=o.length-1),s>=o[0].length-1&&(s=o[0].length-1)),!(a<0||s<0||a>=o.length-1||s>=o[0].length-1)},s.prototype.getHeightAt=function(t,e,r){var i=[];this.getIndexOfPosition(t,e,i,r);var n=[];return this.getRectMinMax(i[0],i[1]+1,i[0],i[1]+1,n),(n[0]+n[1])/2},s.prototype.getCacheConvexTrianglePillarKey=function(t,e,r){return t+"_"+e+"_"+(r?1:0)},s.prototype.getCachedConvexTrianglePillar=function(t,e,r){return this._cachedPillars[this.getCacheConvexTrianglePillarKey(t,e,r)]},s.prototype.setCachedConvexTrianglePillar=function(t,e,r,i,n){this._cachedPillars[this.getCacheConvexTrianglePillarKey(t,e,r)]={convex:i,offset:n}},s.prototype.clearCachedConvexTrianglePillar=function(t,e,r){delete this._cachedPillars[this.getCacheConvexTrianglePillarKey(t,e,r)]},s.prototype.getConvexTrianglePillar=function(t,e,r){var i=this.pillarConvex,a=this.pillarOffset;if(this.cacheEnabled){if(s=this.getCachedConvexTrianglePillar(t,e,r))return this.pillarConvex=s.convex,void(this.pillarOffset=s.offset);i=new n,a=new o,this.pillarConvex=i,this.pillarOffset=a}var s=this.data,h=this.elementSize,l=i.faces;i.vertices.length=6;for(var u=0;u<6;u++)i.vertices[u]||(i.vertices[u]=new o);l.length=5;for(u=0;u<5;u++)l[u]||(l[u]=[]);var c=i.vertices,p=(Math.min(s[t][e],s[t+1][e],s[t][e+1],s[t+1][e+1])-this.minValue)/2+this.minValue;r?(a.set((t+.75)*h,(e+.75)*h,p),c[0].set(.25*h,.25*h,s[t+1][e+1]-p),c[1].set(-.75*h,.25*h,s[t][e+1]-p),c[2].set(.25*h,-.75*h,s[t+1][e]-p),c[3].set(.25*h,.25*h,-p-1),c[4].set(-.75*h,.25*h,-p-1),c[5].set(.25*h,-.75*h,-p-1),l[0][0]=0,l[0][1]=1,l[0][2]=2,l[1][0]=5,l[1][1]=4,l[1][2]=3,l[2][0]=2,l[2][1]=5,l[2][2]=3,l[2][3]=0,l[3][0]=3,l[3][1]=4,l[3][2]=1,l[3][3]=0,l[4][0]=1,l[4][1]=4,l[4][2]=5,l[4][3]=2):(a.set((t+.25)*h,(e+.25)*h,p),c[0].set(-.25*h,-.25*h,s[t][e]-p),c[1].set(.75*h,-.25*h,s[t+1][e]-p),c[2].set(-.25*h,.75*h,s[t][e+1]-p),c[3].set(-.25*h,-.25*h,-p-1),c[4].set(.75*h,-.25*h,-p-1),c[5].set(-.25*h,.75*h,-p-1),l[0][0]=0,l[0][1]=1,l[0][2]=2,l[1][0]=5,l[1][1]=4,l[1][2]=3,l[2][0]=0,l[2][1]=2,l[2][2]=5,l[2][3]=3,l[3][0]=1,l[3][1]=0,l[3][2]=3,l[3][3]=4,l[4][0]=4,l[4][1]=5,l[4][2]=2,l[4][3]=1),i.computeNormals(),i.computeEdges(),i.updateBoundingSphereRadius(),this.setCachedConvexTrianglePillar(t,e,r,i,a)},s.prototype.calculateLocalInertia=function(t,e){return(e=e||new o).set(0,0,0),e},s.prototype.volume=function(){return Number.MAX_VALUE},s.prototype.calculateWorldAABB=function(t,e,r,i){r.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),i.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE)},s.prototype.updateBoundingSphereRadius=function(){var t=this.data,e=this.elementSize;this.boundingSphereRadius=new o(t.length*e,t[0].length*e,Math.max(Math.abs(this.maxValue),Math.abs(this.minValue))).norm()}},{"../math/Vec3":30,"../utils/Utils":53,"./ConvexPolyhedron":38,"./Shape":43}],41:[function(t,e,r){e.exports=o;var i=t("./Shape"),n=t("../math/Vec3");function o(){i.call(this),this.type=i.types.PARTICLE}o.prototype=new i,o.prototype.constructor=o,o.prototype.calculateLocalInertia=function(t,e){return(e=e||new n).set(0,0,0),e},o.prototype.volume=function(){return 0},o.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=0},o.prototype.calculateWorldAABB=function(t,e,r,i){r.copy(t),i.copy(t)}},{"../math/Vec3":30,"./Shape":43}],42:[function(t,e,r){e.exports=o;var i=t("./Shape"),n=t("../math/Vec3");function o(){i.call(this),this.type=i.types.PLANE,this.worldNormal=new n,this.worldNormalNeedsUpdate=!0,this.boundingSphereRadius=Number.MAX_VALUE}o.prototype=new i,o.prototype.constructor=o,o.prototype.computeWorldNormal=function(t){var e=this.worldNormal;e.set(0,0,1),t.vmult(e,e),this.worldNormalNeedsUpdate=!1},o.prototype.calculateLocalInertia=function(t,e){return e=e||new n},o.prototype.volume=function(){return Number.MAX_VALUE};var a=new n;o.prototype.calculateWorldAABB=function(t,e,r,i){a.set(0,0,1),e.vmult(a,a);var n=Number.MAX_VALUE;r.set(-n,-n,-n),i.set(n,n,n),1===a.x&&(i.x=t.x),1===a.y&&(i.y=t.y),1===a.z&&(i.z=t.z),-1===a.x&&(r.x=t.x),-1===a.y&&(r.y=t.y),-1===a.z&&(r.z=t.z)},o.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=Number.MAX_VALUE}},{"../math/Vec3":30,"./Shape":43}],43:[function(t,e,r){e.exports=i;var i=t("./Shape");t("../math/Vec3"),t("../math/Quaternion"),t("../material/Material");function i(){this.id=i.idCounter++,this.type=0,this.boundingSphereRadius=0,this.collisionResponse=!0,this.material=null}i.prototype.constructor=i,i.prototype.updateBoundingSphereRadius=function(){throw"computeBoundingSphereRadius() not implemented for shape type "+this.type},i.prototype.volume=function(){throw"volume() not implemented for shape type "+this.type},i.prototype.calculateLocalInertia=function(t,e){throw"calculateLocalInertia() not implemented for shape type "+this.type},i.idCounter=0,i.types={SPHERE:1,PLANE:2,BOX:4,COMPOUND:8,CONVEXPOLYHEDRON:16,HEIGHTFIELD:32,PARTICLE:64,CYLINDER:128,TRIMESH:256}},{"../material/Material":25,"../math/Quaternion":28,"../math/Vec3":30,"./Shape":43}],44:[function(t,e,r){e.exports=o;var i=t("./Shape"),n=t("../math/Vec3");function o(t){if(i.call(this),this.radius=void 0!==t?Number(t):1,this.type=i.types.SPHERE,this.radius<0)throw new Error("The sphere radius cannot be negative.");this.updateBoundingSphereRadius()}o.prototype=new i,o.prototype.constructor=o,o.prototype.calculateLocalInertia=function(t,e){e=e||new n;var r=2*t*this.radius*this.radius/5;return e.x=r,e.y=r,e.z=r,e},o.prototype.volume=function(){return 4*Math.PI*this.radius/3},o.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=this.radius},o.prototype.calculateWorldAABB=function(t,e,r,i){for(var n=this.radius,o=["x","y","z"],a=0;a<o.length;a++){var s=o[a];r[s]=t[s]-n,i[s]=t[s]+n}}},{"../math/Vec3":30,"./Shape":43}],45:[function(t,e,r){e.exports=h;var i=t("./Shape"),n=t("../math/Vec3"),o=(t("../math/Quaternion"),t("../math/Transform")),a=t("../collision/AABB"),s=t("../utils/Octree");function h(t,e){i.call(this),this.type=i.types.TRIMESH,this.vertices=new Float32Array(t),this.indices=new Int16Array(e),this.normals=new Float32Array(e.length),this.aabb=new a,this.edges=null,this.scale=new n(1,1,1),this.tree=new s,this.updateEdges(),this.updateNormals(),this.updateAABB(),this.updateBoundingSphereRadius(),this.updateTree()}h.prototype=new i,h.prototype.constructor=h;var l=new n;h.prototype.updateTree=function(){var t=this.tree;t.reset(),t.aabb.copy(this.aabb);var e=this.scale;t.aabb.lowerBound.x*=1/e.x,t.aabb.lowerBound.y*=1/e.y,t.aabb.lowerBound.z*=1/e.z,t.aabb.upperBound.x*=1/e.x,t.aabb.upperBound.y*=1/e.y,t.aabb.upperBound.z*=1/e.z;for(var r=new a,i=new n,o=new n,s=new n,h=[i,o,s],l=0;l<this.indices.length/3;l++){var u=3*l;this._getUnscaledVertex(this.indices[u],i),this._getUnscaledVertex(this.indices[u+1],o),this._getUnscaledVertex(this.indices[u+2],s),r.setFromPoints(h),t.insert(r,l)}t.removeEmptyNodes()};var u=new a;h.prototype.getTrianglesInAABB=function(t,e){u.copy(t);var r=this.scale,i=r.x,n=r.y,o=r.z,a=u.lowerBound,s=u.upperBound;return a.x/=i,a.y/=n,a.z/=o,s.x/=i,s.y/=n,s.z/=o,this.tree.aabbQuery(u,e)},h.prototype.setScale=function(t){var e=this.scale.x===this.scale.y===this.scale.z,r=t.x===t.y===t.z;e&&r||this.updateNormals(),this.scale.copy(t),this.updateAABB(),this.updateBoundingSphereRadius()},h.prototype.updateNormals=function(){for(var t=l,e=this.normals,r=0;r<this.indices.length/3;r++){var i=3*r,n=this.indices[i],o=this.indices[i+1],a=this.indices[i+2];this.getVertex(n,m),this.getVertex(o,v),this.getVertex(a,y),h.computeNormal(v,m,y,t),e[i]=t.x,e[i+1]=t.y,e[i+2]=t.z}},h.prototype.updateEdges=function(){for(var t={},e=function(e,r){t[n<o?n+"_"+o:o+"_"+n]=!0},r=0;r<this.indices.length/3;r++){var i=3*r,n=this.indices[i],o=this.indices[i+1];this.indices[i+2];e(),e(),e()}var a=Object.keys(t);this.edges=new Int16Array(2*a.length);for(r=0;r<a.length;r++){var s=a[r].split("_");this.edges[2*r]=parseInt(s[0],10),this.edges[2*r+1]=parseInt(s[1],10)}},h.prototype.getEdgeVertex=function(t,e,r){var i=this.edges[2*t+(e?1:0)];this.getVertex(i,r)};var c=new n,p=new n;h.prototype.getEdgeVector=function(t,e){var r=c,i=p;this.getEdgeVertex(t,0,r),this.getEdgeVertex(t,1,i),i.vsub(r,e)};var d=new n,f=new n;h.computeNormal=function(t,e,r,i){e.vsub(t,f),r.vsub(e,d),d.cross(f,i),i.isZero()||i.normalize()};var m=new n,v=new n,y=new n;h.prototype.getVertex=function(t,e){var r=this.scale;return this._getUnscaledVertex(t,e),e.x*=r.x,e.y*=r.y,e.z*=r.z,e},h.prototype._getUnscaledVertex=function(t,e){var r=3*t,i=this.vertices;return e.set(i[r],i[r+1],i[r+2])},h.prototype.getWorldVertex=function(t,e,r,i){return this.getVertex(t,i),o.pointToWorldFrame(e,r,i,i),i},h.prototype.getTriangleVertices=function(t,e,r,i){var n=3*t;this.getVertex(this.indices[n],e),this.getVertex(this.indices[n+1],r),this.getVertex(this.indices[n+2],i)},h.prototype.getNormal=function(t,e){var r=3*t;return e.set(this.normals[r],this.normals[r+1],this.normals[r+2])};var g=new a;h.prototype.calculateLocalInertia=function(t,e){this.computeLocalAABB(g);var r=g.upperBound.x-g.lowerBound.x,i=g.upperBound.y-g.lowerBound.y,n=g.upperBound.z-g.lowerBound.z;return e.set(1/12*t*(2*i*2*i+2*n*2*n),1/12*t*(2*r*2*r+2*n*2*n),1/12*t*(2*i*2*i+2*r*2*r))};var _=new n;h.prototype.computeLocalAABB=function(t){var e=t.lowerBound,r=t.upperBound,i=this.vertices.length,n=(this.vertices,_);this.getVertex(0,n),e.copy(n),r.copy(n);for(var o=0;o!==i;o++)this.getVertex(o,n),n.x<e.x?e.x=n.x:n.x>r.x&&(r.x=n.x),n.y<e.y?e.y=n.y:n.y>r.y&&(r.y=n.y),n.z<e.z?e.z=n.z:n.z>r.z&&(r.z=n.z)},h.prototype.updateAABB=function(){this.computeLocalAABB(this.aabb)},h.prototype.updateBoundingSphereRadius=function(){for(var t=0,e=this.vertices,r=new n,i=0,o=e.length/3;i!==o;i++){this.getVertex(i,r);var a=r.norm2();a>t&&(t=a)}this.boundingSphereRadius=Math.sqrt(t)};new n;var x=new o,b=new a;h.prototype.calculateWorldAABB=function(t,e,r,i){var n=x,o=b;n.position=t,n.quaternion=e,this.aabb.toWorldFrame(n,o),r.copy(o.lowerBound),i.copy(o.upperBound)},h.prototype.volume=function(){return 4*Math.PI*this.boundingSphereRadius/3},h.createTorus=function(t,e,r,i,n){t=t||1,e=e||.5,r=r||8,i=i||6,n=n||2*Math.PI;for(var o=[],a=[],s=0;s<=r;s++)for(var l=0;l<=i;l++){var u=l/i*n,c=s/r*Math.PI*2,p=(t+e*Math.cos(c))*Math.cos(u),d=(t+e*Math.cos(c))*Math.sin(u),f=e*Math.sin(c);o.push(p,d,f)}for(s=1;s<=r;s++)for(l=1;l<=i;l++){var m=(i+1)*s+l-1,v=(i+1)*(s-1)+l-1,y=(i+1)*(s-1)+l,g=(i+1)*s+l;a.push(m,v,g),a.push(v,y,g)}return new h(o,a)}},{"../collision/AABB":3,"../math/Quaternion":28,"../math/Transform":29,"../math/Vec3":30,"../utils/Octree":50,"./Shape":43}],46:[function(t,e,r){e.exports=n;t("../math/Vec3"),t("../math/Quaternion");var i=t("./Solver");function n(){i.call(this),this.iterations=10,this.tolerance=1e-7}n.prototype=new i;var o=[],a=[],s=[];n.prototype.solve=function(t,e){var r,i,n,h,l,u=0,c=this.iterations,p=this.tolerance*this.tolerance,d=this.equations,f=d.length,m=e.bodies,v=m.length,y=t;if(0!==f)for(var g=0;g!==v;g++)m[g].updateSolveMassProperties();var _=a,x=s,b=o;_.length=f,x.length=f,b.length=f;for(g=0;g!==f;g++){var w=d[g];b[g]=0,x[g]=w.computeB(y),_[g]=1/w.computeC()}if(0!==f){for(g=0;g!==v;g++){var T=(A=m[g]).vlambda,E=A.wlambda;T.set(0,0,0),E&&E.set(0,0,0)}for(u=0;u!==c;u++){h=0;for(var S=0;S!==f;S++){w=d[S];r=x[S],i=_[S],(l=b[S])+(n=i*(r-w.computeGWlambda()-w.eps*l))<w.minForce?n=w.minForce-l:l+n>w.maxForce&&(n=w.maxForce-l),b[S]+=n,h+=n>0?n:-n,w.addToWlambda(n)}if(h*h<p)break}for(g=0;g!==v;g++){var A,I=(A=m[g]).velocity,P=A.angularVelocity;I.vadd(A.vlambda,I),P&&P.vadd(A.wlambda,P)}}return u}},{"../math/Quaternion":28,"../math/Vec3":30,"./Solver":47}],47:[function(t,e,r){function i(){this.equations=[]}e.exports=i,i.prototype.solve=function(t,e){return 0},i.prototype.addEquation=function(t){t.enabled&&this.equations.push(t)},i.prototype.removeEquation=function(t){var e=this.equations,r=e.indexOf(t);-1!==r&&e.splice(r,1)},i.prototype.removeAllEquations=function(){this.equations.length=0}},{}],48:[function(t,e,r){e.exports=o;t("../math/Vec3"),t("../math/Quaternion");var i=t("./Solver"),n=t("../objects/Body");function o(t){for(i.call(this),this.iterations=10,this.tolerance=1e-7,this.subsolver=t,this.nodes=[],this.nodePool=[];this.nodePool.length<128;)this.nodePool.push(this.createNode())}o.prototype=new i;var a=[],s=[],h={bodies:[]},l=n.STATIC;function u(t){for(var e=t.length,r=0;r!==e;r++){var i=t[r];if(!(i.visited||i.body.type&l))return i}return!1}var c=[];function p(t,e,r,i){for(c.push(t),t.visited=!0,e(t,r,i);c.length;)for(var n,o=c.pop();n=u(o.children);)n.visited=!0,e(n,r,i),c.push(n)}function d(t,e,r){e.push(t.body);for(var i=t.eqs.length,n=0;n!==i;n++){var o=t.eqs[n];-1===r.indexOf(o)&&r.push(o)}}function f(t,e){return e.id-t.id}o.prototype.createNode=function(){return{body:null,children:[],eqs:[],visited:!1}},o.prototype.solve=function(t,e){for(var r=a,i=this.nodePool,n=e.bodies,o=this.equations,l=o.length,c=n.length,m=this.subsolver;i.length<c;)i.push(this.createNode());r.length=c;for(var v=0;v<c;v++)r[v]=i[v];for(v=0;v!==c;v++){var y=r[v];y.body=n[v],y.children.length=0,y.eqs.length=0,y.visited=!1}for(var g=0;g!==l;g++){var _=o[g],x=(v=n.indexOf(_.bi),n.indexOf(_.bj)),b=r[v],w=r[x];b.children.push(w),b.eqs.push(_),w.children.push(b),w.eqs.push(_)}var T,E=0,S=s;m.tolerance=this.tolerance,m.iterations=this.iterations;for(var A=h;T=u(r);){S.length=0,A.bodies.length=0,p(T,d,A.bodies,S);var I=S.length;S=S.sort(f);for(v=0;v!==I;v++)m.addEquation(S[v]);m.solve(t,A);m.removeAllEquations(),E++}return E}},{"../math/Quaternion":28,"../math/Vec3":30,"../objects/Body":31,"./Solver":47}],49:[function(t,e,r){var i=function(){};e.exports=i,i.prototype={constructor:i,addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});var r=this._listeners;return void 0===r[t]&&(r[t]=[]),-1===r[t].indexOf(e)&&r[t].push(e),this},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;var r=this._listeners;return void 0!==r[t]&&-1!==r[t].indexOf(e)},removeEventListener:function(t,e){if(void 0===this._listeners)return this;var r=this._listeners;if(void 0===r[t])return this;var i=r[t].indexOf(e);return-1!==i&&r[t].splice(i,1),this},dispatchEvent:function(t){if(void 0===this._listeners)return this;var e=this._listeners[t.type];if(void 0!==e){t.target=this;for(var r=0,i=e.length;r<i;r++)e[r].call(this,t)}return this}}},{}],50:[function(t,e,r){var i=t("../collision/AABB"),n=t("../math/Vec3");function o(t){t=t||{},this.root=t.root||null,this.aabb=t.aabb?t.aabb.clone():new i,this.data=[],this.children=[]}function a(t,e){(e=e||{}).root=null,e.aabb=t,o.call(this,e),this.maxDepth=void 0!==e.maxDepth?e.maxDepth:8}e.exports=a,a.prototype=new o,o.prototype.reset=function(t,e){this.children.length=this.data.length=0},o.prototype.insert=function(t,e,r){var i=this.data;if(r=r||0,!this.aabb.contains(t))return!1;var n=this.children;if(r<(this.maxDepth||this.root.maxDepth)){var o=!1;n.length||(this.subdivide(),o=!0);for(var a=0;8!==a;a++)if(n[a].insert(t,e,r+1))return!0;o&&(n.length=0)}return i.push(e),!0};var s=new n;o.prototype.subdivide=function(){var t=this.aabb,e=t.lowerBound,r=t.upperBound,a=this.children;a.push(new o({aabb:new i({lowerBound:new n(0,0,0)})}),new o({aabb:new i({lowerBound:new n(1,0,0)})}),new o({aabb:new i({lowerBound:new n(1,1,0)})}),new o({aabb:new i({lowerBound:new n(1,1,1)})}),new o({aabb:new i({lowerBound:new n(0,1,1)})}),new o({aabb:new i({lowerBound:new n(0,0,1)})}),new o({aabb:new i({lowerBound:new n(1,0,1)})}),new o({aabb:new i({lowerBound:new n(0,1,0)})})),r.vsub(e,s),s.scale(.5,s);for(var h=this.root||this,l=0;8!==l;l++){var u=a[l];u.root=h;var c=u.aabb.lowerBound;c.x*=s.x,c.y*=s.y,c.z*=s.z,c.vadd(e,c),c.vadd(s,u.aabb.upperBound)}},o.prototype.aabbQuery=function(t,e){this.data,this.children;for(var r=[this];r.length;){var i=r.pop();i.aabb.overlaps(t)&&Array.prototype.push.apply(e,i.data),Array.prototype.push.apply(r,i.children)}return e};var h=new i;o.prototype.rayQuery=function(t,e,r){return t.getAABB(h),h.toLocalFrame(e,h),this.aabbQuery(h,r),r},o.prototype.removeEmptyNodes=function(){for(var t=[this];t.length;){for(var e=t.pop(),r=e.children.length-1;r>=0;r--)e.children[r].data.length||e.children.splice(r,1);Array.prototype.push.apply(t,e.children)}}},{"../collision/AABB":3,"../math/Vec3":30}],51:[function(t,e,r){function i(){this.objects=[],this.type=Object}e.exports=i,i.prototype.release=function(){for(var t=arguments.length,e=0;e!==t;e++)this.objects.push(arguments[e])},i.prototype.get=function(){return 0===this.objects.length?this.constructObject():this.objects.pop()},i.prototype.constructObject=function(){throw new Error("constructObject() not implemented in this Pool subclass yet!")}},{}],52:[function(t,e,r){function i(){this.data={keys:[]}}e.exports=i,i.prototype.get=function(t,e){if(t>e){var r=e;e=t,t=r}return this.data[t+"-"+e]},i.prototype.set=function(t,e,r){if(t>e){var i=e;e=t,t=i}var n=t+"-"+e;this.get(t,e)||this.data.keys.push(n),this.data[n]=r},i.prototype.reset=function(){for(var t=this.data,e=t.keys;e.length>0;){delete t[e.pop()]}}},{}],53:[function(t,e,r){function i(){}e.exports=i,i.defaults=function(t,e){for(var r in t=t||{},e)r in t||(t[r]=e[r]);return t}},{}],54:[function(t,e,r){e.exports=o;var i=t("../math/Vec3"),n=t("./Pool");function o(){n.call(this),this.type=i}o.prototype=new n,o.prototype.constructObject=function(){return new i}},{"../math/Vec3":30,"./Pool":51}],55:[function(t,e,r){e.exports=p;var i=t("../collision/AABB"),n=t("../shapes/Shape"),o=t("../collision/Ray"),a=t("../math/Vec3"),s=t("../math/Transform"),h=(t("../shapes/ConvexPolyhedron"),t("../math/Quaternion")),l=(t("../solver/Solver"),t("../utils/Vec3Pool")),u=t("../equations/ContactEquation"),c=t("../equations/FrictionEquation");function p(t){this.contactPointPool=[],this.frictionEquationPool=[],this.result=[],this.frictionResult=[],this.v3pool=new l,this.world=t,this.currentContactMaterial=null,this.enableFrictionReduction=!1}p.prototype.createContactEquation=function(t,e,r,i,n,o){var a;this.contactPointPool.length?((a=this.contactPointPool.pop()).bi=t,a.bj=e):a=new u(t,e),a.enabled=t.collisionResponse&&e.collisionResponse&&r.collisionResponse&&i.collisionResponse;var s=this.currentContactMaterial;a.restitution=s.restitution,a.setSpookParams(s.contactEquationStiffness,s.contactEquationRelaxation,this.world.dt);var h=r.material||t.material,l=i.material||e.material;return h&&l&&h.restitution>=0&&l.restitution>=0&&(a.restitution=h.restitution*l.restitution),a.si=n||r,a.sj=o||i,a},p.prototype.createFrictionEquationsFromContact=function(t,e){var r=t.bi,i=t.bj,n=t.si,o=t.sj,a=this.world,s=this.currentContactMaterial,h=s.friction,l=n.material||r.material,u=o.material||i.material;if(l&&u&&l.friction>=0&&u.friction>=0&&(h=l.friction*u.friction),h>0){var p=h*a.gravity.length(),d=r.invMass+i.invMass;d>0&&(d=1/d);var f=this.frictionEquationPool,m=f.length?f.pop():new c(r,i,p*d),v=f.length?f.pop():new c(r,i,p*d);return m.bi=v.bi=r,m.bj=v.bj=i,m.minForce=v.minForce=-p*d,m.maxForce=v.maxForce=p*d,m.ri.copy(t.ri),m.rj.copy(t.rj),v.ri.copy(t.ri),v.rj.copy(t.rj),t.ni.tangents(m.t,v.t),m.setSpookParams(s.frictionEquationStiffness,s.frictionEquationRelaxation,a.dt),v.setSpookParams(s.frictionEquationStiffness,s.frictionEquationRelaxation,a.dt),m.enabled=v.enabled=t.enabled,e.push(m,v),!0}return!1};var d=new a,f=new a,m=new a;p.prototype.createFrictionFromAverage=function(t){var e=this.result[this.result.length-1];if(this.createFrictionEquationsFromContact(e,this.frictionResult)&&1!==t){var r=this.frictionResult[this.frictionResult.length-2],i=this.frictionResult[this.frictionResult.length-1];d.setZero(),f.setZero(),m.setZero();for(var n=e.bi,o=(e.bj,0);o!==t;o++)(e=this.result[this.result.length-1-o]).bodyA!==n?(d.vadd(e.ni,d),f.vadd(e.ri,f),m.vadd(e.rj,m)):(d.vsub(e.ni,d),f.vadd(e.rj,f),m.vadd(e.ri,m));var a=1/t;f.scale(a,r.ri),m.scale(a,r.rj),i.ri.copy(r.ri),i.rj.copy(r.rj),d.normalize(),d.tangents(r.t,i.t)}};var v=new a,y=new a,g=new h,_=new h;p.prototype.getContacts=function(t,e,r,i,n,o,a){this.contactPointPool=n,this.frictionEquationPool=a,this.result=i,this.frictionResult=o;for(var s=g,h=_,l=v,u=y,c=0,p=t.length;c!==p;c++){var d=t[c],f=e[c],m=null;d.material&&f.material&&(m=r.getContactMaterial(d.material,f.material)||null);for(var x=0;x<d.shapes.length;x++){d.quaternion.mult(d.shapeOrientations[x],s),d.quaternion.vmult(d.shapeOffsets[x],l),l.vadd(d.position,l);for(var b=d.shapes[x],w=0;w<f.shapes.length;w++){f.quaternion.mult(f.shapeOrientations[w],h),f.quaternion.vmult(f.shapeOffsets[w],u),u.vadd(f.position,u);var T=f.shapes[w];if(!(l.distanceTo(u)>b.boundingSphereRadius+T.boundingSphereRadius)){var E=null;b.material&&T.material&&(E=r.getContactMaterial(b.material,T.material)||null),this.currentContactMaterial=E||m||r.defaultContactMaterial;var S=this[b.type|T.type];S&&(b.type<T.type?S.call(this,b,T,l,u,s,h,d,f,b,T):S.call(this,T,b,u,l,h,s,f,d,b,T))}}}}};p.prototype[n.types.BOX|n.types.BOX]=p.prototype.boxBox=function(t,e,r,i,n,o,a,s){t.convexPolyhedronRepresentation.material=t.material,e.convexPolyhedronRepresentation.material=e.material,t.convexPolyhedronRepresentation.collisionResponse=t.collisionResponse,e.convexPolyhedronRepresentation.collisionResponse=e.collisionResponse,this.convexConvex(t.convexPolyhedronRepresentation,e.convexPolyhedronRepresentation,r,i,n,o,a,s,t,e)},p.prototype[n.types.BOX|n.types.CONVEXPOLYHEDRON]=p.prototype.boxConvex=function(t,e,r,i,n,o,a,s){t.convexPolyhedronRepresentation.material=t.material,t.convexPolyhedronRepresentation.collisionResponse=t.collisionResponse,this.convexConvex(t.convexPolyhedronRepresentation,e,r,i,n,o,a,s,t,e)},p.prototype[n.types.BOX|n.types.PARTICLE]=p.prototype.boxParticle=function(t,e,r,i,n,o,a,s){t.convexPolyhedronRepresentation.material=t.material,t.convexPolyhedronRepresentation.collisionResponse=t.collisionResponse,this.convexParticle(t.convexPolyhedronRepresentation,e,r,i,n,o,a,s,t,e)},p.prototype[n.types.SPHERE]=p.prototype.sphereSphere=function(t,e,r,i,n,o,a,s){var h=this.createContactEquation(a,s,t,e);i.vsub(r,h.ni),h.ni.normalize(),h.ri.copy(h.ni),h.rj.copy(h.ni),h.ri.mult(t.radius,h.ri),h.rj.mult(-e.radius,h.rj),h.ri.vadd(r,h.ri),h.ri.vsub(a.position,h.ri),h.rj.vadd(i,h.rj),h.rj.vsub(s.position,h.rj),this.result.push(h),this.createFrictionEquationsFromContact(h,this.frictionResult)};var x=new a,b=new a,w=new a;p.prototype[n.types.PLANE|n.types.TRIMESH]=p.prototype.planeTrimesh=function(t,e,r,i,n,o,h,l){var u=new a,c=x;c.set(0,0,1),n.vmult(c,c);for(var p=0;p<e.vertices.length/3;p++){e.getVertex(p,u);var d=new a;d.copy(u),s.pointToWorldFrame(i,o,d,u);var f=b;if(u.vsub(r,f),c.dot(f)<=0){var m=this.createContactEquation(h,l,t,e);m.ni.copy(c);var v=w;c.scale(f.dot(c),v),u.vsub(v,v),m.ri.copy(v),m.ri.vsub(h.position,m.ri),m.rj.copy(u),m.rj.vsub(l.position,m.rj),this.result.push(m),this.createFrictionEquationsFromContact(m,this.frictionResult)}}};var T=new a,E=new a,S=(new a,new a),A=new a,I=new a,P=new a,M=new a,C=new a,R=new a,O=new a,D=new a,B=new a,N=new a,k=new i,F=[];p.prototype[n.types.SPHERE|n.types.TRIMESH]=p.prototype.sphereTrimesh=function(t,e,r,i,n,a,h,l){var u=I,c=P,p=M,d=C,f=R,m=O,v=k,y=A,g=E,_=F;s.pointToLocalFrame(i,a,r,f);var x=t.radius;v.lowerBound.set(f.x-x,f.y-x,f.z-x),v.upperBound.set(f.x+x,f.y+x,f.z+x),e.getTrianglesInAABB(v,_);for(var b=S,w=t.radius*t.radius,L=0;L<_.length;L++)for(var V=0;V<3;V++){if(e.getVertex(e.indices[3*_[L]+V],b),b.vsub(f,g),g.norm2()<=w)y.copy(b),s.pointToWorldFrame(i,a,y,b),b.vsub(r,g),(U=this.createContactEquation(h,l,t,e)).ni.copy(g),U.ni.normalize(),U.ri.copy(U.ni),U.ri.scale(t.radius,U.ri),U.ri.vadd(r,U.ri),U.ri.vsub(h.position,U.ri),U.rj.copy(b),U.rj.vsub(l.position,U.rj),this.result.push(U),this.createFrictionEquationsFromContact(U,this.frictionResult)}for(L=0;L<_.length;L++)for(V=0;V<3;V++){e.getVertex(e.indices[3*_[L]+V],u),e.getVertex(e.indices[3*_[L]+(V+1)%3],c),c.vsub(u,p),f.vsub(c,m);var X=m.dot(p);f.vsub(u,m);var j=m.dot(p);if(j>0&&X<0)if(f.vsub(u,m),d.copy(p),d.normalize(),j=m.dot(d),d.scale(j,m),m.vadd(u,m),(H=m.distanceTo(f))<t.radius){var U=this.createContactEquation(h,l,t,e);m.vsub(f,U.ni),U.ni.normalize(),U.ni.scale(t.radius,U.ri),s.pointToWorldFrame(i,a,m,m),m.vsub(l.position,U.rj),s.vectorToWorldFrame(a,U.ni,U.ni),s.vectorToWorldFrame(a,U.ri,U.ri),this.result.push(U),this.createFrictionEquationsFromContact(U,this.frictionResult)}}for(var Y=D,z=B,W=N,q=T,G=(L=0,_.length);L!==G;L++){e.getTriangleVertices(_[L],Y,z,W),e.getNormal(_[L],q),f.vsub(Y,m);var H=m.dot(q);if(q.scale(H,m),f.vsub(m,m),H=m.distanceTo(f),o.pointInTriangle(m,Y,z,W)&&H<t.radius){U=this.createContactEquation(h,l,t,e);m.vsub(f,U.ni),U.ni.normalize(),U.ni.scale(t.radius,U.ri),s.pointToWorldFrame(i,a,m,m),m.vsub(l.position,U.rj),s.vectorToWorldFrame(a,U.ni,U.ni),s.vectorToWorldFrame(a,U.ri,U.ri),this.result.push(U),this.createFrictionEquationsFromContact(U,this.frictionResult)}}_.length=0};var L=new a,V=new a;p.prototype[n.types.SPHERE|n.types.PLANE]=p.prototype.spherePlane=function(t,e,r,i,n,o,a,s){var h=this.createContactEquation(a,s,t,e);if(h.ni.set(0,0,1),o.vmult(h.ni,h.ni),h.ni.negate(h.ni),h.ni.normalize(),h.ni.mult(t.radius,h.ri),r.vsub(i,L),h.ni.mult(h.ni.dot(L),V),L.vsub(V,h.rj),-L.dot(h.ni)<=t.radius){var l=h.ri,u=h.rj;l.vadd(r,l),l.vsub(a.position,l),u.vadd(i,u),u.vsub(s.position,u),this.result.push(h),this.createFrictionEquationsFromContact(h,this.frictionResult)}};var X=new a,j=new a,U=new a;function Y(t,e,r){for(var i=null,n=t.length,o=0;o!==n;o++){var a=t[o],s=X;t[(o+1)%n].vsub(a,s);var h=j;s.cross(e,h);var l=U;r.vsub(a,l);var u=h.dot(l);if(!(null===i||u>0&&!0===i||u<=0&&!1===i))return!1;null===i&&(i=u>0)}return!0}var z=new a,W=new a,q=new a,G=new a,H=[new a,new a,new a,new a,new a,new a],$=new a,J=new a,Z=new a,Q=new a;p.prototype[n.types.SPHERE|n.types.BOX]=p.prototype.sphereBox=function(t,e,r,i,n,o,a,s){var h=this.v3pool,l=H;r.vsub(i,z),e.getSideNormals(l,o);for(var u=t.radius,c=!1,p=J,d=Z,f=Q,m=null,v=0,y=0,g=0,_=null,x=0,b=l.length;x!==b&&!1===c;x++){var w=W;w.copy(l[x]);var T=w.norm();w.normalize();var E=z.dot(w);if(E<T+u&&E>0){var S=q,A=G;S.copy(l[(x+1)%3]),A.copy(l[(x+2)%3]);var I=S.norm(),P=A.norm();S.normalize(),A.normalize();var M=z.dot(S),C=z.dot(A);if(M<I&&M>-I&&C<P&&C>-P){var R=Math.abs(E-T-u);(null===_||R<_)&&(_=R,y=M,g=C,m=T,p.copy(w),d.copy(S),f.copy(A),v++)}}}if(v){c=!0;var O=this.createContactEquation(a,s,t,e);p.mult(-u,O.ri),O.ni.copy(p),O.ni.negate(O.ni),p.mult(m,p),d.mult(y,d),p.vadd(d,p),f.mult(g,f),p.vadd(f,O.rj),O.ri.vadd(r,O.ri),O.ri.vsub(a.position,O.ri),O.rj.vadd(i,O.rj),O.rj.vsub(s.position,O.rj),this.result.push(O),this.createFrictionEquationsFromContact(O,this.frictionResult)}for(var D=h.get(),B=$,N=0;2!==N&&!c;N++)for(var k=0;2!==k&&!c;k++)for(var F=0;2!==F&&!c;F++){if(D.set(0,0,0),N?D.vadd(l[0],D):D.vsub(l[0],D),k?D.vadd(l[1],D):D.vsub(l[1],D),F?D.vadd(l[2],D):D.vsub(l[2],D),i.vadd(D,B),B.vsub(r,B),B.norm2()<u*u)c=!0,(O=this.createContactEquation(a,s,t,e)).ri.copy(B),O.ri.normalize(),O.ni.copy(O.ri),O.ri.mult(u,O.ri),O.rj.copy(D),O.ri.vadd(r,O.ri),O.ri.vsub(a.position,O.ri),O.rj.vadd(i,O.rj),O.rj.vsub(s.position,O.rj),this.result.push(O),this.createFrictionEquationsFromContact(O,this.frictionResult)}h.release(D),D=null;var L=h.get(),V=h.get(),X=(O=h.get(),h.get()),j=(R=h.get(),l.length);for(N=0;N!==j&&!c;N++)for(k=0;k!==j&&!c;k++)if(N%3!=k%3){l[k].cross(l[N],L),L.normalize(),l[N].vadd(l[k],V),O.copy(r),O.vsub(V,O),O.vsub(i,O);var U=O.dot(L);L.mult(U,X);for(F=0;F===N%3||F===k%3;)F++;R.copy(r),R.vsub(X,R),R.vsub(V,R),R.vsub(i,R);var Y=Math.abs(U),K=R.norm();if(Y<l[F].norm()&&K<u){c=!0;var tt=this.createContactEquation(a,s,t,e);V.vadd(X,tt.rj),tt.rj.copy(tt.rj),R.negate(tt.ni),tt.ni.normalize(),tt.ri.copy(tt.rj),tt.ri.vadd(i,tt.ri),tt.ri.vsub(r,tt.ri),tt.ri.normalize(),tt.ri.mult(u,tt.ri),tt.ri.vadd(r,tt.ri),tt.ri.vsub(a.position,tt.ri),tt.rj.vadd(i,tt.rj),tt.rj.vsub(s.position,tt.rj),this.result.push(tt),this.createFrictionEquationsFromContact(tt,this.frictionResult)}}h.release(L,V,O,X,R)};var K=new a,tt=new a,et=new a,rt=new a,it=new a,nt=new a,ot=new a,at=new a,st=new a,ht=new a;p.prototype[n.types.SPHERE|n.types.CONVEXPOLYHEDRON]=p.prototype.sphereConvex=function(t,e,r,i,n,o,a,s){var h=this.v3pool;r.vsub(i,K);for(var l=e.faceNormals,u=e.faces,c=e.vertices,p=t.radius,d=0;d!==c.length;d++){var f=c[d],m=it;o.vmult(f,m),i.vadd(m,m);var v=rt;if(m.vsub(r,v),v.norm2()<p*p)return y=!0,(R=this.createContactEquation(a,s,t,e)).ri.copy(v),R.ri.normalize(),R.ni.copy(R.ri),R.ri.mult(p,R.ri),m.vsub(i,R.rj),R.ri.vadd(r,R.ri),R.ri.vsub(a.position,R.ri),R.rj.vadd(i,R.rj),R.rj.vsub(s.position,R.rj),this.result.push(R),void this.createFrictionEquationsFromContact(R,this.frictionResult)}for(var y=!1,g=(d=0,u.length);d!==g&&!1===y;d++){var _=l[d],x=u[d],b=nt;o.vmult(_,b);var w=ot;o.vmult(c[x[0]],w),w.vadd(i,w);var T=at;b.mult(-p,T),r.vadd(T,T);var E=st;T.vsub(w,E);var S=E.dot(b),A=ht;if(r.vsub(w,A),S<0&&A.dot(b)>0){for(var I=[],P=0,M=x.length;P!==M;P++){var C=h.get();o.vmult(c[x[P]],C),i.vadd(C,C),I.push(C)}if(Y(I,b,r)){y=!0;var R=this.createContactEquation(a,s,t,e);b.mult(-p,R.ri),b.negate(R.ni);var O=h.get();b.mult(-S,O);var D=h.get();b.mult(-p,D),r.vsub(i,R.rj),R.rj.vadd(D,R.rj),R.rj.vadd(O,R.rj),R.rj.vadd(i,R.rj),R.rj.vsub(s.position,R.rj),R.ri.vadd(r,R.ri),R.ri.vsub(a.position,R.ri),h.release(O),h.release(D),this.result.push(R),this.createFrictionEquationsFromContact(R,this.frictionResult);P=0;for(var B=I.length;P!==B;P++)h.release(I[P]);return}for(P=0;P!==x.length;P++){var N=h.get(),k=h.get();o.vmult(c[x[(P+1)%x.length]],N),o.vmult(c[x[(P+2)%x.length]],k),i.vadd(N,N),i.vadd(k,k);var F=tt;k.vsub(N,F);var L=et;F.unit(L);var V=h.get(),X=h.get();r.vsub(N,X);var j=X.dot(L);L.mult(j,V),V.vadd(N,V);var U=h.get();if(V.vsub(r,U),j>0&&j*j<F.norm2()&&U.norm2()<p*p){R=this.createContactEquation(a,s,t,e);V.vsub(i,R.rj),V.vsub(r,R.ni),R.ni.normalize(),R.ni.mult(p,R.ri),R.rj.vadd(i,R.rj),R.rj.vsub(s.position,R.rj),R.ri.vadd(r,R.ri),R.ri.vsub(a.position,R.ri),this.result.push(R),this.createFrictionEquationsFromContact(R,this.frictionResult);for(P=0,B=I.length;P!==B;P++)h.release(I[P]);return h.release(N),h.release(k),h.release(V),h.release(U),void h.release(X)}h.release(N),h.release(k),h.release(V),h.release(U),h.release(X)}for(P=0,B=I.length;P!==B;P++)h.release(I[P])}}};new a,new a;p.prototype[n.types.PLANE|n.types.BOX]=p.prototype.planeBox=function(t,e,r,i,n,o,a,s){e.convexPolyhedronRepresentation.material=e.material,e.convexPolyhedronRepresentation.collisionResponse=e.collisionResponse,this.planeConvex(t,e.convexPolyhedronRepresentation,r,i,n,o,a,s)};var lt=new a,ut=new a,ct=new a,pt=new a;p.prototype[n.types.PLANE|n.types.CONVEXPOLYHEDRON]=p.prototype.planeConvex=function(t,e,r,i,n,o,a,s){var h=lt,l=ut;l.set(0,0,1),n.vmult(l,l);for(var u=0,c=ct,p=0;p!==e.vertices.length;p++){if(h.copy(e.vertices[p]),o.vmult(h,h),i.vadd(h,h),h.vsub(r,c),l.dot(c)<=0){var d=this.createContactEquation(a,s,t,e),f=pt;l.mult(l.dot(c),f),h.vsub(f,f),f.vsub(r,d.ri),d.ni.copy(l),h.vsub(i,d.rj),d.ri.vadd(r,d.ri),d.ri.vsub(a.position,d.ri),d.rj.vadd(i,d.rj),d.rj.vsub(s.position,d.rj),this.result.push(d),u++,this.enableFrictionReduction||this.createFrictionEquationsFromContact(d,this.frictionResult)}}this.enableFrictionReduction&&u&&this.createFrictionFromAverage(u)};var dt=new a,ft=new a;p.prototype[n.types.CONVEXPOLYHEDRON]=p.prototype.convexConvex=function(t,e,r,i,n,o,a,s,h,l,u,c){var p=dt;if(!(r.distanceTo(i)>t.boundingSphereRadius+e.boundingSphereRadius)&&t.findSeparatingAxis(e,r,n,i,o,p,u,c)){var d=[],f=ft;t.clipAgainstHull(r,n,e,i,o,p,-100,100,d);for(var m=0,v=0;v!==d.length;v++){var y=this.createContactEquation(a,s,t,e,h,l),g=y.ri,_=y.rj;p.negate(y.ni),d[v].normal.negate(f),f.mult(d[v].depth,f),d[v].point.vadd(f,g),_.copy(d[v].point),g.vsub(r,g),_.vsub(i,_),g.vadd(r,g),g.vsub(a.position,g),_.vadd(i,_),_.vsub(s.position,_),this.result.push(y),m++,this.enableFrictionReduction||this.createFrictionEquationsFromContact(y,this.frictionResult)}this.enableFrictionReduction&&m&&this.createFrictionFromAverage(m)}};var mt=new a,vt=new a,yt=new a;p.prototype[n.types.PLANE|n.types.PARTICLE]=p.prototype.planeParticle=function(t,e,r,i,n,o,a,s){var h=mt;h.set(0,0,1),a.quaternion.vmult(h,h);var l=vt;if(i.vsub(a.position,l),h.dot(l)<=0){var u=this.createContactEquation(s,a,e,t);u.ni.copy(h),u.ni.negate(u.ni),u.ri.set(0,0,0);var c=yt;h.mult(h.dot(i),c),i.vsub(c,c),u.rj.copy(c),this.result.push(u),this.createFrictionEquationsFromContact(u,this.frictionResult)}};var gt=new a;p.prototype[n.types.PARTICLE|n.types.SPHERE]=p.prototype.sphereParticle=function(t,e,r,i,n,o,a,s){var h=gt;if(h.set(0,0,1),i.vsub(r,h),h.norm2()<=t.radius*t.radius){var l=this.createContactEquation(s,a,e,t);h.normalize(),l.rj.copy(h),l.rj.mult(t.radius,l.rj),l.ni.copy(h),l.ni.negate(l.ni),l.ri.set(0,0,0),this.result.push(l),this.createFrictionEquationsFromContact(l,this.frictionResult)}};var _t=new h,xt=new a,bt=(new a,new a),wt=new a,Tt=new a;p.prototype[n.types.PARTICLE|n.types.CONVEXPOLYHEDRON]=p.prototype.convexParticle=function(t,e,r,i,n,o,a,s){var h=-1,l=bt,u=Tt,c=null,p=xt;if(p.copy(i),p.vsub(r,p),n.conjugate(_t),_t.vmult(p,p),t.pointIsInside(p)){t.worldVerticesNeedsUpdate&&t.computeWorldVertices(r,n),t.worldFaceNormalsNeedsUpdate&&t.computeWorldFaceNormals(n);for(var d=0,f=t.faces.length;d!==f;d++){var m=[t.worldVertices[t.faces[d][0]]],v=t.worldFaceNormals[d];i.vsub(m[0],wt);var y=-v.dot(wt);(null===c||Math.abs(y)<Math.abs(c))&&(c=y,h=d,l.copy(v))}if(-1!==h){var g=this.createContactEquation(s,a,e,t);l.mult(c,u),u.vadd(i,u),u.vsub(r,u),g.rj.copy(u),l.negate(g.ni),g.ri.set(0,0,0);var _=g.ri,x=g.rj;_.vadd(i,_),_.vsub(s.position,_),x.vadd(r,x),x.vsub(a.position,x),this.result.push(g),this.createFrictionEquationsFromContact(g,this.frictionResult)}else console.warn("Point found inside convex, but did not find penetrating face!")}},p.prototype[n.types.BOX|n.types.HEIGHTFIELD]=p.prototype.boxHeightfield=function(t,e,r,i,n,o,a,s){t.convexPolyhedronRepresentation.material=t.material,t.convexPolyhedronRepresentation.collisionResponse=t.collisionResponse,this.convexHeightfield(t.convexPolyhedronRepresentation,e,r,i,n,o,a,s)};var Et=new a,St=new a,At=[0];p.prototype[n.types.CONVEXPOLYHEDRON|n.types.HEIGHTFIELD]=p.prototype.convexHeightfield=function(t,e,r,i,n,o,a,h){var l=e.data,u=e.elementSize,c=t.boundingSphereRadius,p=St,d=At,f=Et;s.pointToLocalFrame(i,o,r,f);var m=Math.floor((f.x-c)/u)-1,v=Math.ceil((f.x+c)/u)+1,y=Math.floor((f.y-c)/u)-1,g=Math.ceil((f.y+c)/u)+1;if(!(v<0||g<0||m>l.length||y>l[0].length)){m<0&&(m=0),v<0&&(v=0),y<0&&(y=0),g<0&&(g=0),m>=l.length&&(m=l.length-1),v>=l.length&&(v=l.length-1),g>=l[0].length&&(g=l[0].length-1),y>=l[0].length&&(y=l[0].length-1);var _=[];e.getRectMinMax(m,y,v,g,_);var x=_[0],b=_[1];if(!(f.z-c>b||f.z+c<x))for(var w=m;w<v;w++)for(var T=y;T<g;T++)e.getConvexTrianglePillar(w,T,!1),s.pointToWorldFrame(i,o,e.pillarOffset,p),r.distanceTo(p)<e.pillarConvex.boundingSphereRadius+t.boundingSphereRadius&&this.convexConvex(t,e.pillarConvex,r,p,n,o,a,h,null,null,d,null),e.getConvexTrianglePillar(w,T,!0),s.pointToWorldFrame(i,o,e.pillarOffset,p),r.distanceTo(p)<e.pillarConvex.boundingSphereRadius+t.boundingSphereRadius&&this.convexConvex(t,e.pillarConvex,r,p,n,o,a,h,null,null,d,null)}};var It=new a,Pt=new a;p.prototype[n.types.SPHERE|n.types.HEIGHTFIELD]=p.prototype.sphereHeightfield=function(t,e,r,i,n,o,a,h){var l=e.data,u=t.radius,c=e.elementSize,p=Pt,d=It;s.pointToLocalFrame(i,o,r,d);var f=Math.floor((d.x-u)/c)-1,m=Math.ceil((d.x+u)/c)+1,v=Math.floor((d.y-u)/c)-1,y=Math.ceil((d.y+u)/c)+1;if(!(m<0||y<0||f>l.length||y>l[0].length)){f<0&&(f=0),m<0&&(m=0),v<0&&(v=0),y<0&&(y=0),f>=l.length&&(f=l.length-1),m>=l.length&&(m=l.length-1),y>=l[0].length&&(y=l[0].length-1),v>=l[0].length&&(v=l[0].length-1);var g=[];e.getRectMinMax(f,v,m,y,g);var _=g[0],x=g[1];if(!(d.z-u>x||d.z+u<_))for(var b=this.result,w=f;w<m;w++)for(var T=v;T<y;T++){var E=b.length;if(e.getConvexTrianglePillar(w,T,!1),s.pointToWorldFrame(i,o,e.pillarOffset,p),r.distanceTo(p)<e.pillarConvex.boundingSphereRadius+t.boundingSphereRadius&&this.sphereConvex(t,e.pillarConvex,r,p,n,o,a,h),e.getConvexTrianglePillar(w,T,!0),s.pointToWorldFrame(i,o,e.pillarOffset,p),r.distanceTo(p)<e.pillarConvex.boundingSphereRadius+t.boundingSphereRadius&&this.sphereConvex(t,e.pillarConvex,r,p,n,o,a,h),b.length-E>2)return}}}},{"../collision/AABB":3,"../collision/Ray":9,"../equations/ContactEquation":19,"../equations/FrictionEquation":21,"../math/Quaternion":28,"../math/Transform":29,"../math/Vec3":30,"../shapes/ConvexPolyhedron":38,"../shapes/Shape":43,"../solver/Solver":47,"../utils/Vec3Pool":54}],56:[function(t,e,r){e.exports=g;var i=t("../shapes/Shape"),n=t("../math/Vec3"),o=t("../math/Quaternion"),a=t("../solver/GSSolver"),s=(t("../utils/Vec3Pool"),t("../equations/ContactEquation"),t("../equations/FrictionEquation"),t("./Narrowphase")),h=t("../utils/EventTarget"),l=t("../collision/ArrayCollisionMatrix"),u=t("../material/Material"),c=t("../material/ContactMaterial"),p=t("../objects/Body"),d=t("../utils/TupleDictionary"),f=t("../collision/RaycastResult"),m=t("../collision/AABB"),v=t("../collision/Ray"),y=t("../collision/NaiveBroadphase");function g(){h.apply(this),this.dt=-1,this.allowSleep=!1,this.contacts=[],this.frictionEquations=[],this.quatNormalizeSkip=0,this.quatNormalizeFast=!1,this.time=0,this.stepnumber=0,this.default_dt=1/60,this.nextId=0,this.gravity=new n,this.broadphase=new y,this.bodies=[],this.solver=new a,this.constraints=[],this.narrowphase=new s(this),this.collisionMatrix=new l,this.collisionMatrixPrevious=new l,this.materials=[],this.contactmaterials=[],this.contactMaterialTable=new d,this.defaultMaterial=new u("default"),this.defaultContactMaterial=new c(this.defaultMaterial,this.defaultMaterial,{friction:.3,restitution:0}),this.doProfiling=!1,this.profile={solve:0,makeContactConstraints:0,broadphase:0,integrate:0,narrowphase:0},this.subsystems=[],this.addBodyEvent={type:"addBody",body:null},this.removeBodyEvent={type:"removeBody",body:null}}g.prototype=new h;new m;var _=new v;if(g.prototype.getContactMaterial=function(t,e){return this.contactMaterialTable.get(t.id,e.id)},g.prototype.numObjects=function(){return this.bodies.length},g.prototype.collisionMatrixTick=function(){var t=this.collisionMatrixPrevious;this.collisionMatrixPrevious=this.collisionMatrix,this.collisionMatrix=t,this.collisionMatrix.reset()},g.prototype.add=g.prototype.addBody=function(t){-1===this.bodies.indexOf(t)&&(t.index=this.bodies.length,this.bodies.push(t),t.world=this,t.initPosition.copy(t.position),t.initVelocity.copy(t.velocity),t.timeLastSleepy=this.time,t instanceof p&&(t.initAngularVelocity.copy(t.angularVelocity),t.initQuaternion.copy(t.quaternion)),this.collisionMatrix.setNumObjects(this.bodies.length),this.addBodyEvent.body=t,this.dispatchEvent(this.addBodyEvent))},g.prototype.addConstraint=function(t){this.constraints.push(t)},g.prototype.removeConstraint=function(t){var e=this.constraints.indexOf(t);-1!==e&&this.constraints.splice(e,1)},g.prototype.rayTest=function(t,e,r){r instanceof f?this.raycastClosest(t,e,{skipBackfaces:!0},r):this.raycastAll(t,e,{skipBackfaces:!0},r)},g.prototype.raycastAll=function(t,e,r,i){return r.mode=v.ALL,r.from=t,r.to=e,r.callback=i,_.intersectWorld(this,r)},g.prototype.raycastAny=function(t,e,r,i){return r.mode=v.ANY,r.from=t,r.to=e,r.result=i,_.intersectWorld(this,r)},g.prototype.raycastClosest=function(t,e,r,i){return r.mode=v.CLOSEST,r.from=t,r.to=e,r.result=i,_.intersectWorld(this,r)},g.prototype.remove=function(t){t.world=null;var e=this.bodies.length-1,r=this.bodies,i=r.indexOf(t);if(-1!==i){r.splice(i,1);for(var n=0;n!==r.length;n++)r[n].index=n;this.collisionMatrix.setNumObjects(e),this.removeBodyEvent.body=t,this.dispatchEvent(this.removeBodyEvent)}},g.prototype.removeBody=g.prototype.remove,g.prototype.addMaterial=function(t){this.materials.push(t)},g.prototype.addContactMaterial=function(t){this.contactmaterials.push(t),this.contactMaterialTable.set(t.materials[0].id,t.materials[1].id,t)},"undefined"==typeof performance&&(performance={}),!performance.now){var x=Date.now();performance.timing&&performance.timing.navigationStart&&(x=performance.timing.navigationStart),performance.now=function(){return Date.now()-x}}var b=new n;g.prototype.step=function(t,e,r){if(r=r||10,0===(e=e||0))this.internalStep(t),this.time+=t;else{var i=Math.floor((this.time+e)/t)-Math.floor(this.time/t);i=Math.min(i,r);for(var n=performance.now(),o=0;o!==i&&(this.internalStep(t),!(performance.now()-n>1e3*t));o++);this.time+=e;for(var a=this.time%t/t,s=b,h=this.bodies,l=0;l!==h.length;l++){var u=h[l];u.type!==p.STATIC&&u.sleepState!==p.SLEEPING?(u.position.vsub(u.previousPosition,s),s.scale(a,s),u.position.vadd(s,u.interpolatedPosition)):(u.interpolatedPosition.copy(u.position),u.interpolatedQuaternion.copy(u.quaternion))}}};var w={type:"postStep"},T={type:"preStep"},E={type:"collide",body:null,contact:null},S=[],A=[],I=[],P=[],M=(new n,new n,new n,new n,new n,new n,new n,new n,new n,new o,new o),C=new o,R=new n;g.prototype.internalStep=function(t){this.dt=t;var e,r=this.contacts,n=I,o=P,a=this.numObjects(),s=this.bodies,h=this.solver,l=this.gravity,u=this.doProfiling,c=this.profile,d=p.DYNAMIC,f=this.constraints,m=A,v=(l.norm(),l.x),y=l.y,g=l.z,_=0;for(u&&(e=performance.now()),_=0;_!==a;_++){if((X=s[_]).type&d){var x=X.force,b=X.mass;x.x+=b*v,x.y+=b*y,x.z+=b*g}}_=0;for(var O=this.subsystems.length;_!==O;_++)this.subsystems[_].update();u&&(e=performance.now()),n.length=0,o.length=0,this.broadphase.collisionPairs(this,n,o),u&&(c.broadphase=performance.now()-e);var D=f.length;for(_=0;_!==D;_++){if(!(U=f[_]).collideConnected)for(var B=n.length-1;B>=0;B-=1)(U.bodyA===n[B]&&U.bodyB===o[B]||U.bodyB===n[B]&&U.bodyA===o[B])&&(n.splice(B,1),o.splice(B,1))}this.collisionMatrixTick(),u&&(e=performance.now());var N=S,k=r.length;for(_=0;_!==k;_++)N.push(r[_]);r.length=0;var F=this.frictionEquations.length;for(_=0;_!==F;_++)m.push(this.frictionEquations[_]);this.frictionEquations.length=0,this.narrowphase.getContacts(n,o,this,r,N,this.frictionEquations,m),u&&(c.narrowphase=performance.now()-e),u&&(e=performance.now());for(_=0;_<this.frictionEquations.length;_++)h.addEquation(this.frictionEquations[_]);for(var L=r.length,V=0;V!==L;V++){var X=(U=r[V]).bi,j=U.bj;U.si,U.sj,(X.material&&j.material&&this.getContactMaterial(X.material,j.material)||this.defaultContactMaterial).friction;if(X.material&&j.material&&(X.material.friction>=0&&j.material.friction>=0&&X.material.friction*j.material.friction,X.material.restitution>=0&&j.material.restitution>=0&&(U.restitution=X.material.restitution*j.material.restitution)),h.addEquation(U),X.allowSleep&&X.type===p.DYNAMIC&&X.sleepState===p.SLEEPING&&j.sleepState===p.AWAKE&&j.type!==p.STATIC)j.velocity.norm2()+j.angularVelocity.norm2()>=2*Math.pow(j.sleepSpeedLimit,2)&&(X._wakeUpAfterNarrowphase=!0);if(j.allowSleep&&j.type===p.DYNAMIC&&j.sleepState===p.SLEEPING&&X.sleepState===p.AWAKE&&X.type!==p.STATIC)X.velocity.norm2()+X.angularVelocity.norm2()>=2*Math.pow(X.sleepSpeedLimit,2)&&(j._wakeUpAfterNarrowphase=!0);this.collisionMatrix.set(X,j,!0),this.collisionMatrixPrevious.get(X,j)||(E.body=j,E.contact=U,X.dispatchEvent(E),E.body=X,j.dispatchEvent(E))}for(u&&(c.makeContactConstraints=performance.now()-e,e=performance.now()),_=0;_!==a;_++){(X=s[_])._wakeUpAfterNarrowphase&&(X.wakeUp(),X._wakeUpAfterNarrowphase=!1)}D=f.length;for(_=0;_!==D;_++){var U;(U=f[_]).update();B=0;for(var Y=U.equations.length;B!==Y;B++){var z=U.equations[B];h.addEquation(z)}}h.solve(t,this),u&&(c.solve=performance.now()-e),h.removeAllEquations();var W=Math.pow;for(_=0;_!==a;_++){if((X=s[_]).type&d){var q=W(1-X.linearDamping,t),G=X.velocity;G.mult(q,G);var H=X.angularVelocity;if(H){var $=W(1-X.angularDamping,t);H.mult($,H)}}}for(this.dispatchEvent(T),_=0;_!==a;_++){(X=s[_]).preStep&&X.preStep.call(X)}u&&(e=performance.now());var J=M,Z=C,Q=this.stepnumber,K=p.DYNAMIC|p.KINEMATIC,tt=Q%(this.quatNormalizeSkip+1)==0,et=this.quatNormalizeFast,rt=.5*t;i.types.PLANE,i.types.CONVEXPOLYHEDRON;for(_=0;_!==a;_++){var it=s[_],nt=it.force,ot=it.torque;if(it.type&K&&it.sleepState!==p.SLEEPING){var at=it.velocity,st=it.angularVelocity,ht=it.position,lt=it.quaternion,ut=it.invMass,ct=it.invInertiaWorld;at.x+=nt.x*ut*t,at.y+=nt.y*ut*t,at.z+=nt.z*ut*t,it.angularVelocity&&(ct.vmult(ot,R),R.mult(t,R),R.vadd(st,st)),ht.x+=at.x*t,ht.y+=at.y*t,ht.z+=at.z*t,it.angularVelocity&&(J.set(st.x,st.y,st.z,0),J.mult(lt,Z),lt.x+=rt*Z.x,lt.y+=rt*Z.y,lt.z+=rt*Z.z,lt.w+=rt*Z.w,tt&&(et?lt.normalizeFast():lt.normalize())),it.aabb&&(it.aabbNeedsUpdate=!0),it.updateInertiaWorld&&it.updateInertiaWorld()}}for(this.clearForces(),this.broadphase.dirty=!0,u&&(c.integrate=performance.now()-e),this.time+=t,this.stepnumber+=1,this.dispatchEvent(w),_=0;_!==a;_++){var pt=(X=s[_]).postStep;pt&&pt.call(X)}if(this.allowSleep)for(_=0;_!==a;_++)s[_].sleepTick(this.time)},g.prototype.clearForces=function(){for(var t=this.bodies,e=t.length,r=0;r!==e;r++){var i=t[r];i.force,i.torque;i.force.set(0,0,0),i.torque.set(0,0,0)}}},{"../collision/AABB":3,"../collision/ArrayCollisionMatrix":4,"../collision/NaiveBroadphase":7,"../collision/Ray":9,"../collision/RaycastResult":10,"../equations/ContactEquation":19,"../equations/FrictionEquation":21,"../material/ContactMaterial":24,"../material/Material":25,"../math/Quaternion":28,"../math/Vec3":30,"../objects/Body":31,"../shapes/Shape":43,"../solver/GSSolver":46,"../utils/EventTarget":49,"../utils/TupleDictionary":52,"../utils/Vec3Pool":54,"./Narrowphase":55}]},{},[2])(2)})),function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.io=e():t.io=e()}(this,(function(){return function(t){function e(i){if(r[i])return r[i].exports;var n=r[i]={exports:{},id:i,loaded:!1};return t[i].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e,r){function i(t,e){"object"==typeof t&&(e=t,t=void 0),e=e||{};var r,i=n(t),o=i.source,l=i.id,u=i.path,c=h[l]&&u in h[l].nsps;return e.forceNew||e["force new connection"]||!1===e.multiplex||c?(s("ignoring socket cache for %s",o),r=a(o,e)):(h[l]||(s("new io instance for %s",o),h[l]=a(o,e)),r=h[l]),i.query&&!e.query&&(e.query=i.query),r.socket(i.path,e)}var n=r(1),o=r(7),a=r(15),s=r(3)("socket.io-client");t.exports=e=i;var h=e.managers={};e.protocol=o.protocol,e.connect=i,e.Manager=r(15),e.Socket=r(39)},function(t,e,r){var i=r(2),n=r(3)("socket.io-client:url");t.exports=function(t,e){var r=t;e=e||"undefined"!=typeof location&&location,null==t&&(t=e.protocol+"//"+e.host),"string"==typeof t&&("/"===t.charAt(0)&&(t="/"===t.charAt(1)?e.protocol+t:e.host+t),/^(https?|wss?):\/\//.test(t)||(n("protocol-less url %s",t),t=void 0!==e?e.protocol+"//"+t:"https://"+t),n("parse %s",t),r=i(t)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";var o=-1!==r.host.indexOf(":")?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+o+":"+r.port,r.href=r.protocol+"://"+o+(e&&e.port===r.port?"":":"+r.port),r}},function(t,e){var r=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,i=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];t.exports=function(t){var e=t,n=t.indexOf("["),o=t.indexOf("]");-1!=n&&-1!=o&&(t=t.substring(0,n)+t.substring(n,o).replace(/:/g,";")+t.substring(o,t.length));for(var a=r.exec(t||""),s={},h=14;h--;)s[i[h]]=a[h]||"";return-1!=n&&-1!=o&&(s.source=e,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s}},function(t,e,r){(function(i){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.log=function(){var t;return"object"===("undefined"==typeof console?"undefined":n(console))&&console.log&&(t=console).log.apply(t,arguments)},e.formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),this.useColors){var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var i=0,n=0;e[0].replace(/%[a-zA-Z%]/g,(function(t){"%%"!==t&&(i++,"%c"===t&&(n=i))})),e.splice(n,0,r)}},e.save=function(t){try{t?e.storage.setItem("debug",t):e.storage.removeItem("debug")}catch(t){}},e.load=function(){var t=void 0;try{t=e.storage.getItem("debug")}catch(t){}return!t&&void 0!==i&&"env"in i&&(t=i.env.DEBUG),t},e.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},e.storage=function(){try{return localStorage}catch(t){}}(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.exports=r(5)(e),t.exports.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}}).call(e,r(4))},function(t,e){function r(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function n(t){if(l===setTimeout)return setTimeout(t,0);if((l===r||!l)&&setTimeout)return l=setTimeout,setTimeout(t,0);try{return l(t,0)}catch(e){try{return l.call(null,t,0)}catch(e){return l.call(this,t,0)}}}function o(){f&&p&&(f=!1,p.length?d=p.concat(d):m=-1,d.length&&a())}function a(){if(!f){var t=n(o);f=!0;for(var e=d.length;e;){for(p=d,d=[];++m<e;)p&&p[m].run();m=-1,e=d.length}p=null,f=!1,function(t){if(u===clearTimeout)return clearTimeout(t);if((u===i||!u)&&clearTimeout)return u=clearTimeout,clearTimeout(t);try{u(t)}catch(e){try{return u.call(null,t)}catch(e){return u.call(this,t)}}}(t)}}function s(t,e){this.fun=t,this.array=e}function h(){}var l,u,c=t.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:r}catch(t){l=r}try{u="function"==typeof clearTimeout?clearTimeout:i}catch(t){u=i}}();var p,d=[],f=!1,m=-1;c.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];d.push(new s(t,e)),1!==d.length||f||n(a)},s.prototype.run=function(){this.fun.apply(null,this.array)},c.title="browser",c.browser=!0,c.env={},c.argv=[],c.version="",c.versions={},c.on=h,c.addListener=h,c.once=h,c.off=h,c.removeListener=h,c.removeAllListeners=h,c.emit=h,c.prependListener=h,c.prependOnceListener=h,c.listeners=function(t){return[]},c.binding=function(t){throw new Error("process.binding is not supported")},c.cwd=function(){return"/"},c.chdir=function(t){throw new Error("process.chdir is not supported")},c.umask=function(){return 0}},function(t,e,r){"use strict";function i(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return Array.from(t)}t.exports=function(t){function e(t){for(var e=0,r=0;r<t.length;r++)e=(e<<5)-e+t.charCodeAt(r),e|=0;return n.colors[Math.abs(e)%n.colors.length]}function n(t){function r(){for(var t=arguments.length,e=Array(t),o=0;o<t;o++)e[o]=arguments[o];if(r.enabled){var a=r,s=Number(new Date),h=s-(i||s);a.diff=h,a.prev=i,a.curr=s,i=s,e[0]=n.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");var l=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,(function(t,r){if("%%"===t)return t;l++;var i=n.formatters[r];if("function"==typeof i){var o=e[l];t=i.call(a,o),e.splice(l,1),l--}return t})),n.formatArgs.call(a,e);var u=a.log||n.log;u.apply(a,e)}}var i=void 0;return r.namespace=t,r.enabled=n.enabled(t),r.useColors=n.useColors(),r.color=e(t),r.destroy=o,r.extend=a,"function"==typeof n.init&&n.init(r),n.instances.push(r),r}function o(){var t=n.instances.indexOf(this);return-1!==t&&(n.instances.splice(t,1),!0)}function a(t,e){var r=n(this.namespace+(void 0===e?":":e)+t);return r.log=this.log,r}function s(t){return t.toString().substring(2,t.toString().length-2).replace(/\.\*\?$/,"*")}return n.debug=n,n.default=n,n.coerce=function(t){return t instanceof Error?t.stack||t.message:t},n.disable=function(){var t=[].concat(i(n.names.map(s)),i(n.skips.map(s).map((function(t){return"-"+t})))).join(",");return n.enable(""),t},n.enable=function(t){n.save(t),n.names=[],n.skips=[];var e=void 0,r=("string"==typeof t?t:"").split(/[\s,]+/),i=r.length;for(e=0;e<i;e++)r[e]&&("-"===(t=r[e].replace(/\*/g,".*?"))[0]?n.skips.push(new RegExp("^"+t.substr(1)+"$")):n.names.push(new RegExp("^"+t+"$")));for(e=0;e<n.instances.length;e++){var o=n.instances[e];o.enabled=n.enabled(o.namespace)}},n.enabled=function(t){if("*"===t[t.length-1])return!0;var e=void 0,r=void 0;for(e=0,r=n.skips.length;e<r;e++)if(n.skips[e].test(t))return!1;for(e=0,r=n.names.length;e<r;e++)if(n.names[e].test(t))return!0;return!1},n.humanize=r(6),Object.keys(t).forEach((function(e){n[e]=t[e]})),n.instances=[],n.names=[],n.skips=[],n.formatters={},n.selectColor=e,n.enable(n.load()),n}},function(t,e){function r(t){var e=Math.abs(t);return e>=s?i(t,e,s,"day"):e>=a?i(t,e,a,"hour"):e>=o?i(t,e,o,"minute"):e>=n?i(t,e,n,"second"):t+" ms"}function i(t,e,r,i){var n=e>=1.5*r;return Math.round(t/r)+" "+i+(n?"s":"")}var n=1e3,o=60*n,a=60*o,s=24*a,h=7*s,l=365.25*s;t.exports=function(t,e){e=e||{};var i=typeof t;if("string"===i&&t.length>0)return function(t){if(!((t=String(t)).length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(e){var r=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return r*l;case"weeks":case"week":case"w":return r*h;case"days":case"day":case"d":return r*s;case"hours":case"hour":case"hrs":case"hr":case"h":return r*a;case"minutes":case"minute":case"mins":case"min":case"m":return r*o;case"seconds":case"second":case"secs":case"sec":case"s":return r*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}(t);if("number"===i&&isFinite(t))return e.long?r(t):function(t){var e=Math.abs(t);return e>=s?Math.round(t/s)+"d":e>=a?Math.round(t/a)+"h":e>=o?Math.round(t/o)+"m":e>=n?Math.round(t/n)+"s":t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},function(t,e,r){function i(){}function n(t){var r=""+t.type;if(e.BINARY_EVENT!==t.type&&e.BINARY_ACK!==t.type||(r+=t.attachments+"-"),t.nsp&&"/"!==t.nsp&&(r+=t.nsp+","),null!=t.id&&(r+=t.id),null!=t.data){var i=function(t){try{return JSON.stringify(t)}catch(t){return!1}}(t.data);if(!1===i)return f;r+=i}return l("encoded %j as %s",t,r),r}function o(){this.reconstructor=null}function a(t){var r=0,i={type:Number(t.charAt(0))};if(null==e.types[i.type])return h("unknown packet type "+i.type);if(e.BINARY_EVENT===i.type||e.BINARY_ACK===i.type){for(var n="";"-"!==t.charAt(++r)&&(n+=t.charAt(r),r!=t.length););if(n!=Number(n)||"-"!==t.charAt(r))throw new Error("Illegal attachments");i.attachments=Number(n)}if("/"===t.charAt(r+1))for(i.nsp="";++r;){if(","===(a=t.charAt(r)))break;if(i.nsp+=a,r===t.length)break}else i.nsp="/";var o=t.charAt(r+1);if(""!==o&&Number(o)==o){for(i.id="";++r;){var a;if(null==(a=t.charAt(r))||Number(a)!=a){--r;break}if(i.id+=t.charAt(r),r===t.length)break}i.id=Number(i.id)}if(t.charAt(++r)){var s=function(t){try{return JSON.parse(t)}catch(t){return!1}}(t.substr(r));if(!(!1!==s&&(i.type===e.ERROR||p(s))))return h("invalid payload");i.data=s}return l("decoded %s as %j",t,i),i}function s(t){this.reconPack=t,this.buffers=[]}function h(t){return{type:e.ERROR,data:"parser error: "+t}}var l=r(8)("socket.io-parser"),u=r(11),c=r(12),p=r(13),d=r(14);e.protocol=4,e.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],e.CONNECT=0,e.DISCONNECT=1,e.EVENT=2,e.ACK=3,e.ERROR=4,e.BINARY_EVENT=5,e.BINARY_ACK=6,e.Encoder=i,e.Decoder=o;var f=e.ERROR+'"encode error"';i.prototype.encode=function(t,r){(l("encoding packet %j",t),e.BINARY_EVENT===t.type||e.BINARY_ACK===t.type)?function(t,e){c.removeBlobs(t,(function(t){var r=c.deconstructPacket(t),i=n(r.packet),o=r.buffers;o.unshift(i),e(o)}))}(t,r):r([n(t)])},u(o.prototype),o.prototype.add=function(t){var r;if("string"==typeof t)r=a(t),e.BINARY_EVENT===r.type||e.BINARY_ACK===r.type?(this.reconstructor=new s(r),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",r)):this.emit("decoded",r);else{if(!d(t)&&!t.base64)throw new Error("Unknown type: "+t);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(r=this.reconstructor.takeBinaryData(t))&&(this.reconstructor=null,this.emit("decoded",r))}},o.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},s.prototype.takeBinaryData=function(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){var e=c.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null},s.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},function(t,e,r){(function(i){"use strict";function n(){var t;try{t=e.storage.debug}catch(t){}return!t&&void 0!==i&&"env"in i&&(t=i.env.DEBUG),t}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};(e=t.exports=r(9)).log=function(){return"object"===("undefined"==typeof console?"undefined":o(console))&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},e.formatArgs=function(t){var r=this.useColors;if(t[0]=(r?"%c":"")+this.namespace+(r?" %c":" ")+t[0]+(r?"%c ":" ")+"+"+e.humanize(this.diff),r){var i="color: "+this.color;t.splice(1,0,i,"color: inherit");var n=0,o=0;t[0].replace(/%[a-zA-Z%]/g,(function(t){"%%"!==t&&(n++,"%c"===t&&(o=n))})),t.splice(o,0,i)}},e.save=function(t){try{null==t?e.storage.removeItem("debug"):e.storage.debug=t}catch(t){}},e.load=n,e.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},e.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(t){}}(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},e.enable(n())}).call(e,r(4))},function(t,e,r){"use strict";function i(t){function r(){if(r.enabled){var t=r,n=+new Date,o=n-(i||n);t.diff=o,t.prev=i,t.curr=n,i=n;for(var a=new Array(arguments.length),s=0;s<a.length;s++)a[s]=arguments[s];a[0]=e.coerce(a[0]),"string"!=typeof a[0]&&a.unshift("%O");var h=0;a[0]=a[0].replace(/%([a-zA-Z%])/g,(function(r,i){if("%%"===r)return r;h++;var n=e.formatters[i];if("function"==typeof n){var o=a[h];r=n.call(t,o),a.splice(h,1),h--}return r})),e.formatArgs.call(t,a);var l=r.log||e.log||console.log.bind(console);l.apply(t,a)}}var i;return r.namespace=t,r.enabled=e.enabled(t),r.useColors=e.useColors(),r.color=function(t){var r,i=0;for(r in t)i=(i<<5)-i+t.charCodeAt(r),i|=0;return e.colors[Math.abs(i)%e.colors.length]}(t),r.destroy=n,"function"==typeof e.init&&e.init(r),e.instances.push(r),r}function n(){var t=e.instances.indexOf(this);return-1!==t&&(e.instances.splice(t,1),!0)}(e=t.exports=i.debug=i.default=i).coerce=function(t){return t instanceof Error?t.stack||t.message:t},e.disable=function(){e.enable("")},e.enable=function(t){e.save(t),e.names=[],e.skips=[];var r,i=("string"==typeof t?t:"").split(/[\s,]+/),n=i.length;for(r=0;r<n;r++)i[r]&&("-"===(t=i[r].replace(/\*/g,".*?"))[0]?e.skips.push(new RegExp("^"+t.substr(1)+"$")):e.names.push(new RegExp("^"+t+"$")));for(r=0;r<e.instances.length;r++){var o=e.instances[r];o.enabled=e.enabled(o.namespace)}},e.enabled=function(t){if("*"===t[t.length-1])return!0;var r,i;for(r=0,i=e.skips.length;r<i;r++)if(e.skips[r].test(t))return!1;for(r=0,i=e.names.length;r<i;r++)if(e.names[r].test(t))return!0;return!1},e.humanize=r(10),e.instances=[],e.names=[],e.skips=[],e.formatters={}},function(t,e){function r(t){return i(t,s,"day")||i(t,a,"hour")||i(t,o,"minute")||i(t,n,"second")||t+" ms"}function i(t,e,r){if(!(t<e))return t<1.5*e?Math.floor(t/e)+" "+r:Math.ceil(t/e)+" "+r+"s"}var n=1e3,o=60*n,a=60*o,s=24*a,h=365.25*s;t.exports=function(t,e){e=e||{};var i=typeof t;if("string"===i&&t.length>0)return function(t){if(!((t=String(t)).length>100)){var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(e){var r=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return r*h;case"days":case"day":case"d":return r*s;case"hours":case"hour":case"hrs":case"hr":case"h":return r*a;case"minutes":case"minute":case"mins":case"min":case"m":return r*o;case"seconds":case"second":case"secs":case"sec":case"s":return r*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}(t);if("number"===i&&!1===isNaN(t))return e.long?r(t):function(t){return t>=s?Math.round(t/s)+"d":t>=a?Math.round(t/a)+"h":t>=o?Math.round(t/o)+"m":t>=n?Math.round(t/n)+"s":t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},function(t,e,r){function i(t){if(t)return function(t){for(var e in i.prototype)t[e]=i.prototype[e];return t}(t)}t.exports=i,i.prototype.on=i.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},i.prototype.once=function(t,e){function r(){this.off(t,r),e.apply(this,arguments)}return r.fn=e,this.on(t,r),this},i.prototype.off=i.prototype.removeListener=i.prototype.removeAllListeners=i.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var r=this._callbacks["$"+t];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var i,n=0;n<r.length;n++)if((i=r[n])===e||i.fn===e){r.splice(n,1);break}return this},i.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),r=this._callbacks["$"+t];if(r)for(var i=0,n=(r=r.slice(0)).length;i<n;++i)r[i].apply(this,e);return this},i.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},i.prototype.hasListeners=function(t){return!!this.listeners(t).length}},function(t,e,r){var i=r(13),n=r(14),o=Object.prototype.toString,a="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===o.call(Blob),s="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===o.call(File);e.deconstructPacket=function(t){var e=[],r=t.data,o=t;return o.data=function t(e,r){if(!e)return e;if(n(e)){var o={_placeholder:!0,num:r.length};return r.push(e),o}if(i(e)){for(var a=new Array(e.length),s=0;s<e.length;s++)a[s]=t(e[s],r);return a}if("object"==typeof e&&!(e instanceof Date)){a={};for(var h in e)a[h]=t(e[h],r);return a}return e}(r,e),o.attachments=e.length,{packet:o,buffers:e}},e.reconstructPacket=function(t,e){return t.data=function t(e,r){if(!e)return e;if(e&&e._placeholder)return r[e.num];if(i(e))for(var n=0;n<e.length;n++)e[n]=t(e[n],r);else if("object"==typeof e)for(var o in e)e[o]=t(e[o],r);return e}(t.data,e),t.attachments=void 0,t},e.removeBlobs=function(t,e){var r=0,o=t;(function t(h,l,u){if(!h)return h;if(a&&h instanceof Blob||s&&h instanceof File){r++;var c=new FileReader;c.onload=function(){u?u[l]=this.result:o=this.result,--r||e(o)},c.readAsArrayBuffer(h)}else if(i(h))for(var p=0;p<h.length;p++)t(h[p],p,h);else if("object"==typeof h&&!n(h))for(var d in h)t(h[d],d,h)})(o),r||e(o)}},function(t,e){var r={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==r.call(t)}},function(t,e){t.exports=function(t){return r&&Buffer.isBuffer(t)||i&&(t instanceof ArrayBuffer||n(t))};var r="function"==typeof Buffer&&"function"==typeof Buffer.isBuffer,i="function"==typeof ArrayBuffer,n=function(t){return"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer}},function(t,e,r){function i(t,e){if(!(this instanceof i))return new i(t,e);t&&"object"==typeof t&&(e=t,t=void 0),(e=e||{}).path=e.path||"/socket.io",this.nsps={},this.subs=[],this.opts=e,this.reconnection(!1!==e.reconnection),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor(e.randomizationFactor||.5),this.backoff=new p({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==e.timeout?2e4:e.timeout),this.readyState="closed",this.uri=t,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var r=e.parser||s;this.encoder=new r.Encoder,this.decoder=new r.Decoder,this.autoConnect=!1!==e.autoConnect,this.autoConnect&&this.open()}var n=r(16),o=r(39),a=r(11),s=r(7),h=r(41),l=r(42),u=r(3)("socket.io-client:manager"),c=r(38),p=r(43),d=Object.prototype.hasOwnProperty;t.exports=i,i.prototype.emitAll=function(){for(var t in this.emit.apply(this,arguments),this.nsps)d.call(this.nsps,t)&&this.nsps[t].emit.apply(this.nsps[t],arguments)},i.prototype.updateSocketIds=function(){for(var t in this.nsps)d.call(this.nsps,t)&&(this.nsps[t].id=this.generateId(t))},i.prototype.generateId=function(t){return("/"===t?"":t+"#")+this.engine.id},a(i.prototype),i.prototype.reconnection=function(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection},i.prototype.reconnectionAttempts=function(t){return arguments.length?(this._reconnectionAttempts=t,this):this._reconnectionAttempts},i.prototype.reconnectionDelay=function(t){return arguments.length?(this._reconnectionDelay=t,this.backoff&&this.backoff.setMin(t),this):this._reconnectionDelay},i.prototype.randomizationFactor=function(t){return arguments.length?(this._randomizationFactor=t,this.backoff&&this.backoff.setJitter(t),this):this._randomizationFactor},i.prototype.reconnectionDelayMax=function(t){return arguments.length?(this._reconnectionDelayMax=t,this.backoff&&this.backoff.setMax(t),this):this._reconnectionDelayMax},i.prototype.timeout=function(t){return arguments.length?(this._timeout=t,this):this._timeout},i.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},i.prototype.open=i.prototype.connect=function(t,e){if(u("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;u("opening %s",this.uri),this.engine=n(this.uri,this.opts);var r=this.engine,i=this;this.readyState="opening",this.skipReconnect=!1;var o=h(r,"open",(function(){i.onopen(),t&&t()})),a=h(r,"error",(function(e){if(u("connect_error"),i.cleanup(),i.readyState="closed",i.emitAll("connect_error",e),t){var r=new Error("Connection error");r.data=e,t(r)}else i.maybeReconnectOnOpen()}));if(!1!==this._timeout){var s=this._timeout;u("connect attempt will timeout after %d",s);var l=setTimeout((function(){u("connect attempt timed out after %d",s),o.destroy(),r.close(),r.emit("error","timeout"),i.emitAll("connect_timeout",s)}),s);this.subs.push({destroy:function(){clearTimeout(l)}})}return this.subs.push(o),this.subs.push(a),this},i.prototype.onopen=function(){u("open"),this.cleanup(),this.readyState="open",this.emit("open");var t=this.engine;this.subs.push(h(t,"data",l(this,"ondata"))),this.subs.push(h(t,"ping",l(this,"onping"))),this.subs.push(h(t,"pong",l(this,"onpong"))),this.subs.push(h(t,"error",l(this,"onerror"))),this.subs.push(h(t,"close",l(this,"onclose"))),this.subs.push(h(this.decoder,"decoded",l(this,"ondecoded")))},i.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},i.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},i.prototype.ondata=function(t){this.decoder.add(t)},i.prototype.ondecoded=function(t){this.emit("packet",t)},i.prototype.onerror=function(t){u("error",t),this.emitAll("error",t)},i.prototype.socket=function(t,e){function r(){~c(n.connecting,i)||n.connecting.push(i)}var i=this.nsps[t];if(!i){i=new o(this,t,e),this.nsps[t]=i;var n=this;i.on("connecting",r),i.on("connect",(function(){i.id=n.generateId(t)})),this.autoConnect&&r()}return i},i.prototype.destroy=function(t){var e=c(this.connecting,t);~e&&this.connecting.splice(e,1),this.connecting.length||this.close()},i.prototype.packet=function(t){u("writing packet %j",t);var e=this;t.query&&0===t.type&&(t.nsp+="?"+t.query),e.encoding?e.packetBuffer.push(t):(e.encoding=!0,this.encoder.encode(t,(function(r){for(var i=0;i<r.length;i++)e.engine.write(r[i],t.options);e.encoding=!1,e.processPacketQueue()})))},i.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var t=this.packetBuffer.shift();this.packet(t)}},i.prototype.cleanup=function(){u("cleanup");for(var t=this.subs.length,e=0;e<t;e++){this.subs.shift().destroy()}this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},i.prototype.close=i.prototype.disconnect=function(){u("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},i.prototype.onclose=function(t){u("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",t),this._reconnection&&!this.skipReconnect&&this.reconnect()},i.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var t=this;if(this.backoff.attempts>=this._reconnectionAttempts)u("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var e=this.backoff.duration();u("will wait %dms before reconnect attempt",e),this.reconnecting=!0;var r=setTimeout((function(){t.skipReconnect||(u("attempting reconnect"),t.emitAll("reconnect_attempt",t.backoff.attempts),t.emitAll("reconnecting",t.backoff.attempts),t.skipReconnect||t.open((function(e){e?(u("reconnect attempt error"),t.reconnecting=!1,t.reconnect(),t.emitAll("reconnect_error",e.data)):(u("reconnect success"),t.onreconnect())})))}),e);this.subs.push({destroy:function(){clearTimeout(r)}})}},i.prototype.onreconnect=function(){var t=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",t)}},function(t,e,r){t.exports=r(17),t.exports.parser=r(24)},function(t,e,r){function i(t,e){return this instanceof i?(e=e||{},t&&"object"==typeof t&&(e=t,t=null),t?(t=l(t),e.hostname=t.host,e.secure="https"===t.protocol||"wss"===t.protocol,e.port=t.port,t.query&&(e.query=t.query)):e.host&&(e.hostname=l(e.host).host),this.secure=null!=e.secure?e.secure:"undefined"!=typeof location&&"https:"===location.protocol,e.hostname&&!e.port&&(e.port=this.secure?"443":"80"),this.agent=e.agent||!1,this.hostname=e.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=e.port||("undefined"!=typeof location&&location.port?location.port:this.secure?443:80),this.query=e.query||{},"string"==typeof this.query&&(this.query=u.decode(this.query)),this.upgrade=!1!==e.upgrade,this.path=(e.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!e.forceJSONP,this.jsonp=!1!==e.jsonp,this.forceBase64=!!e.forceBase64,this.enablesXDR=!!e.enablesXDR,this.withCredentials=!1!==e.withCredentials,this.timestampParam=e.timestampParam||"t",this.timestampRequests=e.timestampRequests,this.transports=e.transports||["polling","websocket"],this.transportOptions=e.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=e.policyPort||843,this.rememberUpgrade=e.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=e.onlyBinaryUpgrades,this.perMessageDeflate=!1!==e.perMessageDeflate&&(e.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=e.pfx||null,this.key=e.key||null,this.passphrase=e.passphrase||null,this.cert=e.cert||null,this.ca=e.ca||null,this.ciphers=e.ciphers||null,this.rejectUnauthorized=void 0===e.rejectUnauthorized||e.rejectUnauthorized,this.forceNode=!!e.forceNode,this.isReactNative="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),("undefined"==typeof self||this.isReactNative)&&(e.extraHeaders&&Object.keys(e.extraHeaders).length>0&&(this.extraHeaders=e.extraHeaders),e.localAddress&&(this.localAddress=e.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,void this.open()):new i(t,e)}var n=r(18),o=r(11),a=r(3)("engine.io-client:socket"),s=r(38),h=r(24),l=r(2),u=r(32);t.exports=i,i.priorWebsocketSuccess=!1,o(i.prototype),i.protocol=h.protocol,i.Socket=i,i.Transport=r(23),i.transports=r(18),i.parser=r(24),i.prototype.createTransport=function(t){a('creating transport "%s"',t);var e=function(t){var e={};for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e}(this.query);e.EIO=h.protocol,e.transport=t;var r=this.transportOptions[t]||{};return this.id&&(e.sid=this.id),new n[t]({query:e,socket:this,agent:r.agent||this.agent,hostname:r.hostname||this.hostname,port:r.port||this.port,secure:r.secure||this.secure,path:r.path||this.path,forceJSONP:r.forceJSONP||this.forceJSONP,jsonp:r.jsonp||this.jsonp,forceBase64:r.forceBase64||this.forceBase64,enablesXDR:r.enablesXDR||this.enablesXDR,withCredentials:r.withCredentials||this.withCredentials,timestampRequests:r.timestampRequests||this.timestampRequests,timestampParam:r.timestampParam||this.timestampParam,policyPort:r.policyPort||this.policyPort,pfx:r.pfx||this.pfx,key:r.key||this.key,passphrase:r.passphrase||this.passphrase,cert:r.cert||this.cert,ca:r.ca||this.ca,ciphers:r.ciphers||this.ciphers,rejectUnauthorized:r.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:r.perMessageDeflate||this.perMessageDeflate,extraHeaders:r.extraHeaders||this.extraHeaders,forceNode:r.forceNode||this.forceNode,localAddress:r.localAddress||this.localAddress,requestTimeout:r.requestTimeout||this.requestTimeout,protocols:r.protocols||void 0,isReactNative:this.isReactNative})},i.prototype.open=function(){var t;if(this.rememberUpgrade&&i.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))t="websocket";else{if(0===this.transports.length){var e=this;return void setTimeout((function(){e.emit("error","No transports available")}),0)}t=this.transports[0]}this.readyState="opening";try{t=this.createTransport(t)}catch(t){return this.transports.shift(),void this.open()}t.open(),this.setTransport(t)},i.prototype.setTransport=function(t){a("setting transport %s",t.name);var e=this;this.transport&&(a("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=t,t.on("drain",(function(){e.onDrain()})).on("packet",(function(t){e.onPacket(t)})).on("error",(function(t){e.onError(t)})).on("close",(function(){e.onClose("transport close")}))},i.prototype.probe=function(t){function e(){if(p.onlyBinaryUpgrades){var e=!this.supportsBinary&&p.transport.supportsBinary;c=c||e}c||(a('probe transport "%s" opened',t),u.send([{type:"ping",data:"probe"}]),u.once("packet",(function(e){if(!c)if("pong"===e.type&&"probe"===e.data){if(a('probe transport "%s" pong',t),p.upgrading=!0,p.emit("upgrading",u),!u)return;i.priorWebsocketSuccess="websocket"===u.name,a('pausing current transport "%s"',p.transport.name),p.transport.pause((function(){c||"closed"!==p.readyState&&(a("changing transport and sending upgrade packet"),l(),p.setTransport(u),u.send([{type:"upgrade"}]),p.emit("upgrade",u),u=null,p.upgrading=!1,p.flush())}))}else{a('probe transport "%s" failed',t);var r=new Error("probe error");r.transport=u.name,p.emit("upgradeError",r)}})))}function r(){c||(c=!0,l(),u.close(),u=null)}function n(e){var i=new Error("probe error: "+e);i.transport=u.name,r(),a('probe transport "%s" failed because of error: %s',t,e),p.emit("upgradeError",i)}function o(){n("transport closed")}function s(){n("socket closed")}function h(t){u&&t.name!==u.name&&(a('"%s" works - aborting "%s"',t.name,u.name),r())}function l(){u.removeListener("open",e),u.removeListener("error",n),u.removeListener("close",o),p.removeListener("close",s),p.removeListener("upgrading",h)}a('probing transport "%s"',t);var u=this.createTransport(t,{probe:1}),c=!1,p=this;i.priorWebsocketSuccess=!1,u.once("open",e),u.once("error",n),u.once("close",o),this.once("close",s),this.once("upgrading",h),u.open()},i.prototype.onOpen=function(){if(a("socket open"),this.readyState="open",i.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){a("starting upgrade probes");for(var t=0,e=this.upgrades.length;t<e;t++)this.probe(this.upgrades[t])}},i.prototype.onPacket=function(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(a('socket receive: type "%s", data "%s"',t.type,t.data),this.emit("packet",t),this.emit("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var e=new Error("server error");e.code=t.data,this.onError(e);break;case"message":this.emit("data",t.data),this.emit("message",t.data)}else a('packet received with socket readyState "%s"',this.readyState)},i.prototype.onHandshake=function(t){this.emit("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},i.prototype.onHeartbeat=function(t){clearTimeout(this.pingTimeoutTimer);var e=this;e.pingTimeoutTimer=setTimeout((function(){"closed"!==e.readyState&&e.onClose("ping timeout")}),t||e.pingInterval+e.pingTimeout)},i.prototype.setPing=function(){var t=this;clearTimeout(t.pingIntervalTimer),t.pingIntervalTimer=setTimeout((function(){a("writing ping packet - expecting pong within %sms",t.pingTimeout),t.ping(),t.onHeartbeat(t.pingTimeout)}),t.pingInterval)},i.prototype.ping=function(){var t=this;this.sendPacket("ping",(function(){t.emit("ping")}))},i.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},i.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(a("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},i.prototype.write=i.prototype.send=function(t,e,r){return this.sendPacket("message",t,e,r),this},i.prototype.sendPacket=function(t,e,r,i){if("function"==typeof e&&(i=e,e=void 0),"function"==typeof r&&(i=r,r=null),"closing"!==this.readyState&&"closed"!==this.readyState){(r=r||{}).compress=!1!==r.compress;var n={type:t,data:e,options:r};this.emit("packetCreate",n),this.writeBuffer.push(n),i&&this.once("flush",i),this.flush()}},i.prototype.close=function(){function t(){i.onClose("forced close"),a("socket closing - telling transport to close"),i.transport.close()}function e(){i.removeListener("upgrade",e),i.removeListener("upgradeError",e),t()}function r(){i.once("upgrade",e),i.once("upgradeError",e)}if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var i=this;this.writeBuffer.length?this.once("drain",(function(){this.upgrading?r():t()})):this.upgrading?r():t()}return this},i.prototype.onError=function(t){a("socket error %j",t),i.priorWebsocketSuccess=!1,this.emit("error",t),this.onClose("transport error",t)},i.prototype.onClose=function(t,e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){a('socket close with reason: "%s"',t);clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",t,e),this.writeBuffer=[],this.prevBufferLen=0}},i.prototype.filterUpgrades=function(t){for(var e=[],r=0,i=t.length;r<i;r++)~s(this.transports,t[r])&&e.push(t[r]);return e}},function(t,e,r){var i=r(19),n=r(21),o=r(35),a=r(36);e.polling=function(t){var e=!1,r=!1,a=!1!==t.jsonp;if("undefined"!=typeof location){var s="https:"===location.protocol,h=location.port;h||(h=s?443:80),e=t.hostname!==location.hostname||h!==t.port,r=t.secure!==s}if(t.xdomain=e,t.xscheme=r,"open"in new i(t)&&!t.forceJSONP)return new n(t);if(!a)throw new Error("JSONP disabled");return new o(t)},e.websocket=a},function(t,e,r){var i=r(20);t.exports=function(t){var e=t.xdomain,r=t.xscheme,n=t.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!e||i))return new XMLHttpRequest}catch(t){}try{if("undefined"!=typeof XDomainRequest&&!r&&n)return new XDomainRequest}catch(t){}if(!e)try{return new(self[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(t){}}},function(t,e){try{t.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(e){t.exports=!1}},function(t,e,r){function i(){}function n(t){if(h.call(this,t),this.requestTimeout=t.requestTimeout,this.extraHeaders=t.extraHeaders,"undefined"!=typeof location){var e="https:"===location.protocol,r=location.port;r||(r=e?443:80),this.xd="undefined"!=typeof location&&t.hostname!==location.hostname||r!==t.port,this.xs=t.secure!==e}}function o(t){this.method=t.method||"GET",this.uri=t.uri,this.xd=!!t.xd,this.xs=!!t.xs,this.async=!1!==t.async,this.data=void 0!==t.data?t.data:null,this.agent=t.agent,this.isBinary=t.isBinary,this.supportsBinary=t.supportsBinary,this.enablesXDR=t.enablesXDR,this.withCredentials=t.withCredentials,this.requestTimeout=t.requestTimeout,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized,this.extraHeaders=t.extraHeaders,this.create()}function a(){for(var t in o.requests)o.requests.hasOwnProperty(t)&&o.requests[t].abort()}var s=r(19),h=r(22),l=r(11),u=r(33),c=r(3)("engine.io-client:polling-xhr");if(t.exports=n,t.exports.Request=o,u(n,h),n.prototype.supportsBinary=!0,n.prototype.request=function(t){return(t=t||{}).uri=this.uri(),t.xd=this.xd,t.xs=this.xs,t.agent=this.agent||!1,t.supportsBinary=this.supportsBinary,t.enablesXDR=this.enablesXDR,t.withCredentials=this.withCredentials,t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized,t.requestTimeout=this.requestTimeout,t.extraHeaders=this.extraHeaders,new o(t)},n.prototype.doWrite=function(t,e){var r="string"!=typeof t&&void 0!==t,i=this.request({method:"POST",data:t,isBinary:r}),n=this;i.on("success",e),i.on("error",(function(t){n.onError("xhr post error",t)})),this.sendXhr=i},n.prototype.doPoll=function(){c("xhr poll");var t=this.request(),e=this;t.on("data",(function(t){e.onData(t)})),t.on("error",(function(t){e.onError("xhr poll error",t)})),this.pollXhr=t},l(o.prototype),o.prototype.create=function(){var t={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized;var e=this.xhr=new s(t),r=this;try{c("xhr open %s: %s",this.method,this.uri),e.open(this.method,this.uri,this.async);try{if(this.extraHeaders)for(var i in e.setDisableHeaderCheck&&e.setDisableHeaderCheck(!0),this.extraHeaders)this.extraHeaders.hasOwnProperty(i)&&e.setRequestHeader(i,this.extraHeaders[i])}catch(t){}if("POST"===this.method)try{this.isBinary?e.setRequestHeader("Content-type","application/octet-stream"):e.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(t){}try{e.setRequestHeader("Accept","*/*")}catch(t){}"withCredentials"in e&&(e.withCredentials=this.withCredentials),this.requestTimeout&&(e.timeout=this.requestTimeout),this.hasXDR()?(e.onload=function(){r.onLoad()},e.onerror=function(){r.onError(e.responseText)}):e.onreadystatechange=function(){if(2===e.readyState)try{var t=e.getResponseHeader("Content-Type");(r.supportsBinary&&"application/octet-stream"===t||"application/octet-stream; charset=UTF-8"===t)&&(e.responseType="arraybuffer")}catch(t){}4===e.readyState&&(200===e.status||1223===e.status?r.onLoad():setTimeout((function(){r.onError("number"==typeof e.status?e.status:0)}),0))},c("xhr data %s",this.data),e.send(this.data)}catch(t){return void setTimeout((function(){r.onError(t)}),0)}"undefined"!=typeof document&&(this.index=o.requestsCount++,o.requests[this.index]=this)},o.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},o.prototype.onData=function(t){this.emit("data",t),this.onSuccess()},o.prototype.onError=function(t){this.emit("error",t),this.cleanup(!0)},o.prototype.cleanup=function(t){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=i:this.xhr.onreadystatechange=i,t)try{this.xhr.abort()}catch(t){}"undefined"!=typeof document&&delete o.requests[this.index],this.xhr=null}},o.prototype.onLoad=function(){var t;try{var e;try{e=this.xhr.getResponseHeader("Content-Type")}catch(t){}t=("application/octet-stream"===e||"application/octet-stream; charset=UTF-8"===e)&&this.xhr.response||this.xhr.responseText}catch(t){this.onError(t)}null!=t&&this.onData(t)},o.prototype.hasXDR=function(){return"undefined"!=typeof XDomainRequest&&!this.xs&&this.enablesXDR},o.prototype.abort=function(){this.cleanup()},o.requestsCount=0,o.requests={},"undefined"!=typeof document)if("function"==typeof attachEvent)attachEvent("onunload",a);else if("function"==typeof addEventListener){var p="onpagehide"in self?"pagehide":"unload";addEventListener(p,a,!1)}},function(t,e,r){function i(t){var e=t&&t.forceBase64;u&&!e||(this.supportsBinary=!1),n.call(this,t)}var n=r(23),o=r(32),a=r(24),s=r(33),h=r(34),l=r(3)("engine.io-client:polling");t.exports=i;var u=null!=new(r(19))({xdomain:!1}).responseType;s(i,n),i.prototype.name="polling",i.prototype.doOpen=function(){this.poll()},i.prototype.pause=function(t){function e(){l("paused"),r.readyState="paused",t()}var r=this;if(this.readyState="pausing",this.polling||!this.writable){var i=0;this.polling&&(l("we are currently polling - waiting to pause"),i++,this.once("pollComplete",(function(){l("pre-pause polling complete"),--i||e()}))),this.writable||(l("we are currently writing - waiting to pause"),i++,this.once("drain",(function(){l("pre-pause writing complete"),--i||e()})))}else e()},i.prototype.poll=function(){l("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},i.prototype.onData=function(t){var e=this;l("polling got data %s",t);a.decodePayload(t,this.socket.binaryType,(function(t,r,i){return"opening"===e.readyState&&e.onOpen(),"close"===t.type?(e.onClose(),!1):void e.onPacket(t)})),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():l('ignoring poll - transport state "%s"',this.readyState))},i.prototype.doClose=function(){function t(){l("writing close packet"),e.write([{type:"close"}])}var e=this;"open"===this.readyState?(l("transport open - closing"),t()):(l("transport not open - deferring close"),this.once("open",t))},i.prototype.write=function(t){var e=this;this.writable=!1;var r=function(){e.writable=!0,e.emit("drain")};a.encodePayload(t,this.supportsBinary,(function(t){e.doWrite(t,r)}))},i.prototype.uri=function(){var t=this.query||{},e=this.secure?"https":"http",r="";return!1!==this.timestampRequests&&(t[this.timestampParam]=h()),this.supportsBinary||t.sid||(t.b64=1),t=o.encode(t),this.port&&("https"===e&&443!==Number(this.port)||"http"===e&&80!==Number(this.port))&&(r=":"+this.port),t.length&&(t="?"+t),e+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+r+this.path+t}},function(t,e,r){function i(t){this.path=t.path,this.hostname=t.hostname,this.port=t.port,this.secure=t.secure,this.query=t.query,this.timestampParam=t.timestampParam,this.timestampRequests=t.timestampRequests,this.readyState="",this.agent=t.agent||!1,this.socket=t.socket,this.enablesXDR=t.enablesXDR,this.withCredentials=t.withCredentials,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized,this.forceNode=t.forceNode,this.isReactNative=t.isReactNative,this.extraHeaders=t.extraHeaders,this.localAddress=t.localAddress}var n=r(24),o=r(11);t.exports=i,o(i.prototype),i.prototype.onError=function(t,e){var r=new Error(t);return r.type="TransportError",r.description=e,this.emit("error",r),this},i.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},i.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},i.prototype.send=function(t){if("open"!==this.readyState)throw new Error("Transport not open");this.write(t)},i.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},i.prototype.onData=function(t){var e=n.decodePacket(t,this.socket.binaryType);this.onPacket(e)},i.prototype.onPacket=function(t){this.emit("packet",t)},i.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},function(t,e,r){function i(t,r){return r("b"+e.packets[t.type]+t.data.data)}function n(t,r,i){if(!r)return e.encodeBase64Packet(t,i);var n=t.data,o=new Uint8Array(n),a=new Uint8Array(1+n.byteLength);a[0]=v[t.type];for(var s=0;s<o.length;s++)a[s+1]=o[s];return i(a.buffer)}function o(t,r,i){if(!r)return e.encodeBase64Packet(t,i);if(m)return function(t,r,i){if(!r)return e.encodeBase64Packet(t,i);var n=new FileReader;return n.onload=function(){e.encodePacket({type:t.type,data:n.result},r,!0,i)},n.readAsArrayBuffer(t.data)}(t,r,i);var n=new Uint8Array(1);return n[0]=v[t.type],i(new _([n.buffer,t.data]))}function a(t,e,r){for(var i=new Array(t.length),n=c(t.length,r),o=function(t,r,n){e(r,(function(e,r){i[t]=r,n(e,i)}))},a=0;a<t.length;a++)o(a,t[a],n)}var s,h=r(25),l=r(26),u=r(27),c=r(28),p=r(29);"undefined"!=typeof ArrayBuffer&&(s=r(30));var d="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),f="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),m=d||f;e.protocol=3;var v=e.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},y=h(v),g={type:"error",data:"parser error"},_=r(31);e.encodePacket=function(t,e,r,a){"function"==typeof e&&(a=e,e=!1),"function"==typeof r&&(a=r,r=null);var s=void 0===t.data?void 0:t.data.buffer||t.data;if("undefined"!=typeof ArrayBuffer&&s instanceof ArrayBuffer)return n(t,e,a);if(void 0!==_&&s instanceof _)return o(t,e,a);if(s&&s.base64)return i(t,a);var h=v[t.type];return void 0!==t.data&&(h+=r?p.encode(String(t.data),{strict:!1}):String(t.data)),a(""+h)},e.encodeBase64Packet=function(t,r){var i,n="b"+e.packets[t.type];if(void 0!==_&&t.data instanceof _){var o=new FileReader;return o.onload=function(){var t=o.result.split(",")[1];r(n+t)},o.readAsDataURL(t.data)}try{i=String.fromCharCode.apply(null,new Uint8Array(t.data))}catch(e){for(var a=new Uint8Array(t.data),s=new Array(a.length),h=0;h<a.length;h++)s[h]=a[h];i=String.fromCharCode.apply(null,s)}return n+=btoa(i),r(n)},e.decodePacket=function(t,r,i){if(void 0===t)return g;if("string"==typeof t){if("b"===t.charAt(0))return e.decodeBase64Packet(t.substr(1),r);if(i&&!1===(t=function(t){try{t=p.decode(t,{strict:!1})}catch(t){return!1}return t}(t)))return g;var n=t.charAt(0);return Number(n)==n&&y[n]?t.length>1?{type:y[n],data:t.substring(1)}:{type:y[n]}:g}n=new Uint8Array(t)[0];var o=u(t,1);return _&&"blob"===r&&(o=new _([o])),{type:y[n],data:o}},e.decodeBase64Packet=function(t,e){var r=y[t.charAt(0)];if(!s)return{type:r,data:{base64:!0,data:t.substr(1)}};var i=s.decode(t.substr(1));return"blob"===e&&_&&(i=new _([i])),{type:r,data:i}},e.encodePayload=function(t,r,i){"function"==typeof r&&(i=r,r=null);var n=l(t);return r&&n?_&&!m?e.encodePayloadAsBlob(t,i):e.encodePayloadAsArrayBuffer(t,i):t.length?void a(t,(function(t,i){e.encodePacket(t,!!n&&r,!1,(function(t){i(null,function(t){return t.length+":"+t}(t))}))}),(function(t,e){return i(e.join(""))})):i("0:")},e.decodePayload=function(t,r,i){if("string"!=typeof t)return e.decodePayloadAsBinary(t,r,i);var n;if("function"==typeof r&&(i=r,r=null),""===t)return i(g,0,1);for(var o,a,s="",h=0,l=t.length;h<l;h++){var u=t.charAt(h);if(":"===u){if(""===s||s!=(o=Number(s)))return i(g,0,1);if(s!=(a=t.substr(h+1,o)).length)return i(g,0,1);if(a.length){if(n=e.decodePacket(a,r,!1),g.type===n.type&&g.data===n.data)return i(g,0,1);if(!1===i(n,h+o,l))return}h+=o,s=""}else s+=u}return""!==s?i(g,0,1):void 0},e.encodePayloadAsArrayBuffer=function(t,r){return t.length?void a(t,(function(t,r){e.encodePacket(t,!0,!0,(function(t){return r(null,t)}))}),(function(t,e){var i=e.reduce((function(t,e){var r;return t+(r="string"==typeof e?e.length:e.byteLength).toString().length+r+2}),0),n=new Uint8Array(i),o=0;return e.forEach((function(t){var e="string"==typeof t,r=t;if(e){for(var i=new Uint8Array(t.length),a=0;a<t.length;a++)i[a]=t.charCodeAt(a);r=i.buffer}n[o++]=e?0:1;var s=r.byteLength.toString();for(a=0;a<s.length;a++)n[o++]=parseInt(s[a]);n[o++]=255;for(i=new Uint8Array(r),a=0;a<i.length;a++)n[o++]=i[a]})),r(n.buffer)})):r(new ArrayBuffer(0))},e.encodePayloadAsBlob=function(t,r){a(t,(function(t,r){e.encodePacket(t,!0,!0,(function(t){var e=new Uint8Array(1);if(e[0]=1,"string"==typeof t){for(var i=new Uint8Array(t.length),n=0;n<t.length;n++)i[n]=t.charCodeAt(n);t=i.buffer,e[0]=0}var o=(t instanceof ArrayBuffer?t.byteLength:t.size).toString(),a=new Uint8Array(o.length+1);for(n=0;n<o.length;n++)a[n]=parseInt(o[n]);if(a[o.length]=255,_){var s=new _([e.buffer,a.buffer,t]);r(null,s)}}))}),(function(t,e){return r(new _(e))}))},e.decodePayloadAsBinary=function(t,r,i){"function"==typeof r&&(i=r,r=null);for(var n=t,o=[];n.byteLength>0;){for(var a=new Uint8Array(n),s=0===a[0],h="",l=1;255!==a[l];l++){if(h.length>310)return i(g,0,1);h+=a[l]}n=u(n,2+h.length),h=parseInt(h);var c=u(n,0,h);if(s)try{c=String.fromCharCode.apply(null,new Uint8Array(c))}catch(t){var p=new Uint8Array(c);c="";for(l=0;l<p.length;l++)c+=String.fromCharCode(p[l])}o.push(c),n=u(n,h)}var d=o.length;o.forEach((function(t,n){i(e.decodePacket(t,r,!0),n,d)}))}},function(t,e){t.exports=Object.keys||function(t){var e=[],r=Object.prototype.hasOwnProperty;for(var i in t)r.call(t,i)&&e.push(i);return e}},function(t,e,r){var i=r(13),n=Object.prototype.toString,o="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===n.call(Blob),a="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===n.call(File);t.exports=function t(e){if(!e||"object"!=typeof e)return!1;if(i(e)){for(var r=0,n=e.length;r<n;r++)if(t(e[r]))return!0;return!1}if("function"==typeof Buffer&&Buffer.isBuffer&&Buffer.isBuffer(e)||"function"==typeof ArrayBuffer&&e instanceof ArrayBuffer||o&&e instanceof Blob||a&&e instanceof File)return!0;if(e.toJSON&&"function"==typeof e.toJSON&&1===arguments.length)return t(e.toJSON(),!0);for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)&&t(e[s]))return!0;return!1}},function(t,e){t.exports=function(t,e,r){var i=t.byteLength;if(e=e||0,r=r||i,t.slice)return t.slice(e,r);if(e<0&&(e+=i),r<0&&(r+=i),r>i&&(r=i),e>=i||e>=r||0===i)return new ArrayBuffer(0);for(var n=new Uint8Array(t),o=new Uint8Array(r-e),a=e,s=0;a<r;a++,s++)o[s]=n[a];return o.buffer}},function(t,e){function r(){}t.exports=function(t,e,i){function n(t,r){if(n.count<=0)throw new Error("after called too many times");--n.count,t?(o=!0,e(t),e=i):0!==n.count||o||e(null,r)}var o=!1;return i=i||r,n.count=t,0===t?e():n}},function(t,e){function r(t){for(var e,r,i=[],n=0,o=t.length;n<o;)(e=t.charCodeAt(n++))>=55296&&e<=56319&&n<o?56320==(64512&(r=t.charCodeAt(n++)))?i.push(((1023&e)<<10)+(1023&r)+65536):(i.push(e),n--):i.push(e);return i}function i(t,e){if(t>=55296&&t<=57343){if(e)throw Error("Lone surrogate U+"+t.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function n(t,e){return c(t>>e&63|128)}function o(t,e){if(0==(4294967168&t))return c(t);var r="";return 0==(4294965248&t)?r=c(t>>6&31|192):0==(4294901760&t)?(i(t,e)||(t=65533),r=c(t>>12&15|224),r+=n(t,6)):0==(4292870144&t)&&(r=c(t>>18&7|240),r+=n(t,12),r+=n(t,6)),r+c(63&t|128)}function a(){if(u>=l)throw Error("Invalid byte index");var t=255&h[u];if(u++,128==(192&t))return 63&t;throw Error("Invalid continuation byte")}function s(t){var e,r;if(u>l)throw Error("Invalid byte index");if(u==l)return!1;if(e=255&h[u],u++,0==(128&e))return e;if(192==(224&e)){if((r=(31&e)<<6|a())>=128)return r;throw Error("Invalid continuation byte")}if(224==(240&e)){if((r=(15&e)<<12|a()<<6|a())>=2048)return i(r,t)?r:65533;throw Error("Invalid continuation byte")}if(240==(248&e)&&((r=(7&e)<<18|a()<<12|a()<<6|a())>=65536&&r<=1114111))return r;throw Error("Invalid UTF-8 detected")}/*! https://mths.be/utf8js v2.1.2 by @mathias */
var h,l,u,c=String.fromCharCode;t.exports={version:"2.1.2",encode:function(t,e){for(var i=!1!==(e=e||{}).strict,n=r(t),a=n.length,s=-1,h="";++s<a;)h+=o(n[s],i);return h},decode:function(t,e){var i=!1!==(e=e||{}).strict;h=r(t),l=h.length,u=0;for(var n,o=[];!1!==(n=s(i));)o.push(n);return function(t){for(var e,r=t.length,i=-1,n="";++i<r;)(e=t[i])>65535&&(n+=c((e-=65536)>>>10&1023|55296),e=56320|1023&e),n+=c(e);return n}(o)}}},function(t,e){!function(){"use strict";for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=new Uint8Array(256),i=0;i<t.length;i++)r[t.charCodeAt(i)]=i;e.encode=function(e){var r,i=new Uint8Array(e),n=i.length,o="";for(r=0;r<n;r+=3)o+=t[i[r]>>2],o+=t[(3&i[r])<<4|i[r+1]>>4],o+=t[(15&i[r+1])<<2|i[r+2]>>6],o+=t[63&i[r+2]];return n%3==2?o=o.substring(0,o.length-1)+"=":n%3==1&&(o=o.substring(0,o.length-2)+"=="),o},e.decode=function(t){var e,i,n,o,a,s=.75*t.length,h=t.length,l=0;"="===t[t.length-1]&&(s--,"="===t[t.length-2]&&s--);var u=new ArrayBuffer(s),c=new Uint8Array(u);for(e=0;e<h;e+=4)i=r[t.charCodeAt(e)],n=r[t.charCodeAt(e+1)],o=r[t.charCodeAt(e+2)],a=r[t.charCodeAt(e+3)],c[l++]=i<<2|n>>4,c[l++]=(15&n)<<4|o>>2,c[l++]=(3&o)<<6|63&a;return u}}()},function(t,e){function r(t){return t.map((function(t){if(t.buffer instanceof ArrayBuffer){var e=t.buffer;if(t.byteLength!==e.byteLength){var r=new Uint8Array(t.byteLength);r.set(new Uint8Array(e,t.byteOffset,t.byteLength)),e=r.buffer}return e}return t}))}function i(t,e){e=e||{};var i=new o;return r(t).forEach((function(t){i.append(t)})),e.type?i.getBlob(e.type):i.getBlob()}function n(t,e){return new Blob(r(t),e||{})}var o=void 0!==o?o:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder&&MozBlobBuilder,a=function(){try{return 2===new Blob(["hi"]).size}catch(t){return!1}}(),s=a&&function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(t){return!1}}(),h=o&&o.prototype.append&&o.prototype.getBlob;"undefined"!=typeof Blob&&(i.prototype=Blob.prototype,n.prototype=Blob.prototype),t.exports=a?s?Blob:n:h?i:void 0},function(t,e){e.encode=function(t){var e="";for(var r in t)t.hasOwnProperty(r)&&(e.length&&(e+="&"),e+=encodeURIComponent(r)+"="+encodeURIComponent(t[r]));return e},e.decode=function(t){for(var e={},r=t.split("&"),i=0,n=r.length;i<n;i++){var o=r[i].split("=");e[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return e}},function(t,e){t.exports=function(t,e){var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}},function(t,e){"use strict";function r(t){var e="";do{e=o[t%a]+e,t=Math.floor(t/a)}while(t>0);return e}function i(){var t=r(+new Date);return t!==n?(h=0,n=t):t+"."+r(h++)}for(var n,o="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),a=64,s={},h=0,l=0;l<a;l++)s[o[l]]=l;i.encode=r,i.decode=function(t){var e=0;for(l=0;l<t.length;l++)e=e*a+s[t.charAt(l)];return e},t.exports=i},function(t,e,r){(function(e){function i(){}function n(){return"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==e?e:{}}function o(t){if(a.call(this,t),this.query=this.query||{},!h){var e=n();h=e.___eio=e.___eio||[]}this.index=h.length;var r=this;h.push((function(t){r.onData(t)})),this.query.j=this.index,"function"==typeof addEventListener&&addEventListener("beforeunload",(function(){r.script&&(r.script.onerror=i)}),!1)}var a=r(22),s=r(33);t.exports=o;var h,l=/\n/g,u=/\\n/g;s(o,a),o.prototype.supportsBinary=!1,o.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),a.prototype.doClose.call(this)},o.prototype.doPoll=function(){var t=this,e=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),e.async=!0,e.src=this.uri(),e.onerror=function(e){t.onError("jsonp poll error",e)};var r=document.getElementsByTagName("script")[0];r?r.parentNode.insertBefore(e,r):(document.head||document.body).appendChild(e),this.script=e,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout((function(){var t=document.createElement("iframe");document.body.appendChild(t),document.body.removeChild(t)}),100)},o.prototype.doWrite=function(t,e){function r(){i(),e()}function i(){if(n.iframe)try{n.form.removeChild(n.iframe)}catch(t){n.onError("jsonp polling iframe removal error",t)}try{var t='<iframe src="javascript:0" name="'+n.iframeId+'">';o=document.createElement(t)}catch(t){(o=document.createElement("iframe")).name=n.iframeId,o.src="javascript:0"}o.id=n.iframeId,n.form.appendChild(o),n.iframe=o}var n=this;if(!this.form){var o,a=document.createElement("form"),s=document.createElement("textarea"),h=this.iframeId="eio_iframe_"+this.index;a.className="socketio",a.style.position="absolute",a.style.top="-1000px",a.style.left="-1000px",a.target=h,a.method="POST",a.setAttribute("accept-charset","utf-8"),s.name="d",a.appendChild(s),document.body.appendChild(a),this.form=a,this.area=s}this.form.action=this.uri(),i(),t=t.replace(u,"\\\n"),this.area.value=t.replace(l,"\\n");try{this.form.submit()}catch(t){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===n.iframe.readyState&&r()}:this.iframe.onload=r}}).call(e,function(){return this}())},function(t,e,r){function i(t){t&&t.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=t.perMessageDeflate,this.usingBrowserWebSocket=n&&!t.forceNode,this.protocols=t.protocols,this.usingBrowserWebSocket||(p=o),a.call(this,t)}var n,o,a=r(23),s=r(24),h=r(32),l=r(33),u=r(34),c=r(3)("engine.io-client:websocket");if("undefined"!=typeof WebSocket?n=WebSocket:"undefined"!=typeof self&&(n=self.WebSocket||self.MozWebSocket),"undefined"==typeof window)try{o=r(37)}catch(t){}var p=n||o;t.exports=i,l(i,a),i.prototype.name="websocket",i.prototype.supportsBinary=!0,i.prototype.doOpen=function(){if(this.check()){var t=this.uri(),e=this.protocols,r={agent:this.agent,perMessageDeflate:this.perMessageDeflate};r.pfx=this.pfx,r.key=this.key,r.passphrase=this.passphrase,r.cert=this.cert,r.ca=this.ca,r.ciphers=this.ciphers,r.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(r.headers=this.extraHeaders),this.localAddress&&(r.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket&&!this.isReactNative?e?new p(t,e):new p(t):new p(t,e,r)}catch(t){return this.emit("error",t)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},i.prototype.addEventListeners=function(){var t=this;this.ws.onopen=function(){t.onOpen()},this.ws.onclose=function(){t.onClose()},this.ws.onmessage=function(e){t.onData(e.data)},this.ws.onerror=function(e){t.onError("websocket error",e)}},i.prototype.write=function(t){var e=this;this.writable=!1;for(var r=t.length,i=0,n=r;i<n;i++)!function(t){s.encodePacket(t,e.supportsBinary,(function(i){if(!e.usingBrowserWebSocket){var n={};if(t.options&&(n.compress=t.options.compress),e.perMessageDeflate)("string"==typeof i?Buffer.byteLength(i):i.length)<e.perMessageDeflate.threshold&&(n.compress=!1)}try{e.usingBrowserWebSocket?e.ws.send(i):e.ws.send(i,n)}catch(t){c("websocket closed before onclose event")}--r||(e.emit("flush"),setTimeout((function(){e.writable=!0,e.emit("drain")}),0))}))}(t[i])},i.prototype.onClose=function(){a.prototype.onClose.call(this)},i.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},i.prototype.uri=function(){var t=this.query||{},e=this.secure?"wss":"ws",r="";return this.port&&("wss"===e&&443!==Number(this.port)||"ws"===e&&80!==Number(this.port))&&(r=":"+this.port),this.timestampRequests&&(t[this.timestampParam]=u()),this.supportsBinary||(t.b64=1),(t=h.encode(t)).length&&(t="?"+t),e+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+r+this.path+t},i.prototype.check=function(){return!(!p||"__initialize"in p&&this.name===i.prototype.name)}},function(t,e){},function(t,e){var r=[].indexOf;t.exports=function(t,e){if(r)return t.indexOf(e);for(var i=0;i<t.length;++i)if(t[i]===e)return i;return-1}},function(t,e,r){function i(t,e,r){this.io=t,this.nsp=e,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},r&&r.query&&(this.query=r.query),this.io.autoConnect&&this.open()}var n=r(7),o=r(11),a=r(40),s=r(41),h=r(42),l=r(3)("socket.io-client:socket"),u=r(32),c=r(26);t.exports=i;var p={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},d=o.prototype.emit;o(i.prototype),i.prototype.subEvents=function(){if(!this.subs){var t=this.io;this.subs=[s(t,"open",h(this,"onopen")),s(t,"packet",h(this,"onpacket")),s(t,"close",h(this,"onclose"))]}},i.prototype.open=i.prototype.connect=function(){return this.connected||(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting")),this},i.prototype.send=function(){var t=a(arguments);return t.unshift("message"),this.emit.apply(this,t),this},i.prototype.emit=function(t){if(p.hasOwnProperty(t))return d.apply(this,arguments),this;var e=a(arguments),r={type:(void 0!==this.flags.binary?this.flags.binary:c(e))?n.BINARY_EVENT:n.EVENT,data:e,options:{}};return r.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof e[e.length-1]&&(l("emitting packet with ack id %d",this.ids),this.acks[this.ids]=e.pop(),r.id=this.ids++),this.connected?this.packet(r):this.sendBuffer.push(r),this.flags={},this},i.prototype.packet=function(t){t.nsp=this.nsp,this.io.packet(t)},i.prototype.onopen=function(){if(l("transport is open - connecting"),"/"!==this.nsp)if(this.query){var t="object"==typeof this.query?u.encode(this.query):this.query;l("sending connect packet with query %s",t),this.packet({type:n.CONNECT,query:t})}else this.packet({type:n.CONNECT})},i.prototype.onclose=function(t){l("close (%s)",t),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",t)},i.prototype.onpacket=function(t){var e=t.nsp===this.nsp,r=t.type===n.ERROR&&"/"===t.nsp;if(e||r)switch(t.type){case n.CONNECT:this.onconnect();break;case n.EVENT:case n.BINARY_EVENT:this.onevent(t);break;case n.ACK:case n.BINARY_ACK:this.onack(t);break;case n.DISCONNECT:this.ondisconnect();break;case n.ERROR:this.emit("error",t.data)}},i.prototype.onevent=function(t){var e=t.data||[];l("emitting event %j",e),null!=t.id&&(l("attaching ack callback to event"),e.push(this.ack(t.id))),this.connected?d.apply(this,e):this.receiveBuffer.push(e)},i.prototype.ack=function(t){var e=this,r=!1;return function(){if(!r){r=!0;var i=a(arguments);l("sending ack %j",i),e.packet({type:c(i)?n.BINARY_ACK:n.ACK,id:t,data:i})}}},i.prototype.onack=function(t){var e=this.acks[t.id];"function"==typeof e?(l("calling ack %s with %j",t.id,t.data),e.apply(this,t.data),delete this.acks[t.id]):l("bad ack %s",t.id)},i.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},i.prototype.emitBuffered=function(){var t;for(t=0;t<this.receiveBuffer.length;t++)d.apply(this,this.receiveBuffer[t]);for(this.receiveBuffer=[],t=0;t<this.sendBuffer.length;t++)this.packet(this.sendBuffer[t]);this.sendBuffer=[]},i.prototype.ondisconnect=function(){l("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},i.prototype.destroy=function(){if(this.subs){for(var t=0;t<this.subs.length;t++)this.subs[t].destroy();this.subs=null}this.io.destroy(this)},i.prototype.close=i.prototype.disconnect=function(){return this.connected&&(l("performing disconnect (%s)",this.nsp),this.packet({type:n.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},i.prototype.compress=function(t){return this.flags.compress=t,this},i.prototype.binary=function(t){return this.flags.binary=t,this}},function(t,e){t.exports=function(t,e){for(var r=[],i=(e=e||0)||0;i<t.length;i++)r[i-e]=t[i];return r}},function(t,e){t.exports=function(t,e,r){return t.on(e,r),{destroy:function(){t.removeListener(e,r)}}}},function(t,e){var r=[].slice;t.exports=function(t,e){if("string"==typeof e&&(e=t[e]),"function"!=typeof e)throw new Error("bind() requires a function");var i=r.call(arguments,2);return function(){return e.apply(t,i.concat(r.call(arguments)))}}},function(t,e){function r(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}t.exports=r,r.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),r=Math.floor(e*this.jitter*t);t=0==(1&Math.floor(10*e))?t-r:t+r}return 0|Math.min(t,this.max)},r.prototype.reset=function(){this.attempts=0},r.prototype.setMin=function(t){this.ms=t},r.prototype.setMax=function(t){this.max=t},r.prototype.setJitter=function(t){this.jitter=t}}])})),function(t,e){if("function"==typeof define&&define.amd)define(["exports"],e);else if("undefined"!=typeof exports)e(exports);else{var r={exports:{}};e(r.exports),t.bodyScrollLock=r.exports}}(this,(function(t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e=!1;if("undefined"!=typeof window){var r={get passive(){e=!0}};window.addEventListener("testPassive",null,r),window.removeEventListener("testPassive",null,r)}var i="undefined"!=typeof window&&window.navigator&&window.navigator.platform&&(/iP(ad|hone|od)/.test(window.navigator.platform)||"MacIntel"===window.navigator.platform&&window.navigator.maxTouchPoints>1),n=[],o=!1,a=-1,s=void 0,h=void 0,l=void 0,u=function(t){return n.some((function(e){return!(!e.options.allowTouchMove||!e.options.allowTouchMove(t))}))},c=function(t){var e=t||window.event;return!!u(e.target)||(e.touches.length>1||(e.preventDefault&&e.preventDefault(),!1))},p=function(){void 0!==l&&(document.body.style.paddingRight=l,l=void 0),void 0!==s&&(document.body.style.overflow=s,s=void 0)},d=function(){if(void 0!==h){var t=-parseInt(document.body.style.top,10),e=-parseInt(document.body.style.left,10);document.body.style.position=h.position,document.body.style.top=h.top,document.body.style.left=h.left,window.scrollTo(e,t),h=void 0}};t.disableBodyScroll=function(t,r){if(t){if(!n.some((function(e){return e.targetElement===t}))){var p={targetElement:t,options:r||{}};n=[].concat(function(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return Array.from(t)}(n),[p]),i?window.requestAnimationFrame((function(){if(void 0===h){h={position:document.body.style.position,top:document.body.style.top,left:document.body.style.left};var t=window,e=t.scrollY,r=t.scrollX,i=t.innerHeight;document.body.style.position="fixed",document.body.style.top=-e,document.body.style.left=-r,setTimeout((function(){return window.requestAnimationFrame((function(){var t=i-window.innerHeight;t&&e>=i&&(document.body.style.top=-(e+t))}))}),300)}})):function(t){if(void 0===l){var e=!!t&&!0===t.reserveScrollBarGap,r=window.innerWidth-document.documentElement.clientWidth;if(e&&r>0){var i=parseInt(window.getComputedStyle(document.body).getPropertyValue("padding-right"),10);l=document.body.style.paddingRight,document.body.style.paddingRight=i+r+"px"}}void 0===s&&(s=document.body.style.overflow,document.body.style.overflow="hidden")}(r),i&&(t.ontouchstart=function(t){1===t.targetTouches.length&&(a=t.targetTouches[0].clientY)},t.ontouchmove=function(e){1===e.targetTouches.length&&function(t,e){var r=t.targetTouches[0].clientY-a;!u(t.target)&&(e&&0===e.scrollTop&&r>0||function(t){return!!t&&t.scrollHeight-t.scrollTop<=t.clientHeight}(e)&&r<0?c(t):t.stopPropagation())}(e,t)},o||(document.addEventListener("touchmove",c,e?{passive:!1}:void 0),o=!0))}}else console.error("disableBodyScroll unsuccessful - targetElement must be provided when calling disableBodyScroll on IOS devices.")},t.clearAllBodyScrollLocks=function(){i&&(n.forEach((function(t){t.targetElement.ontouchstart=null,t.targetElement.ontouchmove=null})),o&&(document.removeEventListener("touchmove",c,e?{passive:!1}:void 0),o=!1),a=-1),i?d():p(),n=[]},t.enableBodyScroll=function(t){t?(n=n.filter((function(e){return e.targetElement!==t})),i&&(t.ontouchstart=null,t.ontouchmove=null,o&&0===n.length&&(document.removeEventListener("touchmove",c,e?{passive:!1}:void 0),o=!1)),i?d():p()):console.error("enableBodyScroll unsuccessful - targetElement must be provided when calling enableBodyScroll on IOS devices.")}}));